(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    154333,       3820]
NotebookOptionsPosition[    139914,       3590]
NotebookOutlinePosition[    140471,       3610]
CellTagsIndexPosition[    140428,       3607]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Print", "[", 
  "\"\<You'll have to make sure that H1D, H1DD etc. appear in coefficients \
(i.e., change updateCoeffs and the simple version of this) to include H1D \
etc. even if Taylor is off.  I think those coefficients should anyway be \
there, it really doesn't hurt. \>\"", "]"}]], "Input",
 CellChangeTimes->{{3.764599368151305*^9, 3.764599440213257*^9}, 
   3.7646595741075416`*^9},ExpressionUUID->"4ca4b9d9-846b-46b4-b112-\
0cb42625de0f"],

Cell[BoxData["\<\"You'll have to make sure that H1D, H1DD etc. appear in \
coefficients (i.e., change updateCoeffs and the simple version of this) to \
include H1D etc. even if Taylor is off.  I think those coefficients should \
anyway be there, it really doesn't hurt. \"\>"], "Print",
 CellChangeTimes->{
  3.765025939447172*^9},ExpressionUUID->"dc94ee06-5ad0-4e39-ab16-\
93b531d48cf4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Print", "[", 
  "\"\<To calculate the effective Hamiltonian, first set parameters \
accordingly (mainly H[t], max, coeffs, offResonant, tay-lor) and then compute \
\\n--> effH[H[t]]. \n\\n For the Magnus-Taylor Expansion, use \\n--> M[H[t], \
max].\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.752381869064521*^9, 3.752382058975713*^9}, {
   3.7523821134936733`*^9, 3.7523821751548*^9}, 
   3.7646595936759768`*^9},ExpressionUUID->"a82f85ff-6ab6-429d-96e5-\
72212a236b30"],

Cell[BoxData[
 RowBox[{"(*", " ", "\[IndentingNewLine]", "        ", 
  RowBox[{
  "CALCULATE", " ", "EFFECTIVE", " ", "HAMILTONIAN", " ", "IN", " ", "*", 
   "ONE", "*", " ", "FUNCTION"}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.732783774703618*^9, 3.7327838042880573`*^9}, {
   3.7384017729937963`*^9, 3.738401803320197*^9}, 
   3.761630091064342*^9},ExpressionUUID->"20252e72-40cd-4630-af8f-\
52bb575015b5"],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.714032593196076*^9, 
  3.71403259418537*^9}},ExpressionUUID->"f5e9d183-5db7-4f18-92c7-\
227a9b359052"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "                          ", 
  RowBox[{"(*", " ", "INITIALIZATION", " ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6884714867492723`*^9, 3.688471495525632*^9}, {
   3.688472833211739*^9, 3.688472909638434*^9}, 3.688472943053876*^9, {
   3.688472974235373*^9, 3.688472992314371*^9}, {3.688473271051791*^9, 
   3.688473359479607*^9}, {3.688474213194075*^9, 
   3.6884742218427362`*^9}},ExpressionUUID->"f2f2cb5e-57c8-4587-bb8f-\
3708b18289f9"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"<<", "Utilities`CleanSlate`"}], "*)"}]], "Input",
 CellChangeTimes->{{3.740750848764427*^9, 3.740750848773137*^9}, 
   3.740750939928162*^9, 
   3.740750987584403*^9},ExpressionUUID->"f0207cac-380f-4d9a-a587-\
f09b4159e0e6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Print", "[", 
  "\"\<Issue:  Truth be told, the parameter A has units of energy squared \
(which is in conflict with coeffs1={{A,1}} \[NotEqual] {{A,2}}.\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7650897724022923`*^9, 
  3.76508982940156*^9}},ExpressionUUID->"b0a534cd-003a-4d16-9f7c-\
404a60621bf3"],

Cell[BoxData["\<\"Issue:  Truth be told, the parameter A has units of energy \
squared (which is in conflict with coeffs1={{A,1}} \[NotEqual] \
{{A,2}}.\"\>"], "Print",
 CellChangeTimes->{
  3.765089833279623*^9},ExpressionUUID->"b733febc-7a3f-4300-b1e0-\
2f8b0925d4a4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"INPUT", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Generic", " ", "Hamiltonian"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", "t_", "]"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["H1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "phi", "]"}], "sx"}], "+", 
         RowBox[{"sx", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "t", " ", "ww"}], "+", "phi"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "phi", "]"}], "sy"}], "-", 
         RowBox[{"sy", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "t", " ", "ww"}], "+", "phi"}], "]"}]}]}], 
        ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Delta", "/", "2"}], ")"}], "sz"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "take", " ", "care", " ", "of", " ", "this", " ", "just", " ", "before", 
     " ", "the", " ", "actual", " ", 
     RowBox[{"compuration", ":", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"/.", 
         RowBox[{"phi", "\[Rule]", "0"}]}], "/.", 
        RowBox[{"Delta", "\[Rule]", "0"}]}], "}"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"set", " ", "maximum", " ", "order", " ", "of", " ", 
      RowBox[{"1", "/", "ww"}]}], ",", " ", 
     RowBox[{
     "and", " ", "set", " ", "up", " ", "list", " ", "of", " ", 
      "coefficients", " ", 
      RowBox[{"(", 
       RowBox[{"for", " ", "sTrim"}], ")"}]}], ",", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"in", " ", "case", " ", "of", " ", "taylor"}], " ", "\[Equal]", 
      " ", 
      RowBox[{
      "True", " ", "the", " ", "highest", " ", "\"\<reasonable\>\"", " ", 
       "max", " ", "is", " ", "5"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"max", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"max", "=", "0"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"coeffs1", " ", "=", " ", 
     RowBox[{"time", "-", 
      RowBox[{
      "dependent", " ", "coefficients", " ", "of", " ", "original", " ", 
       RowBox[{"Hamiltonian", " ", "[", 
        RowBox[{"no", " ", "derivatives"}], "]"}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffs1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"H1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"H2", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffs1", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"A", ",", "1"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"offResonant", " ", "=", " ", 
     RowBox[{"True", " ", "or", " ", "False"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"offResonant", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"taylor", " ", "Expansion"}], " ", "=", " ", 
     RowBox[{"True", " ", "or", " ", "False"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"taylor", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"taylor", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "should", " ", "we", " ", "include", " ", "coefficients", " ", "H1D"}], 
     ",", " ", "H2D", ",", " ", 
     RowBox[{"H1DD", " ", 
      RowBox[{"etc", ".", " ", "in"}], " ", "the", " ", 
      RowBox[{"coefficients", "?", " ", "\[IndentingNewLine]", "I"}], " ", 
      "can", " ", "usually", " ", "keep", " ", "those", " ", "for", " ", 
      "low", " ", "orders", " ", 
      RowBox[{"(", 
       RowBox[{"order", " ", "\[LessEqual]", " ", "5"}], ")"}]}], ",", " ", 
     RowBox[{
      RowBox[{"b", "/", "c"}], " ", "performance", " ", "is", " ", "hardly", 
      " ", "affected", " ", "by", " ", "this"}]}], "\[IndentingNewLine]", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"CoeffsDerivatives", "=", "False"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CoeffsDerivatives", "=", "False"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "how", " ", "much", " ", "output", " ", "should", " ", "be", " ", 
     "written"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"verbose", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"verboseLight", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"verbose", "=", "True"}], ";", "\[IndentingNewLine]", 
     RowBox[{"verboseLight", "=", "True"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"t0", "=", "0"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myDir", "=", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nb1", "=", 
     RowBox[{"NotebookOpen", "[", 
      RowBox[{
      "myDir", " ", "<>", " ", 
       "\"\</scripts/Magnus_script_precalculated.nb\>\""}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"SelectionMove", "[", 
     RowBox[{"nb1", ",", "All", ",", "Notebook"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"SelectionEvaluate", "[", "nb1", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7383435305235815`*^9, 3.738343592495126*^9}, 
   3.7383439885107765`*^9, 3.738346814033387*^9, {3.738347868201682*^9, 
   3.7383478811264215`*^9}, {3.7383480180462527`*^9, 3.738348031894045*^9}, {
   3.738349622067998*^9, 3.7383496222350073`*^9}, 3.738384009688859*^9, {
   3.738392136555678*^9, 3.7383921366032887`*^9}, 3.738398524299714*^9, {
   3.738401751260746*^9, 3.738401751683127*^9}, {3.738401818064953*^9, 
   3.738401818118976*^9}, {3.738402313149651*^9, 3.738402314500173*^9}, {
   3.738403835936941*^9, 3.73840383614491*^9}, {3.7384039423164263`*^9, 
   3.738403942755814*^9}, {3.73840662367668*^9, 3.738406623764216*^9}, {
   3.7384074310297003`*^9, 3.738407456035037*^9}, {3.738408215301742*^9, 
   3.73840821692533*^9}, {3.738408410444408*^9, 3.738408410478509*^9}, {
   3.738408527024033*^9, 3.738408546349365*^9}, {3.738409738544488*^9, 
   3.7384097386151667`*^9}, {3.738410698161747*^9, 3.7384107012545033`*^9}, 
   3.738410732253236*^9, {3.738410835600266*^9, 3.738410836071842*^9}, 
   3.738411307196224*^9, {3.738411775686285*^9, 3.7384117761807613`*^9}, 
   3.738413522998351*^9, 3.7384137293800163`*^9, {3.738575151023292*^9, 
   3.738575152622115*^9}, {3.738575243762333*^9, 3.738575255080852*^9}, {
   3.738575349069961*^9, 3.7385753491094913`*^9}, {3.738575512237668*^9, 
   3.7385755164771*^9}, {3.7385755586355867`*^9, 3.738575562660537*^9}, {
   3.7385758488788233`*^9, 3.738575859155369*^9}, {3.7385784977770243`*^9, 
   3.738578497839757*^9}, {3.738578532534913*^9, 3.738578532566201*^9}, {
   3.738578700358655*^9, 3.738578701294159*^9}, {3.738579695988769*^9, 
   3.7385796960523987`*^9}, {3.738580128035348*^9, 3.738580133106153*^9}, {
   3.7385801832252493`*^9, 3.738580212526276*^9}, {3.738581240035891*^9, 
   3.7385812400973387`*^9}, {3.738581415034849*^9, 3.738581423752041*^9}, 
   3.7385884671138277`*^9, {3.738590511302026*^9, 3.73859051172429*^9}, 
   3.738590556843566*^9, {3.7385914603869762`*^9, 3.738591460866358*^9}, {
   3.738641855484414*^9, 3.7386418557293673`*^9}, {3.7389333694593277`*^9, 
   3.73893336954596*^9}, {3.738933411481882*^9, 3.7389334147995234`*^9}, {
   3.738934368721176*^9, 3.738934385772588*^9}, {3.73893524315198*^9, 
   3.738935243254648*^9}, {3.7401988610234947`*^9, 3.7401988688233633`*^9}, {
   3.7401992248970747`*^9, 3.740199243095538*^9}, {3.7402070681052437`*^9, 
   3.740207068150095*^9}, {3.740207125310916*^9, 3.740207125870207*^9}, {
   3.740219671397649*^9, 3.740219686068626*^9}, {3.740221852715575*^9, 
   3.740221852786862*^9}, {3.740292975895082*^9, 3.740292982942132*^9}, {
   3.740293059282669*^9, 3.740293059338771*^9}, {3.740308714788521*^9, 
   3.74030871706982*^9}, {3.740309002910595*^9, 3.740309005869678*^9}, 
   3.740309518076578*^9, 3.7403104014958344`*^9, {3.7403104861384563`*^9, 
   3.740310502049076*^9}, {3.740311503662157*^9, 3.740311524925953*^9}, {
   3.7403121164248447`*^9, 3.740312116982378*^9}, 3.7403299005143223`*^9, {
   3.7403333499146166`*^9, 3.7403333506616592`*^9}, 3.74033699774126*^9, {
   3.74033705683864*^9, 3.740337086610343*^9}, {3.740337256001032*^9, 
   3.7403372560470343`*^9}, 3.740338860730817*^9, {3.740339210432819*^9, 
   3.7403392151770897`*^9}, 3.740339336264016*^9, 3.740339380150526*^9, 
   3.7403403293248158`*^9, 3.7403404103894525`*^9, 3.7403738753614264`*^9, 
   3.7403740989030247`*^9, 3.740374181115033*^9, {3.740374524889247*^9, 
   3.7403745274409246`*^9}, {3.740384336691969*^9, 3.7403843445818357`*^9}, {
   3.7403849662956467`*^9, 3.740384967350648*^9}, {3.740385010781375*^9, 
   3.740385010836364*^9}, {3.740385146934599*^9, 3.740385147045621*^9}, {
   3.740386829531695*^9, 3.740386829641467*^9}, {3.7403905192967052`*^9, 
   3.740390521486972*^9}, {3.7403909385710897`*^9, 3.740390938617783*^9}, {
   3.740392058195281*^9, 3.740392058297323*^9}, {3.740392722225679*^9, 
   3.7403927582311897`*^9}, {3.740392839563715*^9, 3.740392839698667*^9}, {
   3.740458433440836*^9, 3.740458433527856*^9}, {3.740460922226788*^9, 
   3.740460922337441*^9}, {3.740460960920541*^9, 3.740460961023459*^9}, {
   3.740461101689467*^9, 3.7404611023282747`*^9}, {3.740472181263006*^9, 
   3.740472181725566*^9}, {3.74047233296546*^9, 3.740472333567519*^9}, {
   3.740472443223022*^9, 3.740472449542514*^9}, {3.740472530033896*^9, 
   3.740472538706599*^9}, {3.7404767762141647`*^9, 3.740476778548807*^9}, {
   3.7404770123623857`*^9, 3.74047701242161*^9}, {3.740485983024932*^9, 
   3.74048598311804*^9}, {3.740486282472248*^9, 3.7404862825748587`*^9}, 
   3.740486878516363*^9, 3.740486917328939*^9, 3.740486985349725*^9, {
   3.7404877684233217`*^9, 3.740487786725456*^9}, {3.740491091763782*^9, 
   3.740491123265812*^9}, {3.7404911580641327`*^9, 3.740491158110881*^9}, {
   3.740491218061145*^9, 3.740491218116973*^9}, 3.7404915266383953`*^9, 
   3.740492739192333*^9, {3.740494159227776*^9, 3.7404941619760733`*^9}, 
   3.740494334033304*^9, 3.7404944621466637`*^9, 3.740494948459724*^9, 
   3.7404951516723757`*^9, {3.740497433696289*^9, 3.7404974422955*^9}, 
   3.74049748148528*^9, 3.740497587400281*^9, {3.740497706810161*^9, 
   3.74049770800068*^9}, {3.740574137663707*^9, 3.7405741444112997`*^9}, 
   3.740574178241487*^9, 3.740635035321291*^9, {3.7406354932417593`*^9, 
   3.740635493288329*^9}, 3.740638185700202*^9, {3.740639946948242*^9, 
   3.740639947058135*^9}, 3.740640026775754*^9, {3.740640113556769*^9, 
   3.740640113626382*^9}, 3.740640233797922*^9, 3.740640287835145*^9, {
   3.740640488410193*^9, 3.740640488960527*^9}, {3.740640665912291*^9, 
   3.740640666558778*^9}, 3.7406407845309467`*^9, {3.74064082929629*^9, 
   3.7406408525226316`*^9}, 3.740640889253675*^9, 3.740640935502719*^9, 
   3.740641023616914*^9, {3.7406417480989237`*^9, 3.740641749745139*^9}, 
   3.740641841177815*^9, {3.740642330686594*^9, 3.7406423373027*^9}, {
   3.740642406753251*^9, 3.740642432565411*^9}, {3.740642486093115*^9, 
   3.740642564655777*^9}, {3.740642604446837*^9, 3.7406426049337587`*^9}, 
   3.740642897847465*^9, 3.7406430386733522`*^9, {3.740643139708035*^9, 
   3.740643140113288*^9}, 3.7406431829292603`*^9, {3.7406433799349833`*^9, 
   3.740643380386326*^9}, 3.740643710655932*^9, {3.740643793674638*^9, 
   3.740643794272607*^9}, {3.74064514943439*^9, 3.740645149518373*^9}, {
   3.7406458887334337`*^9, 3.740645891065385*^9}, 3.7406468402833347`*^9, {
   3.740647513807365*^9, 3.74064751388492*^9}, 3.740647613114017*^9, {
   3.740648307076623*^9, 3.740648308366713*^9}, 3.7406487557266493`*^9, {
   3.740652551459551*^9, 3.740652572283136*^9}, 3.740652618735984*^9, {
   3.740658821040663*^9, 3.7406588256819572`*^9}, 3.740659515672008*^9, 
   3.740715272248034*^9, 3.740716653357399*^9, 3.7407173656309834`*^9, {
   3.740721232279829*^9, 3.740721273406143*^9}, {3.740724049623909*^9, 
   3.740724058935175*^9}, {3.740724880076262*^9, 3.740724880635909*^9}, 
   3.740725130608926*^9, 3.7407364871920357`*^9, {3.7407365436139507`*^9, 
   3.740736543669343*^9}, {3.740737159765951*^9, 3.74073716137358*^9}, {
   3.740738969294157*^9, 3.740738993146579*^9}, {3.7407390647858543`*^9, 
   3.7407390648355722`*^9}, {3.740740220677424*^9, 3.7407402207425337`*^9}, 
   3.740740338515524*^9, {3.740747629981555*^9, 3.7407476300761023`*^9}, 
   3.740747693425878*^9, 3.7407478194961*^9, 3.7407479263472223`*^9, {
   3.740748087980647*^9, 3.740748088058902*^9}, {3.740748585667184*^9, 
   3.740748594889655*^9}, {3.740748660551065*^9, 3.740748660630777*^9}, {
   3.740748735851398*^9, 3.7407487359949837`*^9}, 3.7407488857959757`*^9, {
   3.740749008870125*^9, 3.7407490274928827`*^9}, {3.740749241899077*^9, 
   3.740749259018107*^9}, {3.7407499217913837`*^9, 3.740749960268718*^9}, {
   3.740750100278956*^9, 3.7407501716390047`*^9}, {3.7407502143043013`*^9, 
   3.740750214359859*^9}, {3.740750594877228*^9, 3.740750606908331*^9}, {
   3.740750793163335*^9, 3.740750804402315*^9}, 3.741673293022571*^9, 
   3.742215501451941*^9, 3.7617093524253273`*^9, {3.761726172242008*^9, 
   3.761726173568011*^9}, {3.761739064877285*^9, 3.761739064924085*^9}, 
   3.7617397169034634`*^9, {3.7617398412552824`*^9, 3.7617398418480835`*^9}, {
   3.7617552513891068`*^9, 3.761755251435109*^9}, {3.761755416509551*^9, 
   3.761755417521609*^9}, {3.7617562520423403`*^9, 3.7617562630229683`*^9}, {
   3.761758195814518*^9, 3.761758202566904*^9}, {3.7617734104380636`*^9, 
   3.7617734109650936`*^9}, {3.7618068994697247`*^9, 
   3.7618069021529293`*^9}, {3.761836200773692*^9, 3.7618362302889657`*^9}, 
   3.761836366639292*^9, {3.7646595225752497`*^9, 3.764659564227724*^9}, {
   3.764659635708251*^9, 3.7646596362386518`*^9}, {3.764666921051627*^9, 
   3.764666932555068*^9}, {3.764667265306301*^9, 3.7646672653618097`*^9}, 
   3.764668026442363*^9, {3.7650174808301077`*^9, 3.765017520236777*^9}, {
   3.765027366024781*^9, 3.7650273675067835`*^9}, 
   3.7650274494727345`*^9},ExpressionUUID->"3e852b33-5c33-46e5-bc78-\
cd6f7bab6f6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NotebookSave", "[", "nb1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookClose", "[", "nb1", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "contains", " ", "NCAlgebra", " ", "initialization", " ", "and", " ", 
    "MagnusM", " ", "and", " ", "MAgnusM2"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nb2", "=", 
   RowBox[{"NotebookOpen", "[", 
    RowBox[{
    "myDir", " ", "<>", " ", "\"\</scripts/Magnus_scriptKick.nb\>\""}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SelectionMove", "[", 
   RowBox[{"nb2", ",", "All", ",", "Notebook"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SelectionEvaluate", "[", "nb2", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.685081151890257*^9, 3.6850811964694767`*^9}, {
   3.685275972411356*^9, 3.685275984563027*^9}, {3.685276822647539*^9, 
   3.6852768269825068`*^9}, {3.685450714481812*^9, 3.68545071795362*^9}, {
   3.686278936153943*^9, 3.686278936426072*^9}, 3.6882953536455317`*^9, {
   3.6883845937331953`*^9, 3.688384594005246*^9}, {3.688468933843193*^9, 
   3.688468951146367*^9}, {3.688471011559143*^9, 3.6884710131987743`*^9}, 
   3.688471164823751*^9, {3.6884733401520157`*^9, 3.688473341472767*^9}, {
   3.6884735005198107`*^9, 3.688473501679611*^9}, {3.688473546397324*^9, 
   3.6884735507011003`*^9}, {3.688473616687544*^9, 3.688473635080621*^9}, {
   3.6884736835982943`*^9, 3.6884736871260347`*^9}, {3.688474079697554*^9, 
   3.6884741013682947`*^9}, 3.688474216218045*^9, {3.688474974194021*^9, 
   3.688475018471794*^9}, {3.688475071221035*^9, 3.6884751101876287`*^9}, 
   3.6884780231903477`*^9, {3.688478144204636*^9, 3.688478147138968*^9}, {
   3.688478187930819*^9, 3.6884781962411947`*^9}, {3.688478286796315*^9, 
   3.6884782868604307`*^9}, {3.688478375353519*^9, 3.688478376535694*^9}, 
   3.688478412062446*^9, 3.688478451760972*^9, 3.6884784834916887`*^9, {
   3.688478665778397*^9, 3.688478693383504*^9}, {3.688478919138769*^9, 
   3.688478960248755*^9}, {3.688479079291738*^9, 3.688479102345035*^9}, {
   3.708228244573203*^9, 3.70822826061077*^9}, {3.713190842568857*^9, 
   3.7131908464242754`*^9}, {3.7132437338557987`*^9, 3.713243755294389*^9}, {
   3.7403320673632584`*^9, 3.7403320687963405`*^9}, 3.7403322219771023`*^9, 
   3.7403322744251018`*^9, {3.740641498343997*^9, 3.740641617008659*^9}, {
   3.7406416519829903`*^9, 3.7406416683500977`*^9}, 3.7406417255656*^9, 
   3.74064512142348*^9, {3.740652550477673*^9, 3.740652590239407*^9}, {
   3.740652642277026*^9, 3.740652647116197*^9}, 3.765015801482356*^9, {
   3.765043666935778*^9, 
   3.765043667325779*^9}},ExpressionUUID->"5d09364e-3d5d-40ff-9167-\
a0fe715cd7fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "INPUT", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"coefficients", "=", 
     RowBox[{
     "\"\<simple\>\"", " ", "\[IndentingNewLine]", "in", " ", "case", " ", 
      "there", " ", "are", " ", "at", " ", "most", " ", "two", " ", 
      "coefficients"}]}], ",", " ", 
    RowBox[{
    "which", " ", "we", " ", "call", " ", "H1", " ", "and", " ", "H2"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"coefficients", "=", "\"\<simple\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coefficients", "=", "\"\<NotSoSimple\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"coefficients", "\[Equal]", "\"\<simple\>\""}], ",", 
      "\[IndentingNewLine]", "updateCoeffsSimple", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "otherwise", " ", "determine", " ", "the", " ", "coefficients", " ", 
        "laboriously"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"updateCoeffs", ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "myCList"}]}]], "Input",
 CellChangeTimes->{{3.7406429814784193`*^9, 3.740642984645341*^9}, {
  3.740652582010498*^9, 3.7406525871291018`*^9}, {3.7406591170593443`*^9, 
  3.7406591210958853`*^9}, {3.740659199198168*^9, 
  3.7406592005792627`*^9}},ExpressionUUID->"ced70536-88f4-4ea4-9f46-\
8a80b9f13171"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "A", "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      SuperscriptBox["A", "2"], "}"}], ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7406592011673717`*^9, 3.740659246014126*^9, 3.740659522952222*^9, {
   3.7407153071943703`*^9, 3.740715332735564*^9}, 3.740716658670932*^9, 
   3.7407167998411837`*^9, 3.740717312017552*^9, 3.7407173741694193`*^9, 
   3.74072119570942*^9, 3.740721278626651*^9, 3.740724070840911*^9, 
   3.7407248201765537`*^9, {3.740724884370697*^9, 3.740724892744693*^9}, 
   3.740725146935555*^9, 3.740736115091712*^9, 3.740736496053054*^9, {
   3.740736587789515*^9, 3.7407365924775753`*^9}, 3.740737169357251*^9, 
   3.740738878478427*^9, {3.740738985855246*^9, 3.740738997813861*^9}, 
   3.740739071572158*^9, 3.740739935621172*^9, 3.740740227811376*^9, 
   3.740741352109593*^9, 3.7407414111618023`*^9, {3.740741497379506*^9, 
   3.7407415038439493`*^9}, 3.740742657622654*^9, 3.7407429891549892`*^9, 
   3.7407458440466833`*^9, 3.7407458999288273`*^9, 3.7407464599580173`*^9, 
   3.740747047494331*^9, 3.7407475439648247`*^9, 3.740747602487585*^9, 
   3.740747741311721*^9, 3.7407478006468287`*^9, 3.7407478375702467`*^9, 
   3.740747878386138*^9, 3.740747936732877*^9, 3.7407479791139917`*^9, 
   3.740748094694908*^9, {3.740748602749382*^9, 3.740748631545158*^9}, 
   3.740748743085099*^9, 3.740748780786615*^9, 3.7407489060709543`*^9, {
   3.7407489472942257`*^9, 3.740748960956913*^9}, 3.740749031992361*^9, 
   3.74074919347042*^9, {3.740749245547616*^9, 3.740749264142542*^9}, {
   3.740749904318242*^9, 3.740749964400126*^9}, {3.7407501140313807`*^9, 
   3.740750129710478*^9}, 3.740750181588067*^9, 3.7407502189418497`*^9, 
   3.740750299594125*^9, {3.740750573617955*^9, 3.7407506102824574`*^9}, 
   3.74075068021546*^9, {3.740750779230105*^9, 3.740750807706992*^9}, 
   3.740750875114811*^9, 3.7407509478053093`*^9, 3.740750993111856*^9, 
   3.740751328654777*^9, {3.740751364809951*^9, 3.740751377586933*^9}, 
   3.74075184354792*^9, 3.740751902137144*^9, 3.740752058038583*^9, 
   3.740752183911236*^9, 3.740753391590843*^9, 3.7407537552395897`*^9, 
   3.7407538488702173`*^9, {3.740754434639853*^9, 3.7407544406908407`*^9}, {
   3.740754598846939*^9, 3.740754625429432*^9}, 3.7422161695878773`*^9, 
   3.752558008676776*^9, 3.7616219845096283`*^9, 3.7616300164152107`*^9, 
   3.7616405714699993`*^9, 3.761709358556138*^9, 3.761711890145008*^9, {
   3.7617261618055897`*^9, 3.7617261800108223`*^9}, 3.7617375572345557`*^9, 
   3.7617390787457094`*^9, 3.7617393582214303`*^9, 3.761739514472508*^9, 
   3.7617396167170877`*^9, {3.76173980588802*^9, 3.761739820115245*^9}, 
   3.7617398584777126`*^9, 3.7617550666055374`*^9, 3.7617552037223797`*^9, 
   3.761755260879649*^9, 3.7617555510922484`*^9, 3.76175628158003*^9, 
   3.7617578391331167`*^9, 3.7617582103673506`*^9, 3.7617734191475616`*^9, 
   3.761782691976875*^9, 3.7618045287270575`*^9, 3.7618069094743423`*^9, {
   3.7618362171813345`*^9, 3.76183623642038*^9}, 3.761836373052511*^9, 
   3.7620091502019*^9, 3.762084695421937*^9, 3.764666422360326*^9, {
   3.764667253219988*^9, 3.764667269383789*^9}, 3.764668040668469*^9, 
   3.765002254972953*^9, 3.765025321783287*^9, 3.765027390519231*^9, 
   3.7650274635607643`*^9, 3.765042807680065*^9, 
   3.7650862701744328`*^9},ExpressionUUID->"feacbfae-0df4-40b5-b925-\
e5dbbcb9dc2b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NotebookSave", "[", "nb2", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookClose", "[", "nb2", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.688478940385738*^9, 3.688478971687812*^9}, {
   3.688479051036357*^9, 3.6884790624268093`*^9}, {3.713243742782855*^9, 
   3.713243745574942*^9}, 3.7134643479667177`*^9, {3.7406526550999537`*^9, 
   3.740652656932131*^9}},ExpressionUUID->"979da102-f84f-420e-bffe-\
4224c634faf9"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.74047754301464*^9},ExpressionUUID->"01c6a39b-8681-4d07-a3ce-03153f81afe3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"verbose", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"verboseLight", "=", "True"}], ";"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.761622906897386*^9, 3.7616229159519043`*^9}, {
  3.7617375640829678`*^9, 3.7617375645197687`*^9}, {3.7617396324263153`*^9, 
  3.7617396328943157`*^9}, {3.7617550778311796`*^9, 
  3.7617550817174015`*^9}},ExpressionUUID->"ad8e1d9a-cf2e-4926-b4c9-\
48b499705865"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"verbose", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"verboseLight", "=", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.761622906897386*^9, 3.7616229159519043`*^9}, {
  3.7617375640829678`*^9, 3.7617375645197687`*^9}, {3.7617396324263153`*^9, 
  3.7617396328943157`*^9}, {3.761773437908635*^9, 
  3.761773440784799*^9}},ExpressionUUID->"98457cf9-d50b-416f-9904-\
4ab70395bc42"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"$RecursionLimit", "=", "5000"}], "*)"}]], "Input",
 CellChangeTimes->{{3.74048911586637*^9, 3.740489128266183*^9}, {
   3.740490183439399*^9, 3.740490193705366*^9}, 3.740491661061801*^9, {
   3.7404918562279053`*^9, 3.740491856269991*^9}, {3.740492753662826*^9, 
   3.7404927597185097`*^9}, {3.740492844130252*^9, 3.740492844297307*^9}, {
   3.7404929830034847`*^9, 3.740492984066615*^9}, {3.740494318825605*^9, 
   3.740494321367799*^9}, 
   3.74064869107697*^9},ExpressionUUID->"2c66e7b0-248b-4b40-89a4-\
801d97843ca2"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.740740242893029*^9},ExpressionUUID->"8375cb07-c38d-44be-880e-\
f831650195b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HEff", "[", "t_", "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"256", " ", 
      SuperscriptBox["ww", "2"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Delta", " ", 
       SuperscriptBox["H1", "2"], " ", "sz"}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", "ww"}], "+", 
      RowBox[{"128", " ", "Delta", " ", "sz", " ", 
       SuperscriptBox["ww", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
      RowBox[{"64", " ", "H1", " ", "sx", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
      RowBox[{"16", " ", 
       SuperscriptBox["Delta", "2"], " ", "H1", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
      RowBox[{"16", " ", "H1DD", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "-", 
      RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
      RowBox[{"32", " ", "Delta", " ", "H1", " ", "sx", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
      RowBox[{"32", " ", "H1D", " ", "sy", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
      RowBox[{"8", " ", "Delta", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Beta]0"}], "]"}]}], "-", 
      RowBox[{"16", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Beta]0"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Beta]0"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
      RowBox[{"64", " ", "H1", " ", "sy", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
      RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
      RowBox[{"16", " ", 
       SuperscriptBox["Delta", "2"], " ", "H1", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "-", 
      RowBox[{"16", " ", "H1DD", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
      RowBox[{"32", " ", "H1D", " ", "sx", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "-", 
      RowBox[{"32", " ", "Delta", " ", "H1", " ", "sy", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
      RowBox[{"24", " ", "H1", " ", "H1D", " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Beta]0"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Beta]0"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "take", " ", "care", " ", "of", " ", "this", " ", "just", " ", "before", 
     " ", "the", " ", "actual", " ", 
     RowBox[{"compuration", ":", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"/.", 
         RowBox[{"phi", "\[Rule]", "0"}]}], "/.", 
        RowBox[{"Delta", "\[Rule]", "0"}]}], "}"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H1DD", "\[Rule]", "0"}], ",", 
      RowBox[{"H1D", "\[Rule]", 
       RowBox[{"0", "*"}]}], ",", " ", 
      RowBox[{"etc", "."}]}], "}"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7617558288251343`*^9, 3.76175584903629*^9}, {
   3.7617734506853657`*^9, 3.761773462550044*^9}, {3.7618048445732994`*^9, 
   3.7618048492377076`*^9}, {3.76180692523437*^9, 3.761806935406588*^9}, {
   3.7618362534470186`*^9, 3.7618362556274233`*^9}, 3.76183639218336*^9, 
   3.7621546522007637`*^9, 3.7646604792268248`*^9, {3.764661351039524*^9, 
   3.7646613539879293`*^9}, {3.764752121093195*^9, 3.764752123433199*^9}, {
   3.7650175320927973`*^9, 
   3.7650175588946447`*^9}},ExpressionUUID->"e05ba944-752d-4a7c-9921-\
21f783746504"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "if", " ", "you", " ", "need", " ", "to", " ", "go", " ", "to", " ", "3", 
    "rd", " ", "order", " ", "and", " ", "do", " ", "not", " ", "care", " ", 
    "about", " ", "the", " ", "phi", " ", "and", " ", "Delta", " ", 
    "dependence"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"HEff3", "[", "t_", "]"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2048", " ", 
       SuperscriptBox["ww", "3"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "16"}], " ", 
        SuperscriptBox["H1", "2"], " ", "H1D", " ", "sy"}], "+", 
       RowBox[{
        SuperscriptBox["H1", "4"], " ", "sz"}], "+", 
       RowBox[{"16", " ", 
        SuperscriptBox["H1D", "2"], " ", "sz"}], "-", 
       RowBox[{"32", " ", "H1", " ", "H1DD", " ", "sz"}], "-", 
       RowBox[{"16", " ", 
        SuperscriptBox["H1", "3"], " ", "sx", " ", "ww"}], "+", 
       RowBox[{"64", " ", 
        SuperscriptBox["H1", "2"], " ", "sz", " ", 
        SuperscriptBox["ww", "2"]}], "+", 
       RowBox[{"512", " ", "H1", " ", "sx", " ", 
        SuperscriptBox["ww", "3"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["H1", "4"], " ", "sz"}], "-", 
          RowBox[{"64", " ", "H1", " ", "H1DD", " ", "sz"}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["H1", "3"], " ", "sx", " ", "ww"}], "+", 
          RowBox[{"16", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "H1DDD", " ", "sy"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["H1D", "2"], " ", "sz"}], "-", 
             RowBox[{"4", " ", "H1DD", " ", "sx", " ", "ww"}], "-", 
             RowBox[{"8", " ", "H1D", " ", "sy", " ", 
              SuperscriptBox["ww", "2"]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["H1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "36"}], " ", "H1D", " ", "sy"}], "+", 
             RowBox[{"64", " ", "sz", " ", 
              SuperscriptBox["ww", "2"]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["H1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "18"}], " ", "H1D", " ", "sy"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["H1", "2"], " ", "sz"}], "+", 
          RowBox[{"8", " ", "H1", " ", "sx", " ", "ww"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "-", 
       RowBox[{"24", " ", 
        SuperscriptBox["H1", "2"], " ", "H1D", " ", "sx", " ", 
        RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
       RowBox[{"64", " ", "H1DDD", " ", "sx", " ", 
        RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
       RowBox[{"16", " ", 
        SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
        RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
       RowBox[{"128", " ", "H1DD", " ", "sy", " ", "ww", " ", 
        RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
       RowBox[{"192", " ", "H1", " ", "H1D", " ", "sz", " ", "ww", " ", 
        RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
       RowBox[{"256", " ", "H1D", " ", "sx", " ", 
        SuperscriptBox["ww", "2"], " ", 
        RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["H1", "2"], " ", "H1D", " ", "sx", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Beta]0"}], "]"}]}]}], ")"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.765085199983754*^9, 3.765085229536887*^9}, {
  3.7650852630718*^9, 
  3.765085283708948*^9}},ExpressionUUID->"8b65f213-f932-48dc-b9d2-\
36a9893ead51"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.7645996711055813`*^9, 
  3.7646613625679445`*^9},ExpressionUUID->"1437fa0f-c079-4e87-a779-\
d88b0c24343e"],

Cell[BoxData[
 RowBox[{"Print", "[", 
  "\"\<NOTE:  this file hasn't been tested since adding 'Final Preparation' \
[dated:  April 23]\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.765024203538514*^9, 
  3.765024259640213*^9}},ExpressionUUID->"7a4d1e96-d08d-4ef2-aeae-\
6ec8954a7ad4"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["\t     -----    Final Preparation     -----\t     ",
 FontColor->RGBColor[1, 0, 0]]], "Section",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738406695464067*^9, 3.738406699136009*^9}, {
   3.7384068847910023`*^9, 3.7384068906466017`*^9}, {3.740310753819174*^9, 
   3.7403107699224*^9}, {3.761897946758169*^9, 3.761897957613974*^9}, {
   3.7618979923169527`*^9, 3.761897995148902*^9}, {3.762009263473727*^9, 
   3.762009296031787*^9}, {3.762154673711314*^9, 3.762154675341291*^9}, {
   3.764599638419145*^9, 3.764599676593161*^9}, {3.7650156784043384`*^9, 
   3.765015688575556*^9}},ExpressionUUID->"3e73cf19-09ac-47aa-b338-\
fb6ccb8e4b72"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"const", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"H1D", "\[Rule]", "0"}], ",", 
     RowBox[{"H1DD", "\[Rule]", "0"}], ",", 
     RowBox[{"H1DDD", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"const", "=", 
    RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Delta", "\[Rule]", "0"}], ",", 
    RowBox[{"phi", "\[Rule]", "0"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simpl", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simpl", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Delta", "\[Rule]", "0"}], ",", 
     RowBox[{"phi", "\[Rule]", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7650153548849697`*^9, 3.7650153938246384`*^9}, {
  3.765015431919905*^9, 3.76501544611593*^9}, {3.765018322583787*^9, 
  3.7650183255633926`*^9}, {3.765025388521204*^9, 
  3.7650253960872173`*^9}},ExpressionUUID->"19352712-ec9d-4955-8090-\
52007f9f3aae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"HEff", "[", "t_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"HEff", "[", "t", "]"}], "/.", "simpl"}], "/.", "const"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"HEff", "[", "t_", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"HEff3", "[", "t", "]"}], "/.", "simpl"}], "/.", "const"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", "t_", "]"}], "=", 
     RowBox[{
      RowBox[{"H", "[", "t", "]"}], "/.", "simpl"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.765015348691759*^9, 3.765015352482566*^9}, {
  3.7650157391426463`*^9, 3.7650157529652705`*^9}, {3.765018296952942*^9, 
  3.7650183176541786`*^9}, {3.7650862985157957`*^9, 
  3.7650863019223003`*^9}},ExpressionUUID->"7c404ed9-f29d-4e61-bd83-\
e6be0befdba6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<NOTE:  When you realize you set too many parameters to zero you have \
to redefine H and HEff\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.765025905999714*^9, 3.765025992737866*^9}, {
  3.765086289666848*^9, 
  3.7650862930191107`*^9}},ExpressionUUID->"71bfc88a-47bf-4e2f-b691-\
6c633f5d0565"],

Cell[BoxData["\<\"OPTIONAL:  When you realize you set too many parameters to \
zero you have to redefine H and HEff\"\>"], "Print",
 CellChangeTimes->{
  3.765025935843566*^9, {3.7650259784638405`*^9, 
   3.7650259976674747`*^9}},ExpressionUUID->"a1dabdf3-e250-49f4-a011-\
d6d0d8a35c57"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HEff", "[", "t", "]"}], "//", "S"}]], "Input",
 CellChangeTimes->{{3.765025364075961*^9, 
  3.765025368490769*^9}},ExpressionUUID->"e10ada11-1e90-4560-ae60-\
8763a2ce528a"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2048", " ", 
    SuperscriptBox["ww", "3"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "16"}], " ", 
     SuperscriptBox["H1", "2"], " ", "H1D", " ", "sy"}], "+", 
    RowBox[{
     SuperscriptBox["H1", "4"], " ", "sz"}], "+", 
    RowBox[{"16", " ", 
     SuperscriptBox["H1D", "2"], " ", "sz"}], "-", 
    RowBox[{"32", " ", "H1", " ", "H1DD", " ", "sz"}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["H1", "3"], " ", "sx", " ", "ww"}], "+", 
    RowBox[{"64", " ", 
     SuperscriptBox["H1", "2"], " ", "sz", " ", 
     SuperscriptBox["ww", "2"]}], "+", 
    RowBox[{"512", " ", "H1", " ", "sx", " ", 
     SuperscriptBox["ww", "3"]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["H1", "4"], " ", "sz"}], "-", 
       RowBox[{"64", " ", "H1", " ", "H1DD", " ", "sz"}], "-", 
       RowBox[{"8", " ", 
        SuperscriptBox["H1", "3"], " ", "sx", " ", "ww"}], "+", 
       RowBox[{"16", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "H1DDD", " ", "sy"}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["H1D", "2"], " ", "sz"}], "-", 
          RowBox[{"4", " ", "H1DD", " ", "sx", " ", "ww"}], "-", 
          RowBox[{"8", " ", "H1D", " ", "sy", " ", 
           SuperscriptBox["ww", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["H1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "36"}], " ", "H1D", " ", "sy"}], "+", 
          RowBox[{"64", " ", "sz", " ", 
           SuperscriptBox["ww", "2"]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["H1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "18"}], " ", "H1D", " ", "sy"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["H1", "2"], " ", "sz"}], "+", 
       RowBox[{"8", " ", "H1", " ", "sx", " ", "ww"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "-", 
    RowBox[{"24", " ", 
     SuperscriptBox["H1", "2"], " ", "H1D", " ", "sx", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{"64", " ", "H1DDD", " ", "sx", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"16", " ", 
     SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{"128", " ", "H1DD", " ", "sy", " ", "ww", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"192", " ", "H1", " ", "H1D", " ", "sz", " ", "ww", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"256", " ", "H1D", " ", "sx", " ", 
     SuperscriptBox["ww", "2"], " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"18", " ", 
     SuperscriptBox["H1", "2"], " ", "H1D", " ", "sx", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Beta]0"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.765025370939973*^9, 3.7650253993788233`*^9}, 
   3.765025890259286*^9, 3.765026002472283*^9, 3.765042830847106*^9, 
   3.765086314385108*^9},ExpressionUUID->"e9c95b96-0627-4889-852e-\
76acf775b163"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.76501534950296*^9},ExpressionUUID->"44fbd14d-d93c-4943-9bd3-54cece0d73ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"H1Const", "[", "t_", "]"}], "=", "A"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H1Ramp", "[", "t_", "]"}], "=", 
   RowBox[{"A", "*", "t"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H1Parabolic", "[", "t_", "]"}], "=", 
   RowBox[{"A", "*", 
    SuperscriptBox["t", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H1Gaussian", "[", "t_", "]"}], "=", 
   RowBox[{"A", "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["t", "2"]}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "*", 
        SuperscriptBox["sigma", "2"]}], ")"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.764667349577532*^9, 3.76466740342692*^9}, {
  3.764667521342009*^9, 3.76466753166751*^9}, {3.765088765705709*^9, 
  3.765088779735845*^9}, {3.765089172621368*^9, 
  3.765089172748436*^9}},ExpressionUUID->"6687b4a6-d3da-47c5-98d6-\
f2bfde977b06"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"**", " ", "INPUT"}], " ", "***)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"HH1", "[", "t_", "]"}], "=", 
     RowBox[{"H1Ramp", "[", "t", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"HH1", "[", "t_", "]"}], "=", 
      RowBox[{"H1Gaussian", "[", "t", "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HH1D", "[", "t_", "]"}], "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"HH1", "[", "tt", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"tt", ",", "1"}], "}"}]}], "]"}], "/.", 
      RowBox[{"tt", "\[Rule]", "t"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HH1DD", "[", "t_", "]"}], "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"HH1", "[", "tt", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"tt", ",", "2"}], "}"}]}], "]"}], "/.", 
      RowBox[{"tt", "\[Rule]", "t"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HH1DDD", "[", "t_", "]"}], "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"HH1", "[", "tt", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"tt", ",", "3"}], "}"}]}], "]"}], "/.", 
      RowBox[{"tt", "\[Rule]", "t"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"repHs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"H1", "\[Rule]", 
        RowBox[{"HH1", "[", "t", "]"}]}], ",", 
       RowBox[{"H1D", "\[Rule]", 
        RowBox[{"HH1D", "[", "t", "]"}]}], ",", 
       RowBox[{"H1DD", "\[Rule]", 
        RowBox[{"HH1DD", "[", "t", "]"}]}], ",", 
       RowBox[{"H1DDD", "\[Rule]", 
        RowBox[{"HH1DDD", "[", "t", "]"}]}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.764667317331358*^9, 3.7646673461490993`*^9}, {
  3.764667539019099*^9, 3.7646675936643877`*^9}, {3.764667624584199*^9, 
  3.764667624678524*^9}, {3.764667866964015*^9, 3.7646679286884823`*^9}, {
  3.7647469123722095`*^9, 3.764746921186225*^9}, {3.764746988926544*^9, 
  3.7647469957593565`*^9}, {3.7650863386099863`*^9, 
  3.765086350392108*^9}},ExpressionUUID->"f95d04ef-d89a-434d-ab4b-\
ee5a505f90ef"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.7650436861946163`*^9},ExpressionUUID->"af79d0af-4c43-4558-8334-\
53b816024338"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.765043686896617*^9},ExpressionUUID->"c8ad4bda-7c71-4138-b793-\
2545623ed142"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["\n\t     -----    Exact Hamiltonian     -----\n\t     \
",
 FontColor->RGBColor[1, 0, 0]]], "Section",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738406695464067*^9, 3.738406699136009*^9}, {
   3.7384068847910023`*^9, 3.7384068906466017`*^9}, {3.740310753819174*^9, 
   3.7403107699224*^9}, {3.761897946758169*^9, 3.761897957613974*^9}, {
   3.7618979923169527`*^9, 3.761897995148902*^9}, {3.762009263473727*^9, 
   3.762009296031787*^9}, {3.762154673711314*^9, 3.762154675341291*^9}, {
   3.764599638419145*^9, 
   3.764599676593161*^9}},ExpressionUUID->"3e73cf19-09ac-47aa-b338-\
fb6ccb8e4b72"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.764599667149755*^9},ExpressionUUID->"3516c2c8-c249-4e37-93d8-\
c5bd9c30eb0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["0.   Zeroth Order",
 FontColor->RGBColor[1, 0, 0]]], "Section",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738406695464067*^9, 3.738406699136009*^9}, {
   3.7384068847910023`*^9, 3.7384068906466017`*^9}, {3.740310753819174*^9, 
   3.7403107699224*^9}, {3.761897946758169*^9, 3.761897957613974*^9}, {
   3.7618979923169527`*^9, 3.761897995148902*^9}, {3.762009263473727*^9, 
   3.762009296031787*^9}, {3.762154673711314*^9, 
   3.762154675341291*^9}},ExpressionUUID->"c76a4048-4191-4bff-b2a4-\
592959916690"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.7646672929985533`*^9},ExpressionUUID->"99b29b57-67bd-47b4-a17f-\
0f3da3cfbec6"],

Cell[TextData[StyleBox["0.1   Effective Time Evolution",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738406695464067*^9, 3.738406699136009*^9}, {
   3.7384068847910023`*^9, 3.7384068906466017`*^9}, {3.740310753819174*^9, 
   3.7403107699224*^9}, {3.761897946758169*^9, 3.761897957613974*^9}, {
   3.7618979923169527`*^9, 3.761897995148902*^9}, {3.762009263473727*^9, 
   3.762009296031787*^9}, {3.762154673711314*^9, 3.762154675341291*^9}, {
   3.7646681056060343`*^9, 3.764668120773233*^9}, {3.764668294996427*^9, 
   3.764668299988031*^9}},
 FontSize->14,ExpressionUUID->"6077662a-126f-4b58-8722-6f492046fae6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HEff", "[", "t", "]"}], "//", "S"}]], "Input",
 CellChangeTimes->{{3.764747502971649*^9, 3.76474750354885*^9}, 
   3.765026229366082*^9},ExpressionUUID->"b13f3410-47ea-41b9-916a-\
56c5528c340c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2048", " ", 
    SuperscriptBox["ww", "3"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "16"}], " ", 
     SuperscriptBox["H1", "2"], " ", "H1D", " ", "sy"}], "+", 
    RowBox[{
     SuperscriptBox["H1", "4"], " ", "sz"}], "+", 
    RowBox[{"16", " ", 
     SuperscriptBox["H1D", "2"], " ", "sz"}], "-", 
    RowBox[{"32", " ", "H1", " ", "H1DD", " ", "sz"}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["H1", "3"], " ", "sx", " ", "ww"}], "+", 
    RowBox[{"64", " ", 
     SuperscriptBox["H1", "2"], " ", "sz", " ", 
     SuperscriptBox["ww", "2"]}], "+", 
    RowBox[{"512", " ", "H1", " ", "sx", " ", 
     SuperscriptBox["ww", "3"]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["H1", "4"], " ", "sz"}], "-", 
       RowBox[{"64", " ", "H1", " ", "H1DD", " ", "sz"}], "-", 
       RowBox[{"8", " ", 
        SuperscriptBox["H1", "3"], " ", "sx", " ", "ww"}], "+", 
       RowBox[{"16", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "H1DDD", " ", "sy"}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["H1D", "2"], " ", "sz"}], "-", 
          RowBox[{"4", " ", "H1DD", " ", "sx", " ", "ww"}], "-", 
          RowBox[{"8", " ", "H1D", " ", "sy", " ", 
           SuperscriptBox["ww", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["H1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "36"}], " ", "H1D", " ", "sy"}], "+", 
          RowBox[{"64", " ", "sz", " ", 
           SuperscriptBox["ww", "2"]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["H1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "18"}], " ", "H1D", " ", "sy"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["H1", "2"], " ", "sz"}], "+", 
       RowBox[{"8", " ", "H1", " ", "sx", " ", "ww"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "-", 
    RowBox[{"24", " ", 
     SuperscriptBox["H1", "2"], " ", "H1D", " ", "sx", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{"64", " ", "H1DDD", " ", "sx", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"16", " ", 
     SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{"128", " ", "H1DD", " ", "sy", " ", "ww", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"192", " ", "H1", " ", "H1D", " ", "sz", " ", "ww", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"256", " ", "H1D", " ", "sx", " ", 
     SuperscriptBox["ww", "2"], " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"18", " ", 
     SuperscriptBox["H1", "2"], " ", "H1D", " ", "sx", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Beta]0"}], "]"}]}]}], ")"}]}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.7647475012400465`*^9, 3.7647475037672505`*^9}, 
   3.765026229366082*^9, 3.765042844263129*^9, 
   3.765086356361463*^9},ExpressionUUID->"618f3343-35e2-4846-a739-\
1b23af9ac18c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HHEff", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"HEff", "[", "t", "]"}], "/.", "repHs"}], "//", "S"}]}]], "Input",
 CellChangeTimes->{{3.7647470813257074`*^9, 3.764747119080774*^9}, {
  3.764747274731248*^9, 
  3.764747291314077*^9}},ExpressionUUID->"a8eae606-6ac4-427a-8383-\
fbe4c232be47"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2048", " ", 
    SuperscriptBox["ww", "3"]}]], 
  RowBox[{"A", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"16", " ", "A", " ", "sz"}], "-", 
     RowBox[{"16", " ", 
      SuperscriptBox["A", "2"], " ", "sy", " ", 
      SuperscriptBox["t", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["A", "3"], " ", "sz", " ", 
      SuperscriptBox["t", "4"]}], "-", 
     RowBox[{"16", " ", 
      SuperscriptBox["A", "2"], " ", "sx", " ", 
      SuperscriptBox["t", "3"], " ", "ww"}], "+", 
     RowBox[{"64", " ", "A", " ", "sz", " ", 
      SuperscriptBox["t", "2"], " ", 
      SuperscriptBox["ww", "2"]}], "+", 
     RowBox[{"512", " ", "sx", " ", "t", " ", 
      SuperscriptBox["ww", "3"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["A", "3"], " ", "sz", " ", 
         SuperscriptBox["t", "4"]}], "+", 
        RowBox[{"256", " ", "sy", " ", 
         SuperscriptBox["ww", "2"]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["A", "2"], " ", 
         SuperscriptBox["t", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"9", " ", "sy"}], "+", 
           RowBox[{"2", " ", "sx", " ", "t", " ", "ww"}]}], ")"}]}], "-", 
        RowBox[{"32", " ", "A", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["t", "2"], " ", 
            SuperscriptBox["ww", "2"]}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["A", "2"], " ", 
      SuperscriptBox["t", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "18"}], " ", "sy"}], "+", 
        RowBox[{"3", " ", "A", " ", "sz", " ", 
         SuperscriptBox["t", "2"]}], "+", 
        RowBox[{"8", " ", "sx", " ", "t", " ", "ww"}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "-", 
     RowBox[{"24", " ", 
      SuperscriptBox["A", "2"], " ", "sx", " ", 
      SuperscriptBox["t", "2"], " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
     RowBox[{"192", " ", "A", " ", "sz", " ", "t", " ", "ww", " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["A", "2"], " ", "sy", " ", 
      SuperscriptBox["t", "3"], " ", "ww", " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
     RowBox[{"256", " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
     RowBox[{"18", " ", 
      SuperscriptBox["A", "2"], " ", "sx", " ", 
      SuperscriptBox["t", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["A", "2"], " ", "sy", " ", 
      SuperscriptBox["t", "3"], " ", "ww", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Beta]0"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7646612109364777`*^9, 3.7646613692925563`*^9, 
  3.764666446445998*^9, 3.7647470041209707`*^9, 3.7647471375532064`*^9, 
  3.7647472947314825`*^9, 3.765042855417149*^9, 
  3.765086360300969*^9},ExpressionUUID->"281d081d-1bcb-4696-9880-\
81bfd89d28d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"HHEff", "[", "t", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"A", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", "S"}]], "Input",
 CellChangeTimes->{{3.764661190170841*^9, 3.764661289040015*^9}, {
   3.7646613192758684`*^9, 3.7646613240026765`*^9}, 3.764747155493238*^9, 
   3.7647473144655175`*^9, {3.7647473610043993`*^9, 3.764747398493265*^9}, {
   3.764747479944009*^9, 3.7647474799908085`*^9}, 
   3.7647476231788607`*^9},ExpressionUUID->"b1a74f6a-b559-4a53-b7e2-\
2d607c60ee2d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "sx", " ", "t", " ", "ww"}], "+", 
       RowBox[{"sy", " ", 
        RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
       RowBox[{"sx", " ", 
        RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}], " ", "A"}], 
    RowBox[{"8", " ", "ww"}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "A", "]"}], "2"],
    SeriesData[$CellContext`A, 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`A, 
   0, {(Rational[
      1, 8]/$CellContext`ww) (((
        2 $CellContext`sx) $CellContext`t) $CellContext`ww + $CellContext`sy 
      Cos[$CellContext`\[Beta]0] + $CellContext`sx 
      Sin[$CellContext`\[Beta]0])}, 1, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.764747316353121*^9, {3.76474736141*^9, 3.7647473991016665`*^9}, 
   3.7647474804120097`*^9, 
   3.7647476245516634`*^9},ExpressionUUID->"68c5d306-e884-43f3-96f6-\
89e0b0264b85"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.76504287279558*^9},ExpressionUUID->"bd69fa6c-ee28-482a-b452-67de81701de7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MagnusEff0", "[", "t_", "]"}], "=", 
  RowBox[{"MDynamic", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"HEff", "[", "t", "]"}], "/.", "repHs"}], ",", "0", ",", 
    RowBox[{
     RowBox[{"\[Beta]0", "/", 
      RowBox[{"(", 
       RowBox[{"2", "ww"}], ")"}]}], "+", "t"}], ",", 
    RowBox[{"\[Beta]0", "/", 
     RowBox[{"(", 
      RowBox[{"2", "ww"}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.764660068027099*^9, 3.7646600751739116`*^9}, {
   3.764660253899826*^9, 3.7646602539466267`*^9}, {3.7646603513731985`*^9, 
   3.7646603627144184`*^9}, 3.764660523782503*^9, 3.7646605603253713`*^9, {
   3.7646607415316896`*^9, 3.7646607603473234`*^9}, 3.7646614281202593`*^9, {
   3.7646620550167646`*^9, 3.76466205801197*^9}, {3.764668477588344*^9, 
   3.764668502481852*^9}, {3.764668888275631*^9, 3.764668904778412*^9}, {
   3.765027960994238*^9, 
   3.76502796203944*^9}},ExpressionUUID->"ab379c1d-56b6-44be-8b72-\
16c7996d0743"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n [+++] About to start for-loop in MDynamic[HH,max] @ \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "4", ",", "23", ",", "22", ",", "14"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\\n\"\>"}],
  SequenceForm[
  "\n\n\n [+++] About to start for-loop in MDynamic[HH,max] @ ", {2019, 4, 23,
    22, 14}, "\n\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.7650262861823816`*^9, 3.765027978637869*^9, 
  3.76502815547198*^9, 
  3.765042877647188*^9},ExpressionUUID->"1a850f09-589b-4e46-a5aa-\
1dfbd2cdffa3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "4", ",", "23", ",", "22", ",", "14", ",", 
     "37.5847879`9.327586992002146"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 1, 
   ", at date and time ", {2019, 4, 23, 22, 14, 37.5847879`9.327586992002146}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7650262861823816`*^9, 3.765027978637869*^9, 
  3.76502815547198*^9, 
  3.765042877662788*^9},ExpressionUUID->"30fac969-e024-4692-97ea-\
c0134840a9b4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"384", " ", 
    SuperscriptBox["ww", "3"]}]], 
  RowBox[{"\[ImaginaryI]", " ", "A", " ", "t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", "A", " ", "sz", " ", 
      SuperscriptBox["t", "2"], " ", 
      SuperscriptBox["ww", "2"]}], "-", 
     RowBox[{"48", " ", "sx", " ", "t", " ", 
      SuperscriptBox["ww", "3"]}], "-", 
     RowBox[{"6", " ", "A", " ", "sz", " ", "t", " ", "ww", " ", "\[Beta]0"}],
      "-", 
     RowBox[{"48", " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Beta]0"}], "-", 
     RowBox[{"3", " ", "A", " ", "sz", " ", 
      SuperscriptBox["\[Beta]0", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "48"}], " ", "sy", " ", 
         SuperscriptBox["ww", "2"]}], "+", 
        RowBox[{"2", " ", "A", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["t", "2"], " ", 
            SuperscriptBox["ww", "2"]}], "+", 
           RowBox[{"6", " ", "t", " ", "ww", " ", "\[Beta]0"}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["\[Beta]0", "2"]}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{"6", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"8", " ", "sx", " ", 
         SuperscriptBox["ww", "2"]}], "+", 
        RowBox[{"3", " ", "A", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", " ", "ww"}], "+", "\[Beta]0"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.765026292437993*^9, 3.7650279834582777`*^9, 
  3.7650281591535864`*^9, 
  3.7650428813287945`*^9},ExpressionUUID->"24a2554e-2b0c-4ddf-8e7f-\
f05b38ab5f28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MagnusEff0", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"MagnusEff0", "[", "t", "]"}], ",", 
      RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}], "+", 
    RowBox[{
     FractionBox["1", "ww"], 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"MagnusEff0", "[", "t", "]"}], ",", 
       RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["ww", "2"]], 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"MagnusEff0", "[", "t", "]"}], ",", 
       RowBox[{"1", "/", "ww"}], ",", "2"}], "]"}]}]}], "//", 
   "S"}]}]], "Input",
 CellChangeTimes->{{3.765044663457733*^9, 
  3.765044702365202*^9}},ExpressionUUID->"b33c8c43-4615-4f8a-842f-\
6db4f004bf68"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"192", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"\[ImaginaryI]", " ", "A", " ", "t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "A", " ", "sz", " ", 
      SuperscriptBox["t", "2"], " ", "ww"}], "-", 
     RowBox[{"24", " ", "sx", " ", "t", " ", 
      SuperscriptBox["ww", "2"]}], "-", 
     RowBox[{"3", " ", "A", " ", "sz", " ", "t", " ", "\[Beta]0"}], "-", 
     RowBox[{"24", " ", "sx", " ", "ww", " ", "\[Beta]0"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "24"}], " ", "sy", " ", "ww"}], "+", 
        RowBox[{"2", " ", "A", " ", "sz", " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "t", " ", "ww"}], "+", 
           RowBox[{"3", " ", "\[Beta]0"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "A", " ", "sz", " ", "t"}], "+", 
        RowBox[{"8", " ", "sx", " ", "ww"}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.7650446993231964`*^9, 
  3.7650447027708025`*^9}},ExpressionUUID->"ae27b4ee-562c-4aca-a4df-\
6f2574145a2c"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.764669148789734*^9},ExpressionUUID->"842820d1-3dc8-4b3d-94ce-\
b7a4ff2b1ab9"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"?", 
   RowBox[{"sTrim", "\[IndentingNewLine]", 
    RowBox[{"sTrim", "[", 
     RowBox[{"input_", ",", "maxLocal_", ",", 
      RowBox[{"localVerbose_", ":", "False"}]}], "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.764669153953842*^9, 3.7646691556371737`*^9}, {
  3.765028001274509*^9, 
  3.7650280224641466`*^9}},ExpressionUUID->"7169f399-6e74-4ee4-9521-\
b99a4fd9d7ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sTrim", "[", 
   RowBox[{
    RowBox[{"MagnusEff0", "[", "t", "]"}], ",", "0"}], "]"}], "//", 
  "S"}]], "Input",
 CellChangeTimes->{{3.764669152101438*^9, 3.764669167580591*^9}, {
  3.7646692374171953`*^9, 3.764669240449065*^9}, {3.7650281669546003`*^9, 
  3.765028168467803*^9}},ExpressionUUID->"fcdfaef7-0dba-434c-b820-\
42d105c4bf0a"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "A", " ", "t", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sy", " ", 
       RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
      RowBox[{"sx", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"t", " ", "ww"}], "+", "\[Beta]0", "+", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"8", " ", "ww"}]]}]], "Output",
 CellChangeTimes->{{3.764669238144598*^9, 3.76466924061526*^9}, 
   3.765027490971012*^9, {3.765028163803395*^9, 
   3.7650281704802065`*^9}},ExpressionUUID->"12aff59b-b244-4c4b-8392-\
c4415f0050c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sTrim", "[", 
   RowBox[{
    RowBox[{"MagnusEff0", "[", "t", "]"}], ",", "1"}], "]"}], "//", 
  "S"}]], "Input",
 CellChangeTimes->{{3.764669152101438*^9, 3.764669167580591*^9}, {
  3.7646692374171953`*^9, 3.764669240449065*^9}, {3.7650281669546003`*^9, 
  3.765028178763821*^9}},ExpressionUUID->"fcdfaef7-0dba-434c-b820-\
42d105c4bf0a"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"384", " ", 
    SuperscriptBox["ww", "3"]}]], 
  RowBox[{"\[ImaginaryI]", " ", "A", " ", "t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", "A", " ", "sz", " ", 
      SuperscriptBox["t", "2"], " ", 
      SuperscriptBox["ww", "2"]}], "-", 
     RowBox[{"48", " ", "sx", " ", "t", " ", 
      SuperscriptBox["ww", "3"]}], "-", 
     RowBox[{"6", " ", "A", " ", "sz", " ", "t", " ", "ww", " ", "\[Beta]0"}],
      "-", 
     RowBox[{"48", " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Beta]0"}], "-", 
     RowBox[{"3", " ", "A", " ", "sz", " ", 
      SuperscriptBox["\[Beta]0", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "48"}], " ", "sy", " ", 
         SuperscriptBox["ww", "2"]}], "+", 
        RowBox[{"2", " ", "A", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["t", "2"], " ", 
            SuperscriptBox["ww", "2"]}], "+", 
           RowBox[{"6", " ", "t", " ", "ww", " ", "\[Beta]0"}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["\[Beta]0", "2"]}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{"6", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"8", " ", "sx", " ", 
         SuperscriptBox["ww", "2"]}], "+", 
        RowBox[{"3", " ", "A", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", " ", "ww"}], "+", "\[Beta]0"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7650281794814224`*^9},ExpressionUUID->"610f200f-6a0c-4616-9b5e-\
724e70229611"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Print", "[", 
  "\"\<it looks like this result agrees with what we computed in \
TEO_analytical.nb\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7650274951050196`*^9, 3.765027500190628*^9}, {
  3.765027541483901*^9, 
  3.7650275687381487`*^9}},ExpressionUUID->"9cfe5efa-ca3d-46b3-bd1d-\
c3856c334e20"],

Cell[BoxData["\<\"it looks like this result agrees with what we computed in \
TEO_analytical.nb\"\>"], "Print",
 CellChangeTimes->{
  3.7650275702513514`*^9},ExpressionUUID->"1a27889a-eb97-4c03-b229-\
8c8a37fb6e01"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.7650276777687407`*^9},ExpressionUUID->"e2d52dc7-66e4-4655-80d8-\
0968346f1498"],

Cell[CellGroupData[{

Cell[TextData[{
 "Now extract order ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", 
    SuperscriptBox["ww", "2"]}], TraditionalForm]],ExpressionUUID->
  "beb946a0-9677-450a-8f26-502ca00ef1e8"]
}], "Subsection",
 CellChangeTimes->{{3.7650276880179586`*^9, 3.765027696863174*^9}, {
  3.765034483458828*^9, 
  3.7650344907284408`*^9}},ExpressionUUID->"f00ac8b6-b266-405e-9b71-\
316960d29f77"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MagnusEff0", "[", "x", "]"}]], "Input",
 CellChangeTimes->{
  3.765028202007862*^9},ExpressionUUID->"a2049088-9b15-43d4-9740-\
32e962be4a17"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"384", " ", 
    SuperscriptBox["ww", "3"]}]], 
  RowBox[{"\[ImaginaryI]", " ", "A", " ", "x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "48"}], " ", "sx", " ", 
      SuperscriptBox["ww", "3"], " ", "x"}], "-", 
     RowBox[{"4", " ", "A", " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"48", " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Beta]0"}], "-", 
     RowBox[{"6", " ", "A", " ", "sz", " ", "ww", " ", "x", " ", "\[Beta]0"}],
      "-", 
     RowBox[{"3", " ", "A", " ", "sz", " ", 
      SuperscriptBox["\[Beta]0", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "48"}], " ", "sy", " ", 
         SuperscriptBox["ww", "2"]}], "+", 
        RowBox[{"2", " ", "A", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["ww", "2"], " ", 
            SuperscriptBox["x", "2"]}], "+", 
           RowBox[{"6", " ", "ww", " ", "x", " ", "\[Beta]0"}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["\[Beta]0", "2"]}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{"6", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"8", " ", "sx", " ", 
         SuperscriptBox["ww", "2"]}], "+", 
        RowBox[{"3", " ", "A", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ww", " ", "x"}], "+", "\[Beta]0"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7650278639112673`*^9, {3.76502807566124*^9, 3.765028084272455*^9}, {
   3.7650281994338574`*^9, 
   3.7650282024134626`*^9}},ExpressionUUID->"c925c458-3ecc-4374-aaf1-\
2ef13ada8fc6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Out", " ", "of", " ", "Curiosity"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7650440098065844`*^9, 
  3.765044027685216*^9}},ExpressionUUID->"20ac6a61-aa77-4db1-ab4f-\
f5fbf7ea45c8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "*", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"MagnusEff0", "[", "t", "]"}], ",", "A", ",", "1"}], "]"}]}], "//",
   "S"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SuperscriptBox["A", "2"], "*", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"MagnusEff0", "[", "t", "]"}], ",", "A", ",", "2"}], "]"}]}], "//",
   "S"}]}], "Input",
 CellChangeTimes->{{3.7650440395880365`*^9, 
  3.7650440693060894`*^9}},ExpressionUUID->"b959d1b8-f96a-4364-b73b-\
5069bf0d4f62"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "A", " ", "t", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sy", " ", 
       RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
      RowBox[{"sx", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"t", " ", "ww"}], "+", "\[Beta]0", "+", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"8", " ", "ww"}]]}]], "Output",
 CellChangeTimes->{{3.7650440457500477`*^9, 
  3.76504406972729*^9}},ExpressionUUID->"c185e723-d943-4172-9b91-\
bf273118afdc"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"384", " ", 
    SuperscriptBox["ww", "3"]}]], 
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["A", "2"], " ", "sz", " ", "t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      SuperscriptBox["t", "2"], " ", 
      SuperscriptBox["ww", "2"]}], "-", 
     RowBox[{"6", " ", "t", " ", "ww", " ", "\[Beta]0"}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["\[Beta]0", "2"]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["t", "2"], " ", 
         SuperscriptBox["ww", "2"]}], "+", 
        RowBox[{"6", " ", "t", " ", "ww", " ", "\[Beta]0"}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[Beta]0", "2"]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{"18", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"t", " ", "ww"}], "+", "\[Beta]0"}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.7650440457500477`*^9, 
  3.7650440701640906`*^9}},ExpressionUUID->"ffec8103-faae-4d60-9dcf-\
a44f4ced8043"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"remove", "=", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox["ww", "3"]], 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"MagnusEff0", "[", "t", "]"}], ",", "ww", ",", 
     RowBox[{"-", "3"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.765028225970504*^9, 3.7650282808056*^9}, {
  3.765033936444667*^9, 
  3.765033940391474*^9}},ExpressionUUID->"37a211bc-41a5-4e0f-bce1-\
11c35d14c749"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", "A", " ", "t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", "A", " ", "sz", " ", 
      SuperscriptBox["\[Beta]0", "2"]}], "+", 
     RowBox[{"6", " ", "A", " ", "sz", " ", 
      SuperscriptBox["\[Beta]0", "2"], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{"18", " ", "A", " ", "sz", " ", "\[Beta]0", " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}]}], 
  RowBox[{"384", " ", 
   SuperscriptBox["ww", "3"]}]]], "Output",
 CellChangeTimes->{{3.7650282315709143`*^9, 3.7650282814140015`*^9}, 
   3.7650339413274755`*^9},ExpressionUUID->"8fd1d7af-8ba8-48d5-b332-\
7297ce27f607"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MagnusEff02", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"MagnusEff0", "[", "t", "]"}], "-", "remove"}], "//", 
   "S"}]}]], "Input",
 CellChangeTimes->{{3.7650282858288093`*^9, 3.7650283096968513`*^9}, {
  3.765028358635137*^9, 
  3.7650283623011436`*^9}},ExpressionUUID->"ce975180-fcf1-48e6-bb66-\
f7caf1278499"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"192", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"\[ImaginaryI]", " ", "A", " ", "t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "A", " ", "sz", " ", 
      SuperscriptBox["t", "2"], " ", "ww"}], "-", 
     RowBox[{"24", " ", "sx", " ", "t", " ", 
      SuperscriptBox["ww", "2"]}], "-", 
     RowBox[{"3", " ", "A", " ", "sz", " ", "t", " ", "\[Beta]0"}], "-", 
     RowBox[{"24", " ", "sx", " ", "ww", " ", "\[Beta]0"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "24"}], " ", "sy", " ", "ww"}], "+", 
        RowBox[{"2", " ", "A", " ", "sz", " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "t", " ", "ww"}], "+", 
           RowBox[{"3", " ", "\[Beta]0"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "A", " ", "sz", " ", "t"}], "+", 
        RowBox[{"8", " ", "sx", " ", "ww"}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.76502836016394*^9, 3.765028363627146*^9}, 
   3.765033943059078*^9},ExpressionUUID->"b7c02734-b377-461c-8dc8-\
cce21b3b07db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Coefficient", "[", 
  RowBox[{
   RowBox[{"MagnusEff02", "[", "t", "]"}], ",", 
   RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Coefficient", "[", 
  RowBox[{
   RowBox[{"MagnusEff02", "[", "t", "]"}], ",", 
   RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7650339540268974`*^9, 3.7650339822209473`*^9}, {
   3.7650343460195866`*^9, 3.7650343757230387`*^9}, 3.765034414646107*^9, 
   3.7650344554869785`*^9},ExpressionUUID->"9406f4af-d451-4fcd-81f3-\
c004249ff31d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "8"]}], " ", "\[ImaginaryI]", " ", "A", " ", "sx", " ", 
  SuperscriptBox["t", "2"]}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.765033974150933*^9, 3.765033982876148*^9}, {
   3.765034349092792*^9, 3.7650343760662394`*^9}, 
   3.7650344554869785`*^9},ExpressionUUID->"a194a5b0-bbb1-43fd-a6a8-\
ef18c554ed45"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "192"], " ", "\[ImaginaryI]", " ", "A", " ", "t", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "24"}], " ", "sx", " ", "\[Beta]0"}], "-", 
    RowBox[{"24", " ", "sy", " ", 
     RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{"24", " ", "sx", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}]}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.765033974150933*^9, 3.765033982876148*^9}, {
   3.765034349092792*^9, 3.7650343760818396`*^9}, 
   3.7650344555025787`*^9},ExpressionUUID->"de21b645-64fb-4c93-bf77-\
fc8ed4057484"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "+", "%%"}], "//", "S"}]], "Input",
 CellChangeTimes->{{3.7650344206365175`*^9, 3.7650344221185207`*^9}, 
   3.7650344555025787`*^9},ExpressionUUID->"508fccb6-9af8-4d03-802c-\
4bf78b4b3f2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "8"]}], " ", "\[ImaginaryI]", " ", "A", " ", "t", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sy", " ", 
     RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"sx", " ", 
     RowBox[{"(", 
      RowBox[{"t", "+", "\[Beta]0", "+", 
       RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], ")"}]}]}], ")"}]}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.7650344225241213`*^9, 
  3.7650344555025787`*^9},ExpressionUUID->"b72bfe74-3831-4c60-893c-\
9de2a5ed7280"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"MagnusEff02", "[", "t", "]"}], ",", 
    RowBox[{"1", "/", "ww"}], ",", "2"}], "]"}], "//", "S"}]], "Input",
 CellChangeTimes->{{3.7650339540268974`*^9, 3.7650339822209473`*^9}, {
   3.7650343460195866`*^9, 3.7650343757230387`*^9}, 3.765034414646107*^9, 
   3.7650344554869785`*^9, {3.765034499214856*^9, 3.76503451898009*^9}, {
   3.7650346898033905`*^9, 
   3.7650346903649917`*^9}},ExpressionUUID->"3c27ecc0-d92d-4f46-a223-\
eff92799b358"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "64"], " ", "\[ImaginaryI]", " ", 
  SuperscriptBox["A", "2"], " ", "sz", " ", 
  SuperscriptBox["t", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "\[Beta]0"}], "+", 
    RowBox[{"2", " ", "\[Beta]0", " ", 
     RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{"3", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7650345093392735`*^9, 3.7650345195728917`*^9}, 
   3.7650346906769924`*^9},ExpressionUUID->"2e3e105a-6d00-4f9c-bcff-\
981a992e651e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Note that the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", 
    SuperscriptBox["ww", "2"], " "}], TraditionalForm]],ExpressionUUID->
  "3d7cbcb5-48cf-4452-9726-48efeddd43cc"],
 "coefficient is proportional to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["A", "2"], TraditionalForm]],ExpressionUUID->
  "697fb14e-4405-4ee4-805e-5f6b0f5a6f80"],
 " (not sure if this is necessary)"
}], "Subsubsection",
 CellChangeTimes->{{3.7645282757348275`*^9, 3.764528336883325*^9}, {
  3.7646618392891846`*^9, 3.7646618451235943`*^9}, {3.7646618962976847`*^9, 
  3.7646619732586203`*^9}, {3.7646683956322536`*^9, 3.764668425741626*^9}, {
  3.7650345555631547`*^9, 3.765034557809559*^9}, {3.765034627573881*^9, 
  3.765034671083358*^9}, {3.765034819005818*^9, 
  3.765034828303434*^9}},ExpressionUUID->"76737a94-7cad-4294-805b-\
845bbad3d88a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.764668316785742*^9, 
  3.7646683169392757`*^9}},ExpressionUUID->"54a73ce4-363c-4348-bfd2-\
3114c46648ee"],

Cell[TextData[StyleBox["0.2   Exact Time Evolution",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738406695464067*^9, 3.738406699136009*^9}, {
   3.7384068847910023`*^9, 3.7384068906466017`*^9}, {3.740310753819174*^9, 
   3.7403107699224*^9}, {3.761897946758169*^9, 3.761897957613974*^9}, {
   3.7618979923169527`*^9, 3.761897995148902*^9}, {3.762009263473727*^9, 
   3.762009296031787*^9}, {3.762154673711314*^9, 3.762154675341291*^9}, {
   3.7646681056060343`*^9, 3.7646681137976313`*^9}, 3.764668322722937*^9},
 FontSize->14,ExpressionUUID->"d3911fe3-80cb-4b67-88d9-d21b9c53814a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HHEx", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"H", "[", "t", "]"}], "/.", "repHs"}], "//", "S"}]}]], "Input",
 CellChangeTimes->{{3.7647470813257074`*^9, 3.764747119080774*^9}, {
   3.764747274731248*^9, 3.764747291314077*^9}, {3.765042207995203*^9, 
   3.765042215280416*^9}, 3.7650425869746695`*^9, 3.7650427183455*^9, {
   3.7650443192381287`*^9, 
   3.765044319612529*^9}},ExpressionUUID->"a8eae606-6ac4-427a-8383-\
fbe4c232be47"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "A", " ", "t", " ", 
  RowBox[{"(", 
   RowBox[{"sx", "+", 
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.765042719297102*^9, 3.7650427773292036`*^9, 
  3.7650428940438166`*^9, 
  3.7650443211725316`*^9},ExpressionUUID->"24df7942-aec8-4ad3-8448-\
003a7f29bec8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MagnusEx0", "[", "t_", "]"}], "=", 
  RowBox[{"MDynamic", "[", 
   RowBox[{
    RowBox[{"HHEx", "[", "t", "]"}], ",", "0", ",", 
    RowBox[{
     RowBox[{"beta0", "/", 
      RowBox[{"(", 
       RowBox[{"2", "ww"}], ")"}]}], "+", "t"}], ",", 
    RowBox[{"beta0", "/", 
     RowBox[{"(", 
      RowBox[{"2", "ww"}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7617561123223495`*^9, 3.7617561152165146`*^9}, 
   3.761756322753385*^9, 3.761758773099537*^9, {3.761773483091219*^9, 
   3.761773483146222*^9}, {3.7617835046847043`*^9, 3.7617835313783517`*^9}, {
   3.761783570957621*^9, 3.761783595216664*^9}, {3.761783917820631*^9, 
   3.761783918241832*^9}, {3.762009325063225*^9, 3.7620093344296913`*^9}, {
   3.764599512114822*^9, 3.764599557399825*^9}, 3.764660048573865*^9, {
   3.7646678919145393`*^9, 3.7646678919853973`*^9}, {3.76466794035086*^9, 
   3.764667941166801*^9}, {3.764667975045796*^9, 3.7646679880286694`*^9}, {
   3.7646685113305397`*^9, 3.764668521257009*^9}, 3.7650426116081123`*^9, {
   3.7650426820588365`*^9, 3.765042694866459*^9}, {3.7650428977878237`*^9, 
   3.7650428987862253`*^9}, {3.765044304168502*^9, 
   3.7650443243549376`*^9}},ExpressionUUID->"379d5900-605f-4fe7-ade0-\
fe4cd8d852ab"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n [+++] About to start for-loop in MDynamic[HH,max] @ \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "4", ",", "23", ",", "22", ",", "39"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\\n\"\>"}],
  SequenceForm[
  "\n\n\n [+++] About to start for-loop in MDynamic[HH,max] @ ", {2019, 4, 23,
    22, 39}, "\n\n"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765042619330126*^9, {3.7650426663652086`*^9, 3.7650426952720594`*^9}, 
   3.7650427787956066`*^9, 3.7650428993010263`*^9, 3.765044306227706*^9, 
   3.765044343449371*^9},ExpressionUUID->"03a2899b-c439-4c4a-a5c0-\
cac10109c755"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "4", ",", "23", ",", "22", ",", "39", ",", 
     "3.3713707`8.280381489094037"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 1, 
   ", at date and time ", {2019, 4, 23, 22, 39, 3.3713707`8.280381489094037}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765042619330126*^9, {3.7650426663652086`*^9, 3.7650426952720594`*^9}, 
   3.7650427787956066`*^9, 3.7650428993010263`*^9, 3.765044306227706*^9, 
   3.765044343480571*^9},ExpressionUUID->"358765fe-16a8-4f6f-816a-\
14c962991747"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"16", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", "A", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "beta0", " ", "sx", " ", "t", " ", "ww"}], "+", 
      RowBox[{"2", " ", "sx", " ", 
       SuperscriptBox["t", "2"], " ", 
       SuperscriptBox["ww", "2"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"sx", "+", 
         RowBox[{"beta0", " ", "sy"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "beta0", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"sx", "+", 
         RowBox[{"beta0", " ", "sy"}], "+", 
         RowBox[{"2", " ", "sy", " ", "t", " ", "ww"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "-", 
      RowBox[{"beta0", " ", "sx", " ", 
       RowBox[{"Sin", "[", "beta0", "]"}]}], "+", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", "beta0", "]"}]}], "+", 
      RowBox[{"beta0", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "-", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", "sx", " ", "t", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.7650426194549265`*^9, {3.765042666505609*^9, 3.76504269541246*^9}, 
   3.7650427789360065`*^9, 3.76504291875426*^9, 3.765044315681322*^9, 
   3.7650443525441866`*^9},ExpressionUUID->"e1fa7a3a-92be-43c4-ac19-\
0755e25b85d2"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.7650443095973115`*^9},ExpressionUUID->"236f967a-de50-498d-ba1a-\
0aa56a3bd7c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MagnusEx", "[", "t_", "]"}], "=", 
  RowBox[{"MDynamic", "[", 
   RowBox[{"HHEx", ",", "0", ",", 
    RowBox[{
     RowBox[{"beta0", "/", 
      RowBox[{"(", 
       RowBox[{"2", "ww"}], ")"}]}], "+", "t"}], ",", 
    RowBox[{"beta0", "/", 
     RowBox[{"(", 
      RowBox[{"2", "ww"}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7617561123223495`*^9, 3.7617561152165146`*^9}, 
   3.761756322753385*^9, 3.761758773099537*^9, {3.761773483091219*^9, 
   3.761773483146222*^9}, {3.7617835046847043`*^9, 3.7617835313783517`*^9}, {
   3.761783570957621*^9, 3.761783595216664*^9}, {3.761783917820631*^9, 
   3.761783918241832*^9}, {3.762009325063225*^9, 3.7620093344296913`*^9}, {
   3.764599512114822*^9, 3.764599557399825*^9}, 3.764660048573865*^9, {
   3.7646678919145393`*^9, 3.7646678919853973`*^9}, {3.76466794035086*^9, 
   3.764667941166801*^9}, {3.764667975045796*^9, 3.7646679880286694`*^9}, {
   3.7646685113305397`*^9, 3.764668521257009*^9}, 3.7650426116081123`*^9, {
   3.7650443306417484`*^9, 
   3.7650443309381485`*^9}},ExpressionUUID->"379d5900-605f-4fe7-ade0-\
fe4cd8d852ab"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"16", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", "A", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "beta0", " ", "sx", " ", "t", " ", "ww"}], "+", 
      RowBox[{"2", " ", "sx", " ", 
       SuperscriptBox["t", "2"], " ", 
       SuperscriptBox["ww", "2"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"sx", "+", 
         RowBox[{"beta0", " ", "sy"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "beta0", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"sx", "+", 
         RowBox[{"beta0", " ", "sy"}], "+", 
         RowBox[{"2", " ", "sy", " ", "t", " ", "ww"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "-", 
      RowBox[{"beta0", " ", "sx", " ", 
       RowBox[{"Sin", "[", "beta0", "]"}]}], "+", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", "beta0", "]"}]}], "+", 
      RowBox[{"beta0", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "-", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", "sx", " ", "t", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.764667990618548*^9, 3.764668059201818*^9, 
  3.764668140777925*^9, 
  3.764668526875258*^9},ExpressionUUID->"b8b40867-318a-4d3d-bc58-\
c15c8b999fd2"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.76466856801651*^9},ExpressionUUID->"39cfb021-c2df-440e-8a62-2ca0ee2f1761"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"compare", "[", "t_", "]"}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"-", "I"}], "2"], 
    FractionBox["1", 
     RowBox[{"8", " ", 
      SuperscriptBox["ww", "2"]}]], "A", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "beta0"}], "+", "t"}], ")"}], " ", 
       SuperscriptBox["ww", "2"], " ", "X"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "+", 
         RowBox[{"2", " ", "beta0", " ", "ww", " ", "Y"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "beta0", " ", "ww"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"beta0", "+", "t"}], ")"}], " ", "ww", " ", "Y"}]}], ")"}],
        " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"beta0", "+", "t"}], ")"}], " ", "ww"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "beta0", " ", "ww", " ", "X"}], "+", "Y"}],
         ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "beta0", " ", "ww"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"beta0", "+", "t"}], ")"}], " ", "ww", " ", "X"}], "-", 
         "Y"}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"beta0", "+", "t"}], ")"}], " ", "ww"}], "]"}]}]}], 
     ")"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.764668574489521*^9, 3.7646685899613543`*^9}},
 $CellContext`ExpressionUUID -> 
 "23a9abf2-d05b-4b77-b8a0-53f336ae87f0",ExpressionUUID->"f8d2eddc-c944-4723-\
82e2-2341ec9b9197"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"16", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", "A", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "beta0"}], "+", "t"}], ")"}], " ", 
       SuperscriptBox["ww", "2"], " ", "X"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "+", 
         RowBox[{"2", " ", "beta0", " ", "ww", " ", "Y"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "beta0", " ", "ww"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"beta0", "+", "t"}], ")"}], " ", "ww", " ", "Y"}]}], ")"}],
        " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"beta0", "+", "t"}], ")"}], " ", "ww"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "beta0", " ", "ww", " ", "X"}], "+", "Y"}],
         ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "beta0", " ", "ww"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"beta0", "+", "t"}], ")"}], " ", "ww", " ", "X"}], "-", 
         "Y"}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"beta0", "+", "t"}], ")"}], " ", "ww"}], "]"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.764668583170611*^9, 
  3.7646685902261763`*^9}},ExpressionUUID->"88de341f-1cb4-49e4-95b0-\
c25bac639401"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"compare", "[", "t", "]"}], "-", 
       RowBox[{"MagnusEx", "[", "t", "]"}]}], "/.", 
      RowBox[{"ww", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}]}], "/.", 
     RowBox[{"X", "\[Rule]", "sx"}]}], "/.", 
    RowBox[{"Y", "\[Rule]", "sy"}]}], "//", "S"}], "*)"}]], "Input",
 CellChangeTimes->{{3.76466859184548*^9, 3.764668644387306*^9}},
 $CellContext`ExpressionUUID -> 
 "89fc133a-a04d-4147-9ccd-8db68cf20b7e",ExpressionUUID->"5ab05a55-6ac4-4fd0-\
99eb-920e18428949"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.76466864487409*^9},ExpressionUUID->"b099861c-9695-4f02-9d37-184bf8fdf372"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.764667291263608*^9, 
  3.764667291607852*^9}},ExpressionUUID->"21710409-be99-47f6-a433-\
0b6b630e68df"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.762009310093336*^9},ExpressionUUID->"36205668-99eb-405e-bbf1-\
a18febbb4411"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["1.   First Order",
 FontColor->RGBColor[1, 0, 0]]], "Section",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738406695464067*^9, 3.738406699136009*^9}, {
   3.7384068847910023`*^9, 3.7384068906466017`*^9}, {3.740310753819174*^9, 
   3.7403107699224*^9}, {3.761897946758169*^9, 3.761897957613974*^9}, {
   3.7618979923169527`*^9, 3.761897995148902*^9}, {3.762009263473727*^9, 
   3.762009314166874*^9}, {3.762154678510747*^9, 
   3.76215468019681*^9}},ExpressionUUID->"b58448bb-2626-427a-a0b7-\
9360842bf702"],

Cell[BoxData[Cell[TextData[StyleBox["1.1   Effective Time Evolution",
  FontColor->RGBColor[1, 0, 0]]], "Text",
  CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
    3.7384042394074717`*^9, {3.738406695464067*^9, 3.738406699136009*^9}, {
    3.7384068847910023`*^9, 3.7384068906466017`*^9}, {3.740310753819174*^9, 
    3.7403107699224*^9}, {3.761897946758169*^9, 3.761897957613974*^9}, {
    3.7618979923169527`*^9, 3.761897995148902*^9}, {3.762009263473727*^9, 
    3.762009296031787*^9}, {3.762154673711314*^9, 3.762154675341291*^9}, {
    3.7646681056060343`*^9, 3.764668120773233*^9}, {3.764668294996427*^9, 
    3.764668299988031*^9}},
  FontSize->14,ExpressionUUID->
  "6077662a-126f-4b58-8722-6f492046fae6"]], "Input",
 CellChangeTimes->{{3.7617561123223495`*^9, 3.7617561152165146`*^9}, 
   3.761756322753385*^9, 3.761758773099537*^9, {3.761773483091219*^9, 
   3.761773483146222*^9}, {3.7617835046847043`*^9, 3.7617835313783517`*^9}, {
   3.761783570957621*^9, 3.761783595216664*^9}, {3.761783917820631*^9, 
   3.761783918241832*^9}, {3.762009325063225*^9, 3.7620093344296913`*^9}, {
   3.764599512114822*^9, 3.764599557399825*^9}, {3.764599616516444*^9, 
   3.764599618837249*^9}, {3.765044148369028*^9, 
   3.7650441536574373`*^9}},ExpressionUUID->"f02ead17-8213-43e7-82ec-\
c6e57a6bd8e3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7650442055441284`*^9, 
  3.7650442138277435`*^9}},ExpressionUUID->"34258138-e1f7-475f-9970-\
4faf3528c64d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"keep", " ", "only", " ", "result"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MagnusEff1", "[", "t_", "]"}], "=", 
    RowBox[{"MDynamic", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"HEff", "[", "t", "]"}], "/.", "repHs"}], ",", "1", ",", 
      RowBox[{
       RowBox[{"\[Beta]0", "/", 
        RowBox[{"(", 
         RowBox[{"2", "ww"}], ")"}]}], "+", "t"}], ",", 
      RowBox[{"\[Beta]0", "/", 
       RowBox[{"(", 
        RowBox[{"2", "ww"}], ")"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.764660068027099*^9, 3.7646600751739116`*^9}, {
   3.764660253899826*^9, 3.7646602539466267`*^9}, {3.7646603513731985`*^9, 
   3.7646603627144184`*^9}, 3.764660523782503*^9, 3.7646605603253713`*^9, {
   3.7646607415316896`*^9, 3.7646607603473234`*^9}, 3.7646614281202593`*^9, {
   3.7646620550167646`*^9, 3.76466205801197*^9}, {3.764668477588344*^9, 
   3.764668502481852*^9}, {3.764668888275631*^9, 3.764668904778412*^9}, {
   3.765027960994238*^9, 3.76502796203944*^9}, {3.765044189802701*^9, 
   3.765044215247346*^9}, {3.7650443991882687`*^9, 
   3.7650444040086775`*^9}},ExpressionUUID->"ab379c1d-56b6-44be-8b72-\
16c7996d0743"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"30720", " ", 
    SuperscriptBox["ww", "5"]}]], 
  RowBox[{"\[ImaginaryI]", " ", "A", " ", "t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3840"}], " ", "sy", " ", 
         SuperscriptBox["ww", "4"]}], "+", 
        RowBox[{"480", " ", "A", " ", "sz", " ", 
         SuperscriptBox["ww", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"t", " ", "ww"}], "+", "\[Beta]0"}], ")"}], "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["A", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "sy", " ", 
            SuperscriptBox["t", "2"], " ", 
            SuperscriptBox["ww", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["t", "2"], " ", 
               SuperscriptBox["ww", "2"]}], "+", 
              RowBox[{"10", " ", "t", " ", "ww", " ", "\[Beta]0"}], "+", 
              RowBox[{"5", " ", 
               SuperscriptBox["\[Beta]0", "2"]}]}], ")"}]}], "+", 
           RowBox[{"5", " ", "sx", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["t", "3"], " ", 
               SuperscriptBox["ww", "3"]}], "+", 
              RowBox[{"10", " ", 
               SuperscriptBox["t", "2"], " ", 
               SuperscriptBox["ww", "2"], " ", "\[Beta]0"}], "+", 
              RowBox[{"9", " ", "t", " ", "ww", " ", 
               SuperscriptBox["\[Beta]0", "2"]}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["\[Beta]0", "3"]}]}], ")"}]}]}], ")"}]}]}], 
       ")"}], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
     RowBox[{"5", " ", 
      SuperscriptBox["A", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"6", " ", "sy", " ", 
         SuperscriptBox["t", "2"], " ", 
         SuperscriptBox["ww", "2"]}], "+", 
        RowBox[{"sx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["t", "3"], " ", 
            SuperscriptBox["ww", "3"]}], "+", 
           RowBox[{"8", " ", 
            SuperscriptBox["t", "2"], " ", 
            SuperscriptBox["ww", "2"], " ", "\[Beta]0"}], "+", 
           RowBox[{"9", " ", "t", " ", "ww", " ", 
            SuperscriptBox["\[Beta]0", "2"]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["\[Beta]0", "3"]}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"15", " ", 
         SuperscriptBox["A", "2"], " ", "sy", " ", 
         SuperscriptBox["t", "2"], " ", 
         SuperscriptBox["ww", "2"]}], "-", 
        RowBox[{"20", " ", 
         SuperscriptBox["A", "2"], " ", "sx", " ", 
         SuperscriptBox["t", "3"], " ", 
         SuperscriptBox["ww", "3"]}], "+", 
        RowBox[{"160", " ", "A", " ", "sz", " ", 
         SuperscriptBox["t", "2"], " ", 
         SuperscriptBox["ww", "4"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["A", "2"], " ", "sy", " ", 
         SuperscriptBox["t", "4"], " ", 
         SuperscriptBox["ww", "4"]}], "+", 
        RowBox[{"1920", " ", "sx", " ", "t", " ", 
         SuperscriptBox["ww", "5"]}], "-", 
        RowBox[{"50", " ", 
         SuperscriptBox["A", "2"], " ", "sx", " ", 
         SuperscriptBox["t", "2"], " ", 
         SuperscriptBox["ww", "2"], " ", "\[Beta]0"}], "+", 
        RowBox[{"240", " ", "A", " ", "sz", " ", "t", " ", 
         SuperscriptBox["ww", "3"], " ", "\[Beta]0"}], "+", 
        RowBox[{"10", " ", 
         SuperscriptBox["A", "2"], " ", "sy", " ", 
         SuperscriptBox["t", "3"], " ", 
         SuperscriptBox["ww", "3"], " ", "\[Beta]0"}], "+", 
        RowBox[{"1920", " ", "sx", " ", 
         SuperscriptBox["ww", "4"], " ", "\[Beta]0"}], "-", 
        RowBox[{"45", " ", 
         SuperscriptBox["A", "2"], " ", "sx", " ", "t", " ", "ww", " ", 
         SuperscriptBox["\[Beta]0", "2"]}], "+", 
        RowBox[{"120", " ", "A", " ", "sz", " ", 
         SuperscriptBox["ww", "2"], " ", 
         SuperscriptBox["\[Beta]0", "2"]}], "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["A", "2"], " ", "sy", " ", 
         SuperscriptBox["t", "2"], " ", 
         SuperscriptBox["ww", "2"], " ", 
         SuperscriptBox["\[Beta]0", "2"]}], "-", 
        RowBox[{"15", " ", 
         SuperscriptBox["A", "2"], " ", "sx", " ", 
         SuperscriptBox["\[Beta]0", "3"]}], "+", 
        RowBox[{"5", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"384", " ", "sx", " ", 
            SuperscriptBox["ww", "4"]}], "+", 
           RowBox[{"144", " ", "A", " ", "sz", " ", 
            SuperscriptBox["ww", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"t", " ", "ww"}], "+", "\[Beta]0"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["A", "2"], " ", "sy", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"8", " ", 
               SuperscriptBox["t", "3"], " ", 
               SuperscriptBox["ww", "3"]}], "+", 
              RowBox[{"14", " ", 
               SuperscriptBox["t", "2"], " ", 
               SuperscriptBox["ww", "2"], " ", "\[Beta]0"}], "+", 
              RowBox[{"9", " ", "t", " ", "ww", " ", 
               SuperscriptBox["\[Beta]0", "2"]}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["\[Beta]0", "3"]}]}], ")"}]}], "-", 
           RowBox[{
            SuperscriptBox["A", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"6", " ", "sx", " ", 
               SuperscriptBox["t", "2"], " ", 
               SuperscriptBox["ww", "2"]}], "-", 
              RowBox[{"sy", " ", "\[Beta]0", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"8", " ", 
                  SuperscriptBox["t", "2"], " ", 
                  SuperscriptBox["ww", "2"]}], "+", 
                 RowBox[{"9", " ", "t", " ", "ww", " ", "\[Beta]0"}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["\[Beta]0", "2"]}]}], ")"}]}]}], ")"}], " ", 
            RowBox[{"Cos", "[", "\[Beta]0", "]"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["A", "2"], " ", "sy", " ", 
         SuperscriptBox["t", "3"], " ", 
         SuperscriptBox["ww", "3"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Beta]0"}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7650442460261993`*^9},ExpressionUUID->"4145de84-dd46-4d44-a351-\
a827498c2236"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MagnusEff1", "[", "t_", "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"30720", " ", 
      SuperscriptBox["ww", "5"]}]], "\[ImaginaryI]", " ", "A", " ", "t", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3840"}], " ", "sy", " ", 
          SuperscriptBox["ww", "4"]}], "+", 
         RowBox[{"480", " ", "A", " ", "sz", " ", 
          SuperscriptBox["ww", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t", " ", "ww"}], "+", "\[Beta]0"}], ")"}], "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["A", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "sy", " ", 
             SuperscriptBox["t", "2"], " ", 
             SuperscriptBox["ww", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["t", "2"], " ", 
                SuperscriptBox["ww", "2"]}], "+", 
               RowBox[{"10", " ", "t", " ", "ww", " ", "\[Beta]0"}], "+", 
               RowBox[{"5", " ", 
                SuperscriptBox["\[Beta]0", "2"]}]}], ")"}]}], "+", 
            RowBox[{"5", " ", "sx", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["t", "3"], " ", 
                SuperscriptBox["ww", "3"]}], "+", 
               RowBox[{"10", " ", 
                SuperscriptBox["t", "2"], " ", 
                SuperscriptBox["ww", "2"], " ", "\[Beta]0"}], "+", 
               RowBox[{"9", " ", "t", " ", "ww", " ", 
                SuperscriptBox["\[Beta]0", "2"]}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["\[Beta]0", "3"]}]}], ")"}]}]}], ")"}]}]}], 
        ")"}], " ", 
       RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["A", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", "sy", " ", 
          SuperscriptBox["t", "2"], " ", 
          SuperscriptBox["ww", "2"]}], "+", 
         RowBox[{"sx", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["t", "3"], " ", 
             SuperscriptBox["ww", "3"]}], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["t", "2"], " ", 
             SuperscriptBox["ww", "2"], " ", "\[Beta]0"}], "+", 
            RowBox[{"9", " ", "t", " ", "ww", " ", 
             SuperscriptBox["\[Beta]0", "2"]}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["\[Beta]0", "3"]}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"15", " ", 
          SuperscriptBox["A", "2"], " ", "sy", " ", 
          SuperscriptBox["t", "2"], " ", 
          SuperscriptBox["ww", "2"]}], "-", 
         RowBox[{"20", " ", 
          SuperscriptBox["A", "2"], " ", "sx", " ", 
          SuperscriptBox["t", "3"], " ", 
          SuperscriptBox["ww", "3"]}], "+", 
         RowBox[{"160", " ", "A", " ", "sz", " ", 
          SuperscriptBox["t", "2"], " ", 
          SuperscriptBox["ww", "4"]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["A", "2"], " ", "sy", " ", 
          SuperscriptBox["t", "4"], " ", 
          SuperscriptBox["ww", "4"]}], "+", 
         RowBox[{"1920", " ", "sx", " ", "t", " ", 
          SuperscriptBox["ww", "5"]}], "-", 
         RowBox[{"50", " ", 
          SuperscriptBox["A", "2"], " ", "sx", " ", 
          SuperscriptBox["t", "2"], " ", 
          SuperscriptBox["ww", "2"], " ", "\[Beta]0"}], "+", 
         RowBox[{"240", " ", "A", " ", "sz", " ", "t", " ", 
          SuperscriptBox["ww", "3"], " ", "\[Beta]0"}], "+", 
         RowBox[{"10", " ", 
          SuperscriptBox["A", "2"], " ", "sy", " ", 
          SuperscriptBox["t", "3"], " ", 
          SuperscriptBox["ww", "3"], " ", "\[Beta]0"}], "+", 
         RowBox[{"1920", " ", "sx", " ", 
          SuperscriptBox["ww", "4"], " ", "\[Beta]0"}], "-", 
         RowBox[{"45", " ", 
          SuperscriptBox["A", "2"], " ", "sx", " ", "t", " ", "ww", " ", 
          SuperscriptBox["\[Beta]0", "2"]}], "+", 
         RowBox[{"120", " ", "A", " ", "sz", " ", 
          SuperscriptBox["ww", "2"], " ", 
          SuperscriptBox["\[Beta]0", "2"]}], "+", 
         RowBox[{"5", " ", 
          SuperscriptBox["A", "2"], " ", "sy", " ", 
          SuperscriptBox["t", "2"], " ", 
          SuperscriptBox["ww", "2"], " ", 
          SuperscriptBox["\[Beta]0", "2"]}], "-", 
         RowBox[{"15", " ", 
          SuperscriptBox["A", "2"], " ", "sx", " ", 
          SuperscriptBox["\[Beta]0", "3"]}], "+", 
         RowBox[{"5", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"384", " ", "sx", " ", 
             SuperscriptBox["ww", "4"]}], "+", 
            RowBox[{"144", " ", "A", " ", "sz", " ", 
             SuperscriptBox["ww", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t", " ", "ww"}], "+", "\[Beta]0"}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["A", "2"], " ", "sy", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"8", " ", 
                SuperscriptBox["t", "3"], " ", 
                SuperscriptBox["ww", "3"]}], "+", 
               RowBox[{"14", " ", 
                SuperscriptBox["t", "2"], " ", 
                SuperscriptBox["ww", "2"], " ", "\[Beta]0"}], "+", 
               RowBox[{"9", " ", "t", " ", "ww", " ", 
                SuperscriptBox["\[Beta]0", "2"]}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["\[Beta]0", "3"]}]}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["A", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"6", " ", "sx", " ", 
                SuperscriptBox["t", "2"], " ", 
                SuperscriptBox["ww", "2"]}], "-", 
               RowBox[{"sy", " ", "\[Beta]0", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"8", " ", 
                   SuperscriptBox["t", "2"], " ", 
                   SuperscriptBox["ww", "2"]}], "+", 
                  RowBox[{"9", " ", "t", " ", "ww", " ", "\[Beta]0"}], "+", 
                  RowBox[{"3", " ", 
                   SuperscriptBox["\[Beta]0", "2"]}]}], ")"}]}]}], ")"}], " ", 
             RowBox[{"Cos", "[", "\[Beta]0", "]"}]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
         RowBox[{"5", " ", 
          SuperscriptBox["A", "2"], " ", "sy", " ", 
          SuperscriptBox["t", "3"], " ", 
          SuperscriptBox["ww", "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Beta]0"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MagnusEff1", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"MagnusEff1", "[", "t", "]"}], ",", 
      RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}], "+", 
    RowBox[{
     FractionBox["1", "ww"], 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"MagnusEff1", "[", "t", "]"}], ",", 
       RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["ww", "2"]], 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"MagnusEff1", "[", "t", "]"}], ",", 
       RowBox[{"1", "/", "ww"}], ",", "2"}], "]"}]}]}], "//", 
   "S"}]}]}], "Input",
 CellChangeTimes->{{3.7650443849610434`*^9, 3.765044467017188*^9}, {
  3.7650445247392893`*^9, 3.765044531338101*^9}, {3.7650446084832363`*^9, 
  3.7650446242704644`*^9}},ExpressionUUID->"54f84fce-5d68-412a-97b3-\
ff46d27766d8"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"15360", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"\[ImaginaryI]", " ", "A", " ", "t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"480", " ", "sy", " ", "ww"}], "-", 
        RowBox[{"60", " ", "A", " ", "sz", " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", " ", "ww"}], "+", 
           RowBox[{"2", " ", "\[Beta]0"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["A", "2"], " ", 
         SuperscriptBox["t", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"5", " ", "sx"}], "-", 
           RowBox[{"2", " ", "sy", " ", "t", " ", "ww"}], "-", 
           RowBox[{"5", " ", "sy", " ", "\[Beta]0"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
     RowBox[{"5", " ", 
      SuperscriptBox["A", "2"], " ", "sx", " ", 
      SuperscriptBox["t", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "960"}], " ", "sx", " ", "ww", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", " ", "ww"}], "+", "\[Beta]0"}], ")"}]}], "-", 
        RowBox[{"40", " ", "A", " ", "sz", " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "t", " ", "ww"}], "+", 
           RowBox[{"3", " ", "\[Beta]0"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["A", "2"], " ", 
         SuperscriptBox["t", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"10", " ", "sx"}], "-", 
           RowBox[{"2", " ", "sy", " ", "t", " ", "ww"}], "-", 
           RowBox[{"5", " ", "sy", " ", "\[Beta]0"}]}], ")"}]}], "-", 
        RowBox[{"5", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"72", " ", "A", " ", "sz", " ", "t"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["A", "2"], " ", "sy", " ", 
            SuperscriptBox["t", "3"]}], "+", 
           RowBox[{"192", " ", "sx", " ", "ww"}], "+", 
           RowBox[{
            SuperscriptBox["A", "2"], " ", "sy", " ", 
            SuperscriptBox["t", "3"], " ", 
            RowBox[{"Cos", "[", "\[Beta]0", "]"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.765044471260395*^9, 3.765044536860511*^9, {3.7650446160960503`*^9, 
   3.765044625190866*^9}},ExpressionUUID->"ef5fe716-37fc-460b-b61a-\
3edee095f4ee"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"compare", " ", "MagnusEff1", " ", "with", " ", "MagnusEff0"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.765044568747967*^9, 
  3.765044581430789*^9}},ExpressionUUID->"3ab959cc-d9f8-46af-9b22-\
b787d1852797"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MagnusEff1", "[", "t", "]"}], "-", 
   RowBox[{"MagnusEff0", "[", "t", "]"}]}], "//", 
  "S"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diff", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox["A", "2"], 
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MagnusEff1", "[", "t", "]"}], "-", 
       RowBox[{"MagnusEff0", "[", "t", "]"}]}], ",", "A", ",", "2"}], "]"}]}],
    "//", "S"}]}]}], "Input",
 CellChangeTimes->{{3.76504454807693*^9, 3.765044594924813*^9}, {
  3.765044755406295*^9, 
  3.7650447929877605`*^9}},ExpressionUUID->"e34ad0f9-361e-4850-b962-\
4dcbffa891a9"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"15360", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["A", "2"], " ", 
   SuperscriptBox["t", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"20", " ", "sz", " ", "ww"}], "+", 
        RowBox[{"A", " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"5", " ", "sx"}], "-", 
           RowBox[{"2", " ", "sy", " ", "t", " ", "ww"}], "-", 
           RowBox[{"5", " ", "sy", " ", "\[Beta]0"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{"A", " ", "t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "20"}], " ", "sx"}], "+", 
        RowBox[{"4", " ", "sy", " ", "t", " ", "ww"}], "+", 
        RowBox[{"10", " ", "sy", " ", "\[Beta]0"}], "-", 
        RowBox[{"5", " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"40", " ", "sy", " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
        RowBox[{"5", " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Beta]0"}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.765044596297615*^9, 3.7650447307582517`*^9, {3.765044764735111*^9, 
   3.765044793252961*^9}},ExpressionUUID->"ccc7df04-065c-4f9a-b19f-\
1658a556bd38"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["A", "2"], " ", "sz", " ", 
    SuperscriptBox["t", "3"], " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"192", " ", "ww"}]]}]], "Output",
 CellChangeTimes->{
  3.765044596297615*^9, 3.7650447307582517`*^9, {3.765044764735111*^9, 
   3.7650447932685614`*^9}},ExpressionUUID->"9cb04da9-c3ee-49ed-a4d4-\
ea586f18da3e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MagnusEff0", "[", "t", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MagnusEff0", "[", "t", "]"}], "-", 
   RowBox[{"diff", "[", "t", "]"}]}], "//", "S"}]}], "Input",
 CellChangeTimes->{{3.7650448359658365`*^9, 
  3.7650448439686503`*^9}},ExpressionUUID->"35a37ad2-d8d4-43ac-a6e3-\
d5bf74bc3659"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"192", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"\[ImaginaryI]", " ", "A", " ", "t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "A", " ", "sz", " ", 
      SuperscriptBox["t", "2"], " ", "ww"}], "-", 
     RowBox[{"24", " ", "sx", " ", "t", " ", 
      SuperscriptBox["ww", "2"]}], "-", 
     RowBox[{"3", " ", "A", " ", "sz", " ", "t", " ", "\[Beta]0"}], "-", 
     RowBox[{"24", " ", "sx", " ", "ww", " ", "\[Beta]0"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "24"}], " ", "sy", " ", "ww"}], "+", 
        RowBox[{"2", " ", "A", " ", "sz", " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "t", " ", "ww"}], "+", 
           RowBox[{"3", " ", "\[Beta]0"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "A", " ", "sz", " ", "t"}], "+", 
        RowBox[{"8", " ", "sx", " ", "ww"}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.7650448316602287`*^9, 
  3.7650448442182508`*^9}},ExpressionUUID->"034569e8-16c5-4bb6-8f3b-\
da0538846f0b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"192", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"\[ImaginaryI]", " ", "A", " ", "t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "A", " ", "sz", " ", 
      SuperscriptBox["t", "2"], " ", "ww"}], "-", 
     RowBox[{"24", " ", "sx", " ", "t", " ", 
      SuperscriptBox["ww", "2"]}], "-", 
     RowBox[{"3", " ", "A", " ", "sz", " ", "t", " ", "\[Beta]0"}], "-", 
     RowBox[{"24", " ", "sx", " ", "ww", " ", "\[Beta]0"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "24"}], " ", "sy", " ", "ww"}], "+", 
        RowBox[{"A", " ", "sz", " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"5", " ", "t", " ", "ww"}], "+", 
           RowBox[{"6", " ", "\[Beta]0"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "A", " ", "sz", " ", "t"}], "+", 
        RowBox[{"8", " ", "sx", " ", "ww"}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.7650448316602287`*^9, 
  3.765044844779852*^9}},ExpressionUUID->"1a27e381-fd95-4e28-bec1-\
21d46afb49b4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.761782813522689*^9, 
  3.7617828136474886`*^9}},ExpressionUUID->"4c2a9d11-5bd8-40ee-a141-\
43dbbf387379"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.762009356406999*^9},ExpressionUUID->"a43e0993-3142-4ce4-96c6-\
02f396265989"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.765044256526018*^9},ExpressionUUID->"c3303798-0e81-4ac5-8d0f-\
a0aa79b9b1f9"],

Cell[TextData[StyleBox["1.2   Exact Time Evolution",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738406695464067*^9, 3.738406699136009*^9}, {
   3.7384068847910023`*^9, 3.7384068906466017`*^9}, {3.740310753819174*^9, 
   3.7403107699224*^9}, {3.761897946758169*^9, 3.761897957613974*^9}, {
   3.7618979923169527`*^9, 3.761897995148902*^9}, {3.762009263473727*^9, 
   3.762009296031787*^9}, {3.762154673711314*^9, 3.762154675341291*^9}, {
   3.7646681056060343`*^9, 3.7646681137976313`*^9}, 3.764668322722937*^9, 
   3.7650442703944426`*^9},
 FontSize->14,ExpressionUUID->"d3911fe3-80cb-4b67-88d9-d21b9c53814a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HHExact", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"H", "[", "t", "]"}], "/.", "repHs"}], "//", "S"}]}]], "Input",
 CellChangeTimes->{{3.7647470813257074`*^9, 3.764747119080774*^9}, {
   3.764747274731248*^9, 3.764747291314077*^9}, {3.765042207995203*^9, 
   3.765042215280416*^9}, 3.7650425869746695`*^9, 
   3.7650427183455*^9},ExpressionUUID->"a8eae606-6ac4-427a-8383-fbe4c232be47"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "A", " ", "t", " ", 
  RowBox[{"(", 
   RowBox[{"sx", "+", 
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.765042719297102*^9, 3.7650427773292036`*^9, 
  3.7650428940438166`*^9},ExpressionUUID->"f50cb6fd-71de-4841-b1da-\
3cbc27396a01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Print", "[", 
  "\"\<I think that this calculation is not so sensible because of the linear \
time dependence of the drive\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.765044931564804*^9, 
  3.765044992140711*^9}},ExpressionUUID->"e210806f-07d2-42dd-98e2-\
ad420cadf98f"],

Cell[BoxData["\<\"I think that this calculation is not so sensible because of \
the linear time dependence of the drive\"\>"], "Print",
 CellChangeTimes->{{3.7650449783346863`*^9, 
  3.765044994215514*^9}},ExpressionUUID->"c222ecc1-2fc9-444f-bd68-\
93649d6bc4c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MagnusEx1", "[", "t_", "]"}], "=", 
  RowBox[{"MDynamic", "[", 
   RowBox[{
    RowBox[{"HHEx", "[", "t", "]"}], ",", "1", ",", 
    RowBox[{
     RowBox[{"beta0", "/", 
      RowBox[{"(", 
       RowBox[{"2", "ww"}], ")"}]}], "+", "t"}], ",", 
    RowBox[{"beta0", "/", 
     RowBox[{"(", 
      RowBox[{"2", "ww"}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7617561123223495`*^9, 3.7617561152165146`*^9}, 
   3.761756322753385*^9, 3.761758773099537*^9, {3.761773483091219*^9, 
   3.761773483146222*^9}, {3.7617835046847043`*^9, 3.7617835313783517`*^9}, {
   3.761783570957621*^9, 3.761783595216664*^9}, {3.761783917820631*^9, 
   3.761783918241832*^9}, {3.762009325063225*^9, 3.7620093344296913`*^9}, {
   3.764599512114822*^9, 3.764599557399825*^9}, 3.764660048573865*^9, {
   3.7646678919145393`*^9, 3.7646678919853973`*^9}, {3.76466794035086*^9, 
   3.764667941166801*^9}, {3.764667975045796*^9, 3.7646679880286694`*^9}, {
   3.7646685113305397`*^9, 3.764668521257009*^9}, 3.7650426116081123`*^9, {
   3.7650426820588365`*^9, 3.765042694866459*^9}, {3.7650428977878237`*^9, 
   3.7650428987862253`*^9}, {3.765044304168502*^9, 3.7650443243549376`*^9}, {
   3.765044358222597*^9, 
   3.7650443609214015`*^9}},ExpressionUUID->"379d5900-605f-4fe7-ade0-\
fe4cd8d852ab"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n [+++] About to start for-loop in MDynamic[HH,max] @ \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "4", ",", "23", ",", "22", ",", "39"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\\n\"\>"}],
  SequenceForm[
  "\n\n\n [+++] About to start for-loop in MDynamic[HH,max] @ ", {2019, 4, 23,
    22, 39}, "\n\n"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7650443628714046`*^9},ExpressionUUID->"d4fb9770-27ad-412c-9b8f-\
8a5b4a997c23"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "4", ",", "23", ",", "22", ",", "39"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 1, " @ ", {2019, 4, 23, 22, 
   39}, "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765044362887005*^9},ExpressionUUID->"f16e7f3b-9f58-4093-92c0-\
7a482232c84f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "4", ",", "23", ",", "22", ",", "39", ",", 
     "22.7934048`9.110384132588555"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 1, 
   ", at date and time ", {2019, 4, 23, 22, 39, 22.7934048`9.110384132588555}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765044362902605*^9},ExpressionUUID->"5e6942f4-279a-40c6-83c7-\
312fcbdde8b2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "4", ",", "23", ",", "22", ",", "39", ",", 
     "28.4094147`9.206037199128083"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 2, 
   ", at date and time ", {2019, 4, 23, 22, 39, 28.4094147`9.206037199128083}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7650443684250145`*^9},ExpressionUUID->"7c15a603-9bda-4cd1-bbd0-\
db0fa2b1315b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"768", " ", 
     SuperscriptBox["ww", "4"]}]], 
   RowBox[{"\[ImaginaryI]", " ", "A", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "A", " ", 
       SuperscriptBox["beta0", "2"], " ", "sz", " ", "t", " ", "ww"}], "+", 
      RowBox[{"12", " ", "A", " ", "beta0", " ", "sz", " ", 
       SuperscriptBox["t", "2"], " ", 
       SuperscriptBox["ww", "2"]}], "+", 
      RowBox[{"96", " ", "beta0", " ", "sx", " ", "t", " ", 
       SuperscriptBox["ww", "3"]}], "+", 
      RowBox[{"8", " ", "A", " ", "sz", " ", 
       SuperscriptBox["t", "3"], " ", 
       SuperscriptBox["ww", "3"]}], "+", 
      RowBox[{"96", " ", "sx", " ", 
       SuperscriptBox["t", "2"], " ", 
       SuperscriptBox["ww", "4"]}], "-", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", " ", 
          RowBox[{"(", 
           RowBox[{"sx", "+", 
            RowBox[{"beta0", " ", "sy"}]}], ")"}], " ", 
          SuperscriptBox["ww", "2"]}], "+", 
         RowBox[{"A", " ", "beta0", " ", "sz", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", 
            RowBox[{"beta0", " ", "t", " ", "ww"}], "+", 
            RowBox[{
             SuperscriptBox["t", "2"], " ", 
             SuperscriptBox["ww", "2"]}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "beta0", "]"}]}], "+", 
      RowBox[{"6", " ", "A", " ", "sz", " ", "t", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "+", 
      RowBox[{"18", " ", "A", " ", "beta0", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
      RowBox[{"36", " ", "A", " ", "sz", " ", "t", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "-", 
      RowBox[{"6", " ", "A", " ", 
       SuperscriptBox["beta0", "2"], " ", "sz", " ", "t", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
      RowBox[{"48", " ", "sx", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
      RowBox[{"48", " ", "beta0", " ", "sy", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "-", 
      RowBox[{"18", " ", "A", " ", "beta0", " ", "sz", " ", 
       SuperscriptBox["t", "2"], " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
      RowBox[{"96", " ", "sy", " ", "t", " ", 
       SuperscriptBox["ww", "3"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "-", 
      RowBox[{"12", " ", "A", " ", "sz", " ", 
       SuperscriptBox["t", "3"], " ", 
       SuperscriptBox["ww", "3"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
      RowBox[{"18", " ", "A", " ", "sz", " ", 
       RowBox[{"Sin", "[", "beta0", "]"}]}], "-", 
      RowBox[{"6", " ", "A", " ", 
       SuperscriptBox["beta0", "2"], " ", "sz", " ", 
       RowBox[{"Sin", "[", "beta0", "]"}]}], "+", 
      RowBox[{
      "6", " ", "A", " ", "beta0", " ", "sz", " ", "t", " ", "ww", " ", 
       RowBox[{"Sin", "[", "beta0", "]"}]}], "-", 
      RowBox[{"48", " ", "beta0", " ", "sx", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Sin", "[", "beta0", "]"}]}], "+", 
      RowBox[{"48", " ", "sy", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Sin", "[", "beta0", "]"}]}], "+", 
      RowBox[{"6", " ", "A", " ", "sz", " ", 
       SuperscriptBox["t", "2"], " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Sin", "[", "beta0", "]"}]}], "-", 
      RowBox[{"3", " ", "A", " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"3", " ", "A", " ", 
       SuperscriptBox["beta0", "2"], " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
      RowBox[{
      "6", " ", "A", " ", "beta0", " ", "sz", " ", "t", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"18", " ", "A", " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
      RowBox[{"6", " ", "A", " ", 
       SuperscriptBox["beta0", "2"], " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
      RowBox[{
      "30", " ", "A", " ", "beta0", " ", "sz", " ", "t", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
      RowBox[{"48", " ", "beta0", " ", "sx", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "-", 
      RowBox[{"48", " ", "sy", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
      RowBox[{"30", " ", "A", " ", "sz", " ", 
       SuperscriptBox["t", "2"], " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
      RowBox[{"96", " ", "sx", " ", "t", " ", 
       SuperscriptBox["ww", "3"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"beta0", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.765044448921156*^9},ExpressionUUID->"ed22ffd6-6314-41fe-be29-\
e202b7d40da7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.762009356782*^9, 
  3.76200935688472*^9}},ExpressionUUID->"222b3c16-c329-4e80-9482-\
c4c3cd628747"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.765045064619438*^9, 
  3.765045067458643*^9}},ExpressionUUID->"94d9c661-e3a2-4288-a143-\
259a3cd389e7"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.76504506578944*^9, 
  3.7650450664758415`*^9}},ExpressionUUID->"8f76124c-2f35-431c-881f-\
cc1e4b8193e9"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.765045068722245*^9},ExpressionUUID->"5cc983b7-eaed-4411-9de9-\
40ad80bb7230"]
}, Open  ]]
},
WindowSize->{996, 991},
WindowMargins->{{Automatic, 0}, {Automatic, 66}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> True}},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 471, 8, 111, "Input",ExpressionUUID->"4ca4b9d9-846b-46b4-b112-0cb42625de0f"],
Cell[1054, 32, 388, 6, 78, "Print",ExpressionUUID->"dc94ee06-5ad0-4e39-ab16-93b531d48cf4"]
}, Open  ]],
Cell[1457, 41, 496, 9, 111, "Input",ExpressionUUID->"a82f85ff-6ab6-429d-96e5-72212a236b30"],
Cell[1956, 52, 433, 8, 87, "Input",ExpressionUUID->"20252e72-40cd-4630-af8f-52bb575015b5"],
Cell[2392, 62, 177, 4, 38, "Input",ExpressionUUID->"f5e9d183-5db7-4f18-92c7-227a9b359052"],
Cell[2572, 68, 515, 9, 87, "Input",ExpressionUUID->"f2f2cb5e-57c8-4587-bb8f-3708b18289f9"],
Cell[3090, 79, 265, 6, 38, "Input",ExpressionUUID->"f0207cac-380f-4d9a-a587-f09b4159e0e6"],
Cell[CellGroupData[{
Cell[3380, 89, 330, 7, 87, "Input",ExpressionUUID->"b0a534cd-003a-4d16-9f7c-404a60621bf3"],
Cell[3713, 98, 270, 5, 54, "Print",ExpressionUUID->"b733febc-7a3f-4300-b1e0-2f8b0925d4a4"]
}, Open  ]],
Cell[3998, 106, 14795, 284, 1043, "Input",ExpressionUUID->"3e852b33-5c33-46e5-bc78-cd6f7bab6f6c"],
Cell[18796, 392, 2815, 52, 231, "Input",ExpressionUUID->"5d09364e-3d5d-40ff-9167-a0fe715cd7fa"],
Cell[CellGroupData[{
Cell[21636, 448, 1476, 35, 279, "Input",ExpressionUUID->"ced70536-88f4-4ea4-9f46-8a80b9f13171"],
Cell[23115, 485, 3464, 55, 43, "Output",ExpressionUUID->"feacbfae-0df4-40b5-b925-e5dbbcb9dc2b"]
}, Open  ]],
Cell[26594, 543, 475, 9, 63, "Input",ExpressionUUID->"979da102-f84f-420e-bffe-4224c634faf9"],
Cell[27072, 554, 144, 2, 63, "Input",ExpressionUUID->"01c6a39b-8681-4d07-a3ce-03153f81afe3"],
Cell[27219, 558, 487, 11, 63, "Input",ExpressionUUID->"ad8e1d9a-cf2e-4926-b4c9-48b499705865"],
Cell[27709, 571, 442, 9, 63, "Input",ExpressionUUID->"98457cf9-d50b-416f-9904-4ab70395bc42"],
Cell[28154, 582, 562, 10, 38, "Input",ExpressionUUID->"2c66e7b0-248b-4b40-89a4-801d97843ca2"],
Cell[28719, 594, 147, 3, 63, "Input",ExpressionUUID->"8375cb07-c38d-44be-880e-f831650195b8"],
Cell[28869, 599, 5145, 124, 307, "Input",ExpressionUUID->"e05ba944-752d-4a7c-9921-21f783746504"],
Cell[34017, 725, 4033, 96, 302, "Input",ExpressionUUID->"8b65f213-f932-48dc-b9d2-36a9893ead51"],
Cell[38053, 823, 173, 3, 78, "Input",ExpressionUUID->"1437fa0f-c079-4e87-a779-d88b0c24343e"],
Cell[38229, 828, 283, 6, 47, "Input",ExpressionUUID->"7a4d1e96-d08d-4ef2-aeae-6ec8954a7ad4"],
Cell[CellGroupData[{
Cell[38537, 838, 719, 10, 106, "Section",ExpressionUUID->"3e73cf19-09ac-47aa-b338-fb6ccb8e4b72"],
Cell[39259, 850, 1050, 30, 168, "Input",ExpressionUUID->"19352712-ec9d-4955-8090-52007f9f3aae"],
Cell[40312, 882, 919, 27, 108, "Input",ExpressionUUID->"7c404ed9-f29d-4e61-bd83-e6be0befdba6"],
Cell[CellGroupData[{
Cell[41256, 913, 360, 9, 108, "Input",ExpressionUUID->"71bfc88a-47bf-4e2f-b691-6c633f5d0565"],
Cell[41619, 924, 287, 5, 36, "Print",ExpressionUUID->"a1dabdf3-e250-49f4-a011-d6d0d8a35c57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41943, 934, 207, 5, 47, "Input",ExpressionUUID->"e10ada11-1e90-4560-ae60-8763a2ce528a"],
Cell[42153, 941, 3430, 85, 207, "Output",ExpressionUUID->"e9c95b96-0627-4889-852e-76acf775b163"]
}, Open  ]],
Cell[45598, 1029, 144, 2, 78, "Input",ExpressionUUID->"44fbd14d-d93c-4943-9bd3-54cece0d73ed"],
Cell[45745, 1033, 990, 29, 143, "Input",ExpressionUUID->"6687b4a6-d3da-47c5-98d6-f2bfde977b06"],
Cell[46738, 1064, 2307, 63, 258, "Input",ExpressionUUID->"f95d04ef-d89a-434d-ab4b-ee5a505f90ef"],
Cell[49048, 1129, 149, 3, 78, "Input",ExpressionUUID->"af79d0af-4c43-4558-8334-53b816024338"],
Cell[49200, 1134, 147, 3, 78, "Input",ExpressionUUID->"c8ad4bda-7c71-4138-b793-2545623ed142"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49384, 1142, 677, 11, 177, "Section",ExpressionUUID->"3e73cf19-09ac-47aa-b338-fb6ccb8e4b72"],
Cell[50064, 1155, 147, 3, 78, "Input",ExpressionUUID->"3516c2c8-c249-4e37-93d8-c5bd9c30eb0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50248, 1163, 588, 9, 106, "Section",ExpressionUUID->"c76a4048-4191-4bff-b2a4-592959916690"],
Cell[50839, 1174, 149, 3, 78, "Input",ExpressionUUID->"99b29b57-67bd-47b4-a17f-0f3da3cfbec6"],
Cell[50991, 1179, 709, 10, 46, "Text",ExpressionUUID->"6077662a-126f-4b58-8722-6f492046fae6"],
Cell[CellGroupData[{
Cell[51725, 1193, 229, 5, 47, "Input",ExpressionUUID->"b13f3410-47ea-41b9-916a-56c5528c340c"],
Cell[51957, 1200, 3460, 87, 207, "Output",ExpressionUUID->"618f3343-35e2-4846-a739-1b23af9ac18c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55454, 1292, 345, 9, 47, "Input",ExpressionUUID->"a8eae606-6ac4-427a-8383-fbe4c232be47"],
Cell[55802, 1303, 3340, 86, 176, "Output",ExpressionUUID->"281d081d-1bcb-4696-9880-81bfd89d28d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59179, 1394, 557, 12, 47, "Input",ExpressionUUID->"b1a74f6a-b559-4a53-b7e2-2d607c60ee2d"],
Cell[59739, 1408, 1029, 29, 71, "Output",ExpressionUUID->"68c5d306-e884-43f3-96f6-89e0b0264b85"]
}, Open  ]],
Cell[60783, 1440, 144, 2, 78, "Input",ExpressionUUID->"bd69fa6c-ee28-482a-b452-67de81701de7"],
Cell[CellGroupData[{
Cell[60952, 1446, 975, 22, 47, "Input",ExpressionUUID->"ab379c1d-56b6-44be-8b72-16c7996d0743"],
Cell[CellGroupData[{
Cell[61952, 1472, 594, 14, 187, "Print",ExpressionUUID->"1a850f09-589b-4e46-a5aa-1dfbd2cdffa3"],
Cell[62549, 1488, 896, 18, 40, "Print",ExpressionUUID->"30fac969-e024-4692-97ea-c0134840a9b4"]
}, Open  ]],
Cell[63460, 1509, 1850, 49, 108, "Output",ExpressionUUID->"24a2554e-2b0c-4ddf-8e7f-f05b38ab5f28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65347, 1563, 836, 25, 161, "Input",ExpressionUUID->"b33c8c43-4615-4f8a-842f-6db4f004bf68"],
Cell[66186, 1590, 1313, 34, 108, "Output",ExpressionUUID->"ae27b4ee-562c-4aca-a4df-6f2574145a2c"]
}, Open  ]],
Cell[67514, 1627, 147, 3, 78, "Input",ExpressionUUID->"842820d1-3dc8-4b3d-94ce-b7a4ff2b1ab9"],
Cell[67664, 1632, 420, 10, 78, "Input",ExpressionUUID->"7169f399-6e74-4ee4-9521-b99a4fd9d7ee"],
Cell[CellGroupData[{
Cell[68109, 1646, 373, 9, 47, "Input",ExpressionUUID->"fcdfaef7-0dba-434c-b820-42d105c4bf0a"],
Cell[68485, 1657, 645, 17, 71, "Output",ExpressionUUID->"12aff59b-b244-4c4b-8392-c4415f0050c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69167, 1679, 373, 9, 47, "Input",ExpressionUUID->"fcdfaef7-0dba-434c-b820-42d105c4bf0a"],
Cell[69543, 1690, 1777, 48, 108, "Output",ExpressionUUID->"610f200f-6a0c-4616-9b5e-724e70229611"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71357, 1743, 324, 7, 47, "Input",ExpressionUUID->"9cfe5efa-ca3d-46b3-bd1d-c3856c334e20"],
Cell[71684, 1752, 215, 4, 36, "Print",ExpressionUUID->"1a27889a-eb97-4c03-b229-8c8a37fb6e01"]
}, Open  ]],
Cell[71914, 1759, 149, 3, 78, "Input",ExpressionUUID->"e2d52dc7-66e4-4655-80d8-0968346f1498"],
Cell[CellGroupData[{
Cell[72088, 1766, 393, 11, 63, "Subsection",ExpressionUUID->"f00ac8b6-b266-405e-9b71-316960d29f77"],
Cell[CellGroupData[{
Cell[72506, 1781, 165, 4, 58, "Input",ExpressionUUID->"a2049088-9b15-43d4-9740-32e962be4a17"],
Cell[72674, 1787, 1880, 50, 135, "Output",ExpressionUUID->"c925c458-3ecc-4374-aaf1-2ef13ada8fc6"]
}, Open  ]],
Cell[74569, 1840, 223, 5, 58, "Input",ExpressionUUID->"20ac6a61-aa77-4db1-ab4f-f5fbf7ea45c8"],
Cell[CellGroupData[{
Cell[74817, 1849, 538, 16, 97, "Input",ExpressionUUID->"b959d1b8-f96a-4364-b73b-5069bf0d4f62"],
Cell[75358, 1867, 572, 16, 88, "Output",ExpressionUUID->"c185e723-d943-4172-9b91-bf273118afdc"],
Cell[75933, 1885, 1187, 33, 135, "Output",ExpressionUUID->"ffec8103-faae-4d60-9dcf-a44f4ced8043"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77157, 1923, 430, 12, 91, "Input",ExpressionUUID->"37a211bc-41a5-4e0f-bce1-11c35d14c749"],
Cell[77590, 1937, 711, 17, 100, "Output",ExpressionUUID->"8fd1d7af-8ba8-48d5-b332-7297ce27f607"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78338, 1959, 365, 10, 58, "Input",ExpressionUUID->"ce975180-fcf1-48e6-bb66-f7caf1278499"],
Cell[78706, 1971, 1331, 34, 135, "Output",ExpressionUUID->"b7c02734-b377-461c-8dc8-cce21b3b07db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80074, 2010, 556, 12, 97, "Input",ExpressionUUID->"9406f4af-d451-4fcd-81f3-c004249ff31d"],
Cell[80633, 2024, 410, 10, 87, "Output",ExpressionUUID->"a194a5b0-bbb1-43fd-a6a8-ef18c554ed45"],
Cell[81046, 2036, 644, 16, 87, "Output",ExpressionUUID->"de21b645-64fb-4c93-bf77-fc8ed4057484"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81727, 2057, 229, 5, 58, "Input",ExpressionUUID->"508fccb6-9af8-4d03-802c-4bf78b4b3f2b"],
Cell[81959, 2064, 561, 16, 102, "Output",ExpressionUUID->"b72bfe74-3831-4c60-893c-9de2a5ed7280"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82557, 2085, 522, 11, 66, "Input",ExpressionUUID->"3c27ecc0-d92d-4f46-a223-eff92799b358"],
Cell[83082, 2098, 559, 14, 102, "Output",ExpressionUUID->"2e3e105a-6d00-4f9c-bcff-981a992e651e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83678, 2117, 852, 20, 70, "Subsubsection",ExpressionUUID->"76737a94-7cad-4294-805b-845bbad3d88a"],
Cell[84533, 2139, 208, 4, 156, "Input",ExpressionUUID->"54a73ce4-363c-4348-bfd2-3114c46648ee"],
Cell[84744, 2145, 679, 9, 71, "Text",ExpressionUUID->"d3911fe3-80cb-4b67-88d9-d21b9c53814a"],
Cell[CellGroupData[{
Cell[85448, 2158, 489, 11, 66, "Input",ExpressionUUID->"a8eae606-6ac4-427a-8383-fbe4c232be47"],
Cell[85940, 2171, 520, 14, 102, "Output",ExpressionUUID->"24df7942-aec8-4ad3-8448-003a7f29bec8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86497, 2190, 1262, 25, 66, "Input",ExpressionUUID->"379d5900-605f-4fe7-ade0-fe4cd8d852ab"],
Cell[CellGroupData[{
Cell[87784, 2219, 674, 15, 268, "Print",ExpressionUUID->"03a2899b-c439-4c4a-a5c0-cac10109c755"],
Cell[88461, 2236, 974, 19, 96, "Print",ExpressionUUID->"358765fe-16a8-4f6f-816a-14c962991747"]
}, Open  ]],
Cell[89450, 2258, 1784, 47, 241, "Output",ExpressionUUID->"e1fa7a3a-92be-43c4-ac19-0755e25b85d2"]
}, Open  ]],
Cell[91249, 2308, 149, 3, 112, "Input",ExpressionUUID->"236f967a-de50-498d-ba1a-0aa56a3bd7c7"],
Cell[CellGroupData[{
Cell[91423, 2315, 1131, 23, 66, "Input",ExpressionUUID->"379d5900-605f-4fe7-ade0-fe4cd8d852ab"],
Cell[92557, 2340, 1707, 46, 241, "Output",ExpressionUUID->"b8b40867-318a-4d3d-bc58-c15c8b999fd2"]
}, Open  ]],
Cell[94279, 2389, 144, 2, 112, "Input",ExpressionUUID->"39cfb021-c2df-440e-8a62-2ca0ee2f1761"],
Cell[CellGroupData[{
Cell[94448, 2395, 1903, 57, 300, "Input",ExpressionUUID->"f8d2eddc-c944-4723-82e2-2341ec9b9197"],
Cell[96354, 2454, 1751, 53, 197, "Output",ExpressionUUID->"88de341f-1cb4-49e4-95b0-c25bac639401"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98142, 2512, 582, 16, 66, "Input",ExpressionUUID->"5ab05a55-6ac4-4fd0-99eb-920e18428949"],
Cell[98727, 2530, 127, 2, 66, "Output",ExpressionUUID->"b099861c-9695-4f02-9d37-184bf8fdf372"]
}, Open  ]],
Cell[98869, 2535, 206, 4, 156, "Input",ExpressionUUID->"21710409-be99-47f6-a433-0b6b630e68df"],
Cell[99078, 2541, 147, 3, 112, "Input",ExpressionUUID->"36205668-99eb-405e-bbf1-a18febbb4411"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[99286, 2551, 586, 9, 171, "Section",ExpressionUUID->"b58448bb-2626-427a-a0b7-9360842bf702"],
Cell[99875, 2562, 1321, 20, 77, "Input",ExpressionUUID->"f02ead17-8213-43e7-82ec-c6e57a6bd8e3"],
Cell[101199, 2584, 156, 3, 66, "Input",ExpressionUUID->"34258138-e1f7-475f-9970-4faf3528c64d"],
Cell[CellGroupData[{
Cell[101380, 2591, 1289, 29, 197, "Input",ExpressionUUID->"ab379c1d-56b6-44be-8b72-16c7996d0743"],
Cell[102672, 2622, 6897, 170, 570, "Output",ExpressionUUID->"4145de84-dd46-4d44-a351-a827498c2236"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109606, 2797, 7967, 195, 946, "Input",ExpressionUUID->"54f84fce-5d68-412a-97b3-ff46d27766d8"],
Cell[117576, 2994, 2655, 70, 291, "Output",ExpressionUUID->"ef5fe716-37fc-460b-b61a-3edee095f4ee"]
}, Open  ]],
Cell[120246, 3067, 250, 6, 66, "Input",ExpressionUUID->"3ab959cc-d9f8-46af-9b22-b787d1852797"],
Cell[CellGroupData[{
Cell[120521, 3077, 672, 20, 113, "Input",ExpressionUUID->"e34ad0f9-361e-4850-b962-4dcbffa891a9"],
Cell[121196, 3099, 1500, 41, 151, "Output",ExpressionUUID->"ccc7df04-065c-4f9a-b19f-1658a556bd38"],
Cell[122699, 3142, 429, 11, 110, "Output",ExpressionUUID->"9cb04da9-c3ee-49ed-a4d4-ea586f18da3e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123165, 3158, 339, 8, 112, "Input",ExpressionUUID->"35a37ad2-d8d4-43ac-a6e3-d5bf74bc3659"],
Cell[123507, 3168, 1313, 34, 156, "Output",ExpressionUUID->"034569e8-16c5-4bb6-8f3b-da0538846f0b"],
Cell[124823, 3204, 1301, 34, 156, "Output",ExpressionUUID->"1a27e381-fd95-4e28-bec1-21d46afb49b4"]
}, Open  ]],
Cell[126139, 3241, 208, 4, 156, "Input",ExpressionUUID->"4c2a9d11-5bd8-40ee-a141-43dbbf387379"],
Cell[126350, 3247, 147, 3, 112, "Input",ExpressionUUID->"a43e0993-3142-4ce4-96c6-02f396265989"],
Cell[126500, 3252, 147, 3, 112, "Input",ExpressionUUID->"c3303798-0e81-4ac5-8d0f-a0aa79b9b1f9"],
Cell[126650, 3257, 707, 10, 71, "Text",ExpressionUUID->"d3911fe3-80cb-4b67-88d9-d21b9c53814a"],
Cell[CellGroupData[{
Cell[127382, 3271, 438, 9, 66, "Input",ExpressionUUID->"a8eae606-6ac4-427a-8383-fbe4c232be47"],
Cell[127823, 3282, 493, 13, 102, "Output",ExpressionUUID->"f50cb6fd-71de-4841-b1da-3cbc27396a01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128353, 3300, 295, 6, 156, "Input",ExpressionUUID->"e210806f-07d2-42dd-98e2-ad420cadf98f"],
Cell[128651, 3308, 263, 4, 96, "Print",ExpressionUUID->"c222ecc1-2fc9-444f-bd68-93649d6bc4c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128951, 3317, 1314, 26, 66, "Input",ExpressionUUID->"379d5900-605f-4fe7-ade0-fe4cd8d852ab"],
Cell[CellGroupData[{
Cell[130290, 3347, 526, 13, 268, "Print",ExpressionUUID->"d4fb9770-27ad-412c-9b8f-8a5b4a997c23"],
Cell[130819, 3362, 559, 14, 140, "Print",ExpressionUUID->"f16e7f3b-9f58-4093-92c0-7a482232c84f"],
Cell[131381, 3378, 826, 17, 96, "Print",ExpressionUUID->"5e6942f4-279a-40c6-83c7-312fcbdde8b2"],
Cell[132210, 3397, 828, 17, 96, "Print",ExpressionUUID->"7c15a603-9bda-4cd1-bbd0-db0fa2b1315b"]
}, Open  ]],
Cell[133053, 3417, 6167, 148, 721, "Output",ExpressionUUID->"ed22ffd6-6314-41fe-be29-e202b7d40da7"]
}, Open  ]],
Cell[139235, 3568, 202, 4, 156, "Input",ExpressionUUID->"222b3c16-c329-4e80-9482-c4c3cd628747"],
Cell[139440, 3574, 152, 3, 66, "Input",ExpressionUUID->"94d9c661-e3a2-4288-a143-259a3cd389e7"],
Cell[139595, 3579, 153, 3, 66, "Input",ExpressionUUID->"8f76124c-2f35-431c-881f-cc1e4b8193e9"],
Cell[139751, 3584, 147, 3, 112, "Input",ExpressionUUID->"5cc983b7-eaed-4411-9de9-40ad80bb7230"]
}, Open  ]]
}
]
*)

