(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    121685,       2940]
NotebookOptionsPosition[    114903,       2752]
NotebookOutlinePosition[    115542,       2776]
CellTagsIndexPosition[    115455,       2771]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Print", "[", 
  "\"\<To calculate the effective Hamiltonian, first set parameters \
accordingly (mainly H[t], max, coeffs, offResonant, taylor) and then compute \
\\n--> effH[H[t]]. \n\\n For the Magnus-Taylor Expansion, use \\n--> M[H[t], \
max].\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.752381869064521*^9, 3.752382058975713*^9}, {
  3.7523821134936733`*^9, 3.7523821751548*^9}},
 ExpressionUUID -> "a82f85ff-6ab6-429d-96e5-72212a236b30"],

Cell[BoxData["\<\"To calculate the effective Hamiltonian, first set \
parameters accordingly (mainly H[t], max, coeffs, offResonant, taylor) and \
then compute \\n--> effH[H[t]]. \\n\\n For the Magnus-Taylor Expansion, use \
\\n--> M[H[t], max].\"\>"], "Print",
 CellChangeTimes->{{3.752382132808332*^9, 3.75238217537676*^9}, 
   3.753185880582761*^9, 3.7616299965407753`*^9, 3.761737546018136*^9, 
   3.761737610011449*^9, 3.76173946585382*^9, 3.7617550454773293`*^9, 
   3.7617551885415115`*^9, 3.761755245693781*^9, 3.7617555371564517`*^9, 
   3.761773913414832*^9, 3.761783940536271*^9},
 ExpressionUUID -> "df9a9843-428b-4d38-a76a-960b2d1266c3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", "\[IndentingNewLine]", "        ", 
  RowBox[{
  "CALCULATE", " ", "EFFECTIVE", " ", "HAMILTONIAN", " ", "IN", " ", "*", 
   "ONE", "*", " ", "FUNCTION"}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.732783774703618*^9, 3.7327838042880573`*^9}, {
   3.7384017729937963`*^9, 3.738401803320197*^9}, 3.761630091064342*^9},
 ExpressionUUID -> "20252e72-40cd-4630-af8f-52bb575015b5"],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.714032593196076*^9, 3.71403259418537*^9}},
 ExpressionUUID -> "f5e9d183-5db7-4f18-92c7-227a9b359052"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "                          ", 
  RowBox[{"(*", " ", "INITIALIZATION", " ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6884714867492723`*^9, 3.688471495525632*^9}, {
   3.688472833211739*^9, 3.688472909638434*^9}, 3.688472943053876*^9, {
   3.688472974235373*^9, 3.688472992314371*^9}, {3.688473271051791*^9, 
   3.688473359479607*^9}, {3.688474213194075*^9, 3.6884742218427362`*^9}},
 ExpressionUUID -> "f2f2cb5e-57c8-4587-bb8f-3708b18289f9"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"<<", "Utilities`CleanSlate`"}], "*)"}]], "Input",
 CellChangeTimes->{{3.740750848764427*^9, 3.740750848773137*^9}, 
   3.740750939928162*^9, 3.740750987584403*^9},
 ExpressionUUID -> "f0207cac-380f-4d9a-a587-f09b4159e0e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"INPUT", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Generic", " ", "Hamiltonian", " ", "a", " ", "la", " ", "Kai", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"see", " ", "our", " ", "Email", " ", "chat", " ", 
       RowBox[{"on", "/", "around"}], " ", "March", " ", "13"}], ",", " ", 
      "2019"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", "t_", "]"}], "=", 
     RowBox[{
      FractionBox["H1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "phi", "]"}], "sx"}], "+", 
        RowBox[{"sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"2", " ", "t", " ", "ww"}], "+", "phi"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", "phi", "]"}], "sy"}], "-", 
        RowBox[{"sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"2", " ", "t", " ", "ww"}], "+", "phi"}], "]"}]}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"set", " ", "maximum", " ", "order", " ", "of", " ", 
      RowBox[{"1", "/", "ww"}]}], ",", " ", 
     RowBox[{
     "and", " ", "set", " ", "up", " ", "list", " ", "of", " ", 
      "coefficients", " ", 
      RowBox[{"(", 
       RowBox[{"for", " ", "sTrim"}], ")"}]}], ",", "  ", 
     RowBox[{
      RowBox[{"in", " ", "case", " ", "of", " ", "taylor"}], " ", "\[Equal]", 
      " ", 
      RowBox[{
      "True", " ", "\[IndentingNewLine]", "the", " ", "highest", " ", 
       "\"\<reasonable\>\"", " ", "max", " ", "is", " ", "5"}]}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"max", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"coeffs1", " ", "=", " ", 
     RowBox[{"time", "-", 
      RowBox[{
      "dependent", " ", "coefficients", " ", "of", " ", "original", " ", 
       RowBox[{"Hamiltonian", " ", "[", 
        RowBox[{"no", " ", "derivatives"}], "]"}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffs1", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"H1", ",", "1"}], "}"}], 
      RowBox[{"(*", 
       RowBox[{",", 
        RowBox[{"{", 
         RowBox[{"H2", ",", "1"}], "}"}]}], "*)"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"offResonant", " ", "=", " ", 
     RowBox[{"True", " ", "or", " ", "False"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"offResonant", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"taylor", " ", "Expansion"}], " ", "=", " ", 
     RowBox[{"True", " ", "or", " ", "False"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"taylor", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"taylor", "=", "True"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "how", " ", "much", " ", "output", " ", "should", " ", "be", " ", 
     "written"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"verbose", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"verboseLight", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"verbose", "=", "True"}], ";", "\[IndentingNewLine]", 
     RowBox[{"verboseLight", "=", "True"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"t0", "=", "0"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myDir", "=", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nb1", "=", 
     RowBox[{"NotebookOpen", "[", 
      RowBox[{
      "myDir", " ", "<>", " ", 
       "\"\</scripts/Magnus_script_precalculated.nb\>\""}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"SelectionMove", "[", 
     RowBox[{"nb1", ",", "All", ",", "Notebook"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"SelectionEvaluate", "[", "nb1", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7383435305235815`*^9, 3.738343592495126*^9}, 
   3.7383439885107765`*^9, 3.738346814033387*^9, {3.738347868201682*^9, 
   3.7383478811264215`*^9}, {3.7383480180462527`*^9, 3.738348031894045*^9}, {
   3.738349622067998*^9, 3.7383496222350073`*^9}, 3.738384009688859*^9, {
   3.738392136555678*^9, 3.7383921366032887`*^9}, 3.738398524299714*^9, {
   3.738401751260746*^9, 3.738401751683127*^9}, {3.738401818064953*^9, 
   3.738401818118976*^9}, {3.738402313149651*^9, 3.738402314500173*^9}, {
   3.738403835936941*^9, 3.73840383614491*^9}, {3.7384039423164263`*^9, 
   3.738403942755814*^9}, {3.73840662367668*^9, 3.738406623764216*^9}, {
   3.7384074310297003`*^9, 3.738407456035037*^9}, {3.738408215301742*^9, 
   3.73840821692533*^9}, {3.738408410444408*^9, 3.738408410478509*^9}, {
   3.738408527024033*^9, 3.738408546349365*^9}, {3.738409738544488*^9, 
   3.7384097386151667`*^9}, {3.738410698161747*^9, 3.7384107012545033`*^9}, 
   3.738410732253236*^9, {3.738410835600266*^9, 3.738410836071842*^9}, 
   3.738411307196224*^9, {3.738411775686285*^9, 3.7384117761807613`*^9}, 
   3.738413522998351*^9, 3.7384137293800163`*^9, {3.738575151023292*^9, 
   3.738575152622115*^9}, {3.738575243762333*^9, 3.738575255080852*^9}, {
   3.738575349069961*^9, 3.7385753491094913`*^9}, {3.738575512237668*^9, 
   3.7385755164771*^9}, {3.7385755586355867`*^9, 3.738575562660537*^9}, {
   3.7385758488788233`*^9, 3.738575859155369*^9}, {3.7385784977770243`*^9, 
   3.738578497839757*^9}, {3.738578532534913*^9, 3.738578532566201*^9}, {
   3.738578700358655*^9, 3.738578701294159*^9}, {3.738579695988769*^9, 
   3.7385796960523987`*^9}, {3.738580128035348*^9, 3.738580133106153*^9}, {
   3.7385801832252493`*^9, 3.738580212526276*^9}, {3.738581240035891*^9, 
   3.7385812400973387`*^9}, {3.738581415034849*^9, 3.738581423752041*^9}, 
   3.7385884671138277`*^9, {3.738590511302026*^9, 3.73859051172429*^9}, 
   3.738590556843566*^9, {3.7385914603869762`*^9, 3.738591460866358*^9}, {
   3.738641855484414*^9, 3.7386418557293673`*^9}, {3.7389333694593277`*^9, 
   3.73893336954596*^9}, {3.738933411481882*^9, 3.7389334147995234`*^9}, {
   3.738934368721176*^9, 3.738934385772588*^9}, {3.73893524315198*^9, 
   3.738935243254648*^9}, {3.7401988610234947`*^9, 3.7401988688233633`*^9}, {
   3.7401992248970747`*^9, 3.740199243095538*^9}, {3.7402070681052437`*^9, 
   3.740207068150095*^9}, {3.740207125310916*^9, 3.740207125870207*^9}, {
   3.740219671397649*^9, 3.740219686068626*^9}, {3.740221852715575*^9, 
   3.740221852786862*^9}, {3.740292975895082*^9, 3.740292982942132*^9}, {
   3.740293059282669*^9, 3.740293059338771*^9}, {3.740308714788521*^9, 
   3.74030871706982*^9}, {3.740309002910595*^9, 3.740309005869678*^9}, 
   3.740309518076578*^9, 3.7403104014958344`*^9, {3.7403104861384563`*^9, 
   3.740310502049076*^9}, {3.740311503662157*^9, 3.740311524925953*^9}, {
   3.7403121164248447`*^9, 3.740312116982378*^9}, 3.7403299005143223`*^9, {
   3.7403333499146166`*^9, 3.7403333506616592`*^9}, 3.74033699774126*^9, {
   3.74033705683864*^9, 3.740337086610343*^9}, {3.740337256001032*^9, 
   3.7403372560470343`*^9}, 3.740338860730817*^9, {3.740339210432819*^9, 
   3.7403392151770897`*^9}, 3.740339336264016*^9, 3.740339380150526*^9, 
   3.7403403293248158`*^9, 3.7403404103894525`*^9, 3.7403738753614264`*^9, 
   3.7403740989030247`*^9, 3.740374181115033*^9, {3.740374524889247*^9, 
   3.7403745274409246`*^9}, {3.740384336691969*^9, 3.7403843445818357`*^9}, {
   3.7403849662956467`*^9, 3.740384967350648*^9}, {3.740385010781375*^9, 
   3.740385010836364*^9}, {3.740385146934599*^9, 3.740385147045621*^9}, {
   3.740386829531695*^9, 3.740386829641467*^9}, {3.7403905192967052`*^9, 
   3.740390521486972*^9}, {3.7403909385710897`*^9, 3.740390938617783*^9}, {
   3.740392058195281*^9, 3.740392058297323*^9}, {3.740392722225679*^9, 
   3.7403927582311897`*^9}, {3.740392839563715*^9, 3.740392839698667*^9}, {
   3.740458433440836*^9, 3.740458433527856*^9}, {3.740460922226788*^9, 
   3.740460922337441*^9}, {3.740460960920541*^9, 3.740460961023459*^9}, {
   3.740461101689467*^9, 3.7404611023282747`*^9}, {3.740472181263006*^9, 
   3.740472181725566*^9}, {3.74047233296546*^9, 3.740472333567519*^9}, {
   3.740472443223022*^9, 3.740472449542514*^9}, {3.740472530033896*^9, 
   3.740472538706599*^9}, {3.7404767762141647`*^9, 3.740476778548807*^9}, {
   3.7404770123623857`*^9, 3.74047701242161*^9}, {3.740485983024932*^9, 
   3.74048598311804*^9}, {3.740486282472248*^9, 3.7404862825748587`*^9}, 
   3.740486878516363*^9, 3.740486917328939*^9, 3.740486985349725*^9, {
   3.7404877684233217`*^9, 3.740487786725456*^9}, {3.740491091763782*^9, 
   3.740491123265812*^9}, {3.7404911580641327`*^9, 3.740491158110881*^9}, {
   3.740491218061145*^9, 3.740491218116973*^9}, 3.7404915266383953`*^9, 
   3.740492739192333*^9, {3.740494159227776*^9, 3.7404941619760733`*^9}, 
   3.740494334033304*^9, 3.7404944621466637`*^9, 3.740494948459724*^9, 
   3.7404951516723757`*^9, {3.740497433696289*^9, 3.7404974422955*^9}, 
   3.74049748148528*^9, 3.740497587400281*^9, {3.740497706810161*^9, 
   3.74049770800068*^9}, {3.740574137663707*^9, 3.7405741444112997`*^9}, 
   3.740574178241487*^9, 3.740635035321291*^9, {3.7406354932417593`*^9, 
   3.740635493288329*^9}, 3.740638185700202*^9, {3.740639946948242*^9, 
   3.740639947058135*^9}, 3.740640026775754*^9, {3.740640113556769*^9, 
   3.740640113626382*^9}, 3.740640233797922*^9, 3.740640287835145*^9, {
   3.740640488410193*^9, 3.740640488960527*^9}, {3.740640665912291*^9, 
   3.740640666558778*^9}, 3.7406407845309467`*^9, {3.74064082929629*^9, 
   3.7406408525226316`*^9}, 3.740640889253675*^9, 3.740640935502719*^9, 
   3.740641023616914*^9, {3.7406417480989237`*^9, 3.740641749745139*^9}, 
   3.740641841177815*^9, {3.740642330686594*^9, 3.7406423373027*^9}, {
   3.740642406753251*^9, 3.740642432565411*^9}, {3.740642486093115*^9, 
   3.740642564655777*^9}, {3.740642604446837*^9, 3.7406426049337587`*^9}, 
   3.740642897847465*^9, 3.7406430386733522`*^9, {3.740643139708035*^9, 
   3.740643140113288*^9}, 3.7406431829292603`*^9, {3.7406433799349833`*^9, 
   3.740643380386326*^9}, 3.740643710655932*^9, {3.740643793674638*^9, 
   3.740643794272607*^9}, {3.74064514943439*^9, 3.740645149518373*^9}, {
   3.7406458887334337`*^9, 3.740645891065385*^9}, 3.7406468402833347`*^9, {
   3.740647513807365*^9, 3.74064751388492*^9}, 3.740647613114017*^9, {
   3.740648307076623*^9, 3.740648308366713*^9}, 3.7406487557266493`*^9, {
   3.740652551459551*^9, 3.740652572283136*^9}, 3.740652618735984*^9, {
   3.740658821040663*^9, 3.7406588256819572`*^9}, 3.740659515672008*^9, 
   3.740715272248034*^9, 3.740716653357399*^9, 3.7407173656309834`*^9, {
   3.740721232279829*^9, 3.740721273406143*^9}, {3.740724049623909*^9, 
   3.740724058935175*^9}, {3.740724880076262*^9, 3.740724880635909*^9}, 
   3.740725130608926*^9, 3.7407364871920357`*^9, {3.7407365436139507`*^9, 
   3.740736543669343*^9}, {3.740737159765951*^9, 3.74073716137358*^9}, {
   3.740738969294157*^9, 3.740738993146579*^9}, {3.7407390647858543`*^9, 
   3.7407390648355722`*^9}, {3.740740220677424*^9, 3.7407402207425337`*^9}, 
   3.740740338515524*^9, {3.740747629981555*^9, 3.7407476300761023`*^9}, 
   3.740747693425878*^9, 3.7407478194961*^9, 3.7407479263472223`*^9, {
   3.740748087980647*^9, 3.740748088058902*^9}, {3.740748585667184*^9, 
   3.740748594889655*^9}, {3.740748660551065*^9, 3.740748660630777*^9}, {
   3.740748735851398*^9, 3.7407487359949837`*^9}, 3.7407488857959757`*^9, {
   3.740749008870125*^9, 3.7407490274928827`*^9}, {3.740749241899077*^9, 
   3.740749259018107*^9}, {3.7407499217913837`*^9, 3.740749960268718*^9}, {
   3.740750100278956*^9, 3.7407501716390047`*^9}, {3.7407502143043013`*^9, 
   3.740750214359859*^9}, {3.740750594877228*^9, 3.740750606908331*^9}, {
   3.740750793163335*^9, 3.740750804402315*^9}, 3.741673293022571*^9, 
   3.742215501451941*^9, 3.7617093524253273`*^9, {3.761726172242008*^9, 
   3.761726173568011*^9}, {3.761739064877285*^9, 3.761739064924085*^9}, 
   3.7617397169034634`*^9, {3.7617398412552824`*^9, 3.7617398418480835`*^9}, {
   3.7617552513891068`*^9, 3.761755251435109*^9}, {3.761755416509551*^9, 
   3.761755417521609*^9}, {3.761774315291818*^9, 3.761774317120923*^9}, {
   3.7617745397866583`*^9, 3.7617745399086657`*^9}, {3.76182108920008*^9, 
   3.761821092018241*^9}, {3.7618326632461095`*^9, 3.7618327065919266`*^9}, 
   3.7618327568760695`*^9, {3.761832794752989*^9, 3.7618328117899632`*^9}, {
   3.7618331350944552`*^9, 3.7618331403617563`*^9}, {3.761834436441888*^9, 
   3.761834448028551*^9}},
 ExpressionUUID -> "3e852b33-5c33-46e5-bc78-cd6f7bab6f6c"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookSave", "[", "nb1", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookClose", "[", "nb1", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "contains", " ", "NCAlgebra", " ", "initialization", " ", "and", " ", 
     "MagnusM", " ", "and", " ", "MAgnusM2"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nb2", "=", 
     RowBox[{"NotebookOpen", "[", 
      RowBox[{"myDir", " ", "<>", " ", "\"\</scripts/Magnus_script1.nb\>\""}],
       "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"SelectionMove", "[", 
     RowBox[{"nb2", ",", "All", ",", "Notebook"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"SelectionEvaluate", "[", "nb2", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.685081151890257*^9, 3.6850811964694767`*^9}, {
   3.685275972411356*^9, 3.685275984563027*^9}, {3.685276822647539*^9, 
   3.6852768269825068`*^9}, {3.685450714481812*^9, 3.68545071795362*^9}, {
   3.686278936153943*^9, 3.686278936426072*^9}, 3.6882953536455317`*^9, {
   3.6883845937331953`*^9, 3.688384594005246*^9}, {3.688468933843193*^9, 
   3.688468951146367*^9}, {3.688471011559143*^9, 3.6884710131987743`*^9}, 
   3.688471164823751*^9, {3.6884733401520157`*^9, 3.688473341472767*^9}, {
   3.6884735005198107`*^9, 3.688473501679611*^9}, {3.688473546397324*^9, 
   3.6884735507011003`*^9}, {3.688473616687544*^9, 3.688473635080621*^9}, {
   3.6884736835982943`*^9, 3.6884736871260347`*^9}, {3.688474079697554*^9, 
   3.6884741013682947`*^9}, 3.688474216218045*^9, {3.688474974194021*^9, 
   3.688475018471794*^9}, {3.688475071221035*^9, 3.6884751101876287`*^9}, 
   3.6884780231903477`*^9, {3.688478144204636*^9, 3.688478147138968*^9}, {
   3.688478187930819*^9, 3.6884781962411947`*^9}, {3.688478286796315*^9, 
   3.6884782868604307`*^9}, {3.688478375353519*^9, 3.688478376535694*^9}, 
   3.688478412062446*^9, 3.688478451760972*^9, 3.6884784834916887`*^9, {
   3.688478665778397*^9, 3.688478693383504*^9}, {3.688478919138769*^9, 
   3.688478960248755*^9}, {3.688479079291738*^9, 3.688479102345035*^9}, {
   3.708228244573203*^9, 3.70822826061077*^9}, {3.713190842568857*^9, 
   3.7131908464242754`*^9}, {3.7132437338557987`*^9, 3.713243755294389*^9}, {
   3.7403320673632584`*^9, 3.7403320687963405`*^9}, 3.7403322219771023`*^9, 
   3.7403322744251018`*^9, {3.740641498343997*^9, 3.740641617008659*^9}, {
   3.7406416519829903`*^9, 3.7406416683500977`*^9}, 3.7406417255656*^9, 
   3.74064512142348*^9, {3.740652550477673*^9, 3.740652590239407*^9}, {
   3.740652642277026*^9, 3.740652647116197*^9}},
 ExpressionUUID -> "5d09364e-3d5d-40ff-9167-a0fe715cd7fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "INPUT", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"coefficients", "=", 
     RowBox[{
     "\"\<simple\>\"", " ", "\[IndentingNewLine]", "in", " ", "case", " ", 
      "there", " ", "are", " ", "at", " ", "most", " ", "two", " ", 
      "coefficients"}]}], ",", " ", 
    RowBox[{
    "which", " ", "we", " ", "call", " ", "H1", " ", "and", " ", "H2"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"coefficients", "=", "\"\<simple\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coefficients", "=", "\"\<NotSoSimple\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"coefficients", "\[Equal]", "\"\<simple\>\""}], ",", 
      "\[IndentingNewLine]", "updateCoeffsSimple", ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "otherwise", " ", "determine", " ", "the", " ", "coefficients", " ", 
        "laboriously"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"updateCoeffs", ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "myCList"}]}]], "Input",
 CellChangeTimes->{{3.7406429814784193`*^9, 3.740642984645341*^9}, {
  3.740652582010498*^9, 3.7406525871291018`*^9}, {3.7406591170593443`*^9, 
  3.7406591210958853`*^9}, {3.740659199198168*^9, 3.7406592005792627`*^9}},
 ExpressionUUID -> "ced70536-88f4-4ea4-9f46-8a80b9f13171"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "H1", "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      SuperscriptBox["H1", "2"], "}"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      SuperscriptBox["H1", "3"], "}"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      SuperscriptBox["H1", "4"], "}"}], ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7406592011673717`*^9, 3.740659246014126*^9, 3.740659522952222*^9, {
   3.7407153071943703`*^9, 3.740715332735564*^9}, 3.740716658670932*^9, 
   3.7407167998411837`*^9, 3.740717312017552*^9, 3.7407173741694193`*^9, 
   3.74072119570942*^9, 3.740721278626651*^9, 3.740724070840911*^9, 
   3.7407248201765537`*^9, {3.740724884370697*^9, 3.740724892744693*^9}, 
   3.740725146935555*^9, 3.740736115091712*^9, 3.740736496053054*^9, {
   3.740736587789515*^9, 3.7407365924775753`*^9}, 3.740737169357251*^9, 
   3.740738878478427*^9, {3.740738985855246*^9, 3.740738997813861*^9}, 
   3.740739071572158*^9, 3.740739935621172*^9, 3.740740227811376*^9, 
   3.740741352109593*^9, 3.7407414111618023`*^9, {3.740741497379506*^9, 
   3.7407415038439493`*^9}, 3.740742657622654*^9, 3.7407429891549892`*^9, 
   3.7407458440466833`*^9, 3.7407458999288273`*^9, 3.7407464599580173`*^9, 
   3.740747047494331*^9, 3.7407475439648247`*^9, 3.740747602487585*^9, 
   3.740747741311721*^9, 3.7407478006468287`*^9, 3.7407478375702467`*^9, 
   3.740747878386138*^9, 3.740747936732877*^9, 3.7407479791139917`*^9, 
   3.740748094694908*^9, {3.740748602749382*^9, 3.740748631545158*^9}, 
   3.740748743085099*^9, 3.740748780786615*^9, 3.7407489060709543`*^9, {
   3.7407489472942257`*^9, 3.740748960956913*^9}, 3.740749031992361*^9, 
   3.74074919347042*^9, {3.740749245547616*^9, 3.740749264142542*^9}, {
   3.740749904318242*^9, 3.740749964400126*^9}, {3.7407501140313807`*^9, 
   3.740750129710478*^9}, 3.740750181588067*^9, 3.7407502189418497`*^9, 
   3.740750299594125*^9, {3.740750573617955*^9, 3.7407506102824574`*^9}, 
   3.74075068021546*^9, {3.740750779230105*^9, 3.740750807706992*^9}, 
   3.740750875114811*^9, 3.7407509478053093`*^9, 3.740750993111856*^9, 
   3.740751328654777*^9, {3.740751364809951*^9, 3.740751377586933*^9}, 
   3.74075184354792*^9, 3.740751902137144*^9, 3.740752058038583*^9, 
   3.740752183911236*^9, 3.740753391590843*^9, 3.7407537552395897`*^9, 
   3.7407538488702173`*^9, {3.740754434639853*^9, 3.7407544406908407`*^9}, {
   3.740754598846939*^9, 3.740754625429432*^9}, 3.7422161695878773`*^9, 
   3.752558008676776*^9, 3.7616219845096283`*^9, 3.7616300164152107`*^9, 
   3.7616405714699993`*^9, 3.761709358556138*^9, 3.761711890145008*^9, {
   3.7617261618055897`*^9, 3.7617261800108223`*^9}, 3.7617375572345557`*^9, 
   3.7617390787457094`*^9, 3.7617393582214303`*^9, 3.761739514472508*^9, 
   3.7617396167170877`*^9, {3.76173980588802*^9, 3.761739820115245*^9}, 
   3.7617398584777126`*^9, 3.7617550666055374`*^9, 3.7617552037223797`*^9, 
   3.761755260879649*^9, 3.7617555510922484`*^9, 3.76177392789166*^9, 
   3.7617743246723547`*^9, 3.761774554741514*^9, 3.761783958742503*^9, 
   3.7618039021227355`*^9, 3.7618042300113277`*^9, 3.761820820411706*^9, 
   3.7618328196674137`*^9, 3.7618342998020725`*^9, 3.7618344556749883`*^9},
 ExpressionUUID -> "0c125149-83c2-4730-9ead-c9a24b6e679e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NotebookSave", "[", "nb2", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookClose", "[", "nb2", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.688478940385738*^9, 3.688478971687812*^9}, {
   3.688479051036357*^9, 3.6884790624268093`*^9}, {3.713243742782855*^9, 
   3.713243745574942*^9}, 3.7134643479667177`*^9, {3.7406526550999537`*^9, 
   3.740652656932131*^9}},
 ExpressionUUID -> "979da102-f84f-420e-bffe-4224c634faf9"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.74047754301464*^9},
 ExpressionUUID -> "01c6a39b-8681-4d07-a3ce-03153f81afe3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"verbose", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"verboseLight", "=", "True"}], ";"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.761622906897386*^9, 3.7616229159519043`*^9}, {
  3.7617375640829678`*^9, 3.7617375645197687`*^9}, {3.7617396324263153`*^9, 
  3.7617396328943157`*^9}, {3.7617550778311796`*^9, 3.7617550817174015`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"verbose", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"verboseLight", "=", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.761622906897386*^9, 3.7616229159519043`*^9}, {
  3.7617375640829678`*^9, 3.7617375645197687`*^9}, {3.7617396324263153`*^9, 
  3.7617396328943157`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"$RecursionLimit", "=", "5000"}], "*)"}]], "Input",
 CellChangeTimes->{{3.74048911586637*^9, 3.740489128266183*^9}, {
   3.740490183439399*^9, 3.740490193705366*^9}, 3.740491661061801*^9, {
   3.7404918562279053`*^9, 3.740491856269991*^9}, {3.740492753662826*^9, 
   3.7404927597185097`*^9}, {3.740492844130252*^9, 3.740492844297307*^9}, {
   3.7404929830034847`*^9, 3.740492984066615*^9}, {3.740494318825605*^9, 
   3.740494321367799*^9}, 3.74064869107697*^9},
 ExpressionUUID -> "2c66e7b0-248b-4b40-89a4-801d97843ca2"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.740740242893029*^9},
 ExpressionUUID -> "8375cb07-c38d-44be-880e-f831650195b8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"HEff", "[", "t_", "]"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"256", " ", 
        SuperscriptBox["ww", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "8"}], " ", "Delta", " ", 
         SuperscriptBox["H1", "2"], " ", "sz"}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["H1", "2"], " ", "sz", " ", "ww"}], "+", 
        RowBox[{"128", " ", "Delta", " ", "sz", " ", 
         SuperscriptBox["ww", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["H1", "3"], " ", "sx", " ", 
         RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
        RowBox[{"64", " ", "H1", " ", "sx", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
        RowBox[{"16", " ", 
         SuperscriptBox["Delta", "2"], " ", "H1", " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"16", " ", "H1DD", " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"32", " ", "Delta", " ", "H1", " ", "sx", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"32", " ", "H1D", " ", "sy", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"8", " ", "Delta", " ", 
         SuperscriptBox["H1", "2"], " ", "sz", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"2", " ", "phi"}], "+", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"16", " ", 
         SuperscriptBox["H1", "2"], " ", "sz", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"2", " ", "phi"}], "+", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["H1", "3"], " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["H1", "3"], " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["H1", "3"], " ", "sy", " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"64", " ", "H1", " ", "sy", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
        RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"16", " ", 
         SuperscriptBox["Delta", "2"], " ", "H1", " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"16", " ", "H1DD", " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"32", " ", "H1D", " ", "sx", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"32", " ", "Delta", " ", "H1", " ", "sy", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"24", " ", "H1", " ", "H1D", " ", "sz", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"2", " ", "phi"}], "+", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["H1", "3"], " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["H1", "3"], " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}]}], ")"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"phi", "\[Rule]", "0"}], ",", 
       RowBox[{"Delta", "\[Rule]", "0"}]}], "}"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7617558288251343`*^9, 3.76175584903629*^9}, 
   3.761832836103354*^9}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.761755816552432*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"effectiveHamiltonianTest", "=", 
  RowBox[{"effHTest", "[", 
   RowBox[{"H", "[", "t", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<\\n\\n\\n Test result = \>\"", ",", "effectiveHamiltonianTest"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7617741804501057`*^9, 3.7617741936518607`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n Compute eff. Hamiltonian @\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "2019", ",", "3", ",", "17", ",", "22", ",", "1", ",", 
      "5.0005215`8.451590274410716"}], "}"}], "[", 
    RowBox[{"1", ";;", "5"}], "]"}]}],
  SequenceForm["\n Compute eff. Hamiltonian @", 
   {2019, 3, 17, 22, 1, 5.0005215`8.451590274410716}[
    Span[1, 5]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618344650195227`*^9}],

Cell[BoxData["\<\"verboseLight = False\"\>"], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618344650215225`*^9}],

Cell[BoxData["\<\"verbose = False\"\>"], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834465024523*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting .. Main Magnus with max = \"\>", "\[InvisibleSpace]", 
   "3"}],
  SequenceForm["Starting .. Main Magnus with max = ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834465026523*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" We use HH = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "4"], " ", "H1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sx", " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
      RowBox[{"sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "-", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}]}], ")"}]}]}],
  SequenceForm[
  " We use HH = ", 
   Rational[1, 4] $CellContext`H1 ($CellContext`sx 
     Cos[$CellContext`phi] + $CellContext`sx 
     Cos[$CellContext`phi + 
       2 $CellContext`t $CellContext`ww] - $CellContext`sy 
    Sin[$CellContext`phi] - $CellContext`sy 
    Sin[$CellContext`phi + 2 $CellContext`t $CellContext`ww])],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834465029523*^9}],

Cell[BoxData["\<\"\\n\\n[effHTest]  testing MDynamic.\\n\\n\"\>"], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834465032523*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n [+++] About to start for-loop in MDynamic[HH,max] @ \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\\n\"\>"}],
  SequenceForm[
  "\n\n\n [+++] About to start for-loop in MDynamic[HH,max] @ ", {2019, 3, 17,
    22, 1}, "\n\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618344650355234`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 1, " @ ", {2019, 3, 17, 22, 1},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618344650385237`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "1", ",", 
     "5.0025217`8.45176395672257"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 1, 
   ", at date and time ", {2019, 3, 17, 22, 1, 5.0025217`8.45176395672257}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618344650425243`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 2, " @ ", {2019, 3, 17, 22, 1},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618344663435984`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "1", ",", 
     "6.3425983`8.554842179601707"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 2, 
   ", at date and time ", {2019, 3, 17, 22, 1, 6.3425983`8.554842179601707}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618344663475986`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "3", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "1"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 3, " @ ", {2019, 3, 17, 22, 1},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834471299882*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "1", ",", 
     "11.2988818`8.805610424576908"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 3, 
   ", at date and time ", {2019, 3, 17, 22, 1, 11.2988818`8.805610424576908}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618344713038816`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "3", ",", 
     "9.5846474`8.734151105295124"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 4, 
   ", at date and time ", {2019, 3, 17, 22, 3, 9.5846474`8.734151105295124}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618345895896473`*^9}],

Cell[BoxData["\<\"Computing Main Magnus finished.\"\>"], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639492502*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"HRWA = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     FractionBox["1", "4"], " ", "H1", " ", "sx", " ", 
     RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "4"], " ", "H1", " ", "sy", " ", 
     RowBox[{"Sin", "[", "phi", "]"}]}]}]}],
  SequenceForm[
  "HRWA = ", 
   Rational[1, 4] $CellContext`H1 $CellContext`sx Cos[$CellContext`phi] + 
   Rational[-1, 4] $CellContext`H1 $CellContext`sy Sin[$CellContext`phi]],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639495502*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n Running recursive procedure (iii = \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["\n Running recursive procedure (iii = ", 1, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346394985027`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n [+++] About to start for-loop in MDynamic[HH,max] @ \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\\n\"\>"}],
  SequenceForm[
  "\n\n\n [+++] About to start for-loop in MDynamic[HH,max] @ ", {2019, 3, 17,
    22, 3}, "\n\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346395015025`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 1, " @ ", {2019, 3, 17, 22, 3},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346395035024`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "3", ",", 
     "59.494502`9.527051661840124"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 1, 
   ", at date and time ", {2019, 3, 17, 22, 3, 59.494502`9.527051661840124}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639506503*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "3", ",", 
     "59.5055027`9.527131956682677"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 2, 
   ", at date and time ", {2019, 3, 17, 22, 3, 59.5055027`9.527131956682677}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639509503*^9}],

Cell[BoxData["\<\"finished computing HeffSub (the terms that are to be \
subtracted)\"\>"], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346396975136`*^9}],

Cell[BoxData["\<\"finished computing next level of Heff\"\>"], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639699514*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n Running recursive procedure (iii = \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["\n Running recursive procedure (iii = ", 2, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346397025137`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n [+++] About to start for-loop in MDynamic[HH,max] @ \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\\n\"\>"}],
  SequenceForm[
  "\n\n\n [+++] About to start for-loop in MDynamic[HH,max] @ ", {2019, 3, 17,
    22, 3}, "\n\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639704514*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 1, " @ ", {2019, 3, 17, 22, 3},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346397075143`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "3", ",", 
     "59.6775125`9.52838554065545"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 1, 
   ", at date and time ", {2019, 3, 17, 22, 3, 59.6775125`9.52838554065545}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346397095146`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 2, " @ ", {2019, 3, 17, 22, 3},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346397125144`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "3", ",", 
     "59.7055141`9.528589270464183"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 2, 
   ", at date and time ", {2019, 3, 17, 22, 3, 59.7055141`9.528589270464183}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346397205153`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "3", ",", 
     "59.7445163`9.528872877605801"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 3, 
   ", at date and time ", {2019, 3, 17, 22, 3, 59.7445163`9.528872877605801}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639750517*^9}],

Cell[BoxData["\<\"finished computing HeffSub (the terms that are to be \
subtracted)\"\>"], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639844522*^9}],

Cell[BoxData["\<\"finished computing next level of Heff\"\>"], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346398465223`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n Running recursive procedure (iii = \"\>", 
   "\[InvisibleSpace]", "3", "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["\n Running recursive procedure (iii = ", 3, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346398505225`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n [+++] About to start for-loop in MDynamic[HH,max] @ \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\\n\"\>"}],
  SequenceForm[
  "\n\n\n [+++] About to start for-loop in MDynamic[HH,max] @ ", {2019, 3, 17,
    22, 3}, "\n\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346398525224`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 1, " @ ", {2019, 3, 17, 22, 3},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639855523*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "3", ",", 
     "59.8465222`9.529613745998459"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 1, 
   ", at date and time ", {2019, 3, 17, 22, 3, 59.8465222`9.529613745998459}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639857523*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 2, " @ ", {2019, 3, 17, 22, 3},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639886524*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "3", ",", 
     "59.8845243`9.529889432269773"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 2, 
   ", at date and time ", {2019, 3, 17, 22, 3, 59.8845243`9.529889432269773}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639890525*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "3", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 3, " @ ", {2019, 3, 17, 22, 3},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639929527*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "3", ",", 
     "59.9295269`9.530215677506865"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 3, 
   ", at date and time ", {2019, 3, 17, 22, 3, 59.9295269`9.530215677506865}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639933527*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "22", ",", "3", ",", 
     "59.966529`9.530483739842001"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 4, 
   ", at date and time ", {2019, 3, 17, 22, 3, 59.966529`9.530483739842001}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834639968529*^9}],

Cell[BoxData["\<\"finished computing HeffSub (the terms that are to be \
subtracted)\"\>"], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834640402554*^9}],

Cell[BoxData["\<\"finished computing next level of Heff\"\>"], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834640405554*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Finished @ \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "22", ",", "4"}], "}"}]}],
  SequenceForm["Finished @ ", {2019, 3, 17, 22, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.7618346404075546`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2048", " ", 
    SuperscriptBox["ww", "3"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["H1", "4"], " ", "sz"}], "+", 
    RowBox[{"64", " ", 
     SuperscriptBox["H1", "2"], " ", "sz", " ", 
     SuperscriptBox["ww", "2"]}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["H1", "3"], " ", "sx", " ", "ww", " ", 
     RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
    RowBox[{"512", " ", "H1", " ", "sx", " ", 
     SuperscriptBox["ww", "3"], " ", 
     RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
    RowBox[{"16", " ", 
     SuperscriptBox["H1", "3"], " ", "sx", " ", "ww", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "-", "\[Beta]0"}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "4"], " ", "sz", " ", 
     RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{"128", " ", 
     SuperscriptBox["H1", "2"], " ", "sz", " ", 
     SuperscriptBox["ww", "2"], " ", 
     RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["H1", "4"], " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "-", 
    RowBox[{"8", " ", 
     SuperscriptBox["H1", "3"], " ", "sx", " ", "ww", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "+", 
    RowBox[{"16", " ", 
     SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
     RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
    RowBox[{"512", " ", "H1", " ", "sy", " ", 
     SuperscriptBox["ww", "3"], " ", 
     RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "-", "\[Beta]0"}], "]"}]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.7617745941227665`*^9, 3.7617839959661684`*^9, 
  3.7618042602853813`*^9, 3.7618209009993153`*^9, 3.761834324915509*^9, 
  3.761834640435556*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n Test result = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2048", " ", 
      SuperscriptBox["ww", "3"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["H1", "4"], " ", "sz"}], "+", 
      RowBox[{"64", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", 
       SuperscriptBox["ww", "2"]}], "-", 
      RowBox[{"16", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", "ww", " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
      RowBox[{"512", " ", "H1", " ", "sx", " ", 
       SuperscriptBox["ww", "3"], " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
      RowBox[{"16", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Beta]0"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "4"], " ", "sz", " ", 
       RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
      RowBox[{"128", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "4"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "+", 
      RowBox[{"16", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
      RowBox[{"512", " ", "H1", " ", "sy", " ", 
       SuperscriptBox["ww", "3"], " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
      RowBox[{"16", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Beta]0"}], "]"}]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}]}], ")"}]}]}],
  SequenceForm[
  "\n\n\n Test result = ", 
   Rational[1, 2048] $CellContext`ww^(-3) ($CellContext`H1^4 $CellContext`sz + 
    64 $CellContext`H1^2 $CellContext`sz $CellContext`ww^2 - 
    16 $CellContext`H1^3 $CellContext`sx $CellContext`ww 
    Cos[$CellContext`phi] + 
    512 $CellContext`H1 $CellContext`sx $CellContext`ww^3 
     Cos[$CellContext`phi] + 
    16 $CellContext`H1^3 $CellContext`sx $CellContext`ww 
     Cos[$CellContext`phi - $CellContext`\[Beta]0] - 
    2 $CellContext`H1^4 $CellContext`sz Cos[$CellContext`\[Beta]0] - 
    128 $CellContext`H1^2 $CellContext`sz $CellContext`ww^2 
    Cos[$CellContext`\[Beta]0] - 3 $CellContext`H1^4 $CellContext`sz 
    Cos[2 $CellContext`\[Beta]0] - 
    8 $CellContext`H1^3 $CellContext`sx $CellContext`ww 
    Cos[$CellContext`phi + 2 $CellContext`\[Beta]0] + 
    16 $CellContext`H1^3 $CellContext`sy $CellContext`ww 
     Sin[$CellContext`phi] - 
    512 $CellContext`H1 $CellContext`sy $CellContext`ww^3 
    Sin[$CellContext`phi] - 
    16 $CellContext`H1^3 $CellContext`sy $CellContext`ww 
    Sin[$CellContext`phi - $CellContext`\[Beta]0] + 
    8 $CellContext`H1^3 $CellContext`sy $CellContext`ww 
     Sin[$CellContext`phi + 2 $CellContext`\[Beta]0])],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774569304347*^9, 3.7617839735001287`*^9, 
  3.761804237717741*^9, 3.761820877962998*^9, 3.7618343080885468`*^9, 
  3.761834640439556*^9}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.761834711883642*^9}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.761834725772437*^9}],

Cell[BoxData[
 RowBox[{"\[InvisibleSpace]", 
  RowBox[{
   RowBox[{"myRes", "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2048", " ", 
       SuperscriptBox["ww", "3"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["H1", "4"], " ", "sz"}], "+", 
       RowBox[{"64", " ", 
        SuperscriptBox["H1", "2"], " ", "sz", " ", 
        SuperscriptBox["ww", "2"]}], "-", 
       RowBox[{"16", " ", 
        SuperscriptBox["H1", "3"], " ", "sx", " ", "ww", " ", 
        RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
       RowBox[{"512", " ", "H1", " ", "sx", " ", 
        SuperscriptBox["ww", "3"], " ", 
        RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
       RowBox[{"16", " ", 
        SuperscriptBox["H1", "3"], " ", "sx", " ", "ww", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"phi", "-", "\[Beta]0"}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["H1", "4"], " ", "sz", " ", 
        RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
       RowBox[{"128", " ", 
        SuperscriptBox["H1", "2"], " ", "sz", " ", 
        SuperscriptBox["ww", "2"], " ", 
        RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["H1", "4"], " ", "sz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "-", 
       RowBox[{"8", " ", 
        SuperscriptBox["H1", "3"], " ", "sx", " ", "ww", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"phi", "+", 
          RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "+", 
       RowBox[{"16", " ", 
        SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
        RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
       RowBox[{"512", " ", "H1", " ", "sy", " ", 
        SuperscriptBox["ww", "3"], " ", 
        RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
       RowBox[{"16", " ", 
        SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"phi", "-", "\[Beta]0"}], "]"}]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["H1", "3"], " ", "sy", " ", "ww", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"phi", "+", 
          RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}]}], ")"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.7618347297406635`*^9, 3.7618347346319437`*^9}, {
  3.7618347685058813`*^9, 3.761834769337929*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "Coefficient"}]], "Input",
 CellChangeTimes->{{3.7618347955394273`*^9, 3.7618347974005337`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox["\<\"\\!\\(\\*RowBox[{\\\"Coefficient\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"form\\\", \
\\\"TI\\\"]}], \\\"]\\\"}]\\) gives the coefficient of \
\\!\\(\\*StyleBox[\\\"form\\\", \\\"TI\\\"]\\) in the polynomial \
\\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\). \
\\n\\!\\(\\*RowBox[{\\\"Coefficient\\\", \\\"[\\\", RowBox[{StyleBox[\\\"expr\
\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"form\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"n\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) gives the coefficient of \
\\!\\(\\*RowBox[{StyleBox[\\\"form\\\", \\\"TI\\\"], \\\"^\\\", \
StyleBox[\\\"n\\\", \\\"TI\\\"]}]\\) in \\!\\(\\*StyleBox[\\\"expr\\\", \
\\\"TI\\\"]\\). \"\>", "MSG"], "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:ref/Coefficient"]}]], "Print", "PrintUsage",
 CellChangeTimes->{3.7618347979505653`*^9},
 CellTags->"Info3761849197-3507274"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox["1", 
    SuperscriptBox["ww", "3"]], 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"myRes", "//", "Expand"}], ",", 
     FractionBox["sx", 
      SuperscriptBox["ww", "2"]]}], "]"}]}], "//", 
  "FS"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   FractionBox["1", 
    SuperscriptBox["ww", "3"]], 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"myRes", "//", "Expand"}], ",", 
     FractionBox["sy", 
      SuperscriptBox["ww", "2"]]}], "]"}]}], "//", "FS"}]}], "Input",
 CellChangeTimes->{{3.761834760857444*^9, 3.7618348289833403`*^9}, {
  3.7618348595490885`*^9, 3.7618348604941425`*^9}, {3.761834983974205*^9, 
  3.7618350581904497`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Beta]0"}], "]"}]}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], ")"}]}], 
   RowBox[{"256", " ", 
    SuperscriptBox["ww", "3"]}]]}]], "Output",
 CellChangeTimes->{{3.761834791479195*^9, 3.761834829751384*^9}, 
   3.761834861046174*^9, {3.761835013874915*^9, 3.7618350272506804`*^9}, 
   3.7618350586624775`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["H1", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Beta]0"}], "]"}]}], "+", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], ")"}]}], 
  RowBox[{"256", " ", 
   SuperscriptBox["ww", "3"]}]]], "Output",
 CellChangeTimes->{{3.761834791479195*^9, 3.761834829751384*^9}, 
   3.761834861046174*^9, {3.761835013874915*^9, 3.7618350272506804`*^9}, 
   3.7618350588074856`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["ww", "3"]], 
    RowBox[{"Coefficient", "[", 
     RowBox[{"myRes", ",", "ww", ",", 
      RowBox[{"-", "3"}]}], "]"}]}], "//", "TrigExpand"}], "//", 
  "S"}]], "Input",
 CellChangeTimes->{{3.761834760857444*^9, 3.7618348289833403`*^9}, {
  3.7618348595490885`*^9, 3.761834886708642*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1", "4"], " ", "sz", " ", 
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      FractionBox["\[Beta]0", "2"], "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"Cos", "[", "\[Beta]0", "]"}]}]}], ")"}]}], 
   RowBox[{"512", " ", 
    SuperscriptBox["ww", "3"]}]]}]], "Output",
 CellChangeTimes->{{3.761834876868079*^9, 3.7618348868566504`*^9}}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.761804070030434*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7618343174210806`*^9, 3.76183431758809*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HEffReal", "=", 
   RowBox[{"effH", "[", 
    RowBox[{"H", "[", "t", "]"}], "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7617741804501057`*^9, 3.7617741936518607`*^9}, {
  3.761834491430033*^9, 3.7618345155494127`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n Compute eff. Hamiltonian @\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "2019", ",", "3", ",", "17", ",", "5", ",", "18", ",", 
      "54.6879276`9.490466307962619"}], "}"}], "[", 
    RowBox[{"1", ";;", "5"}], "]"}]}],
  SequenceForm["\n Compute eff. Hamiltonian @", 
   {2019, 3, 17, 5, 18, 54.6879276`9.490466307962619}[
    Span[1, 5]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617743347069287`*^9}],

Cell[BoxData["\<\"verboseLight = False\"\>"], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774334708929*^9}],

Cell[BoxData["\<\"verbose = False\"\>"], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774334712929*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting .. Main Magnus with max = \"\>", "\[InvisibleSpace]", 
   "2"}],
  SequenceForm["Starting .. Main Magnus with max = ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774334715929*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" We use HH = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "4"], " ", "H1", " ", 
    RowBox[{"(", 
     RowBox[{"sx", "+", 
      RowBox[{"sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}]}], ")"}]}]}],
  SequenceForm[
  " We use HH = ", 
   Rational[1, 4] $CellContext`H1 ($CellContext`sx + $CellContext`sx 
     Cos[2 $CellContext`t $CellContext`ww] - $CellContext`sy 
    Sin[2 $CellContext`t $CellContext`ww])],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617743347199297`*^9}],

Cell[BoxData["\<\"\\n\\n[effHTest]  testing MDynamic.\\n\\n\"\>"], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617743347239294`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n [+++] About to start for-loop in MDynamic[HH,max] @ \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "5", ",", "18"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\\n\"\>"}],
  SequenceForm[
  "\n\n\n [+++] About to start for-loop in MDynamic[HH,max] @ ", {2019, 3, 17,
    5, 18}, "\n\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774334761932*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "5", ",", "18"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 1, " @ ", {2019, 3, 17, 5, 18},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774334765932*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "5", ",", "18", ",", 
     "54.7349303`9.490839411259167"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 1, 
   ", at date and time ", {2019, 3, 17, 5, 18, 54.7349303`9.490839411259167}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617743347719326`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "5", ",", "19"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 2, " @ ", {2019, 3, 17, 5, 19},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774353705015*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "5", ",", "19", ",", 
     "13.7040153`8.889422788532684"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 2, 
   ", at date and time ", {2019, 3, 17, 5, 19, 13.7040153`8.889422788532684}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617743537100153`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "5", ",", "20", ",", 
     "8.0331227`8.657459367880358"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 3, 
   ", at date and time ", {2019, 3, 17, 5, 20, 8.0331227`8.657459367880358}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774408036123*^9}],

Cell[BoxData["\<\"Computing Main Magnus finished.\"\>"], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744612801685`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"HRWA = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox[
     RowBox[{"H1", " ", "sx"}], "4"], "-", 
    FractionBox[
     RowBox[{"H1D", " ", "sx", " ", "td"}], "4"], "+", 
    RowBox[{
     FractionBox["1", "8"], " ", "H1DD", " ", "sx", " ", 
     SuperscriptBox["td", "2"]}]}]}],
  SequenceForm[
  "HRWA = ", Rational[1, 4] $CellContext`H1 $CellContext`sx + 
   Rational[-1, 4] $CellContext`H1D $CellContext`sx $CellContext`td + 
   Rational[1, 8] $CellContext`H1DD $CellContext`sx $CellContext`td^2],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744612861686`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n Running recursive procedure (iii = \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["\n Running recursive procedure (iii = ", 1, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744612911687`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n [+++] About to start for-loop in MDynamic[HH,max] @ \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "5", ",", "21"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\\n\"\>"}],
  SequenceForm[
  "\n\n\n [+++] About to start for-loop in MDynamic[HH,max] @ ", {2019, 3, 17,
    5, 21}, "\n\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744612961693`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "5", ",", "21"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 1, " @ ", {2019, 3, 17, 5, 21},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744613001695`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "5", ",", "21", ",", 
     "1.2861686`7.861872889118769"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 1, 
   ", at date and time ", {2019, 3, 17, 5, 21, 1.2861686`7.861872889118769}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744613051696`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "5", ",", "21", ",", 
     "1.7811969`8.003286917044953"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 2, 
   ", at date and time ", {2019, 3, 17, 5, 21, 1.7811969`8.003286917044953}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774461784197*^9}],

Cell[BoxData["\<\"finished computing HeffSub (the terms that are to be \
subtracted)\"\>"], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774461846201*^9}],

Cell[BoxData["\<\"finished computing next level of Heff\"\>"], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744618502007`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n Running recursive procedure (iii = \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["\n Running recursive procedure (iii = ", 2, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774461857201*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n [+++] About to start for-loop in MDynamic[HH,max] @ \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "5", ",", "21"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\\n\"\>"}],
  SequenceForm[
  "\n\n\n [+++] About to start for-loop in MDynamic[HH,max] @ ", {2019, 3, 17,
    5, 21}, "\n\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744618642015`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "5", ",", "21"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 1, " @ ", {2019, 3, 17, 5, 21},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774461870202*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "5", ",", "21", ",", 
     "1.8612015`8.022368380305181"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 1, 
   ", at date and time ", {2019, 3, 17, 5, 21, 1.8612015`8.022368380305181}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744618742023`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n  In for-loop of MDynamic[HH,max], i = \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\" @ \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "5", ",", "21"}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\n\"\>"}],
  SequenceForm[
  "\n  In for-loop of MDynamic[HH,max], i = ", 2, " @ ", {2019, 3, 17, 5, 21},
    "\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774470964722*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "5", ",", "21", ",", 
     "10.9637221`8.792532980728943"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 2, 
   ", at date and time ", {2019, 3, 17, 5, 21, 10.9637221`8.792532980728943}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744709687223`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "5", ",", "21", ",", 
     "11.9117764`8.828551491688556"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 3, 
   ", at date and time ", {2019, 3, 17, 5, 21, 11.9117764`8.828551491688556}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744719137764`*^9}],

Cell[BoxData["\<\"finished computing HeffSub (the terms that are to be \
subtracted)\"\>"], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774473455865*^9}],

Cell[BoxData["\<\"finished computing next level of Heff\"\>"], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.761774473484866*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Finished @ \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "5", ",", "21"}], "}"}]}],
  SequenceForm["Finished @ ", {2019, 3, 17, 5, 21}],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744734878664`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"H1", " ", "sx"}], "4"], "-", 
  FractionBox[
   RowBox[{"H1D", " ", "sx", " ", "td"}], "4"], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "H1DD", " ", "sx", " ", 
   SuperscriptBox["td", "2"]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1", "3"], " ", "sx"}], 
   RowBox[{"128", " ", 
    SuperscriptBox["ww", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1D", "2"], " ", "\[Pi]", " ", "sz", " ", "td"}], 
   RowBox[{"16", " ", 
    SuperscriptBox["ww", "2"]}]], "+", 
  FractionBox[
   RowBox[{"H1", " ", "H1DD", " ", "\[Pi]", " ", "sz", " ", "td"}], 
   RowBox[{"8", " ", 
    SuperscriptBox["ww", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1", "2"], " ", "sz"}], 
   RowBox[{"32", " ", "ww"}]], "-", 
  FractionBox[
   RowBox[{"H1DD", " ", "\[Pi]", " ", "sx", " ", "td"}], 
   RowBox[{"4", " ", "ww"}]], "-", 
  FractionBox[
   RowBox[{"H1", " ", "H1D", " ", "sz", " ", "td"}], 
   RowBox[{"16", " ", "ww"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1D", "2"], " ", "sz", " ", 
    SuperscriptBox["td", "2"]}], 
   RowBox[{"32", " ", "ww"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1D", "2"], " ", "sz", " ", "td", " ", "\[Beta]0"}], 
   RowBox[{"32", " ", 
    SuperscriptBox["ww", "2"]}]], "+", 
  FractionBox[
   RowBox[{"H1", " ", "H1DD", " ", "sz", " ", "td", " ", "\[Beta]0"}], 
   RowBox[{"16", " ", 
    SuperscriptBox["ww", "2"]}]], "-", 
  FractionBox[
   RowBox[{"H1DD", " ", "sx", " ", "td", " ", "\[Beta]0"}], 
   RowBox[{"8", " ", "ww"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1", "3"], " ", "sx", " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"128", " ", 
    SuperscriptBox["ww", "2"]}]], "+", 
  FractionBox[
   RowBox[{"H1DD", " ", "sx", " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"16", " ", 
    SuperscriptBox["ww", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1D", "2"], " ", "\[Pi]", " ", "sz", " ", "td", " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"8", " ", 
    SuperscriptBox["ww", "2"]}]], "-", 
  FractionBox[
   RowBox[{"H1", " ", "H1DD", " ", "\[Pi]", " ", "sz", " ", "td", " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["ww", "2"]}]], "+", 
  FractionBox[
   RowBox[{"H1D", " ", "sy", " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"8", " ", "ww"}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1", "2"], " ", "sz", " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"16", " ", "ww"}]], "-", 
  FractionBox[
   RowBox[{"H1DD", " ", "sy", " ", "td", " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"8", " ", "ww"}]], "+", 
  FractionBox[
   RowBox[{"H1", " ", "H1D", " ", "sz", " ", "td", " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"8", " ", "ww"}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1D", "2"], " ", "sz", " ", 
    SuperscriptBox["td", "2"], " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"16", " ", "ww"}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1D", "2"], " ", "sz", " ", "td", " ", "\[Beta]0", " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"16", " ", 
    SuperscriptBox["ww", "2"]}]], "-", 
  FractionBox[
   RowBox[{"H1", " ", "H1DD", " ", "sz", " ", "td", " ", "\[Beta]0", " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"8", " ", 
    SuperscriptBox["ww", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1", "3"], " ", "sx", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], 
   RowBox[{"256", " ", 
    SuperscriptBox["ww", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1", "3"], " ", "sy", " ", 
    RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"128", " ", 
    SuperscriptBox["ww", "2"]}]], "-", 
  FractionBox[
   RowBox[{"H1DD", " ", "sy", " ", 
    RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"16", " ", 
    SuperscriptBox["ww", "2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", "H1", " ", "H1D", " ", "sz", " ", 
    RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"32", " ", 
    SuperscriptBox["ww", "2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["H1D", "2"], " ", "sz", " ", "td", " ", 
    RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"32", " ", 
    SuperscriptBox["ww", "2"]}]], "+", 
  FractionBox[
   RowBox[{"H1D", " ", "sx", " ", 
    RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"8", " ", "ww"}]], "-", 
  FractionBox[
   RowBox[{"H1DD", " ", "sx", " ", "td", " ", 
    RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], 
   RowBox[{"8", " ", "ww"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["H1", "3"], " ", "sy", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], 
   RowBox[{"256", " ", 
    SuperscriptBox["ww", "2"]}]]}]], "Output",
 CellChangeTimes->{3.761774209952793*^9, 3.761774274997514*^9, 
  3.7617744734928665`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n Test result = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox[
     RowBox[{"H1", " ", "sx"}], "4"], "-", 
    FractionBox[
     RowBox[{"H1D", " ", "sx", " ", "td"}], "4"], "+", 
    RowBox[{
     FractionBox["1", "8"], " ", "H1DD", " ", "sx", " ", 
     SuperscriptBox["td", "2"]}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1", "3"], " ", "sx"}], 
     RowBox[{"128", " ", 
      SuperscriptBox["ww", "2"]}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1D", "2"], " ", "\[Pi]", " ", "sz", " ", "td"}], 
     RowBox[{"16", " ", 
      SuperscriptBox["ww", "2"]}]], "+", 
    FractionBox[
     RowBox[{"H1", " ", "H1DD", " ", "\[Pi]", " ", "sz", " ", "td"}], 
     RowBox[{"8", " ", 
      SuperscriptBox["ww", "2"]}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1", "2"], " ", "sz"}], 
     RowBox[{"32", " ", "ww"}]], "-", 
    FractionBox[
     RowBox[{"H1DD", " ", "\[Pi]", " ", "sx", " ", "td"}], 
     RowBox[{"4", " ", "ww"}]], "-", 
    FractionBox[
     RowBox[{"H1", " ", "H1D", " ", "sz", " ", "td"}], 
     RowBox[{"16", " ", "ww"}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1D", "2"], " ", "sz", " ", 
      SuperscriptBox["td", "2"]}], 
     RowBox[{"32", " ", "ww"}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1D", "2"], " ", "sz", " ", "td", " ", "\[Beta]0"}], 
     RowBox[{"32", " ", 
      SuperscriptBox["ww", "2"]}]], "+", 
    FractionBox[
     RowBox[{"H1", " ", "H1DD", " ", "sz", " ", "td", " ", "\[Beta]0"}], 
     RowBox[{"16", " ", 
      SuperscriptBox["ww", "2"]}]], "-", 
    FractionBox[
     RowBox[{"H1DD", " ", "sx", " ", "td", " ", "\[Beta]0"}], 
     RowBox[{"8", " ", "ww"}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"128", " ", 
      SuperscriptBox["ww", "2"]}]], "+", 
    FractionBox[
     RowBox[{"H1DD", " ", "sx", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"16", " ", 
      SuperscriptBox["ww", "2"]}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1D", "2"], " ", "\[Pi]", " ", "sz", " ", "td", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"8", " ", 
      SuperscriptBox["ww", "2"]}]], "-", 
    FractionBox[
     RowBox[{"H1", " ", "H1DD", " ", "\[Pi]", " ", "sz", " ", "td", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"4", " ", 
      SuperscriptBox["ww", "2"]}]], "+", 
    FractionBox[
     RowBox[{"H1D", " ", "sy", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"8", " ", "ww"}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1", "2"], " ", "sz", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"16", " ", "ww"}]], "-", 
    FractionBox[
     RowBox[{"H1DD", " ", "sy", " ", "td", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"8", " ", "ww"}]], "+", 
    FractionBox[
     RowBox[{"H1", " ", "H1D", " ", "sz", " ", "td", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"8", " ", "ww"}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1D", "2"], " ", "sz", " ", 
      SuperscriptBox["td", "2"], " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"16", " ", "ww"}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1D", "2"], " ", "sz", " ", "td", " ", "\[Beta]0", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"16", " ", 
      SuperscriptBox["ww", "2"]}]], "-", 
    FractionBox[
     RowBox[{"H1", " ", "H1DD", " ", "sz", " ", "td", " ", "\[Beta]0", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"8", " ", 
      SuperscriptBox["ww", "2"]}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], 
     RowBox[{"256", " ", 
      SuperscriptBox["ww", "2"]}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"128", " ", 
      SuperscriptBox["ww", "2"]}]], "-", 
    FractionBox[
     RowBox[{"H1DD", " ", "sy", " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"16", " ", 
      SuperscriptBox["ww", "2"]}]], "+", 
    FractionBox[
     RowBox[{"3", " ", "H1", " ", "H1D", " ", "sz", " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"32", " ", 
      SuperscriptBox["ww", "2"]}]], "-", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["H1D", "2"], " ", "sz", " ", "td", " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"32", " ", 
      SuperscriptBox["ww", "2"]}]], "+", 
    FractionBox[
     RowBox[{"H1D", " ", "sx", " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"8", " ", "ww"}]], "-", 
    FractionBox[
     RowBox[{"H1DD", " ", "sx", " ", "td", " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], 
     RowBox[{"8", " ", "ww"}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["H1", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], 
     RowBox[{"256", " ", 
      SuperscriptBox["ww", "2"]}]]}]}],
  SequenceForm[
  "\n\n\n Test result = ", Rational[1, 4] $CellContext`H1 $CellContext`sx + 
   Rational[-1, 4] $CellContext`H1D $CellContext`sx $CellContext`td + 
   Rational[1, 8] $CellContext`H1DD $CellContext`sx $CellContext`td^2 + 
   Rational[-1, 128] $CellContext`H1^3 $CellContext`sx $CellContext`ww^(-2) + 
   Rational[1, 16] $CellContext`H1D^2 
    Pi $CellContext`sz $CellContext`td $CellContext`ww^(-2) + 
   Rational[1, 8] $CellContext`H1 $CellContext`H1DD 
    Pi $CellContext`sz $CellContext`td $CellContext`ww^(-2) + 
   Rational[1, 32] $CellContext`H1^2 $CellContext`sz/$CellContext`ww + 
   Rational[-1, 4] $CellContext`H1DD 
    Pi $CellContext`sx $CellContext`td/$CellContext`ww + 
   Rational[-1, 
      16] $CellContext`H1 $CellContext`H1D $CellContext`sz \
$CellContext`td/$CellContext`ww + 
   Rational[1, 
      32] $CellContext`H1D^2 $CellContext`sz \
$CellContext`td^2/$CellContext`ww + 
   Rational[1, 
      32] $CellContext`H1D^2 $CellContext`sz $CellContext`td \
$CellContext`ww^(-2) $CellContext`\[Beta]0 + 
   Rational[1, 
      16] $CellContext`H1 $CellContext`H1DD $CellContext`sz $CellContext`td \
$CellContext`ww^(-2) $CellContext`\[Beta]0 + 
   Rational[-1, 
      8] $CellContext`H1DD $CellContext`sx $CellContext`td \
$CellContext`ww^(-1) $CellContext`\[Beta]0 + 
   Rational[1, 128] $CellContext`H1^3 $CellContext`sx $CellContext`ww^(-2) 
    Cos[$CellContext`\[Beta]0] + 
   Rational[1, 16] $CellContext`H1DD $CellContext`sx $CellContext`ww^(-2) 
    Cos[$CellContext`\[Beta]0] + 
   Rational[-1, 8] $CellContext`H1D^2 
    Pi $CellContext`sz $CellContext`td $CellContext`ww^(-2) 
    Cos[$CellContext`\[Beta]0] + 
   Rational[-1, 4] $CellContext`H1 $CellContext`H1DD 
    Pi $CellContext`sz $CellContext`td $CellContext`ww^(-2) 
    Cos[$CellContext`\[Beta]0] + 
   Rational[1, 8] $CellContext`H1D $CellContext`sy $CellContext`ww^(-1) 
    Cos[$CellContext`\[Beta]0] + 
   Rational[-1, 16] $CellContext`H1^2 $CellContext`sz $CellContext`ww^(-1) 
    Cos[$CellContext`\[Beta]0] + 
   Rational[-1, 
      8] $CellContext`H1DD $CellContext`sy $CellContext`td \
$CellContext`ww^(-1) Cos[$CellContext`\[Beta]0] + 
   Rational[
     1, 8] $CellContext`H1 $CellContext`H1D $CellContext`sz $CellContext`td \
$CellContext`ww^(-1) Cos[$CellContext`\[Beta]0] + 
   Rational[-1, 
      16] $CellContext`H1D^2 $CellContext`sz $CellContext`td^2 \
$CellContext`ww^(-1) Cos[$CellContext`\[Beta]0] + 
   Rational[-1, 
      16] $CellContext`H1D^2 $CellContext`sz $CellContext`td \
$CellContext`ww^(-2) $CellContext`\[Beta]0 Cos[$CellContext`\[Beta]0] + 
   Rational[-1, 
      8] $CellContext`H1 $CellContext`H1DD $CellContext`sz $CellContext`td \
$CellContext`ww^(-2) $CellContext`\[Beta]0 Cos[$CellContext`\[Beta]0] + 
   Rational[-1, 256] $CellContext`H1^3 $CellContext`sx $CellContext`ww^(-2) 
    Cos[2 $CellContext`\[Beta]0] + 
   Rational[1, 128] $CellContext`H1^3 $CellContext`sy $CellContext`ww^(-2) 
    Sin[$CellContext`\[Beta]0] + 
   Rational[-1, 16] $CellContext`H1DD $CellContext`sy $CellContext`ww^(-2) 
    Sin[$CellContext`\[Beta]0] + 
   Rational[3, 
      32] $CellContext`H1 $CellContext`H1D $CellContext`sz \
$CellContext`ww^(-2) Sin[$CellContext`\[Beta]0] + 
   Rational[-3, 
      32] $CellContext`H1D^2 $CellContext`sz $CellContext`td \
$CellContext`ww^(-2) Sin[$CellContext`\[Beta]0] + 
   Rational[1, 8] $CellContext`H1D $CellContext`sx $CellContext`ww^(-1) 
    Sin[$CellContext`\[Beta]0] + 
   Rational[-1, 
      8] $CellContext`H1DD $CellContext`sx $CellContext`td \
$CellContext`ww^(-1) Sin[$CellContext`\[Beta]0] + 
   Rational[1, 256] $CellContext`H1^3 $CellContext`sy $CellContext`ww^(-2) 
    Sin[2 $CellContext`\[Beta]0]],
  Editable->False]], "Print",
 CellChangeTimes->{3.761774194486909*^9, 3.7617742597896433`*^9, 
  3.7617744734998674`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7617743434444284`*^9, 3.7617743435704355`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7617743610844374`*^9, 3.7617743613534527`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.761774358590295*^9, 3.7617743594733453`*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.761774344131468*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"effectiveHamiltonian", "=", 
  RowBox[{"effH", "[", 
   RowBox[{"H", "[", "t", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\\n\\n\\n Result = \>\"", ",", "effectiveHamiltonian"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.740739977018279*^9, 3.74073998036152*^9}, {
  3.752557875265486*^9, 3.75255790843076*^9}},
 ExpressionUUID -> "0832b9c2-23a7-4204-a9ba-dbb23cf44b45"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n Compute eff. Hamiltonian @\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "2019", ",", "3", ",", "17", ",", "5", ",", "12", ",", 
      "48.8500029`9.441439452075393"}], "}"}], "[", 
    RowBox[{"1", ";;", "5"}], "]"}]}],
  SequenceForm["\n Compute eff. Hamiltonian @", 
   {2019, 3, 17, 5, 12, 48.8500029`9.441439452075393}[
    Span[1, 5]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.761773968873004*^9}],

Cell[BoxData["\<\"verboseLight = False\"\>"], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.761773968876004*^9}],

Cell[BoxData["\<\"verbose = False\"\>"], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.7617739688790045`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Starting .. Main Magnus with max = \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["Starting .. Main Magnus with max = ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.7617739688820047`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" We use HH = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "4"], " ", "H1", " ", 
    RowBox[{"(", 
     RowBox[{"sx", "+", 
      RowBox[{"sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}]}], ")"}]}]}],
  SequenceForm[
  " We use HH = ", 
   Rational[1, 4] $CellContext`H1 ($CellContext`sx + $CellContext`sx 
     Cos[2 $CellContext`t $CellContext`ww] - $CellContext`sy 
    Sin[2 $CellContext`t $CellContext`ww])],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.7617739688860044`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "5", ",", "12", ",", 
     "48.8950054`9.441839356666794"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 1, 
   ", at date and time ", {2019, 3, 17, 5, 12, 48.8950054`9.441839356666794}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.761773968923007*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"[in M[HH, max]]  i = \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["[in M[HH, max]]  i = ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.7617739810336995`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "5", ",", "13", ",", 
     "1.0316996`7.766128248593925"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 2, 
   ", at date and time ", {2019, 3, 17, 5, 13, 1.0316996`7.766128248593925}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.7617739810376997`*^9}],

Cell[BoxData["\<\"[in sGetOO]  Now:  final integral\"\>"], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.7617739810417004`*^9}],

Cell[BoxData["\<\"Computing Main Magnus finished.\"\>"], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.7617739889521523`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"HRWA = \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"H1", " ", "sx"}], "4"]}],
  SequenceForm["HRWA = ", Rational[1, 4] $CellContext`H1 $CellContext`sx],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.761773988958153*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n Running recursive procedure (iii = \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["\n Running recursive procedure (iii = ", 1, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.7617739889621534`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "5", ",", "13", ",", 
     "8.9531527`8.704550958981276"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 1, 
   ", at date and time ", {2019, 3, 17, 5, 13, 8.9531527`8.704550958981276}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.761773988966153*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"[in M[HH, max]]  i = \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["[in M[HH, max]]  i = ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.761773989289172*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Begin calculating \\!\\(\\*SubscriptBox[\\(\[CapitalOmega]\
\[CapitalOmega]\\), \\(k\\)]\\)/\\!\\(\\*SubscriptBox[\\(Omega\\), \
\\(k\\)]\\) of order k = \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", at date and time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2019", ",", "3", ",", "17", ",", "5", ",", "13", ",", 
     "9.2871718`8.720458444089566"}], "}"}]}],
  SequenceForm[
  "Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \
\(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k = ", 2, 
   ", at date and time ", {2019, 3, 17, 5, 13, 9.2871718`8.720458444089566}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.761773989292172*^9}],

Cell[BoxData["\<\"[in sGetOO]  Now:  final integral\"\>"], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.7617739892951727`*^9}],

Cell[BoxData["\<\"finished computing HeffSub (the terms that are to be \
subtracted)\"\>"], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.761773989505184*^9}],

Cell[BoxData["\<\"finished computing next level of Heff\"\>"], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.7617739895091844`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Finished @ \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2019", ",", "3", ",", "17", ",", "5", ",", "13"}], "}"}]}],
  SequenceForm["Finished @ ", {2019, 3, 17, 5, 13}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.7617739895131845`*^9}]
}, Open  ]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["H1", "2"], " ", "sz"}], "+", 
   RowBox[{"8", " ", "H1", " ", "sx", " ", "ww"}], "+", 
   RowBox[{"4", " ", "H1D", " ", "sy", " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["H1", "2"], " ", "sz", " ", 
    RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
   RowBox[{"4", " ", "H1D", " ", "sx", " ", 
    RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], 
  RowBox[{"32", " ", "ww"}]]], "Output",
 CellChangeTimes->{3.761755229784871*^9, 3.761755369694873*^9, 
  3.761755578532818*^9, 3.761755808352963*^9, 3.761773989517185*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n\\n\\n Result = \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["H1", "2"], " ", "sz"}], "+", 
     RowBox[{"8", " ", "H1", " ", "sx", " ", "ww"}], "+", 
     RowBox[{"4", " ", "H1D", " ", "sy", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["H1", "2"], " ", "sz", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
     RowBox[{"4", " ", "H1D", " ", "sx", " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], 
    RowBox[{"32", " ", "ww"}]]}],
  SequenceForm[
  "\n\n\n Result = ", 
   Rational[1, 32] $CellContext`ww^(-1) ($CellContext`H1^2 $CellContext`sz + 
    8 $CellContext`H1 $CellContext`sx $CellContext`ww + 
    4 $CellContext`H1D $CellContext`sy Cos[$CellContext`\[Beta]0] - 
    2 $CellContext`H1^2 $CellContext`sz Cos[$CellContext`\[Beta]0] + 
    4 $CellContext`H1D $CellContext`sx Sin[$CellContext`\[Beta]0])],
  Editable->False]], "Print",
 CellChangeTimes->{3.7617552111578054`*^9, 3.7617552684210806`*^9, 
  3.761755557106592*^9, 3.7617557996424646`*^9, 3.761773989519185*^9}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.761755215058028*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "I", " ", "think", " ", "these", " ", "results", " ", "are", " ", 
   "correct"}], "*)"}]], "Input",
 CellChangeTimes->{{3.761755230018884*^9, 3.7617552373303022`*^9}, {
  3.7617553290705495`*^9, 3.7617553334928026`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\"\<\\\\n\\\\n\\\\n Result = \>\"", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["H1", "2"], " ", "sz"}], "+", 
     RowBox[{"8", " ", "H1", " ", "sx", " ", "ww"}], "+", 
     RowBox[{"4", " ", "H1D", " ", "sy", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["H1", "2"], " ", "sz", " ", 
      RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
     RowBox[{"4", " ", "H1D", " ", "sx", " ", 
      RowBox[{"Sin", "[", "\[Beta]0", "]"}]}]}], 
    RowBox[{"32", " ", "ww"}]]}],
  SequenceForm[
  "\n\n\n Result = ", 
   Rational[1, 32] $CellContext`ww^(-1) ($CellContext`H1^2 $CellContext`sz + 
    8 $CellContext`H1 $CellContext`sx $CellContext`ww + 
    4 $CellContext`H1D $CellContext`sy Cos[$CellContext`\[Beta]0] - 
    2 $CellContext`H1^2 $CellContext`sz Cos[$CellContext`\[Beta]0] + 
    4 $CellContext`H1D $CellContext`sx Sin[$CellContext`\[Beta]0])],
  Editable->False]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.761739446083785*^9, 3.7617395181385145`*^9, 3.76173963512712*^9, 
   3.7617398254972544`*^9, 3.7617398640625224`*^9, 3.761755104190687*^9, {
   3.76175522731773*^9, 3.7617552277177525`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"256", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox["H1", "3"], " ", "sx"}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["H1", "2"], " ", "sz", " ", "ww"}], "+", 
    RowBox[{"64", " ", "H1", " ", "sx", " ", 
     SuperscriptBox["ww", "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "3"], " ", "sx", " ", 
     RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"16", " ", "H1DD", " ", "sx", " ", 
     RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"32", " ", "H1D", " ", "sy", " ", "ww", " ", 
     RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["H1", "2"], " ", "sz", " ", "ww", " ", 
     RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["H1", "3"], " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "3"], " ", "sy", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
    RowBox[{"16", " ", "H1DD", " ", "sy", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"24", " ", "H1", " ", "H1D", " ", "sz", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{"32", " ", "H1D", " ", "sx", " ", "ww", " ", 
     RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["H1", "3"], " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Beta]0"}], "]"}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.76175530984445*^9, 3.7617553146297235`*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.7617552154410505`*^9}]
},
WindowSize->{1424, 726},
WindowMargins->{{2, Automatic}, {Automatic, 2}},
ShowSelection->True,
Magnification->2.1000008583068848`,
FrontEndVersion->"8.0 for Microsoft Windows (32-bit) (October 6, 2011)",
StyleDefinitions->"Default.nb",
PrivateNotebookOptions -> {"VersionedStylesheet" -> {"Default.nb"[8.] -> True}}
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3761849197-3507274"->{
  Cell[65831, 1477, 1014, 19, 124, "Print",
   CellTags->"Info3761849197-3507274"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3761849197-3507274", 115347, 2765}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 468, 8, 209, "Input"],
Cell[1051, 32, 650, 9, 231, "Print"]
}, Open  ]],
Cell[1716, 44, 431, 7, 135, "Input"],
Cell[2150, 53, 176, 3, 60, "Input"],
Cell[2329, 58, 513, 8, 135, "Input"],
Cell[2845, 68, 263, 5, 60, "Input"],
Cell[3111, 75, 13069, 239, 1378, "Input"],
Cell[16183, 316, 2785, 49, 421, "Input"],
Cell[CellGroupData[{
Cell[18993, 369, 1475, 34, 458, "Input"],
Cell[20471, 405, 3407, 58, 91, "Output"]
}, Open  ]],
Cell[23893, 466, 477, 9, 125, "Input"],
Cell[24373, 477, 145, 2, 98, "Input"],
Cell[24521, 481, 427, 9, 98, "Input"],
Cell[24951, 492, 336, 7, 125, "Input"],
Cell[25290, 501, 560, 9, 60, "Input"],
Cell[25853, 512, 146, 2, 98, "Input"],
Cell[26002, 516, 4422, 104, 448, "Input"],
Cell[30427, 622, 87, 1, 98, "Input"],
Cell[CellGroupData[{
Cell[30539, 627, 350, 8, 125, "Input"],
Cell[CellGroupData[{
Cell[30914, 639, 618, 15, 83, "Print"],
Cell[31535, 656, 218, 3, 45, "Print"],
Cell[31756, 661, 211, 3, 45, "Print"],
Cell[31970, 666, 372, 8, 45, "Print"],
Cell[32345, 676, 1149, 30, 67, "Print"],
Cell[33497, 708, 237, 3, 194, "Print"],
Cell[33737, 713, 584, 13, 231, "Print"],
Cell[34324, 728, 619, 14, 120, "Print"],
Cell[34946, 744, 882, 17, 83, "Print"],
Cell[35831, 763, 619, 14, 120, "Print"],
Cell[36453, 779, 884, 17, 83, "Print"],
Cell[37340, 798, 617, 14, 120, "Print"],
Cell[37960, 814, 886, 17, 83, "Print"],
Cell[38849, 833, 884, 17, 83, "Print"],
Cell[39736, 852, 227, 3, 45, "Print"],
Cell[39966, 857, 698, 17, 67, "Print"],
Cell[40667, 876, 420, 8, 83, "Print"],
Cell[41090, 886, 584, 13, 231, "Print"],
Cell[41677, 901, 619, 14, 120, "Print"],
Cell[42299, 917, 882, 17, 83, "Print"],
Cell[43184, 936, 884, 17, 83, "Print"],
Cell[44071, 955, 264, 4, 45, "Print"],
Cell[44338, 961, 233, 3, 45, "Print"],
Cell[44574, 966, 420, 8, 83, "Print"],
Cell[44997, 976, 582, 13, 231, "Print"],
Cell[45582, 991, 619, 14, 120, "Print"],
Cell[46204, 1007, 884, 17, 83, "Print"],
Cell[47091, 1026, 619, 14, 120, "Print"],
Cell[47713, 1042, 886, 17, 83, "Print"],
Cell[48602, 1061, 884, 17, 83, "Print"],
Cell[49489, 1080, 262, 4, 45, "Print"],
Cell[49754, 1086, 235, 3, 45, "Print"],
Cell[49992, 1091, 420, 8, 83, "Print"],
Cell[50415, 1101, 584, 13, 231, "Print"],
Cell[51002, 1116, 617, 14, 120, "Print"],
Cell[51622, 1132, 884, 17, 83, "Print"],
Cell[52509, 1151, 617, 14, 120, "Print"],
Cell[53129, 1167, 884, 17, 83, "Print"],
Cell[54016, 1186, 617, 14, 120, "Print"],
Cell[54636, 1202, 884, 17, 83, "Print"],
Cell[55523, 1221, 882, 17, 83, "Print"],
Cell[56408, 1240, 262, 4, 45, "Print"],
Cell[56673, 1246, 233, 3, 45, "Print"],
Cell[56909, 1251, 425, 9, 45, "Print"]
}, Open  ]],
Cell[57349, 1263, 2169, 55, 229, "Output"],
Cell[59521, 1320, 3601, 82, 339, "Print"]
}, Open  ]],
Cell[63137, 1405, 87, 1, 98, "Input"],
Cell[63227, 1408, 87, 1, 98, "Input"],
Cell[63317, 1411, 2362, 58, 278, "Input"],
Cell[CellGroupData[{
Cell[65704, 1473, 124, 2, 87, "Input"],
Cell[65831, 1477, 1014, 19, 124, "Print",
 CellTags->"Info3761849197-3507274"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66882, 1501, 722, 22, 190, "Input"],
Cell[67607, 1525, 663, 19, 117, "Output"],
Cell[68273, 1546, 631, 18, 117, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68941, 1569, 378, 11, 118, "Input"],
Cell[69322, 1582, 492, 15, 127, "Output"]
}, Open  ]],
Cell[69829, 1600, 87, 1, 98, "Input"],
Cell[69919, 1603, 147, 2, 135, "Input"],
Cell[CellGroupData[{
Cell[70091, 1609, 275, 6, 98, "Input"],
Cell[CellGroupData[{
Cell[70391, 1619, 549, 14, 83, "Print"],
Cell[70943, 1635, 145, 2, 45, "Print"],
Cell[71091, 1639, 140, 2, 45, "Print"],
Cell[71234, 1643, 301, 7, 45, "Print"],
Cell[71538, 1652, 758, 20, 67, "Print"],
Cell[72299, 1674, 168, 2, 194, "Print"],
Cell[72470, 1678, 511, 12, 231, "Print"],
Cell[72984, 1692, 546, 13, 120, "Print"],
Cell[73533, 1707, 815, 16, 83, "Print"],
Cell[74351, 1725, 546, 13, 443, "Print"],
Cell[74900, 1740, 815, 16, 237, "Print"],
Cell[75718, 1758, 811, 16, 237, "Print"],
Cell[76532, 1776, 158, 2, 132, "Print"],
Cell[76693, 1780, 684, 17, 191, "Print"],
Cell[77380, 1799, 349, 7, 237, "Print"],
Cell[77732, 1808, 513, 12, 751, "Print"],
Cell[78248, 1822, 548, 13, 1171, "Print"],
Cell[78799, 1837, 813, 16, 819, "Print"],
Cell[79615, 1855, 811, 16, 819, "Print"],
Cell[80429, 1873, 191, 3, 453, "Print"],
Cell[80623, 1878, 164, 2, 453, "Print"],
Cell[80790, 1882, 347, 7, 819, "Print"],
Cell[81140, 1891, 513, 12, 2236, "Print"],
Cell[81656, 1905, 546, 13, 1171, "Print"],
Cell[82205, 1920, 813, 16, 819, "Print"],
Cell[83021, 1938, 546, 13, 1171, "Print"],
Cell[83570, 1953, 815, 16, 819, "Print"],
Cell[84388, 1971, 815, 16, 819, "Print"],
Cell[85206, 1989, 191, 3, 453, "Print"],
Cell[85400, 1994, 162, 2, 453, "Print"],
Cell[85565, 1998, 354, 8, 453, "Print"]
}, Open  ]],
Cell[85934, 2009, 5065, 151, 6501, "Output"],
Cell[91002, 2162, 9160, 229, 7452, "Print"]
}, Open  ]],
Cell[100177, 2394, 150, 2, 1386, "Input"],
Cell[100330, 2398, 96, 1, 604, "Input"],
Cell[100429, 2401, 94, 1, 604, "Input"],
Cell[100526, 2404, 87, 1, 1001, "Input"],
Cell[CellGroupData[{
Cell[100638, 2409, 432, 9, 1001, "Input"],
Cell[CellGroupData[{
Cell[101095, 2422, 595, 14, 819, "Print"],
Cell[101693, 2438, 193, 2, 453, "Print"],
Cell[101889, 2442, 190, 2, 453, "Print"],
Cell[102082, 2446, 351, 7, 453, "Print"],
Cell[102436, 2455, 806, 20, 737, "Print"],
Cell[103245, 2477, 861, 16, 819, "Print"],
Cell[104109, 2495, 319, 6, 453, "Print"],
Cell[104431, 2503, 861, 16, 819, "Print"],
Cell[105295, 2521, 208, 2, 453, "Print"],
Cell[105506, 2525, 206, 2, 453, "Print"],
Cell[105715, 2529, 383, 8, 737, "Print"],
Cell[106101, 2539, 397, 7, 819, "Print"],
Cell[106501, 2548, 859, 16, 819, "Print"],
Cell[107363, 2566, 317, 6, 453, "Print"],
Cell[107683, 2574, 859, 16, 819, "Print"],
Cell[108545, 2592, 208, 2, 453, "Print"],
Cell[108756, 2596, 239, 3, 453, "Print"],
Cell[108998, 2601, 212, 2, 453, "Print"],
Cell[109213, 2605, 402, 8, 453, "Print"]
}, Open  ]],
Cell[109630, 2616, 641, 15, 963, "Output"],
Cell[110274, 2633, 1159, 25, 1908, "Print"]
}, Open  ]],
Cell[111448, 2661, 87, 1, 1001, "Input"],
Cell[CellGroupData[{
Cell[111560, 2666, 264, 6, 604, "Input"],
Cell[111827, 2674, 1291, 29, 1197, "Print"]
}, Open  ]],
Cell[113133, 2706, 1674, 41, 2702, "Input"],
Cell[114810, 2749, 89, 1, 1001, "Input"]
}
]
*)

