(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    160848,       3394]
NotebookOptionsPosition[    154317,       3294]
NotebookOutlinePosition[    154804,       3313]
CellTagsIndexPosition[    154761,       3310]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Derivation", " ", "of", " ", "Magnus", " ", "terms", " ", "sketched", " ",
     "in", " ", 
    RowBox[{"FlipFlop", ".", "pdf", "."}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"You", "'"}], "re", " ", "not", " ", "using", " ", "commutators", 
    " ", "from", " ", "\"\<Quantum Unit\>\"", " ", 
    RowBox[{"(", 
     RowBox[{
     "or", " ", "whatever", " ", "this", " ", "MM", " ", "little", " ", 
      "package", " ", "is", " ", "called"}], ")"}], " ", "to", " ", 
    "calculate", " ", "these", " ", "terms", " ", "yet"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.685081133724957*^9, 3.6850811441514387`*^9}, {
  3.687060963025004*^9, 3.68706101373247*^9}, {3.68706106785851*^9, 
  3.6870611077671824`*^9}, {3.688473981694998*^9, 3.688474010772595*^9}, {
  3.68847736135122*^9, 
  3.688477428012034*^9}},ExpressionUUID->"6c047262-06f7-4def-b8fd-\
544910e5d36a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "NC`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "NCAlgebra`"}], ";"}], "\[IndentingNewLine]"}], "Input",Expres\
sionUUID->"845f275c-6c08-4cf6-aa2c-f379f0baa0b6"],

Cell[CellGroupData[{

Cell[BoxData["\<\"You are using the version of NCAlgebra which is found in:\"\
\>"], "Print",
 CellChangeTimes->{3.738343790267438*^9, 3.7383446419571514`*^9, 
  3.7383464290323668`*^9, 3.73834654099377*^9, 3.738346817209569*^9, 
  3.738583611389427*^9},ExpressionUUID->"60389d04-dd91-4e75-a892-\
d783efeed7d7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  \"\>", 
   "\[InvisibleSpace]", "\<\"/Users/zeuch/Documents/NC for \
Mathematica/NC\"\>"}],
  SequenceForm["  ", "/Users/zeuch/Documents/NC for Mathematica/NC"],
  Editable->False]], "Print",
 CellChangeTimes->{3.738343790267438*^9, 3.7383446419571514`*^9, 
  3.7383464290323668`*^9, 3.73834654099377*^9, 3.738346817209569*^9, 
  3.738583611397141*^9},ExpressionUUID->"3030fbff-19dc-465e-91b5-\
18b8bd259595"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"You can now use \\\"<< NCAlgebra`\\\" to load NCAlgebra or \
\"\>", "\[InvisibleSpace]", "\<\"\\\"<< NCGB`\\\" to load NCGB.\"\>"}],
  SequenceForm[
  "You can now use \"<< NCAlgebra`\" to load NCAlgebra or ", 
   "\"<< NCGB`\" to load NCGB."],
  Editable->False]], "Print",
 CellChangeTimes->{3.738343790267438*^9, 3.7383446419571514`*^9, 
  3.7383464290323668`*^9, 3.73834654099377*^9, 3.738346817209569*^9, 
  3.73858361140587*^9},ExpressionUUID->"8a935431-7954-4f43-869f-1027ad10ef0c"],

Cell[BoxData["\<\"You have already loaded NCAlgebra.m\"\>"], "Print",
 CellChangeTimes->{3.738343790267438*^9, 3.7383446419571514`*^9, 
  3.7383464290323668`*^9, 3.73834654099377*^9, 3.738346817209569*^9, 
  3.738583611413783*^9},ExpressionUUID->"39dff0fa-2d79-4851-8226-\
3a6d7d203ab1"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", "=", "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FS", "=", "FullSimplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MF", "=", "MatrixForm"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"verbose", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tc", "=", 
    RowBox[{"Pi", "/", "ww"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"General", "::", "spell1"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"MatrixExp", "::", "eivn"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Some", " ", "definitions"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCommutative", "[", "t", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ww", ">", "0"}], ",", 
      RowBox[{"t", ">", "0"}], ",", 
      RowBox[{"t0", ">", "0"}], ",", 
      RowBox[{"H1", ">", "0"}], ",", 
      RowBox[{"phi10", ">", "0"}], ",", 
      RowBox[{"tp", ">", "0"}], ",", 
      RowBox[{"t", ">", "t0"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tc", "=", 
    RowBox[{"Pi", "/", "ww"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Set", " ", "up", " ", "Hamiltonian"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetNonCommutative", "[", 
    RowBox[{"sx", ",", "sy", ",", "sz"}], "]"}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6854280721762667`*^9, 3.685428156252984*^9}, {
   3.685428365025311*^9, 3.685428377730204*^9}, {3.685428591773527*^9, 
   3.685428743998624*^9}, {3.685428809659196*^9, 3.6854288144749947`*^9}, {
   3.6854289356614733`*^9, 3.685428982906287*^9}, {3.6854290605583076`*^9, 
   3.6854291812796717`*^9}, {3.685438584466955*^9, 3.685438606182131*^9}, {
   3.685438728756711*^9, 3.685438757684882*^9}, {3.6854430264239073`*^9, 
   3.6854430455273657`*^9}, {3.685443099688509*^9, 3.685443111700201*^9}, {
   3.685443186072546*^9, 3.685443357654079*^9}, {3.685443388373611*^9, 
   3.685443492840063*^9}, {3.685443672744789*^9, 3.6854437023164387`*^9}, {
   3.6854437482347507`*^9, 3.685443800007066*^9}, {3.685444080064969*^9, 
   3.6854441545573893`*^9}, {3.685444219494914*^9, 3.6854442521279097`*^9}, {
   3.685444325533291*^9, 3.685444331012267*^9}, {3.685444367714292*^9, 
   3.685444404112564*^9}, {3.685444442494067*^9, 3.685444608397945*^9}, {
   3.6854449240940228`*^9, 3.685445147075528*^9}, 3.685445246172552*^9, {
   3.685445288210637*^9, 3.68544546860104*^9}, {3.685445740690527*^9, 
   3.6854459347224703`*^9}, {3.685445985342507*^9, 3.685446183148288*^9}, 
   3.685446296111268*^9, 3.685446327406671*^9, {3.685446380002393*^9, 
   3.685446499635841*^9}, {3.685446564152755*^9, 3.6854465643893948`*^9}, {
   3.6854466020556173`*^9, 3.685446619941609*^9}, {3.685446697850505*^9, 
   3.685446698825523*^9}, {3.685446738304585*^9, 3.685446740815366*^9}, 
   3.685446775022687*^9, {3.685446807349608*^9, 3.685446907182836*^9}, {
   3.685446942589156*^9, 3.6854470153877487`*^9}, 3.68544706215914*^9, {
   3.685447104302463*^9, 3.685447258501079*^9}, {3.685447401915511*^9, 
   3.685447407458702*^9}, {3.685447521623539*^9, 3.685447830783773*^9}, {
   3.685447938795052*^9, 3.685448063475031*^9}, {3.685448094457341*^9, 
   3.685448139247037*^9}, {3.685448312534136*^9, 3.685448331293077*^9}, {
   3.685448747815238*^9, 3.6854487483913183`*^9}, {3.685448795861264*^9, 
   3.685448815756217*^9}, {3.685448863866296*^9, 3.6854488666662703`*^9}, {
   3.68544894970197*^9, 3.685448969876096*^9}, {3.685449124141901*^9, 
   3.6854491829291897`*^9}, {3.685449239055122*^9, 3.685449268372387*^9}, {
   3.685449343033641*^9, 3.685449401237926*^9}, {3.685449442387971*^9, 
   3.685449453594746*^9}, {3.685449521096662*^9, 3.685449672127655*^9}, {
   3.6854497671231947`*^9, 3.685449827288219*^9}, {3.685449969528926*^9, 
   3.685450108353345*^9}, {3.6854504132021513`*^9, 3.685450421305258*^9}, {
   3.685450503989087*^9, 3.685450523764933*^9}, {3.685450641533947*^9, 
   3.6854506430218277`*^9}, {3.6854507726794243`*^9, 3.685450773006978*^9}, {
   3.685450821492547*^9, 3.685450825460247*^9}, {3.685450869426158*^9, 
   3.685450869610022*^9}, {3.6854509536377153`*^9, 3.685450975660213*^9}, {
   3.685451020257968*^9, 3.685451029801701*^9}, {3.685451064479903*^9, 
   3.685451192360969*^9}, {3.685451355284073*^9, 3.685451410398123*^9}, {
   3.685451444924185*^9, 3.685451452299707*^9}, {3.685451790291039*^9, 
   3.685451795650496*^9}, {3.685451842232213*^9, 3.6854518652143717`*^9}, {
   3.685451899860577*^9, 3.685451907188558*^9}, {3.685452159831252*^9, 
   3.685452164870726*^9}, {3.685452287777194*^9, 3.6854523935626507`*^9}, {
   3.68545323905908*^9, 3.685453283628357*^9}, {3.685453316074792*^9, 
   3.685453373935953*^9}, {3.6854534055899057`*^9, 3.68545343116488*^9}, {
   3.685453461843294*^9, 3.6854535673969593`*^9}, {3.685453598836355*^9, 
   3.685453626490649*^9}, {3.685454172958167*^9, 3.6854542338509007`*^9}, 
   3.68545429215287*^9, {3.685454382939279*^9, 3.6854544167214117`*^9}, {
   3.685460676575384*^9, 3.6854607149674673`*^9}, {3.685461712132866*^9, 
   3.685461721484438*^9}, {3.685461910538969*^9, 3.685461929912917*^9}, {
   3.685467909913105*^9, 3.685467938720428*^9}, {3.685468004316504*^9, 
   3.685468039483872*^9}, {3.685468112494627*^9, 3.685468126346159*^9}, {
   3.6856770823420343`*^9, 3.685677087398638*^9}, {3.685677443212776*^9, 
   3.685677464555159*^9}, {3.685677533960013*^9, 3.685677610283165*^9}, {
   3.685677713797711*^9, 3.685677734996669*^9}, {3.685678055828665*^9, 
   3.68567808287997*^9}, {3.685678118626307*^9, 3.685678127225037*^9}, {
   3.685678160759049*^9, 3.685678161072011*^9}, {3.6856782033731422`*^9, 
   3.685678242226836*^9}, {3.685678275273377*^9, 3.685678281593624*^9}, {
   3.685678517561801*^9, 3.685678527992001*^9}, 3.6856810261894627`*^9, {
   3.685684500852409*^9, 3.685684511257571*^9}, 3.6856845609500513`*^9, {
   3.685684617647122*^9, 3.68568462478948*^9}, {3.68568467052174*^9, 
   3.685684672575316*^9}, {3.6856847462405567`*^9, 3.685684751670946*^9}, {
   3.6856847852129307`*^9, 3.685684798221465*^9}, {3.685684869852549*^9, 
   3.6856848716049433`*^9}, 3.6856849209776783`*^9, {3.685684963379821*^9, 
   3.685684993474588*^9}, {3.6856850453838673`*^9, 3.685685079150231*^9}, {
   3.6856851454279737`*^9, 3.685685199884295*^9}, {3.685685803137822*^9, 
   3.6856858196729603`*^9}, {3.685685890293558*^9, 3.68568590342048*^9}, {
   3.6856859444424753`*^9, 3.6856859738727217`*^9}, {3.685686009879936*^9, 
   3.685686060404449*^9}, 3.68568609225881*^9, {3.685686131824669*^9, 
   3.6856861713911533`*^9}, {3.685686397720549*^9, 3.685686405159937*^9}, {
   3.6856865848423367`*^9, 3.685686595097632*^9}, {3.6856868181547403`*^9, 
   3.685686833969338*^9}, {3.685687145758114*^9, 3.6856872547337627`*^9}, {
   3.6856875152263107`*^9, 3.685687553079838*^9}, {3.6856876776466293`*^9, 
   3.685687691350555*^9}, {3.685687788541012*^9, 3.685687791044339*^9}, 
   3.685687902788308*^9, {3.685687934198107*^9, 3.685687961424757*^9}, {
   3.6856883505193787`*^9, 3.68568835825502*^9}, {3.685688566812989*^9, 
   3.685688566948283*^9}, {3.6856886158259363`*^9, 3.68568863147302*^9}, {
   3.685688665255026*^9, 3.6856886663914547`*^9}, {3.6856887137661533`*^9, 
   3.685688777474218*^9}, {3.685688818919153*^9, 3.685688979799198*^9}, {
   3.685694321989048*^9, 3.685694587624444*^9}, {3.6856946664037952`*^9, 
   3.685694705697022*^9}, {3.6857017929912033`*^9, 3.685701817365686*^9}, {
   3.685701954366891*^9, 3.685701961030011*^9}, {3.68570204019425*^9, 
   3.685702040442431*^9}, {3.686056022731269*^9, 3.686056025865938*^9}, 
   3.686222529616403*^9, 3.6869020173826017`*^9, {3.686902081386014*^9, 
   3.686902178460608*^9}, {3.68690284700167*^9, 3.686902908118828*^9}, {
   3.686903871466975*^9, 3.686903888010007*^9}, {3.686933037851474*^9, 
   3.6869330774455366`*^9}, {3.6869331137645917`*^9, 
   3.6869332634208565`*^9}, {3.6869337007045827`*^9, 
   3.6869337059825907`*^9}, {3.686935558359727*^9, 3.686935583256764*^9}, {
   3.6869356218538313`*^9, 3.686935653508877*^9}, {3.6869359928404193`*^9, 
   3.6869360801775723`*^9}, {3.686936182417734*^9, 3.686936186351741*^9}, {
   3.6869391872982807`*^9, 3.6869392593933845`*^9}, {3.6869393041524625`*^9, 
   3.686939327938496*^9}, 3.68693941177462*^9, {3.6869394922027445`*^9, 
   3.6869394924927444`*^9}, {3.6869907545761137`*^9, 
   3.6869907571645193`*^9}, {3.6869908414498987`*^9, 
   3.6869908423431005`*^9}, {3.687060432655922*^9, 3.687060444542066*^9}, {
   3.687464392693749*^9, 3.6874644835620985`*^9}, {3.6874650304728203`*^9, 
   3.68746507189919*^9}, {3.6874651597022114`*^9, 3.6874652024066544`*^9}, {
   3.6875952592998123`*^9, 3.687595260875415*^9}, {3.6876342145274076`*^9, 
   3.6876342211106195`*^9}, 3.688473889606106*^9, {3.6884739299403667`*^9, 
   3.688473961208825*^9}, {3.707053676399847*^9, 3.707053679002863*^9}, {
   3.713243720544136*^9, 3.713243721513112*^9}, {3.7383270688136253`*^9, 
   3.7383270724464397`*^9}, {3.738328645527233*^9, 3.7383286489339733`*^9}, {
   3.7383434413734818`*^9, 3.738343455431286*^9}, {3.7383436088790627`*^9, 
   3.7383436625141306`*^9}},ExpressionUUID->"c397ca24-69a4-493f-91d3-\
ee70d5e86823"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.686936200390766*^9, 3.6869362012407675`*^9}, {
  3.7071103599744787`*^9, 
  3.70711036341159*^9}},ExpressionUUID->"1ba2070e-713d-4b94-acca-\
5db7a2ace5f9"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.713507286914978*^9, 
  3.713507288666814*^9}},ExpressionUUID->"6c5a2d12-093b-4ede-b78c-\
46a21d94da9b"],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
  "Define", " ", "basic", " ", "principles", " ", "of", " ", "Math", " ", 
   "Multiplication"}], "Subsection"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
  "Idea", " ", "from", " ", "the", " ", "same", " ", "stackexchange", " ", 
   "post", " ", "as", " ", "the", " ", "one", " ", "whose", " ", "link", " ", 
   "is", " ", "given", " ", "below", " ", "when", " ", "defining", " ", "the",
    " ", "commutator"}], "Subsubsection"]}], "Input",
 CellChangeTimes->{{3.707199907269494*^9, 3.707199947533094*^9}, {
  3.7071999839473553`*^9, 
  3.7072000287303667`*^9}},ExpressionUUID->"216b6541-5ed8-42d2-8113-\
a101a0036f9f"],

Cell[BoxData[
 RowBox[{"basic", " ", "Define", " ", "Math", " ", "Multiplication", " ", 
  "of", " ", "principles"}]], "Output",
 CellChangeTimes->{
  3.707200390696267*^9, 3.7072077532358093`*^9, 3.707207942666328*^9, 
   3.707208264414586*^9, 3.707213487675226*^9, 3.7072137703628073`*^9, 
   3.707214003215536*^9, 3.707214910916134*^9, 3.707219119423944*^9, 
   3.707221370392983*^9, 3.70807234986644*^9, 3.708075016633404*^9, 
   3.7080779089893503`*^9, 3.708078152726819*^9, 3.708085245810009*^9, 
   3.708249243560369*^9, 3.708249825895012*^9, 3.708258893887779*^9, 
   3.708267633393882*^9, 3.70831916003237*^9, 3.708321070490366*^9, 
   3.7083227037317944`*^9, 3.708322803145878*^9, 3.708322953641468*^9, 
   3.7083238186398153`*^9, 3.708324050677053*^9, 3.7083250673040323`*^9, 
   3.7083252684808073`*^9, 3.708325365498801*^9, 3.7083254117498903`*^9, 
   3.708325507075354*^9, 3.7083255641339493`*^9, {3.708331644821999*^9, 
   3.7083316684210367`*^9}, 3.708341955257514*^9, 3.709712849550269*^9, 
   3.709713023071327*^9, {3.709713102364616*^9, 3.709713117322776*^9}, 
   3.709713398544464*^9, 3.7128384051222763`*^9, 3.712924403809877*^9, 
   3.712924462702973*^9, 3.7129888022508574`*^9, 3.712989000092991*^9, 
   3.712990590494645*^9, 3.712991254862896*^9, 3.712992427487204*^9, 
   3.712992824211857*^9, 3.712997216066689*^9, 3.713005616026626*^9, 
   3.7130056844914513`*^9, 3.713006943175551*^9, 3.7130078825784197`*^9, 
   3.713008224510191*^9, 3.713175213245337*^9, 3.713240470666202*^9, 
   3.7132414580980053`*^9, 3.713241654357418*^9, 3.7132418595284777`*^9, 
   3.713243092977187*^9, 3.713243396907157*^9, {3.713243534517726*^9, 
   3.713243547052123*^9}, 3.7132440554910183`*^9, 3.7132441574589777`*^9, 
   3.7132442912224693`*^9, 3.71324440627297*^9, {3.713245629082117*^9, 
   3.713245658190596*^9}, 3.713245709699074*^9, 3.713245812380589*^9, 
   3.713250177525526*^9, 3.713250598358356*^9, 3.7132646099853563`*^9, 
   3.713265494627233*^9, {3.713265720149145*^9, 3.7132657439537983`*^9}, 
   3.713268807102416*^9, 3.7132688517857523`*^9, 3.713271301212556*^9, 
   3.713271405007127*^9, 3.7132717988282747`*^9, 3.71327190033178*^9, 
   3.71327239020154*^9, 3.713272656532425*^9, 3.7132748428243*^9, 
   3.7132753966222258`*^9, 3.71327816174093*^9, 3.7132783095039263`*^9, 
   3.7134639286657352`*^9, 3.713464336654071*^9, 3.7134666929855537`*^9, 
   3.713523872770049*^9, 3.7135242961321774`*^9, 3.713524559349369*^9, 
   3.7136728497853193`*^9, 3.713673190504858*^9, 3.7136874044729023`*^9, 
   3.713804858975506*^9, 3.7138549159314013`*^9, 3.713854958832399*^9, 
   3.713865972718472*^9, 3.7138753231108713`*^9, 3.713875945414609*^9, 
   3.713876132429997*^9, 3.7138770865082006`*^9, 3.713877145204359*^9, 
   3.713877420974777*^9, 3.7138775157306213`*^9, 3.713877553113906*^9, 
   3.714026030127915*^9, 3.714028011710791*^9, 3.714029686454919*^9, 
   3.714029718355152*^9, 3.7140299505898*^9, 3.714032029794148*^9, 
   3.714032598121167*^9, 3.714033527163602*^9, 3.7140370056334543`*^9, 
   3.714037662688613*^9, 3.7140377722958603`*^9, 3.714037916607338*^9, 
   3.714038463411227*^9, 3.714039022755406*^9, 3.714039316379922*^9, 
   3.714039451860523*^9, 3.714110037441347*^9, 3.7141327436864367`*^9, 
   3.7149010180147657`*^9, 3.7149013004154873`*^9, 3.715852051134026*^9, 
   3.715852220369259*^9, 3.715853102767915*^9, {3.715858487831047*^9, 
   3.7158585097589417`*^9}, 3.7158586259189777`*^9, 3.715858719390615*^9, 
   3.7158588423498917`*^9, 3.715861270624954*^9, 3.718524066259481*^9, 
   3.7225821395843067`*^9, 3.722584057945004*^9, 3.7225841505174313`*^9, 
   3.72258497512068*^9, 3.7225852120835114`*^9, 3.722585363477291*^9, 
   3.7225929121758623`*^9, 3.722596961539549*^9, 3.722597079949621*^9, 
   3.7225973744329023`*^9, 3.722597895627348*^9, 3.722862895958506*^9, 
   3.722863431223514*^9, 3.7228636626607037`*^9, 3.7228638881591387`*^9, 
   3.722864102053772*^9, 3.7228649723223333`*^9, 3.7228660613835363`*^9, 
   3.722866137377997*^9, 3.722866919174004*^9, 3.7228669727136497`*^9, 
   3.722867464697185*^9, 3.7228675939689837`*^9, 3.7228682336461477`*^9, 
   3.722869195700789*^9, 3.7228729188091516`*^9, 3.722937209634927*^9, 
   3.722938457249321*^9, 3.7229398254521437`*^9, 3.722940079271023*^9, 
   3.722941533475884*^9, 3.722941898939485*^9, 3.7229452938613253`*^9, 
   3.722945397120438*^9, 3.7233963393906107`*^9, 3.7233969012624035`*^9, 
   3.723398183241455*^9, 3.7233995004297686`*^9, 3.723401695950432*^9, 
   3.7234052252883577`*^9, 3.723823862566317*^9, 3.723908833425061*^9, 
   3.723908870408017*^9, 3.723908959058812*^9, 3.723975476564849*^9, 
   3.723976011356577*^9, 3.7239814886048326`*^9, 3.723982713699489*^9, 
   3.723983191271723*^9, {3.72398390299008*^9, 3.723983914598797*^9}, 
   3.723984061349018*^9, 3.723984160537047*^9, 3.723984698457007*^9, 
   3.7239847496462584`*^9, 3.7383266498686857`*^9, 3.738327116389976*^9, 
   3.738329381879903*^9, 3.7383296721575203`*^9, 3.738329736812819*^9, 
   3.738329773008362*^9, 3.738343389163496*^9, 3.7383437913585*^9, 
   3.738344643031213*^9, 3.7383464303104396`*^9, 3.7383465421088343`*^9, 
   3.738346817261572*^9, 
   3.7385836115064583`*^9},ExpressionUUID->"def05332-c18d-4a8f-927c-\
c141481853dc"],

Cell[BoxData[
 RowBox[{"as", " ", "below", " ", "commutator", " ", "defining", " ", "from", 
  " ", "given", " ", "Idea", " ", "is", " ", "link", " ", "one", " ", "post", 
  " ", "same", " ", "stackexchange", " ", 
  SuperscriptBox["the", "3"], " ", "when", " ", "whose"}]], "Output",
 CellChangeTimes->{
  3.707200390696267*^9, 3.7072077532358093`*^9, 3.707207942666328*^9, 
   3.707208264414586*^9, 3.707213487675226*^9, 3.7072137703628073`*^9, 
   3.707214003215536*^9, 3.707214910916134*^9, 3.707219119423944*^9, 
   3.707221370392983*^9, 3.70807234986644*^9, 3.708075016633404*^9, 
   3.7080779089893503`*^9, 3.708078152726819*^9, 3.708085245810009*^9, 
   3.708249243560369*^9, 3.708249825895012*^9, 3.708258893887779*^9, 
   3.708267633393882*^9, 3.70831916003237*^9, 3.708321070490366*^9, 
   3.7083227037317944`*^9, 3.708322803145878*^9, 3.708322953641468*^9, 
   3.7083238186398153`*^9, 3.708324050677053*^9, 3.7083250673040323`*^9, 
   3.7083252684808073`*^9, 3.708325365498801*^9, 3.7083254117498903`*^9, 
   3.708325507075354*^9, 3.7083255641339493`*^9, {3.708331644821999*^9, 
   3.7083316684210367`*^9}, 3.708341955257514*^9, 3.709712849550269*^9, 
   3.709713023071327*^9, {3.709713102364616*^9, 3.709713117322776*^9}, 
   3.709713398544464*^9, 3.7128384051222763`*^9, 3.712924403809877*^9, 
   3.712924462702973*^9, 3.7129888022508574`*^9, 3.712989000092991*^9, 
   3.712990590494645*^9, 3.712991254862896*^9, 3.712992427487204*^9, 
   3.712992824211857*^9, 3.712997216066689*^9, 3.713005616026626*^9, 
   3.7130056844914513`*^9, 3.713006943175551*^9, 3.7130078825784197`*^9, 
   3.713008224510191*^9, 3.713175213245337*^9, 3.713240470666202*^9, 
   3.7132414580980053`*^9, 3.713241654357418*^9, 3.7132418595284777`*^9, 
   3.713243092977187*^9, 3.713243396907157*^9, {3.713243534517726*^9, 
   3.713243547052123*^9}, 3.7132440554910183`*^9, 3.7132441574589777`*^9, 
   3.7132442912224693`*^9, 3.71324440627297*^9, {3.713245629082117*^9, 
   3.713245658190596*^9}, 3.713245709699074*^9, 3.713245812380589*^9, 
   3.713250177525526*^9, 3.713250598358356*^9, 3.7132646099853563`*^9, 
   3.713265494627233*^9, {3.713265720149145*^9, 3.7132657439537983`*^9}, 
   3.713268807102416*^9, 3.7132688517857523`*^9, 3.713271301212556*^9, 
   3.713271405007127*^9, 3.7132717988282747`*^9, 3.71327190033178*^9, 
   3.71327239020154*^9, 3.713272656532425*^9, 3.7132748428243*^9, 
   3.7132753966222258`*^9, 3.71327816174093*^9, 3.7132783095039263`*^9, 
   3.7134639286657352`*^9, 3.713464336654071*^9, 3.7134666929855537`*^9, 
   3.713523872770049*^9, 3.7135242961321774`*^9, 3.713524559349369*^9, 
   3.7136728497853193`*^9, 3.713673190504858*^9, 3.7136874044729023`*^9, 
   3.713804858975506*^9, 3.7138549159314013`*^9, 3.713854958832399*^9, 
   3.713865972718472*^9, 3.7138753231108713`*^9, 3.713875945414609*^9, 
   3.713876132429997*^9, 3.7138770865082006`*^9, 3.713877145204359*^9, 
   3.713877420974777*^9, 3.7138775157306213`*^9, 3.713877553113906*^9, 
   3.714026030127915*^9, 3.714028011710791*^9, 3.714029686454919*^9, 
   3.714029718355152*^9, 3.7140299505898*^9, 3.714032029794148*^9, 
   3.714032598121167*^9, 3.714033527163602*^9, 3.7140370056334543`*^9, 
   3.714037662688613*^9, 3.7140377722958603`*^9, 3.714037916607338*^9, 
   3.714038463411227*^9, 3.714039022755406*^9, 3.714039316379922*^9, 
   3.714039451860523*^9, 3.714110037441347*^9, 3.7141327436864367`*^9, 
   3.7149010180147657`*^9, 3.7149013004154873`*^9, 3.715852051134026*^9, 
   3.715852220369259*^9, 3.715853102767915*^9, {3.715858487831047*^9, 
   3.7158585097589417`*^9}, 3.7158586259189777`*^9, 3.715858719390615*^9, 
   3.7158588423498917`*^9, 3.715861270624954*^9, 3.718524066259481*^9, 
   3.7225821395843067`*^9, 3.722584057945004*^9, 3.7225841505174313`*^9, 
   3.72258497512068*^9, 3.7225852120835114`*^9, 3.722585363477291*^9, 
   3.7225929121758623`*^9, 3.722596961539549*^9, 3.722597079949621*^9, 
   3.7225973744329023`*^9, 3.722597895627348*^9, 3.722862895958506*^9, 
   3.722863431223514*^9, 3.7228636626607037`*^9, 3.7228638881591387`*^9, 
   3.722864102053772*^9, 3.7228649723223333`*^9, 3.7228660613835363`*^9, 
   3.722866137377997*^9, 3.722866919174004*^9, 3.7228669727136497`*^9, 
   3.722867464697185*^9, 3.7228675939689837`*^9, 3.7228682336461477`*^9, 
   3.722869195700789*^9, 3.7228729188091516`*^9, 3.722937209634927*^9, 
   3.722938457249321*^9, 3.7229398254521437`*^9, 3.722940079271023*^9, 
   3.722941533475884*^9, 3.722941898939485*^9, 3.7229452938613253`*^9, 
   3.722945397120438*^9, 3.7233963393906107`*^9, 3.7233969012624035`*^9, 
   3.723398183241455*^9, 3.7233995004297686`*^9, 3.723401695950432*^9, 
   3.7234052252883577`*^9, 3.723823862566317*^9, 3.723908833425061*^9, 
   3.723908870408017*^9, 3.723908959058812*^9, 3.723975476564849*^9, 
   3.723976011356577*^9, 3.7239814886048326`*^9, 3.723982713699489*^9, 
   3.723983191271723*^9, {3.72398390299008*^9, 3.723983914598797*^9}, 
   3.723984061349018*^9, 3.723984160537047*^9, 3.723984698457007*^9, 
   3.7239847496462584`*^9, 3.7383266498686857`*^9, 3.738327116389976*^9, 
   3.738329381879903*^9, 3.7383296721575203`*^9, 3.738329736812819*^9, 
   3.738329773008362*^9, 3.738343389163496*^9, 3.7383437913585*^9, 
   3.738344643031213*^9, 3.7383464303104396`*^9, 3.7383465421088343`*^9, 
   3.738346817261572*^9, 
   3.738583611512784*^9},ExpressionUUID->"e4f27691-88b3-44cb-b2f1-\
99fd0a2ec795"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"lower", "-", 
     RowBox[{"case", ":", "  ", 
      RowBox[{
       RowBox[{"(", "usually", ")"}], " ", "operator"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"upper", "-", 
     RowBox[{"case", ":", "  ", "scalar"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"a_", ",", "a_"}], "]"}], ":=", 
     RowBox[{"a", ".", "a"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"a_", ",", "C_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"C", " ", "a"}], " ", "/;", " ", 
      RowBox[{"CommutativeQ", "[", "C", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"C_", ",", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"C", " ", "a"}], " ", "/;", " ", 
      RowBox[{"CommutativeQ", "[", "C", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{
       RowBox[{"Plus", "[", 
        RowBox[{"a_", ",", "addends__"}], "]"}], ",", "b_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"MatM", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "+", 
      RowBox[{"MatM", "[", 
       RowBox[{
        RowBox[{"Plus", "[", "addends", "]"}], ",", "b"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"Plus", "[", 
        RowBox[{"b_", ",", "baddends_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"MatM", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "+", 
      RowBox[{"MatM", "[", 
       RowBox[{"a", ",", 
        RowBox[{"Plus", "[", "baddends", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{
       RowBox[{"Times", "[", 
        RowBox[{"C_", ",", "factors__"}], "]"}], ",", "b_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"C", " ", 
       RowBox[{"MatM", "[", 
        RowBox[{
         RowBox[{"Times", "[", "factors", "]"}], ",", "b"}], "]"}]}], " ", "/;",
       " ", 
      RowBox[{"CommutativeQ", "[", "C", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"Times", "[", 
        RowBox[{"C_", ",", "factors__"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"C", " ", 
       RowBox[{"MatM", "[", 
        RowBox[{"a", ",", 
         RowBox[{"Times", "[", "factors", "]"}]}], "]"}]}], " ", "/;", " ", 
      RowBox[{"CommutativeQ", "[", "C", "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.707144967307352*^9, 3.707145063736967*^9}, 
   3.707145390209306*^9, {3.707145484478651*^9, 3.707145501379898*^9}, {
   3.7071455325701847`*^9, 3.707145563592757*^9}, {3.7071456246857758`*^9, 
   3.70714564203738*^9}, {3.7071456893465357`*^9, 3.7071459120638103`*^9}, {
   3.707146006482107*^9, 3.707146042377239*^9}, {3.707146084645227*^9, 
   3.7071462297281733`*^9}, {3.707147195001252*^9, 
   3.7071472053605967`*^9}},ExpressionUUID->"4c722c32-8986-4382-b985-\
5ed8d352bedb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatM", "[", 
  RowBox[{"a", ",", 
   RowBox[{"b", "+", "c"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatM", "[", 
  RowBox[{"c", ",", 
   RowBox[{"I", 
    RowBox[{"(", " ", 
     RowBox[{"b", "+", "c"}], ")"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.707147068888291*^9, 3.7071470701855907`*^9}, {
  3.707147103141281*^9, 3.707147131140129*^9}, {3.707147176556802*^9, 
  3.707147185201355*^9}},ExpressionUUID->"ef4d6b76-dd69-4ca5-8a29-\
44bc36ef55cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatM", "[", 
   RowBox[{"a", ",", "b"}], "]"}], "+", 
  RowBox[{"MatM", "[", 
   RowBox[{"a", ",", "c"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.707147105998897*^9, 3.707147131521646*^9}, {
   3.707147178669676*^9, 3.707147206630189*^9}, 3.707200066270007*^9, 
   3.7072003907184687`*^9, 3.707207753267054*^9, 3.707207942695545*^9, 
   3.707208264443851*^9, 3.7072134877039137`*^9, 3.707213770393611*^9, 
   3.707214003243682*^9, 3.70721491094538*^9, 3.707219119455327*^9, 
   3.707221370429689*^9, 3.708072349983358*^9, 3.708075016712679*^9, 
   3.708077909055324*^9, 3.708078152800376*^9, 3.70808524590903*^9, 
   3.7082492436330338`*^9, 3.7082498259531403`*^9, 3.708258893963339*^9, 
   3.708267633449973*^9, 3.708319160099332*^9, 3.7083210705654488`*^9, 
   3.708322703799308*^9, 3.708322803229823*^9, 3.70832295371413*^9, 
   3.708323818721108*^9, 3.7083240507560387`*^9, 3.708325067383452*^9, 
   3.708325268560877*^9, 3.708325365571549*^9, 3.708325411825303*^9, 
   3.7083255071682863`*^9, 3.708325564214341*^9, {3.708331644905621*^9, 
   3.7083316684896107`*^9}, 3.7083419553233624`*^9, 3.70971284966757*^9, 
   3.70971302313472*^9, {3.709713102428535*^9, 3.709713117398479*^9}, 
   3.709713398609098*^9, 3.712838405215136*^9, 3.712924403887779*^9, 
   3.712924462767399*^9, 3.7129888023336563`*^9, 3.712989000141281*^9, 
   3.7129905905616093`*^9, 3.7129912549422693`*^9, 3.7129924275614843`*^9, 
   3.712992824268454*^9, 3.712997216172027*^9, 3.713005616099576*^9, 
   3.713005684571073*^9, 3.713006943259503*^9, 3.713007882654684*^9, 
   3.7130082245926237`*^9, 3.713175213457747*^9, 3.713240470748909*^9, 
   3.713241458162882*^9, 3.713241654420042*^9, 3.7132418595835667`*^9, 
   3.7132430930389767`*^9, 3.713243396981702*^9, {3.71324353459321*^9, 
   3.713243547135949*^9}, 3.713244055564796*^9, 3.713244157523336*^9, 
   3.713244291297696*^9, 3.7132444063388243`*^9, {3.713245629147011*^9, 
   3.713245658254457*^9}, 3.713245709786578*^9, 3.713245812442593*^9, 
   3.7132501776035233`*^9, 3.7132505984386168`*^9, 3.713264610056563*^9, 
   3.7132654946904182`*^9, {3.713265720214552*^9, 3.713265744033415*^9}, 
   3.713268807220626*^9, 3.713268851850733*^9, 3.713271301294113*^9, 
   3.713271405073349*^9, 3.7132717988945723`*^9, 3.713271900406559*^9, 
   3.713272390285162*^9, 3.713272656617457*^9, 3.713274842913913*^9, 
   3.713275396725268*^9, 3.713278161844688*^9, 3.7132783096088667`*^9, 
   3.713463928802743*^9, 3.713464336766077*^9, 3.713466693068866*^9, 
   3.713523872920912*^9, 3.713524296199144*^9, 3.713524559424005*^9, 
   3.7136728501052847`*^9, 3.713673190530918*^9, 3.713687404498542*^9, 
   3.7138048591088877`*^9, 3.713854915982101*^9, 3.713854958899556*^9, 
   3.713865972786634*^9, 3.713875323181212*^9, 3.713875945463674*^9, 
   3.713876132479292*^9, 3.713877086559662*^9, 3.713877145255254*^9, 
   3.713877421024825*^9, 3.7138775157924023`*^9, 3.713877553188962*^9, 
   3.7140260302101316`*^9, 3.7140280117545*^9, 3.714029686505413*^9, 
   3.714029718447702*^9, 3.7140299506819267`*^9, 3.714032029844254*^9, 
   3.714032598210843*^9, 3.7140335272137203`*^9, 3.714037005702262*^9, 
   3.7140376627601357`*^9, 3.7140377723646317`*^9, 3.71403791667852*^9, 
   3.714038463483368*^9, 3.7140390228296423`*^9, 3.7140393164462013`*^9, 
   3.7140394519137917`*^9, 3.7141100375088663`*^9, 3.714132743773786*^9, 
   3.714901018132758*^9, 3.714901300522398*^9, 3.715852051218624*^9, 
   3.715852220434187*^9, 3.715853102848624*^9, {3.7158584879147053`*^9, 
   3.7158585098472023`*^9}, 3.715858625988985*^9, 3.715858719464419*^9, 
   3.715858842405356*^9, 3.715861270695837*^9, 3.718524066340013*^9, 
   3.722582139654456*^9, 3.722584058019824*^9, 3.72258415059354*^9, 
   3.7225849751961308`*^9, 3.7225852148518267`*^9, 3.722585363526662*^9, 
   3.7225929122519073`*^9, 3.722596961616563*^9, 3.722597082574698*^9, 
   3.72259737746133*^9, 3.722597895678846*^9, 3.722862896073677*^9, 
   3.722863431289921*^9, 3.722863662727233*^9, 3.722863888208556*^9, 
   3.7228641021138*^9, 3.722864972372204*^9, 3.722866061433901*^9, 
   3.722866137437937*^9, 3.722866921817396*^9, 3.7228669727973013`*^9, 
   3.722867464747109*^9, 3.722867594015791*^9, 3.72286823370704*^9, 
   3.722869195745185*^9, 3.7228729188849277`*^9, 3.722937209655219*^9, 
   3.722938457279887*^9, 3.722939825483385*^9, 3.722940079289365*^9, 
   3.722941533522637*^9, 3.722941898959084*^9, 3.722945293876322*^9, 
   3.722945397138308*^9, 3.7233963395934105`*^9, 3.7233969013560033`*^9, 
   3.7233981833350554`*^9, 3.7233995005389686`*^9, 3.7234016963092327`*^9, 
   3.723405225388098*^9, 3.723823862632927*^9, 3.723908833491811*^9, 
   3.723908870470456*^9, 3.723908959124324*^9, 3.723975476639683*^9, 
   3.72397601143211*^9, 3.723981488672958*^9, 3.723982713766398*^9, 
   3.7239831913477163`*^9, {3.7239839055711193`*^9, 3.723983914675118*^9}, 
   3.723984063819034*^9, 3.723984160603702*^9, 3.7239846985322857`*^9, 
   3.7239847497472*^9, 3.738326649973633*^9, 3.738327116484775*^9, 
   3.7383293819548903`*^9, 3.738329672249786*^9, 3.7383297368962803`*^9, 
   3.738329773090971*^9, 3.7383433892645016`*^9, 3.7383437914175034`*^9, 
   3.738344643086216*^9, 3.738346430336441*^9, 3.7383465421358356`*^9, 
   3.7383468172895737`*^9, 
   3.7385836115917273`*^9},ExpressionUUID->"c58f1fea-de1f-403e-b544-\
5bfe65efd992"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"c", ".", "c"}], "+", 
    RowBox[{"MatM", "[", 
     RowBox[{"c", ",", "b"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.707147105998897*^9, 3.707147131521646*^9}, {
   3.707147178669676*^9, 3.707147206630189*^9}, 3.707200066270007*^9, 
   3.7072003907184687`*^9, 3.707207753267054*^9, 3.707207942695545*^9, 
   3.707208264443851*^9, 3.7072134877039137`*^9, 3.707213770393611*^9, 
   3.707214003243682*^9, 3.70721491094538*^9, 3.707219119455327*^9, 
   3.707221370429689*^9, 3.708072349983358*^9, 3.708075016712679*^9, 
   3.708077909055324*^9, 3.708078152800376*^9, 3.70808524590903*^9, 
   3.7082492436330338`*^9, 3.7082498259531403`*^9, 3.708258893963339*^9, 
   3.708267633449973*^9, 3.708319160099332*^9, 3.7083210705654488`*^9, 
   3.708322703799308*^9, 3.708322803229823*^9, 3.70832295371413*^9, 
   3.708323818721108*^9, 3.7083240507560387`*^9, 3.708325067383452*^9, 
   3.708325268560877*^9, 3.708325365571549*^9, 3.708325411825303*^9, 
   3.7083255071682863`*^9, 3.708325564214341*^9, {3.708331644905621*^9, 
   3.7083316684896107`*^9}, 3.7083419553233624`*^9, 3.70971284966757*^9, 
   3.70971302313472*^9, {3.709713102428535*^9, 3.709713117398479*^9}, 
   3.709713398609098*^9, 3.712838405215136*^9, 3.712924403887779*^9, 
   3.712924462767399*^9, 3.7129888023336563`*^9, 3.712989000141281*^9, 
   3.7129905905616093`*^9, 3.7129912549422693`*^9, 3.7129924275614843`*^9, 
   3.712992824268454*^9, 3.712997216172027*^9, 3.713005616099576*^9, 
   3.713005684571073*^9, 3.713006943259503*^9, 3.713007882654684*^9, 
   3.7130082245926237`*^9, 3.713175213457747*^9, 3.713240470748909*^9, 
   3.713241458162882*^9, 3.713241654420042*^9, 3.7132418595835667`*^9, 
   3.7132430930389767`*^9, 3.713243396981702*^9, {3.71324353459321*^9, 
   3.713243547135949*^9}, 3.713244055564796*^9, 3.713244157523336*^9, 
   3.713244291297696*^9, 3.7132444063388243`*^9, {3.713245629147011*^9, 
   3.713245658254457*^9}, 3.713245709786578*^9, 3.713245812442593*^9, 
   3.7132501776035233`*^9, 3.7132505984386168`*^9, 3.713264610056563*^9, 
   3.7132654946904182`*^9, {3.713265720214552*^9, 3.713265744033415*^9}, 
   3.713268807220626*^9, 3.713268851850733*^9, 3.713271301294113*^9, 
   3.713271405073349*^9, 3.7132717988945723`*^9, 3.713271900406559*^9, 
   3.713272390285162*^9, 3.713272656617457*^9, 3.713274842913913*^9, 
   3.713275396725268*^9, 3.713278161844688*^9, 3.7132783096088667`*^9, 
   3.713463928802743*^9, 3.713464336766077*^9, 3.713466693068866*^9, 
   3.713523872920912*^9, 3.713524296199144*^9, 3.713524559424005*^9, 
   3.7136728501052847`*^9, 3.713673190530918*^9, 3.713687404498542*^9, 
   3.7138048591088877`*^9, 3.713854915982101*^9, 3.713854958899556*^9, 
   3.713865972786634*^9, 3.713875323181212*^9, 3.713875945463674*^9, 
   3.713876132479292*^9, 3.713877086559662*^9, 3.713877145255254*^9, 
   3.713877421024825*^9, 3.7138775157924023`*^9, 3.713877553188962*^9, 
   3.7140260302101316`*^9, 3.7140280117545*^9, 3.714029686505413*^9, 
   3.714029718447702*^9, 3.7140299506819267`*^9, 3.714032029844254*^9, 
   3.714032598210843*^9, 3.7140335272137203`*^9, 3.714037005702262*^9, 
   3.7140376627601357`*^9, 3.7140377723646317`*^9, 3.71403791667852*^9, 
   3.714038463483368*^9, 3.7140390228296423`*^9, 3.7140393164462013`*^9, 
   3.7140394519137917`*^9, 3.7141100375088663`*^9, 3.714132743773786*^9, 
   3.714901018132758*^9, 3.714901300522398*^9, 3.715852051218624*^9, 
   3.715852220434187*^9, 3.715853102848624*^9, {3.7158584879147053`*^9, 
   3.7158585098472023`*^9}, 3.715858625988985*^9, 3.715858719464419*^9, 
   3.715858842405356*^9, 3.715861270695837*^9, 3.718524066340013*^9, 
   3.722582139654456*^9, 3.722584058019824*^9, 3.72258415059354*^9, 
   3.7225849751961308`*^9, 3.7225852148518267`*^9, 3.722585363526662*^9, 
   3.7225929122519073`*^9, 3.722596961616563*^9, 3.722597082574698*^9, 
   3.72259737746133*^9, 3.722597895678846*^9, 3.722862896073677*^9, 
   3.722863431289921*^9, 3.722863662727233*^9, 3.722863888208556*^9, 
   3.7228641021138*^9, 3.722864972372204*^9, 3.722866061433901*^9, 
   3.722866137437937*^9, 3.722866921817396*^9, 3.7228669727973013`*^9, 
   3.722867464747109*^9, 3.722867594015791*^9, 3.72286823370704*^9, 
   3.722869195745185*^9, 3.7228729188849277`*^9, 3.722937209655219*^9, 
   3.722938457279887*^9, 3.722939825483385*^9, 3.722940079289365*^9, 
   3.722941533522637*^9, 3.722941898959084*^9, 3.722945293876322*^9, 
   3.722945397138308*^9, 3.7233963395934105`*^9, 3.7233969013560033`*^9, 
   3.7233981833350554`*^9, 3.7233995005389686`*^9, 3.7234016963092327`*^9, 
   3.723405225388098*^9, 3.723823862632927*^9, 3.723908833491811*^9, 
   3.723908870470456*^9, 3.723908959124324*^9, 3.723975476639683*^9, 
   3.72397601143211*^9, 3.723981488672958*^9, 3.723982713766398*^9, 
   3.7239831913477163`*^9, {3.7239839055711193`*^9, 3.723983914675118*^9}, 
   3.723984063819034*^9, 3.723984160603702*^9, 3.7239846985322857`*^9, 
   3.7239847497472*^9, 3.738326649973633*^9, 3.738327116484775*^9, 
   3.7383293819548903`*^9, 3.738329672249786*^9, 3.7383297368962803`*^9, 
   3.738329773090971*^9, 3.7383433892645016`*^9, 3.7383437914175034`*^9, 
   3.738344643086216*^9, 3.738346430336441*^9, 3.7383465421358356`*^9, 
   3.7383468172895737`*^9, 
   3.738583611598979*^9},ExpressionUUID->"89b9692d-a4fc-48f4-9357-\
77e5115e6851"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"c", ".", "c"}], "+", 
    RowBox[{"MatM", "[", 
     RowBox[{"c", ",", "b"}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.7072005486450853`*^9, 
  3.7072005579411097`*^9}},ExpressionUUID->"7f6f8020-75c4-4947-847d-\
46fe016a1d0e"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"c", ".", "c"}], "+", 
    RowBox[{"MatM", "[", 
     RowBox[{"c", ",", "b"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.707207753291656*^9, 3.707207942721518*^9, 3.707208264448893*^9, 
   3.7072134877285843`*^9, 3.707213770420802*^9, 3.7072140032682056`*^9, 
   3.707214910970434*^9, 3.7072191194811077`*^9, 3.70722137045785*^9, 
   3.7080750167521152`*^9, 3.7080779091003447`*^9, 3.708078152843883*^9, 
   3.708085245971113*^9, 3.70824924367043*^9, 3.708249825990567*^9, 
   3.708258894013104*^9, 3.708267633508891*^9, 3.7083191601383123`*^9, 
   3.7083210706145487`*^9, 3.7083227038402653`*^9, 3.7083228032785*^9, 
   3.7083229537899933`*^9, 3.708323818762065*^9, 3.7083240507979603`*^9, 
   3.708325067424677*^9, 3.7083252686072598`*^9, 3.708325365613576*^9, 
   3.7083254118674383`*^9, 3.7083255072505283`*^9, 3.708325564263036*^9, {
   3.708331644970974*^9, 3.708331668539797*^9}, 3.7083419553792467`*^9, 
   3.7097128497108793`*^9, 3.70971302317308*^9, {3.709713102470039*^9, 
   3.709713117506606*^9}, 3.709713398647296*^9, 3.712838405281938*^9, 
   3.7129244039270277`*^9, 3.7129244628052273`*^9, 3.712988802378769*^9, 
   3.712989000181713*^9, 3.712990590601688*^9, 3.712991254989778*^9, 
   3.7129924276035423`*^9, 3.712992824328162*^9, 3.712997216224863*^9, 
   3.71300561614359*^9, 3.713005684636613*^9, 3.713006943345783*^9, 
   3.7130078827197437`*^9, 3.7130082246604757`*^9, 3.7131752135706043`*^9, 
   3.713240470797709*^9, 3.713241458198348*^9, 3.713241654456172*^9, 
   3.713241859619968*^9, 3.7132430930764017`*^9, 3.713243397018347*^9, {
   3.7132435346302013`*^9, 3.71324354719458*^9}, 3.713244055608786*^9, 
   3.713244157560341*^9, 3.713244291335867*^9, 3.713244406376742*^9, {
   3.7132456291851892`*^9, 3.71324565830294*^9}, 3.713245709844269*^9, 
   3.713245812480876*^9, 3.713250177644409*^9, 3.713250598481222*^9, 
   3.713264610097044*^9, 3.713265494731086*^9, {3.713265720281557*^9, 
   3.71326574413319*^9}, 3.713268807283352*^9, 3.713268851889894*^9, 
   3.713271301382351*^9, 3.71327140511547*^9, 3.713271798937235*^9, 
   3.713271900474311*^9, 3.713272390351316*^9, 3.713272656690877*^9, 
   3.7132748429755383`*^9, 3.713275396785819*^9, 3.713278161961668*^9, 
   3.713278309870755*^9, 3.713463928908749*^9, 3.713464336832081*^9, 
   3.713466693119924*^9, 3.7135238730453043`*^9, 3.713524296255546*^9, 
   3.713524559480864*^9, 3.7136728502023773`*^9, 3.713673190555341*^9, 
   3.713687404517983*^9, 3.713804859275522*^9, 3.71385491603069*^9, 
   3.713854958933062*^9, 3.713865972824725*^9, 3.7138753232471724`*^9, 
   3.713875945523342*^9, 3.713876132521659*^9, 3.713877086616596*^9, 
   3.71387714529751*^9, 3.7138774210669107`*^9, 3.7138775158427563`*^9, 
   3.7138775532235622`*^9, 3.7140260302602*^9, 3.7140280117851152`*^9, 
   3.714029686542575*^9, 3.714029718497738*^9, 3.7140299507325*^9, 
   3.714032029877513*^9, 3.714032598248385*^9, 3.714033527256221*^9, 
   3.714037005780815*^9, 3.714037662809389*^9, 3.714037772413796*^9, 
   3.714037916714167*^9, 3.714038463532551*^9, 3.71403902287206*^9, 
   3.7140393164891987`*^9, 3.714039451971324*^9, 3.71411003755345*^9, 
   3.714132743824519*^9, 3.714901018181003*^9, 3.714901300572672*^9, 
   3.71585205126849*^9, 3.715852220468956*^9, 3.7158531028989162`*^9, {
   3.715858487963443*^9, 3.715858509898118*^9}, 3.715858626025313*^9, 
   3.715858719498887*^9, 3.715858842462719*^9, 3.715861270736245*^9, 
   3.7185240663925047`*^9, 3.722582139701022*^9, 3.722584058053175*^9, 
   3.722584150624467*^9, 3.72258497522917*^9, 3.7225852148869133`*^9, 
   3.722585363570838*^9, 3.72259291228596*^9, 3.7225969644455967`*^9, 
   3.722597082901072*^9, 3.722597377510413*^9, 3.722597895719942*^9, 
   3.72286289612541*^9, 3.722863431339808*^9, 3.72286366275976*^9, 
   3.722863888239193*^9, 3.722864102147477*^9, 3.722864972414982*^9, 
   3.722866061528616*^9, 3.722866137470586*^9, 3.7228669220924463`*^9, 
   3.7228669728435173`*^9, 3.72286746478983*^9, 3.7228675940595293`*^9, 
   3.722868233740602*^9, 3.722869195779169*^9, 3.7228729189193*^9, 
   3.7229372096682253`*^9, 3.722938457299644*^9, 3.722939825488065*^9, 
   3.722940079300789*^9, 3.7229415335452642`*^9, 3.722941898971912*^9, 
   3.722945293887863*^9, 3.722945397150342*^9, 3.723396339936611*^9, 
   3.7233969014028034`*^9, 3.723398183381855*^9, 3.723399500616969*^9, 
   3.723401696387233*^9, 3.723405225421163*^9, 3.723823862681705*^9, 
   3.723908833530004*^9, 3.723908870520473*^9, 3.7239089616384573`*^9, 
   3.7239754766793737`*^9, 3.723976011472443*^9, 3.72398148872253*^9, 
   3.723982713807609*^9, 3.723983191386549*^9, {3.723983905871023*^9, 
   3.723983914715226*^9}, 3.723984064114696*^9, 3.723984162988242*^9, 
   3.72398469857292*^9, 3.7239847498054113`*^9, 3.7383266500830927`*^9, 
   3.738327116541625*^9, 3.738329382004689*^9, 3.73832967231246*^9, 
   3.73832973694405*^9, 3.738329773143215*^9, 3.7383433893195047`*^9, 
   3.738343791459506*^9, 3.7383446431282187`*^9, 3.738346430350442*^9, 
   3.7383465421498365`*^9, 3.738346817303574*^9, 
   3.738583611638596*^9},ExpressionUUID->"55d970ca-5980-4088-a44c-\
5d2c3016d588"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"rules", " ", "for", " ", "multiplying", " ", "sigma"}], "-", 
    "matrices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sigma", "[", "ii_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"ii", ",", "1"}], "]"}], "sx"}], "+", 
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"ii", ",", "2"}], "]"}], "sy"}], "+", 
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"ii", ",", "3"}], "]"}], "sz"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"SigmaRules", "=", 
      RowBox[{"{", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MatM", "[", 
             RowBox[{
              RowBox[{"sigma", "[", "ii", "]"}], ",", 
              RowBox[{"sigma", "[", "jj", "]"}]}], "]"}], "->", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"KroneckerDelta", "[", 
               RowBox[{"ii", ",", "jj"}], "]"}], "id"}], "+", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"I", " ", 
                RowBox[{
                 RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"ii", ",", "jj", ",", "kk"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"kk", ",", "3"}], "}"}]}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "3"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "3"}], "}"}]}], "]"}], "}"}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetNonCommutative", "[", 
     RowBox[{"sx", ",", "sy", ",", "sz"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SigmaRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"MatM", "[", 
         RowBox[{"sx", ",", "sy"}], "]"}], "\[Rule]", 
        RowBox[{"I", " ", "sz"}]}], ",", 
       RowBox[{
        RowBox[{"MatM", "[", 
         RowBox[{"sy", ",", "sx"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "sz"}]}], ",", 
       RowBox[{
        RowBox[{"MatM", "[", 
         RowBox[{"sy", ",", "sz"}], "]"}], "\[Rule]", 
        RowBox[{"I", " ", "sx"}]}], ",", 
       RowBox[{
        RowBox[{"MatM", "[", 
         RowBox[{"sz", ",", "sy"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "sx"}]}], ",", 
       RowBox[{
        RowBox[{"MatM", "[", 
         RowBox[{"sz", ",", "sx"}], "]"}], "\[Rule]", 
        RowBox[{"I", " ", "sy"}]}], ",", 
       RowBox[{
        RowBox[{"MatM", "[", 
         RowBox[{"sx", ",", "sz"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "sy"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SigmaMRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sx", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"sy", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "I"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"I", ",", "0"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"sz", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SigmaComRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{"sx", ",", "sy"}], "]"}], "\[Rule]", 
        RowBox[{"2", "I", " ", "sz"}]}], ",", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{"sy", ",", "sx"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "2"}], "I", " ", "sz"}]}], ",", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{"sy", ",", "sz"}], "]"}], "\[Rule]", 
        RowBox[{"2", "I", " ", "sx"}]}], ",", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{"sz", ",", "sy"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "2"}], "I", " ", "sx"}]}], ",", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{"sz", ",", "sx"}], "]"}], "\[Rule]", 
        RowBox[{"2", "I", " ", "sy"}]}], ",", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{"sx", ",", "sz"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "2"}], "I", " ", "sy"}]}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7072005592454233`*^9, 3.707200560236704*^9}, {
  3.707200606036077*^9, 3.70720073467288*^9}, {3.707200773608013*^9, 
  3.707200954571744*^9}, {3.707201049961164*^9, 3.707201178782775*^9}, {
  3.707201349066576*^9, 3.707201372792913*^9}, {3.70720256857242*^9, 
  3.707202617059319*^9}, {3.707202682241213*^9, 3.707202778974551*^9}, {
  3.707205898649386*^9, 3.707205929119828*^9}, {3.707206008958642*^9, 
  3.707206020821785*^9}, {3.707206082589411*^9, 3.707206083764413*^9}, {
  3.707206482466934*^9, 3.707206546648831*^9}, {3.707206585360615*^9, 
  3.707206610071673*^9}, {3.70721371509057*^9, 3.70721374536127*^9}, {
  3.7083349329182863`*^9, 
  3.708334997097377*^9}},ExpressionUUID->"0bbddc1d-3f62-43ff-807b-\
86b45d7253ea"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatM", "[", 
  RowBox[{"w", ",", "q"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatM", "[", 
  RowBox[{"sx", ",", "sy"}], "]"}]}], "Input",
 CellChangeTimes->{{3.707213656620713*^9, 
  3.707213675194297*^9}},ExpressionUUID->"a01a8235-36c3-430d-8461-\
19c7114d6214"],

Cell[BoxData[
 RowBox[{"MatM", "[", 
  RowBox[{"w", ",", "q"}], "]"}]], "Output",
 CellChangeTimes->{{3.7072136663835573`*^9, 3.707213675528854*^9}, {
   3.7072137483754597`*^9, 3.70721377045287*^9}, 3.7072140032986317`*^9, 
   3.707214911001442*^9, 3.707219119528315*^9, 3.707221370493095*^9, 
   3.7080723500831337`*^9, 3.708075016829918*^9, 3.7080779091740637`*^9, 
   3.708078152917234*^9, 3.708085246036187*^9, 3.708249243733411*^9, 
   3.708249826076277*^9, 3.708258894071021*^9, 3.708267633577592*^9, 
   3.708319160268355*^9, 3.708321070699435*^9, 3.7083227039404163`*^9, 
   3.7083228033381977`*^9, 3.708322953866434*^9, 3.708323818954124*^9, 
   3.708324050924574*^9, 3.7083250675106497`*^9, 3.7083252686767693`*^9, 
   3.708325365688134*^9, 3.708325411941334*^9, 3.7083255073268213`*^9, 
   3.708325564329727*^9, {3.70833164510168*^9, 3.70833166859828*^9}, 
   3.708341955447019*^9, 3.709712849784639*^9, 3.709713023234666*^9, {
   3.709713102529305*^9, 3.7097131176601*^9}, 3.709713398708873*^9, 
   3.712838405379237*^9, 3.712924403987207*^9, 3.712924462867733*^9, 
   3.7129888024508047`*^9, 3.7129890002275476`*^9, 3.712990590661023*^9, 
   3.7129912550592613`*^9, 3.71299242767349*^9, 3.7129928243947887`*^9, 
   3.712997216305356*^9, 3.713005616216855*^9, 3.71300568470278*^9, 
   3.713006943425274*^9, 3.713007882825069*^9, 3.713008224726891*^9, 
   3.7131752137509127`*^9, 3.7132404708978767`*^9, 3.713241458262855*^9, 
   3.7132416545201406`*^9, 3.713241859685236*^9, 3.713243093139688*^9, 
   3.713243397082624*^9, {3.71324353469381*^9, 3.713243547297708*^9}, 
   3.713244055675705*^9, 3.7132441576242437`*^9, 3.713244291397427*^9, 
   3.713244406439084*^9, {3.7132456292474003`*^9, 3.713245658390129*^9}, 
   3.713245709911489*^9, 3.71324581254359*^9, 3.7132501777034693`*^9, 
   3.7132505985545063`*^9, 3.7132646101563177`*^9, 3.713265494816022*^9, {
   3.7132657203973703`*^9, 3.713265744199585*^9}, 3.7132688073497057`*^9, 
   3.713268851951179*^9, 3.7132713014609632`*^9, 3.713271405190673*^9, 
   3.7132717990037327`*^9, 3.71327190054079*^9, 3.713272390429514*^9, 
   3.713272656790886*^9, 3.713274843056595*^9, 3.7132753968691473`*^9, 
   3.713278162061558*^9, 3.713278309976694*^9, 3.7134639290437565`*^9, 
   3.713464336943087*^9, 3.713466693219797*^9, 3.7135238731207523`*^9, 
   3.713524296322114*^9, 3.713524559615182*^9, 3.713672850374298*^9, 
   3.713673190579255*^9, 3.713687404547414*^9, 3.71380485937563*^9, 
   3.713854916080789*^9, 3.713854959031179*^9, 3.713865972885787*^9, 
   3.7138753233391457`*^9, 3.713875945589632*^9, 3.713876132588789*^9, 
   3.7138770866832857`*^9, 3.713877145362938*^9, 3.7138774211349993`*^9, 
   3.71387751590923*^9, 3.713877553289324*^9, 3.714026030342258*^9, 
   3.714028011827875*^9, 3.714029686605689*^9, 3.714029718540553*^9, 
   3.7140299507999*^9, 3.7140320299430447`*^9, 3.714032598312811*^9, 
   3.714033527322462*^9, 3.714037005847456*^9, 3.7140376628762693`*^9, 
   3.7140377724808483`*^9, 3.7140379167793283`*^9, 3.7140384635994377`*^9, 
   3.714039022946435*^9, 3.714039316564248*^9, 3.714039452056288*^9, 
   3.714110037633597*^9, 3.714132744119729*^9, 3.7149010182360992`*^9, 
   3.714901300639257*^9, 3.715852051353454*^9, 3.7158522205297947`*^9, 
   3.715853102967355*^9, {3.7158584880486917`*^9, 3.715858509964452*^9}, 
   3.7158586260890408`*^9, 3.715858719563692*^9, 3.715858842529537*^9, 
   3.7158612708142033`*^9, 3.718524066476182*^9, 3.722582139758698*^9, 
   3.72258405812*^9, 3.7225841506933126`*^9, 3.722584975271139*^9, 
   3.722585214952466*^9, 3.7225853636365347`*^9, 3.722592912351708*^9, 
   3.722596964744252*^9, 3.722597082961914*^9, 3.722597377577883*^9, 
   3.7225978957869368`*^9, 3.72286289620907*^9, 3.722863434609898*^9, 
   3.722863662799807*^9, 3.722863888282064*^9, 3.7228641022140303`*^9, 
   3.722864972482478*^9, 3.722866061593153*^9, 3.722866139899303*^9, 
   3.722866922153289*^9, 3.722866972910131*^9, 3.722867464856097*^9, 
   3.722867594126495*^9, 3.722868233806252*^9, 3.722869198457086*^9, 
   3.7228729189846983`*^9, 3.7229372096886387`*^9, 3.722938457327347*^9, 
   3.722939825517242*^9, 3.7229400793202877`*^9, 3.7229415335734367`*^9, 
   3.722941898992217*^9, 3.7229452939058437`*^9, 3.722945397169167*^9, 
   3.7233963400926113`*^9, 3.723396901512004*^9, 3.7233981834910555`*^9, 
   3.7233995007261686`*^9, 3.723401696543233*^9, 3.723405225487958*^9, 
   3.7238238627329693`*^9, 3.723908833592157*^9, 3.723908870570601*^9, 
   3.7239089619002*^9, 3.723975476739213*^9, 3.723976011532363*^9, 
   3.723981488789258*^9, 3.723982713883142*^9, 3.72398319151481*^9, {
   3.7239839059330378`*^9, 3.7239839147976837`*^9}, 3.7239840642687397`*^9, 
   3.723984163247313*^9, 3.723984698633081*^9, 3.723984749873247*^9, 
   3.738326650191139*^9, 3.738327116634377*^9, 3.738329382094385*^9, 
   3.7383296723998003`*^9, 3.738329737011911*^9, 3.7383297732249537`*^9, 
   3.73834338941551*^9, 3.7383437915155087`*^9, 3.738344643240225*^9, 
   3.738346430376443*^9, 3.738346542176838*^9, 3.7383468173275757`*^9, 
   3.738583611709085*^9},ExpressionUUID->"9bef4048-d673-4cfe-b5f1-\
3a28dc77d9c7"],

Cell[BoxData[
 RowBox[{"MatM", "[", 
  RowBox[{"sx", ",", "sy"}], "]"}]], "Output",
 CellChangeTimes->{{3.7072136663835573`*^9, 3.707213675528854*^9}, {
   3.7072137483754597`*^9, 3.70721377045287*^9}, 3.7072140032986317`*^9, 
   3.707214911001442*^9, 3.707219119528315*^9, 3.707221370493095*^9, 
   3.7080723500831337`*^9, 3.708075016829918*^9, 3.7080779091740637`*^9, 
   3.708078152917234*^9, 3.708085246036187*^9, 3.708249243733411*^9, 
   3.708249826076277*^9, 3.708258894071021*^9, 3.708267633577592*^9, 
   3.708319160268355*^9, 3.708321070699435*^9, 3.7083227039404163`*^9, 
   3.7083228033381977`*^9, 3.708322953866434*^9, 3.708323818954124*^9, 
   3.708324050924574*^9, 3.7083250675106497`*^9, 3.7083252686767693`*^9, 
   3.708325365688134*^9, 3.708325411941334*^9, 3.7083255073268213`*^9, 
   3.708325564329727*^9, {3.70833164510168*^9, 3.70833166859828*^9}, 
   3.708341955447019*^9, 3.709712849784639*^9, 3.709713023234666*^9, {
   3.709713102529305*^9, 3.7097131176601*^9}, 3.709713398708873*^9, 
   3.712838405379237*^9, 3.712924403987207*^9, 3.712924462867733*^9, 
   3.7129888024508047`*^9, 3.7129890002275476`*^9, 3.712990590661023*^9, 
   3.7129912550592613`*^9, 3.71299242767349*^9, 3.7129928243947887`*^9, 
   3.712997216305356*^9, 3.713005616216855*^9, 3.71300568470278*^9, 
   3.713006943425274*^9, 3.713007882825069*^9, 3.713008224726891*^9, 
   3.7131752137509127`*^9, 3.7132404708978767`*^9, 3.713241458262855*^9, 
   3.7132416545201406`*^9, 3.713241859685236*^9, 3.713243093139688*^9, 
   3.713243397082624*^9, {3.71324353469381*^9, 3.713243547297708*^9}, 
   3.713244055675705*^9, 3.7132441576242437`*^9, 3.713244291397427*^9, 
   3.713244406439084*^9, {3.7132456292474003`*^9, 3.713245658390129*^9}, 
   3.713245709911489*^9, 3.71324581254359*^9, 3.7132501777034693`*^9, 
   3.7132505985545063`*^9, 3.7132646101563177`*^9, 3.713265494816022*^9, {
   3.7132657203973703`*^9, 3.713265744199585*^9}, 3.7132688073497057`*^9, 
   3.713268851951179*^9, 3.7132713014609632`*^9, 3.713271405190673*^9, 
   3.7132717990037327`*^9, 3.71327190054079*^9, 3.713272390429514*^9, 
   3.713272656790886*^9, 3.713274843056595*^9, 3.7132753968691473`*^9, 
   3.713278162061558*^9, 3.713278309976694*^9, 3.7134639290437565`*^9, 
   3.713464336943087*^9, 3.713466693219797*^9, 3.7135238731207523`*^9, 
   3.713524296322114*^9, 3.713524559615182*^9, 3.713672850374298*^9, 
   3.713673190579255*^9, 3.713687404547414*^9, 3.71380485937563*^9, 
   3.713854916080789*^9, 3.713854959031179*^9, 3.713865972885787*^9, 
   3.7138753233391457`*^9, 3.713875945589632*^9, 3.713876132588789*^9, 
   3.7138770866832857`*^9, 3.713877145362938*^9, 3.7138774211349993`*^9, 
   3.71387751590923*^9, 3.713877553289324*^9, 3.714026030342258*^9, 
   3.714028011827875*^9, 3.714029686605689*^9, 3.714029718540553*^9, 
   3.7140299507999*^9, 3.7140320299430447`*^9, 3.714032598312811*^9, 
   3.714033527322462*^9, 3.714037005847456*^9, 3.7140376628762693`*^9, 
   3.7140377724808483`*^9, 3.7140379167793283`*^9, 3.7140384635994377`*^9, 
   3.714039022946435*^9, 3.714039316564248*^9, 3.714039452056288*^9, 
   3.714110037633597*^9, 3.714132744119729*^9, 3.7149010182360992`*^9, 
   3.714901300639257*^9, 3.715852051353454*^9, 3.7158522205297947`*^9, 
   3.715853102967355*^9, {3.7158584880486917`*^9, 3.715858509964452*^9}, 
   3.7158586260890408`*^9, 3.715858719563692*^9, 3.715858842529537*^9, 
   3.7158612708142033`*^9, 3.718524066476182*^9, 3.722582139758698*^9, 
   3.72258405812*^9, 3.7225841506933126`*^9, 3.722584975271139*^9, 
   3.722585214952466*^9, 3.7225853636365347`*^9, 3.722592912351708*^9, 
   3.722596964744252*^9, 3.722597082961914*^9, 3.722597377577883*^9, 
   3.7225978957869368`*^9, 3.72286289620907*^9, 3.722863434609898*^9, 
   3.722863662799807*^9, 3.722863888282064*^9, 3.7228641022140303`*^9, 
   3.722864972482478*^9, 3.722866061593153*^9, 3.722866139899303*^9, 
   3.722866922153289*^9, 3.722866972910131*^9, 3.722867464856097*^9, 
   3.722867594126495*^9, 3.722868233806252*^9, 3.722869198457086*^9, 
   3.7228729189846983`*^9, 3.7229372096886387`*^9, 3.722938457327347*^9, 
   3.722939825517242*^9, 3.7229400793202877`*^9, 3.7229415335734367`*^9, 
   3.722941898992217*^9, 3.7229452939058437`*^9, 3.722945397169167*^9, 
   3.7233963400926113`*^9, 3.723396901512004*^9, 3.7233981834910555`*^9, 
   3.7233995007261686`*^9, 3.723401696543233*^9, 3.723405225487958*^9, 
   3.7238238627329693`*^9, 3.723908833592157*^9, 3.723908870570601*^9, 
   3.7239089619002*^9, 3.723975476739213*^9, 3.723976011532363*^9, 
   3.723981488789258*^9, 3.723982713883142*^9, 3.72398319151481*^9, {
   3.7239839059330378`*^9, 3.7239839147976837`*^9}, 3.7239840642687397`*^9, 
   3.723984163247313*^9, 3.723984698633081*^9, 3.723984749873247*^9, 
   3.738326650191139*^9, 3.738327116634377*^9, 3.738329382094385*^9, 
   3.7383296723998003`*^9, 3.738329737011911*^9, 3.7383297732249537`*^9, 
   3.73834338941551*^9, 3.7383437915155087`*^9, 3.738344643240225*^9, 
   3.738346430376443*^9, 3.738346542176838*^9, 3.7383468173275757`*^9, 
   3.7385836117162123`*^9},ExpressionUUID->"d5a0ba4b-c0e4-4e24-b9e6-\
368972947bd8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SigmaRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"sx", ",", "sy"}], "]"}], "\[Rule]", 
     RowBox[{"I", " ", "sz"}]}], ",", 
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"sy", ",", "sx"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "sz"}]}], ",", 
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"sy", ",", "sz"}], "]"}], "\[Rule]", 
     RowBox[{"I", " ", "sx"}]}], ",", 
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"sz", ",", "sy"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "sx"}]}], ",", 
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"sz", ",", "sx"}], "]"}], "\[Rule]", 
     RowBox[{"I", " ", "sy"}]}], ",", 
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"sx", ",", "sz"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "sy"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.707208503289118*^9, 3.707208505295559*^9}, {
  3.7072086356443863`*^9, 
  3.707208639900655*^9}},ExpressionUUID->"03a9572e-09d8-4e00-a2f8-\
af978cde0e91"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"MatM", "[", 
     RowBox[{"sx", ",", "sy"}], "]"}], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", "sz"}]}], ",", 
   RowBox[{
    RowBox[{"MatM", "[", 
     RowBox[{"sy", ",", "sx"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "sz"}]}], ",", 
   RowBox[{
    RowBox[{"MatM", "[", 
     RowBox[{"sy", ",", "sz"}], "]"}], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", "sx"}]}], ",", 
   RowBox[{
    RowBox[{"MatM", "[", 
     RowBox[{"sz", ",", "sy"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "sx"}]}], ",", 
   RowBox[{
    RowBox[{"MatM", "[", 
     RowBox[{"sz", ",", "sx"}], "]"}], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", "sy"}]}], ",", 
   RowBox[{
    RowBox[{"MatM", "[", 
     RowBox[{"sx", ",", "sz"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "sy"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.707208640869484*^9, 3.7072134877610826`*^9, {3.7072136871499033`*^9, 
   3.7072137027792387`*^9}, {3.707213749087329*^9, 3.707213770480398*^9}, 
   3.7072140033248796`*^9, 3.707214911028027*^9, 3.7072191195549793`*^9, 
   3.707221370519611*^9, 3.708072350134472*^9, 3.708075016881991*^9, 
   3.708077909212912*^9, 3.708078153067067*^9, 3.708085246086994*^9, 
   3.708249243766795*^9, 3.7082498261193037`*^9, 3.708258894128845*^9, 
   3.7082676336152973`*^9, 3.708319160351758*^9, 3.708321070747692*^9, 
   3.708322703999783*^9, 3.708322803394307*^9, 3.7083229539154797`*^9, 
   3.708323819003899*^9, 3.708324050991466*^9, 3.708325067566383*^9, 
   3.7083252687217827`*^9, 3.7083253657266703`*^9, 3.708325411979841*^9, 
   3.7083255074173813`*^9, 3.708325564379918*^9, {3.708331645154894*^9, 
   3.708331668657118*^9}, 3.7083419554840937`*^9, 3.7097128498200607`*^9, 
   3.70971302327326*^9, {3.709713102568318*^9, 3.7097131177079678`*^9}, 
   3.70971339874374*^9, 3.712838405427186*^9, 3.712924404069826*^9, 
   3.712924462916916*^9, 3.7129888025249043`*^9, 3.712989000264688*^9, 
   3.7129905907105293`*^9, 3.712991255096921*^9, 3.712992427728281*^9, 
   3.7129928244329*^9, 3.7129972163577414`*^9, 3.713005616257451*^9, 
   3.713005684743432*^9, 3.713006943465431*^9, 3.7130078828870792`*^9, 
   3.7130082247688007`*^9, 3.713175213862948*^9, 3.713240470947648*^9, 
   3.713241458295858*^9, 3.71324165455372*^9, 3.713241859719256*^9, 
   3.713243093174473*^9, 3.71324339711689*^9, {3.7132435347282763`*^9, 
   3.713243547358477*^9}, 3.7132440557106256`*^9, 3.7132441576593447`*^9, 
   3.713244291433803*^9, 3.7132444064740353`*^9, {3.713245629282641*^9, 
   3.713245658436441*^9}, 3.7132457099484262`*^9, 3.7132458125786457`*^9, 
   3.713250177741082*^9, 3.713250598594913*^9, 3.7132646101903353`*^9, 
   3.713265494874168*^9, {3.713265720434175*^9, 3.713265744248897*^9}, 
   3.713268807399431*^9, 3.713268851988432*^9, 3.713271301511413*^9, 
   3.713271405230742*^9, 3.7132717990621634`*^9, 3.7132719006082497`*^9, 
   3.713272390501742*^9, 3.713272656857625*^9, 3.713274843130309*^9, 
   3.71327539694195*^9, 3.713278162362369*^9, 3.713278310058241*^9, 
   3.7134639291287613`*^9, 3.7134643371020966`*^9, 3.7134666932697573`*^9, 
   3.713523873187039*^9, 3.71352429647259*^9, 3.713524559653297*^9, 
   3.7136728504820223`*^9, 3.713673190600354*^9, 3.71368740456703*^9, 
   3.713804859426552*^9, 3.713854916114854*^9, 3.713854959081229*^9, 
   3.71386597296707*^9, 3.713875323382139*^9, 3.713875945632916*^9, 
   3.713876132625599*^9, 3.713877086720686*^9, 3.7138771454000874`*^9, 
   3.713877421171588*^9, 3.71387751594753*^9, 3.7138775533264914`*^9, 
   3.71402603039785*^9, 3.7140280118714857`*^9, 3.714029686641707*^9, 
   3.7140297185813837`*^9, 3.714029950831551*^9, 3.7140320299929447`*^9, 
   3.714032598346506*^9, 3.714033527354837*^9, 3.714037005902936*^9, 
   3.714037662915738*^9, 3.7140377725193663`*^9, 3.714037916829606*^9, 
   3.71403846364124*^9, 3.714039022996151*^9, 3.7140393166074677`*^9, 
   3.714039452109622*^9, 3.7141100376825857`*^9, 3.714132744190775*^9, 
   3.714901018313479*^9, 3.7149013006755543`*^9, 3.7158520515854063`*^9, 
   3.715852220584641*^9, 3.715853103003484*^9, {3.715858488097073*^9, 
   3.715858510004957*^9}, 3.715858626125606*^9, 3.715858719597754*^9, 
   3.715858842566373*^9, 3.7158612708802023`*^9, 3.718524066526566*^9, 
   3.722582139834429*^9, 3.722584058168893*^9, 3.722584150725038*^9, 
   3.72258497531236*^9, 3.722585214985486*^9, 3.722585363669956*^9, 
   3.722592912417749*^9, 3.722596964785262*^9, 3.7225970829945*^9, 
   3.722597377616414*^9, 3.722597895823586*^9, 3.722862896258628*^9, 
   3.72286343465936*^9, 3.7228636628433332`*^9, 3.722863888325523*^9, 
   3.722864102249305*^9, 3.722864972516995*^9, 3.722866061643446*^9, 
   3.722866140164144*^9, 3.722866922188884*^9, 3.722866972949189*^9, 
   3.722867464891259*^9, 3.7228675941613483`*^9, 3.722868233843396*^9, 
   3.7228691987127657`*^9, 3.722872919022888*^9, 3.722937209703974*^9, 
   3.722938457346314*^9, 3.722939825539793*^9, 3.722940079333976*^9, 
   3.722941533595697*^9, 3.722941899005608*^9, 3.722945293918737*^9, 
   3.722945397182913*^9, 3.723396340248612*^9, 3.7233969015588036`*^9, 
   3.723398183537855*^9, 3.7233995007729692`*^9, 3.723401696668033*^9, 
   3.7234052255209427`*^9, 3.7238238627649307`*^9, 3.723908833627508*^9, 
   3.723908870604939*^9, 3.723908961943303*^9, 3.723975476777878*^9, 
   3.723976011568837*^9, 3.723981488828219*^9, 3.723982713920746*^9, 
   3.723983191564785*^9, {3.7239839059724407`*^9, 3.723983914856669*^9}, 
   3.723984064326601*^9, 3.723984163305978*^9, 3.723984698673254*^9, 
   3.723984749914257*^9, 3.73832665025611*^9, 3.73832711680752*^9, 
   3.738329382154916*^9, 3.738329672464178*^9, 3.738329737061879*^9, 
   3.738329773273918*^9, 3.738343389467513*^9, 3.7383437915595117`*^9, 
   3.7383446432822275`*^9, 3.738346430390444*^9, 3.738346542190839*^9, 
   3.7383468173425765`*^9, 
   3.738583611775176*^9},ExpressionUUID->"f674b8b2-654e-443a-85ec-\
9b8fa5794c81"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.707053719178553*^9, 
  3.707111764087183*^9},ExpressionUUID->"2819428d-c3e8-429d-a13c-\
f5104770ae41"],

Cell[TextData[{
 StyleBox["Define the Commutator\n", "Subsection"],
 "Idea from here (second answer by `evanb\[CloseCurlyQuote])",
 StyleBox["\n", "Subsection"],
 "https://mathematica.stackexchange.com/questions/63811/pull-out-scalars-from-\
noncommutativemultiply-in-commutator-of-su2-spin-algebra"
}], "Text",
 CellChangeTimes->{{3.7071393813653517`*^9, 3.707139429163363*^9}, {
  3.7071396964865713`*^9, 
  3.7071397432300177`*^9}},ExpressionUUID->"87ac8d07-10f9-485b-be11-\
6a4a324f32d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"obviously", " ", "trivial", " ", "commutators"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{"xx_", ",", "xx_"}], "]"}], ":=", "0"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Commutator", " ", "/:", " ", 
     RowBox[{"Plus", "[", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{"xx_", ",", "yy_"}], "]"}], ",", 
       RowBox[{"Commutator", "[", 
        RowBox[{"yy_", ",", "xx_"}], "]"}]}], "]"}], " ", ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"below", ":", " ", 
     RowBox[{"scalars", " ", "always", " ", "commute"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{"xx_", ",", "yy_"}], "]"}], ":=", 
     RowBox[{"0", " ", "/;", " ", 
      RowBox[{"CommutativeQ", "[", "xx", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{"xx_", ",", "yy_"}], "]"}], ":=", 
     RowBox[{"0", " ", "/;", " ", 
      RowBox[{"CommutativeQ", "[", "yy", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Linearity", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{
       RowBox[{"Plus", "[", 
        RowBox[{"a_", ",", "addends__"}], "]"}], ",", "B_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Commutator", "[", 
       RowBox[{"a", ",", "B"}], "]"}], "+", 
      RowBox[{"Commutator", "[", 
       RowBox[{
        RowBox[{"Plus", "[", "addends", "]"}], ",", "B"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{"A_", ",", 
       RowBox[{"Plus", "[", 
        RowBox[{"b_", ",", "baddends__"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Commutator", "[", 
       RowBox[{"A", ",", "b"}], "]"}], "+", 
      RowBox[{"Commutator", "[", 
       RowBox[{"A", ",", 
        RowBox[{"Plus", "[", "baddends", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{
       RowBox[{"Times", "[", 
        RowBox[{"c_", ",", "factors__"}], "]"}], ",", "B_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{"Times", "[", "factors", "]"}], ",", "B"}], "]"}]}], " ", "/;",
       " ", 
      RowBox[{"CommutativeQ", "[", "c", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{"A_", ",", 
       RowBox[{"Times", "[", 
        RowBox[{"c_", ",", "factors__"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"Commutator", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Times", "[", "factors", "]"}]}], "]"}]}], " ", "/;", " ", 
      RowBox[{"CommutativeQ", "[", "c", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "  ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "pull", " ", "integrals", " ", "out", " ", "of", " ", "the", " ", 
     "commutator", " ", 
     RowBox[{"(", 
      RowBox[{
      "only", " ", "works", " ", "for", " ", "\"\<definite integrals\>\"", 
       " ", "I", " ", "think"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"A_", ",", "x_"}], "]"}], ",", "B_"}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{"A", ",", "B"}], "]"}], ",", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{"A_", ",", 
       RowBox[{"Integrate", "[", 
        RowBox[{"B_", ",", "x_"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{"A", ",", "B"}], "]"}], ",", "x"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7071394235541067`*^9, 3.707139535253931*^9}, {
   3.707139635201075*^9, 3.707139635625049*^9}, {3.7071397637151413`*^9, 
   3.707139852615191*^9}, {3.7071398860851507`*^9, 3.7071401129947453`*^9}, 
   3.707140165048381*^9, 3.7071408922367077`*^9, 3.707141183717742*^9, 
   3.707141672368496*^9, 3.7071420136986303`*^9, {3.707142090932115*^9, 
   3.7071421170237703`*^9}, {3.707142222150655*^9, 3.707142229252624*^9}, {
   3.709717177812396*^9, 3.709717184256524*^9}, {3.7097172674757853`*^9, 
   3.709717307345194*^9}},ExpressionUUID->"3140e23a-edfa-4156-8d0f-\
b5a7b0a7533a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.707199869091449*^9, 
  3.707199869230146*^9}},ExpressionUUID->"09f3bd6e-ba21-4e4e-b3e3-\
96555f76aa63"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.707199869809314*^9, 
  3.707199869966061*^9}},ExpressionUUID->"0307b34c-3907-409a-b408-\
b03cbc85c648"],

Cell["\<\
An old version of MagnusM3 {including (*Print[] statement*)s for debugging} \
can be found at the very end of this script, named MagnusM3-commented\
\>", "Text",
 CellChangeTimes->{{3.722089183808223*^9, 3.722089203722333*^9}, {
  3.722089402585099*^9, 
  3.722089445878076*^9}},ExpressionUUID->"b3b7d255-8074-42f4-a0ee-\
3d14a0074b4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Third", " ", "MagnusM3", " ", "for", " ", "the", " ", "case", " ", 
     "that", " ", "the", " ", "initial", " ", "time", " ", 
     SubscriptBox["t", "0"], " ", "is", " ", "not", " ", "equal", " ", "to", 
     " ", "0"}], ",", " ", 
    RowBox[{"and", " ", "using", " ", "commutators", " ", 
     RowBox[{"properly", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Assuming", " ", "NCi", " ", "are", " ", "already", " ", "Non"}], 
    "-", 
    RowBox[{"Commutative", " ", "variables", " ", "in", " ", "the", " ", 
     RowBox[{"Hamiltonian", " ", "[", 
      RowBox[{
       RowBox[{"e", ".", "g", "."}], ",", " ", "sx", ",", " ", "sy", ",", " ",
        "sz"}], "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MagnusM3", "[", 
     RowBox[{"Ht_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "HH", ",", "temp", ",", "result0", ",", "result1", ",", "term"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"In", ":", " ", 
         RowBox[{"Ht", " ", 
          RowBox[{"(", 
           RowBox[{"NC", " ", "object"}], ")"}]}]}], ",", " ", 
        RowBox[{"k", " ", "=", " ", "1"}], ",", "2", ",", 
        RowBox[{
         RowBox[{"3", "..."}], " ", 
         RowBox[{"(", 
          RowBox[{"order", " ", "of", " ", "Magnus", " ", "Expansion"}], 
          ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Out", ":", " ", 
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{"result", ",", " ", 
           SuperscriptBox["\[Lambda]", "k"]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k", "-", 
            RowBox[{"th", " ", "Magnus", " ", "term", " ", 
             SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "k"], " ", 
             RowBox[{"(", 
              RowBox[{"anti", "-", "Hermitian"}], ")"}], " ", "as", " ", "a", 
             " ", "function", " ", "of", " ", "Hamiltonian", " ", 
             RowBox[{"Ht", " ", "--"}], " ", "to", " ", "get", " ", 
             SubscriptBox["H", "k"], "*", 
             SubscriptBox["t", "c"]}]}], ",", " ", 
           RowBox[{
            RowBox[{"multiply", " ", "by"}], " ", "+", "\[ImaginaryI]"}]}], 
          ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", 
        RowBox[{"x", ",", "y", ",", "please"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SetNonCommutative", "[", 
        RowBox[{
        "HH", ",", "please", ",", "\[CapitalOmega]\[CapitalOmega]", ",", 
         SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "1"], ",", "x", ",", 
         "y"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetCommutative", "[", "\[Lambda]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"HH", "=", "please"}], ";", "\[IndentingNewLine]", 
       RowBox[{"result0", "=", 
        RowBox[{"\[Lambda]", " ", "HH"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "=", "1"}], ";", 
          RowBox[{"temp", "=", "HH"}]}], ",", 
         RowBox[{"i", "<", "k"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Write", " ", "down", " ", 
           RowBox[{"Eq", ".", " ", 
            RowBox[{"(", "21", ")"}]}], " ", 
           RowBox[{"of", " ", "'"}], "A", " ", "pedagogical", " ", "approach",
            " ", "to", " ", "the", " ", 
           RowBox[{"ME", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"Commutator", "[", 
            RowBox[{"\[CapitalOmega]\[CapitalOmega]", ",", "temp"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"term", "=", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"BernoulliB", "[", "i", "]"}], 
              RowBox[{"Factorial", "[", "i", "]"}]], "\[Lambda]", "*", 
             "temp"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]\[CapitalOmega]", "\[Rule]", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"s", "=", "1"}], 
                RowBox[{"k", "+", "1", "-", "i"}]], 
               RowBox[{
                SuperscriptBox["\[Lambda]", "s"], 
                RowBox[{
                 SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "s"], "[", 
                 RowBox[{"t", ",", "t0"}], "]"}]}]}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result0", "+=", "term"}], ";", "\[IndentingNewLine]", 
          RowBox[{"SetNonCommutative", "[", 
           SubscriptBox["\[CapitalOmega]\[CapitalOmega]", 
            RowBox[{"i", "+", "1"}]], "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"result1", "[", "\[Lambda]_", "]"}], ":=", "result0"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"result1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"result1", "[", "\[Lambda]", "]"}], "//", "NCE"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]", ",", "0", ",", "k"}], "}"}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"please", "\[Rule]", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "Ht"}]}], "}"}]}], "//", 
         "Normal"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"If", " ", "you", " ", "want", " ", "to", " ", "double"}], 
          "-", 
          RowBox[{
          "check", " ", "the", " ", "first", " ", "few", " ", "terms", " ", 
           "remember", " ", "that"}]}], ",", " ", 
         RowBox[{"for", " ", "instance"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "1"], " ", "=", " ", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"\[Integral]", 
            RowBox[{"H", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"and", " ", "not"}], " ", "+", "\[ImaginaryI]"}], 
               ")"}], "."}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result1", "//", "NCE"}], "//", "Expand"}], ",", 
         SuperscriptBox["\[Lambda]", "k"]}], "]"}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.707111771288121*^9, 3.707111789609984*^9}, {
   3.707112030020212*^9, 3.7071121691880417`*^9}, {3.7071122022039347`*^9, 
   3.7071122437619534`*^9}, {3.707112314790288*^9, 3.7071123167780123`*^9}, 
   3.707112379610424*^9, {3.707131059268106*^9, 3.707131072484827*^9}, {
   3.707139327307535*^9, 3.707139370039452*^9}, {3.707139403901848*^9, 
   3.707139418589225*^9}, {3.70714044205525*^9, 3.7071404485000353`*^9}, {
   3.7071408211950693`*^9, 3.7071408481992903`*^9}, {3.707141017144085*^9, 
   3.707141037295416*^9}, {3.7071411468170424`*^9, 3.707141172561247*^9}, {
   3.707141322153028*^9, 3.7071413317440166`*^9}, {3.707141394269773*^9, 
   3.70714144965106*^9}, {3.7071417273103743`*^9, 3.7071417301089354`*^9}, {
   3.707141784146392*^9, 3.7071417929061737`*^9}, {3.70714252805975*^9, 
   3.707142536961306*^9}, 3.707199868433742*^9, {3.721984933214237*^9, 
   3.7219849359823017`*^9}, {3.721985496629765*^9, 3.721985539197152*^9}, {
   3.72198557532434*^9, 3.72198567753734*^9}, {3.721985856206003*^9, 
   3.7219859567062883`*^9}, 3.721986978607662*^9, {3.721987065886168*^9, 
   3.721987073549246*^9}, {3.7219884657260027`*^9, 3.721988539788446*^9}, {
   3.721988597185894*^9, 3.721988653241888*^9}, 3.721990526520855*^9, {
   3.721990804056933*^9, 3.7219908621987133`*^9}, 3.72208530868289*^9, {
   3.7220859277569017`*^9, 3.722086203870735*^9}, {3.722086260380568*^9, 
   3.722086261156311*^9}, {3.7220863878222017`*^9, 3.722086392589443*^9}, {
   3.722086436988825*^9, 3.7220864375393953`*^9}, {3.722086535150161*^9, 
   3.72208660932338*^9}, {3.722086652103705*^9, 3.722086667749743*^9}, {
   3.72208929326413*^9, 3.722089294584712*^9}, {3.722089500334942*^9, 
   3.722089582200533*^9}},ExpressionUUID->"ccabe858-fe33-4de0-be08-\
7331aa9d41a3"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.707051677032414*^9, 
  3.7070516773408413`*^9}},ExpressionUUID->"adb30d95-e908-4d2c-9c8e-\
5886451f92d9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"write", " ", "list", " ", "of", " ", "coefficients"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.722582218799387*^9, 
  3.722582226705678*^9}},ExpressionUUID->"6342f5e2-8b8b-4fb8-aa85-\
77dbbbde7a01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "coeffs1", " ", "in", " ", "the", " ", "form", " ", "of", " ", 
      "\[IndentingNewLine]", "coeffs1"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Kc", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Ks", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Jc", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Js", ",", "1"}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "max", " ", "is", " ", "the", " ", "maximum", " ", "power", " ", "of", 
      " ", "\[Omega]", " ", "\[IndentingNewLine]", "offR", " ", 
      RowBox[{"(", "resonant", ")"}]}], " ", "=", " ", 
     RowBox[{"True", " ", "or", " ", "False"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"setCList", "[", 
     RowBox[{"coeffs1_", ",", "max_", ",", "offR_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coeffs", ",", "dds", ",", "termSt"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"coeffs1", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Kc", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Ks", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Jc", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Js", ",", "1"}], "}"}]}], "}"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "=", "1"}], ";", 
          RowBox[{"coeffs", "=", "coeffs1"}], ";", 
          RowBox[{"dds", "=", "\"\<\>\""}]}], ",", 
         RowBox[{"i", "\[LessEqual]", "max"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dds", "=", 
           RowBox[{"dds", "<>", "\"\<D\>\""}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", "coeffs1", "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termSt", "=", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"coeffs", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "<>", 
               "dds"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"coeffs", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"coeffs", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ToExpression", "@", "termSt"}], ",", 
                   RowBox[{"i", "+", "1"}]}], "}"}], "}"}]}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"offR", "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"coeffs", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"Delta", ",", "1"}], "}"}], "}"}], ",", "coeffs"}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "coeffs", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.722582239596987*^9, 3.722582462165538*^9}, {
  3.722582573238707*^9, 3.722582663994506*^9}, {3.7225836565365133`*^9, 
  3.722583667241906*^9}, {3.722870090330449*^9, 
  3.722870094786159*^9}},ExpressionUUID->"1d12a89a-53cc-40b3-99c2-\
9b9f52b72533"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"based", " ", "on", " ", "coeffs"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c1", ",", "dim1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"c2", ",", "dim2"}], "}"}], ",", " ", ".."}], "}"}], " ", 
      "[", 
      RowBox[{
       RowBox[{"obtained", " ", "from", " ", "setCList"}], ",", " ", 
       "ideally"}], "]"}]}], ",", " ", 
    RowBox[{"find", " ", "a", " ", "list", " ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          SuperscriptBox["c1A", "p1"], "}"}], ",", " ", "dimTotA"}], "}"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["c1B", "p1"], ",", " ", 
           SuperscriptBox["c2B", "p2"]}], "}"}], ",", " ", "dimTotB"}], "}"}],
        ",", " ", ".."}], "}"}], "\[IndentingNewLine]", "or", " ", 
     "something", " ", "like", " ", "that"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"detCList", "[", 
     RowBox[{"coeffs_", ",", "max_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "work", ",", "item", ",", "i", ",", "exp", ",", "rep", ",", "cBigList",
         ",", "cList", ",", "coefficient"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"work", "=", "coeffs"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"here", ":", "  ", 
          RowBox[{"extend", " ", "coeffs", " ", 
           RowBox[{"(", "\"\<work\>\"", ")"}], " ", "to", " ", "include", " ",
            "higher", " ", "order", " ", "of", " ", "H1"}]}], ",", " ", "H1D",
          ",", " ", "..", ",", " ", "Hn", ",", " ", ".."}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", 
          RowBox[{"Length", "[", "coeffs", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<outer loop, i = \>\"", ",", "i"}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"item", "=", 
           RowBox[{"coeffs", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"exp", "=", "2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "up", " ", "to", " ", "dimension", " ", "\"\<exp\>\"", " ", "so", 
             " ", "that", " ", 
             SuperscriptBox["Hn", "exp"], " ", "so", " ", "that", " ", 
             "total", " ", "dimension", " ", 
             RowBox[{"dim", "[", "Hn", "]"}], "*", "exp"}], " ", 
            "\[LessEqual]", " ", "max"}], "  ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"exp", "*", 
              RowBox[{"item", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], "<=", "max"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"work", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"work", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"item", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "exp"], ",", 
                   RowBox[{"exp", "*", 
                    RowBox[{"item", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"exp", "+=", "1"}], ";"}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"exp", ">", "10"}], ",", "Break"}], "]"}], "*)"}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", ">", "20"}], ",", "Break"}], "]"}], "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"now", " ", "create", " ", "all", " ", "combinations"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cBigList", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{"work", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "max"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<After Subsets: CBigList = \>\"", ",", "cBigList"}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Table", ":", " ", 
         RowBox[{"elements", " ", "of", " ", "coeffs"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"cBigList", "=", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cBigList", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", 
               RowBox[{"1", ";;", 
                RowBox[{"Length", "[", 
                 RowBox[{"cBigList", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", "1"}], "]"}], 
             "]"}], ",", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"cBigList", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"cBigList", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "cBigList", "]"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Now", " ", "remove", " ", "all", " ", "those", " ", "entries", " ", 
         "whose", " ", "dimension", " ", "is", " ", "too", " ", "large"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cBigList", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"cBigList", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "<=", "max"}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Now", " ", "remove", " ", "all", " ", "\"\<double entries\>\"", " ", 
         "such", " ", "as", " ", 
         RowBox[{"{", 
          RowBox[{"H1", ",", 
           SuperscriptBox["H1", "2"], ",", "3"}], "}"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rep", "=", 
        RowBox[{
         RowBox[{"x_", "^", "y_"}], "\[RuleDelayed]", "x"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Before, cBigList = \>\"", ",", "cBigList"}], "]"}], 
         ";"}], "*)"}], 
       RowBox[{"cBigList", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"cBigList", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"#1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/.", "rep"}], "]"}], "]"}]}],
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Afterwards, cBigList = \>\"", ",", "cBigList"}], "]"}],
          ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<After combining subsets: CBigList = \>\"", ",", "cBigList"}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "cBigList", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.722265649333127*^9, 3.7222656660438023`*^9}, {
   3.72226571918497*^9, 3.722265787237772*^9}, {3.722265829467671*^9, 
   3.722265881809205*^9}, {3.722265913391123*^9, 3.722265993874937*^9}, {
   3.722266130659968*^9, 3.722266182146254*^9}, {3.722266245022108*^9, 
   3.722266292203671*^9}, {3.722266331441856*^9, 3.722266347721066*^9}, {
   3.7222664354846992`*^9, 3.722266557134239*^9}, {3.7222666103494177`*^9, 
   3.722266637265815*^9}, {3.722266751941916*^9, 3.7222667770190773`*^9}, {
   3.722266828304941*^9, 3.722267019694347*^9}, {3.722267083947215*^9, 
   3.722267193237677*^9}, {3.722267228995532*^9, 3.7222672471066236`*^9}, {
   3.722267569426394*^9, 3.7222676390544*^9}, {3.722267690044179*^9, 
   3.722267692084495*^9}, {3.7222677280819483`*^9, 3.722267774391572*^9}, {
   3.722267826418831*^9, 3.72226783990849*^9}, {3.722267991940419*^9, 
   3.722268239840456*^9}, {3.722268301940954*^9, 3.722268308708186*^9}, {
   3.7222683480589247`*^9, 3.722268357026557*^9}, {3.7222702365688467`*^9, 
   3.722270241280201*^9}, {3.7222703752818403`*^9, 3.7222704125436773`*^9}, {
   3.72227053594503*^9, 3.722270637572221*^9}, {3.722270669354926*^9, 
   3.722270782468568*^9}, {3.722271017105094*^9, 3.722271190424255*^9}, {
   3.72227122467875*^9, 3.722271230269107*^9}, {3.722271278354701*^9, 
   3.722271365295229*^9}, {3.7222714238442698`*^9, 3.722271488336911*^9}, {
   3.722271548629878*^9, 3.722271568868731*^9}, {3.7222716081230717`*^9, 
   3.7222717074298964`*^9}, 3.722271918129998*^9, {3.722272026557276*^9, 
   3.722272027741239*^9}, 3.72227214883521*^9, {3.722323444892396*^9, 
   3.7223234933390913`*^9}, {3.722323534866523*^9, 3.722323625983028*^9}, {
   3.722323677838883*^9, 3.7223236845739403`*^9}, {3.72232372196519*^9, 
   3.722323768555046*^9}, {3.722323858641345*^9, 3.7223238762010937`*^9}, {
   3.722323960022725*^9, 3.722324008421112*^9}, {3.7223242881189413`*^9, 
   3.722324316580667*^9}, {3.722325144454933*^9, 3.722325150045713*^9}, {
   3.722325183914885*^9, 3.722325323916162*^9}, {3.722325476701263*^9, 
   3.72232550445122*^9}, {3.722325542129327*^9, 3.7223255441333942`*^9}, {
   3.72232576414926*^9, 3.722325775140049*^9}, {3.722326359964814*^9, 
   3.722326421187125*^9}, {3.722329575852964*^9, 3.722329580864532*^9}, {
   3.722329613284609*^9, 3.722329691706996*^9}, 3.722329732273837*^9, {
   3.722329843658019*^9, 3.7223298444233103`*^9}, 3.722337793393621*^9, 
   3.722605138245414*^9, {3.722870859017942*^9, 3.722870873160345*^9}, {
   3.7228709765654697`*^9, 3.722870992537624*^9}, {3.722871045975439*^9, 
   3.7228712400683413`*^9}, {3.722871367677937*^9, 3.722871400923794*^9}, {
   3.722872176652277*^9, 3.722872182361086*^9}, {3.722872628153451*^9, 
   3.7228726369316072`*^9}, 3.7228727266125174`*^9, {3.7228727997441072`*^9, 
   3.722872802752112*^9}, {3.722872875837571*^9, 3.7228728858911657`*^9}, {
   3.7228730071473722`*^9, 3.7228730613621798`*^9}, 3.722877665628639*^9, {
   3.7229382138571167`*^9, 3.722938251948758*^9}, {3.72293838890589*^9, 
   3.7229384056473513`*^9}, {3.722938814316485*^9, 3.7229388207255707`*^9}, {
   3.722939082085661*^9, 3.7229391039087*^9}, {3.722939686758284*^9, 
   3.722939687629053*^9}, {3.722939730764876*^9, 3.722939731923811*^9}, {
   3.722939782186533*^9, 3.722939791474189*^9}, {3.722940444497147*^9, 
   3.722940480782804*^9}, {3.722940511104767*^9, 3.722940514548882*^9}, {
   3.7229408825659*^9, 
   3.7229408999086018`*^9}},ExpressionUUID->"1c0dbf3f-8518-4498-85f4-\
38a88ff7acc8"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.722940546842856*^9},ExpressionUUID->"46514008-5004-4b95-aa49-\
289073451663"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"assumes", " ", 
     RowBox[{"coeffs", "[", "i", "]"}], " ", "for", " ", "all", " ", "i"}], 
    " ", "\[LessEqual]", " ", 
    RowBox[{"max", " ", "have", " ", "been", " ", "defined"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sTrim", "[", 
     RowBox[{"input_", ",", "max_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"work", ",", "CC"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "use", " ", "detCList", " ", "to", " ", "determine", " ", "a", " ", 
         "coefficient", " ", "list", " ", "with", " ", "units", " ", 
         "power"}], " ", "<", " ", "max"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"NEW", ":", "  ", 
        RowBox[{"remove", " ", "the", " ", "detCList", " ", "command", " ", 
         RowBox[{"here", " ", "[", 
          RowBox[{"just", " ", "call", " ", "it", " ", "once"}], "]"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"cList", "=", 
         RowBox[{
          RowBox[{"det", "--"}], 
          RowBox[{"CList", "[", 
           RowBox[{"coeffs", ",", "max"}], "]"}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"setZero", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"coeffs", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Rule]", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "coeffs", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<within sTrim, setZero = \>\"", ",", "setZero"}], "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<within sTrim, cList = \>\"", ",", "cList"}], "]"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<the cList = \>\"", ",", "cList"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "define", " ", "\"\<coefficient\>\"", " ", "taken", " ", "from", " ", 
         "myCList"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CC", "[", "x_", "]"}], ":=", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"myCList", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "1", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"myCList", "[", 
              RowBox[{"[", 
               RowBox[{"x", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<CC[1] = \>\"", ",", 
           RowBox[{"CC", "[", "1", "]"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<myCList = \>\"", ",", "myCList"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "myDelta", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"work", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"CC", "[", "i", "]"}], "\[Times]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Coefficient", "[", 
              RowBox[{"input", ",", 
               RowBox[{"CC", "[", "i", "]"}]}], "]"}], "/.", "setZero"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "myCList", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "work", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.721646861578413*^9, 3.721647122937542*^9}, {
   3.721647186059969*^9, 3.7216472040669928`*^9}, {3.7216472516417313`*^9, 
   3.721647366186899*^9}, {3.7216485826710453`*^9, 3.721648583261739*^9}, {
   3.721649350479156*^9, 3.7216493918294353`*^9}, {3.721649452795085*^9, 
   3.721649454939217*^9}, {3.721650026821982*^9, 3.721650028261038*^9}, {
   3.721650204732091*^9, 3.721650367644103*^9}, {3.7216504126346617`*^9, 
   3.7216506589970503`*^9}, {3.7216507124590187`*^9, 3.721650811772908*^9}, {
   3.7216509145362988`*^9, 3.721650916240287*^9}, {3.721651347890688*^9, 
   3.721651396536365*^9}, {3.7216514449656973`*^9, 3.721651521130227*^9}, {
   3.721651570223546*^9, 3.721651620109528*^9}, {3.7216516856813593`*^9, 
   3.721651725735572*^9}, {3.721651802947692*^9, 3.721651804483438*^9}, {
   3.721651935605544*^9, 3.7216520702460737`*^9}, {3.721652123643791*^9, 
   3.721652153089279*^9}, {3.7216521976245832`*^9, 3.7216523451275673`*^9}, {
   3.721652508615893*^9, 3.721652514390979*^9}, {3.721652577828837*^9, 
   3.72165258525949*^9}, {3.721652642873365*^9, 3.72165269068592*^9}, {
   3.72165286523077*^9, 3.721652884276165*^9}, {3.721652996887019*^9, 
   3.721653025005021*^9}, {3.721653113312718*^9, 3.721653139182396*^9}, {
   3.721653197619608*^9, 3.721653221258705*^9}, {3.721653445377419*^9, 
   3.721653547842104*^9}, {3.72165359472047*^9, 3.721653599302874*^9}, {
   3.721653633869792*^9, 3.721653646670844*^9}, {3.72165371277079*^9, 
   3.721653740212371*^9}, {3.721653982843232*^9, 3.7216539847626343`*^9}, {
   3.721654044698041*^9, 3.721654102612323*^9}, 3.721654177961626*^9, {
   3.721654561550646*^9, 3.721654575164209*^9}, {3.721654610660861*^9, 
   3.7216546235058603`*^9}, {3.7216546565629253`*^9, 3.721654696925716*^9}, {
   3.721654743381205*^9, 3.721654769090541*^9}, {3.721655123279132*^9, 
   3.721655123897428*^9}, {3.721655339949319*^9, 3.721655409440703*^9}, {
   3.721655630317445*^9, 3.7216556308853893`*^9}, {3.7216573573189507`*^9, 
   3.721657358942239*^9}, {3.722060512608799*^9, 3.722060513182702*^9}, {
   3.722060629664212*^9, 3.722060632448197*^9}, {3.7220609438318443`*^9, 
   3.722060947615685*^9}, 3.722249735066506*^9, {3.722249778199438*^9, 
   3.722249778614716*^9}, {3.722250209080286*^9, 3.722250212584449*^9}, {
   3.722250418918291*^9, 3.722250425979177*^9}, {3.722268433857778*^9, 
   3.722268510393326*^9}, {3.722268732847348*^9, 3.722268733591189*^9}, {
   3.722268784829177*^9, 3.722268991121221*^9}, {3.722269055613061*^9, 
   3.72226909641136*^9}, {3.722269151304063*^9, 3.722269221508543*^9}, {
   3.722269253595476*^9, 3.7222692550777693`*^9}, 3.722269287785211*^9, {
   3.722269389371937*^9, 3.7222694529848757`*^9}, {3.722269508118339*^9, 
   3.722269509749908*^9}, {3.722269549892626*^9, 3.7222695514679127`*^9}, {
   3.7222696965802603`*^9, 3.722269697348217*^9}, {3.722269739538418*^9, 
   3.722269739953968*^9}, {3.7222699673421803`*^9, 3.722269981399115*^9}, {
   3.722270485795659*^9, 3.7222705245457287`*^9}, 3.722272117989572*^9, {
   3.722272311896781*^9, 3.7222723256216927`*^9}, {3.722273323426779*^9, 
   3.722273328529426*^9}, 3.7222808966773233`*^9, {3.7222809439454064`*^9, 
   3.72228098590948*^9}, {3.722281017671136*^9, 3.7222810395579743`*^9}, {
   3.7222811379941473`*^9, 3.722281166932198*^9}, {3.722281197586252*^9, 
   3.722281199973056*^9}, {3.7222812886552114`*^9, 3.7222813233652725`*^9}, 
   3.7222813613357396`*^9, {3.722281876631735*^9, 3.7222818885969563`*^9}, {
   3.722604511639942*^9, 3.722604553866919*^9}, {3.722604692026877*^9, 
   3.722604740277816*^9}, {3.722868157070367*^9, 3.722868178421338*^9}, {
   3.7228690841579247`*^9, 3.722869177519308*^9}, {3.7229404138863163`*^9, 
   3.722940425353148*^9}, {3.7229406520811653`*^9, 3.722940684176736*^9}, {
   3.7229410874305887`*^9, 3.722941091334589*^9}, {3.722941295920381*^9, 
   3.722941297340198*^9}, 3.7229413312965317`*^9, {3.7229414136302853`*^9, 
   3.7229414836279488`*^9}},ExpressionUUID->"c3c80b85-1444-40c1-85d3-\
8cda474a03a6"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7229413664389763`*^9, 
  3.722941366565814*^9}},ExpressionUUID->"552601b9-58eb-4846-9aeb-\
14077abbe02f"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.722941367380577*^9, 
  3.722941367509789*^9}},ExpressionUUID->"f5c1929c-d0da-4264-8437-\
12c8eec89070"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721650822968539*^9, 
  3.721650823435548*^9}},ExpressionUUID->"0ab08077-9da1-419a-b558-\
8f13b4f6c66b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Get", " ", "\[CapitalOmega]\[CapitalOmega]", 
    RowBox[{"(", 
     RowBox[{"t", ",", "t0"}], ")"}], " ", "may", " ", "output", " ", 
    RowBox[{"(", 
     RowBox[{"depending", " ", "on", " ", 
      RowBox[{"lastTrue", "/", "False"}]}], ")"}], "\[IndentingNewLine]", 
    SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "order"], 
    RowBox[{"(", 
     RowBox[{"t", ",", "t0"}], ")"}], " ", "\[IndentingNewLine]", "or", 
    "\[IndentingNewLine]", 
    SubscriptBox["Omega", "order"], 
    RowBox[{"(", "t0", ")"}], "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{"maximal", " ", 
      RowBox[{
       RowBox[{"coefficient", " ", "~", " ", "1"}], "/", 
       SuperscriptBox["ww", "maxOmega"]}]}], ")"}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"'", 
    RowBox[{"s", "'"}], " ", "stands", " ", 
    RowBox[{"for", " ", "'"}], 
    RowBox[{
     RowBox[{"smart", "'"}], " ", "--"}], " ", "here", " ", "we", " ", "use", 
    " ", "sTrim"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sGetOO", "[", 
     RowBox[{"order_", ",", "maxOmega_", ",", "lastTF_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cList", ",", "fn", ",", "Omega", ",", "OO"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"I", "'"}], "m", " ", "assuming", " ", "that", " ", 
        "maxOmega", " ", "is", " ", "the", " ", "maximal", " ", 
        RowBox[{"1", "/", "ww"}], " ", "in", " ", 
        RowBox[{"Omega", "[", 
         RowBox[{"t", ",", "t0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"and", " ", "not", " ", "the", " ", "maximal", " ", 
          RowBox[{"1", "/", "ww"}], " ", "in", " ", "the", " ", 
          "Hamiltonian"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\\n Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\
\[CapitalOmega]\), \(k\)]\)/\!\(\*SubscriptBox[\(Omega\), \(k\)]\) of order k \
= \>\"", ",", " ", "order", ",", " ", "\"\<, at date and time \>\"", ",", " ", 
         RowBox[{
          RowBox[{"Date", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fn", "[", "t_", "]"}], "=", 
        RowBox[{
         RowBox[{"fxn", "[", 
          RowBox[{"t", ",", "order"}], "]"}], "//.", "SigmaComRules"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<SigmaComRules Done:  \>\"", ",", " ", 
            RowBox[{
             RowBox[{"Date", "[", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"4", ";;", "5"}], "]"}], "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tempo", "=", 
        RowBox[{"sTrim", "[", 
         RowBox[{
          RowBox[{"fn", "[", "t", "]"}], ",", 
          RowBox[{"maxOmega", "+", "1"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fn", "[", "t_", "]"}], "=", "tempo"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Trimming Done:  \>\"", ",", " ", 
            RowBox[{
             RowBox[{"Date", "[", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"3", ";;", "5"}], "]"}], "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"fn", "[", "t_", "]"}], "=", 
          RowBox[{
           RowBox[{"fn", "[", "t", "]"}], "//", "S"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fn", "[", "t_", "]"}], "=", 
        RowBox[{
         RowBox[{"fn", "[", "t", "]"}], "//", "TrigReduce"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fn", "[", "t_", "]"}], "=", 
        RowBox[{
         RowBox[{"fn", "[", "t", "]"}], "//", "Expand"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Simplify (formerly:  FS) of fn finished:  \>\"", ",", " ", 
            RowBox[{
             RowBox[{"Date", "[", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"3", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<fn[t]//Length = \>\"", ",", 
            RowBox[{
             RowBox[{"fn", "[", "t", "]"}], "//", "Length"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\\n \\n fn[t] = \>\"", ",", 
           RowBox[{"fn", "[", "t", "]"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"lastTF", "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Calculate", " ", "the", " ", "actual", " ", "Magnus", " ", "Term", 
           " ", "for", " ", "a", " ", "period", " ", "tc"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Omega", "[", "t0_", "]"}], "=", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"fn", "[", "tt", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"tt", ",", "t0", ",", 
               RowBox[{"t0", "+", "tc"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"verbose", ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Integration from `t0' to `t0 + tc' done:  \>\"", ",", " ", 
               RowBox[{
                RowBox[{"Date", "[", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"4", ";;", "5"}], "]"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"Omega", "[", "t0_", "]"}], "=", 
             RowBox[{
              RowBox[{"Grim", "[", 
               RowBox[{
                RowBox[{"Omega", "[", "t0", "]"}], ",", 
                FractionBox["1", "ww"], ",", "tc", ",", "t0", ",", 
                RowBox[{"maxOmega", "+", "1"}]}], "]"}], "//", "S"}]}], ";"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Omega", "[", "t0_", "]"}], "=", 
           RowBox[{
            RowBox[{"Omega", "[", "t0", "]"}], "//", "Expand"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"verbose", ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Done.  Returning Omega[t0] @ \>\"", ",", 
               RowBox[{
                RowBox[{"Date", "[", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"3", ";;", "5"}], "]"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"Omega", "[", "t0", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Otherwise", " ", "Calculate", " ", "the", " ", 
           "\"\<intermediate Magnus Term\>\"", " ", "from", " ", "time", " ", 
           "t0", " ", "to", " ", "t"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"OO", "[", 
            RowBox[{"t_", ",", "t0_"}], "]"}], "=", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"fn", "[", "tt", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"tt", ",", "t0", ",", "t"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"verbose", ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Integration from `t0' to `t' done:  \>\"", ",", " ", 
               RowBox[{
                RowBox[{"Date", "[", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;", "5"}], "]"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"tempo", "=", 
             RowBox[{
              RowBox[{"Grim", "[", 
               RowBox[{
                RowBox[{"OO", "[", 
                 RowBox[{"t", ",", "t0"}], "]"}], ",", 
                FractionBox["1", "ww"], ",", "t", ",", "t0", ",", 
                RowBox[{"maxOmega", "+", "1"}]}], "]"}], "//", "S"}]}], ";"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<(2) After applying Grim, tempo = \>\"", ",", "tempo"}], 
             "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"OO", "[", 
              RowBox[{"t_", ",", "t0_"}], "]"}], "=", "tempo"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OO", "[", 
            RowBox[{"t_", ",", "t0_"}], "]"}], "=", 
           RowBox[{
            RowBox[{"OO", "[", 
             RowBox[{"t", ",", "t0"}], "]"}], "//", "Expand"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"verbose", ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Done.  Returning \[CapitalOmega]\[CapitalOmega][t,t0] @ \>\
\"", ",", 
               RowBox[{
                RowBox[{"Date", "[", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;", "5"}], "]"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"OO", "[", 
            RowBox[{"t", ",", "t0"}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<Error in GetOO:  Not returning a value.\>\"", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7140260426925383`*^9, 3.714026049543007*^9}, {
   3.7140264904393272`*^9, 3.7140264975107813`*^9}, {3.714027456679131*^9, 
   3.714027475733078*^9}, {3.714027589984705*^9, 3.714027615942354*^9}, {
   3.714027840155286*^9, 3.714027933791109*^9}, {3.714028032912889*^9, 
   3.7140280699516068`*^9}, {3.7140281420761023`*^9, 3.714028188409039*^9}, {
   3.7140282513105907`*^9, 3.714028261277321*^9}, {3.714028292532201*^9, 
   3.714028308770823*^9}, {3.714028623588571*^9, 3.714029151688439*^9}, {
   3.714029204726091*^9, 3.714029214453555*^9}, {3.714029263348009*^9, 
   3.71402928895323*^9}, {3.714029322912924*^9, 3.714029323856091*^9}, {
   3.714029384852892*^9, 3.714029508144293*^9}, {3.714029544685296*^9, 
   3.71402965435994*^9}, {3.7140298415663033`*^9, 3.7140298946337013`*^9}, 
   3.714031845928854*^9, 3.714032096573615*^9, {3.714032157216181*^9, 
   3.714032169679215*^9}, {3.714032406364376*^9, 3.714032450825303*^9}, {
   3.714032481687807*^9, 3.7140325233977127`*^9}, {3.714032569661084*^9, 
   3.714032577536427*^9}, {3.714032709475704*^9, 3.714032712987866*^9}, {
   3.7140327432125874`*^9, 3.7140327432412977`*^9}, {3.714033500605049*^9, 
   3.714033502500091*^9}, {3.714033693558601*^9, 3.714033698294201*^9}, {
   3.7140369647728558`*^9, 3.7140369839179983`*^9}, {3.714037476309639*^9, 
   3.714037532553767*^9}, {3.714037569641075*^9, 3.714037649124505*^9}, 
   3.714037760598216*^9, {3.714037888168128*^9, 3.714037903752211*^9}, {
   3.714038208503997*^9, 3.714038224030754*^9}, {3.714038376727951*^9, 
   3.7140384034423437`*^9}, {3.7140395592126017`*^9, 3.714039566611388*^9}, 
   3.714040043296257*^9, 3.7140401990146093`*^9, {3.714110345829932*^9, 
   3.7141103641643467`*^9}, {3.714120039299493*^9, 3.714120104192177*^9}, {
   3.714120790766384*^9, 3.714120835009925*^9}, 3.7141211799986153`*^9, {
   3.714121220197948*^9, 3.714121275459208*^9}, 3.7141242053874807`*^9, 
   3.7156156895490484`*^9, {3.715667526010626*^9, 3.715667681164093*^9}, {
   3.7156677743754807`*^9, 3.7156678058632*^9}, {3.715667850612784*^9, 
   3.715667890609943*^9}, {3.715668034610754*^9, 3.715668047650387*^9}, {
   3.715668503797359*^9, 3.715668511227899*^9}, {3.716100614384966*^9, 
   3.716100629592639*^9}, {3.7161007313021708`*^9, 3.716100741172083*^9}, {
   3.716101290030175*^9, 3.716101304108267*^9}, {3.716101418646975*^9, 
   3.7161014571883593`*^9}, {3.716101521112522*^9, 3.716101526785357*^9}, {
   3.7161056272550077`*^9, 3.7161056298235826`*^9}, {3.716105733913231*^9, 
   3.71610578780648*^9}, {3.716105907185014*^9, 3.716105934712315*^9}, 
   3.716106047777412*^9, {3.716106215664777*^9, 3.7161062164963617`*^9}, {
   3.716106267589604*^9, 3.716106279230775*^9}, {3.716106934588006*^9, 
   3.7161069613157167`*^9}, {3.716109272418009*^9, 3.7161092735036707`*^9}, {
   3.716109319278286*^9, 3.716109319740603*^9}, {3.7161094050968323`*^9, 
   3.716109422744524*^9}, 3.716112803650763*^9, {3.716125552788731*^9, 
   3.716125552925077*^9}, {3.716125724412046*^9, 3.7161257304037046`*^9}, {
   3.7161257771308517`*^9, 3.716125778217497*^9}, {3.716125837185573*^9, 
   3.716125846327836*^9}, {3.717130417829729*^9, 3.717130420024781*^9}, {
   3.717130457039091*^9, 3.717130476126556*^9}, {3.7216464850500402`*^9, 
   3.7216465404298897`*^9}, {3.721655444760976*^9, 3.721655495204322*^9}, {
   3.7216563090442867`*^9, 3.721656309410828*^9}, {3.721657098578437*^9, 
   3.721657116394072*^9}, {3.722062422252212*^9, 3.722062445938748*^9}, {
   3.72206277371446*^9, 3.722062773793195*^9}, {3.722062806368455*^9, 
   3.722062806455557*^9}, {3.722063935036903*^9, 3.722063987120311*^9}, 
   3.722076607414689*^9, 3.7220766696368017`*^9, {3.722076835396352*^9, 
   3.72207684025014*^9}, 3.722077815123934*^9, 3.722077941749178*^9, 
   3.7220780244016237`*^9, {3.7220923642351723`*^9, 3.722092367969694*^9}, {
   3.7222819144618015`*^9, 3.722282014785578*^9}, {3.722282072100078*^9, 
   3.722282082115296*^9}, {3.7222821139549513`*^9, 3.7222822172271333`*^9}, {
   3.722338643854249*^9, 3.72233868182863*^9}, {3.722339531150635*^9, 
   3.722339541869759*^9}, {3.7223396319883823`*^9, 3.722339634092937*^9}, 
   3.722339682939569*^9, 3.722339724266879*^9, 3.722584516121903*^9, {
   3.722596719616889*^9, 3.722596762380941*^9}, {3.722597287919258*^9, 
   3.7225973312361727`*^9}, {3.7225973621314707`*^9, 3.72259736288246*^9}, {
   3.722604453752264*^9, 3.722604482922195*^9}, {3.722863543461102*^9, 
   3.72286357516374*^9}, {3.7228637385642548`*^9, 3.7228637532596693`*^9}, 
   3.722863821681571*^9, {3.7228638607243147`*^9, 3.722863862417911*^9}, 
   3.7228639783709373`*^9, {3.722864421500538*^9, 3.7228644231921473`*^9}, 
   3.722866102991184*^9, {3.7228670813682547`*^9, 3.722867082928289*^9}, 
   3.722867425755155*^9, {3.7229402293702097`*^9, 3.7229403160524893`*^9}, {
   3.722941608104253*^9, 3.722941627000263*^9}, {3.723396647013157*^9, 
   3.7233967360893135`*^9}, {3.723975940094746*^9, 3.723975995266087*^9}, {
   3.723977471150168*^9, 3.723977474293599*^9}, {3.723981400704432*^9, 
   3.723981443539872*^9}, 3.7239826953637447`*^9, {3.7239831761782513`*^9, 
   3.723983179114408*^9}, {3.7239838020122957`*^9, 3.723983833087895*^9}, {
   3.723983869983033*^9, 3.7239838922851553`*^9}, 3.723984139315653*^9, {
   3.723984651646055*^9, 3.723984656773494*^9}, 3.7239847249287024`*^9, {
   3.738328634281392*^9, 3.738328674486926*^9}, {3.7383287330531273`*^9, 
   3.738328831127029*^9}},ExpressionUUID->"a03b9462-03f4-4072-95c9-\
0854b4873965"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.722582105462973*^9},ExpressionUUID->"0ef0325a-b40a-402c-87cf-\
6c561d2e1904"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"detMT", " ", "=", " ", 
     RowBox[{
      RowBox[{"determine", " ", "Magnus"}], "-", 
      RowBox[{"Taylor", " ", "Expansion", "\[IndentingNewLine]", 
       RowBox[{"in", ":", "  ", 
        RowBox[{"Hamiltonian", " ", "HH"}]}]}]}]}], ",", " ", 
    RowBox[{"its", " ", "main", " ", "coeffcients", " ", "cfs"}], ",", " ", 
    RowBox[{"offResonant", " ", "[", "Boolean", "]"}]}], " ", 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"detMT", "[", 
     RowBox[{"HH_", ",", "max_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"out", "=", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Clear", "[", 
         RowBox[{"\[CapitalOmega]\[CapitalOmega]", ",", "Omega"}], "]"}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Take", " ", "first", " ", "few", " ", "Magnus", " ", "terms", " ", 
         "from", " ", "Magnus_Formula3"}], "-", 
        RowBox[{"without_commutators", ".", "nb"}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\\n \\n Today's date and time: \>\"", ",", 
         RowBox[{
          RowBox[{"Date", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Calculate Magnus Expansion to max. order (max = \>\"", ",", 
           "max", ",", 
           "\"\<) of (1/ww\!\(\*SuperscriptBox[\()\), \(max\)]\)\>\""}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"SetNonCommutative", "[", "h", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<=", 
          RowBox[{"max", "+", "1"}]}], ",", 
         RowBox[{"ii", "=", 
          RowBox[{"ii", "+", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"fxn", "[", 
            RowBox[{"t_", ",", "ii"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"MagnusM3", "[", 
               RowBox[{"h", ",", "ii"}], "]"}], "/.", 
              RowBox[{"h", "\[Rule]", 
               RowBox[{"H", "[", "t", "]"}]}]}], "//.", "SigmaComRules"}], "//",
             "S"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<Magnus functions have been determined\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"maxxi", "=", "max"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Calculate", " ", "Magnus", " ", "terms", " ", 
         SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "i"]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "max"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "i"], "[", 
            RowBox[{"t_", ",", "t0_"}], "]"}], "=", 
           RowBox[{"sGetOO", "[", 
            RowBox[{"i", ",", "maxxi", ",", "False"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<We find \[CapitalOmega]\[CapitalOmega][i,t,t0] = \>\"", ",", 
              RowBox[{
               SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "i"], "[", 
               RowBox[{"t", ",", "t0"}], "]"}]}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            SubscriptBox["Omega", "i"], "[", "t0_", "]"}], "=", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "i"], "[", 
             RowBox[{
              RowBox[{"t0", "+", "tc"}], ",", "t0"}], "]"}], "//", "S"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"out", "+=", 
           RowBox[{
            SubscriptBox["Omega", "i"], "[", "t0", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<We find \[CapitalOmega]\[CapitalOmega][i,t,t0] = \>\"", ",", 
            RowBox[{
             SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "i"], "[", 
             RowBox[{"t", ",", "t0"}], "]"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "\[Equal]", "1"}], " ", "\[Or]", " ", 
             RowBox[{"i", "\[Equal]", "3"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<i = \>\"", ",", "i"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(\[CapitalOmega]\[CapitalOmega]\), \(i\
\)]\)[t,t0] = \>\"", ",", 
               RowBox[{
                SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "i"], "[", 
                RowBox[{"t", ",", "t0"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["Omega", "i"], "[", "t0_", "]"}], "=", 
        RowBox[{
         RowBox[{"sGetOO", "[", 
          RowBox[{"i", ",", "maxxi", ",", "True"}], "]"}], "//", "S"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<We find \!\(\*SubscriptBox[\(Omega\), \(i\)]\)[t0] = \>\"", ",", 
         RowBox[{
          SubscriptBox["Omega", "i"], "[", "t0", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"out", "=", 
        RowBox[{
         RowBox[{
          FractionBox["I", "tc"], 
          RowBox[{"(", 
           RowBox[{"out", "+", 
            RowBox[{
             SubscriptBox["Omega", "i"], "[", "t0", "]"}]}], ")"}]}], "//", 
         "S"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "out", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7382577663269415`*^9, 3.738257852617877*^9}, {
   3.738269614404346*^9, 3.7382696581228466`*^9}, {3.738269699876235*^9, 
   3.738269728577876*^9}, {3.738269838461161*^9, 3.738269881589628*^9}, {
   3.738270006850793*^9, 3.738270009758959*^9}, {3.7382700773098226`*^9, 
   3.7382702674386973`*^9}, {3.7382702997035427`*^9, 
   3.7382703073369794`*^9}, {3.738270346896242*^9, 3.7382703718366685`*^9}, 
   3.738270449384104*^9, {3.7382705773164215`*^9, 3.738270673908946*^9}, {
   3.738270735189451*^9, 3.7382707792779727`*^9}, {3.7382708259026394`*^9, 
   3.7382708534192133`*^9}, {3.7382710011516633`*^9, 3.738271031071375*^9}, {
   3.7382712259225197`*^9, 3.738271241998439*^9}, {3.738271494374874*^9, 
   3.7382715257276673`*^9}, {3.738271575761529*^9, 3.7382715809938283`*^9}, {
   3.738271795784114*^9, 3.738271795835117*^9}, {3.7382719298017793`*^9, 
   3.7382719331339693`*^9}, 3.738272716143755*^9, 3.7382729798378377`*^9, {
   3.7382733435586414`*^9, 3.738273358362488*^9}, 3.7382734604393263`*^9, {
   3.7382735265811095`*^9, 3.7382735287712345`*^9}, {3.738273606731694*^9, 
   3.7382736129640503`*^9}, {3.738273866732565*^9, 3.738273867786626*^9}, {
   3.7382739175614724`*^9, 3.7382739192765703`*^9}, {3.7382740249946175`*^9, 
   3.7382740433946695`*^9}, {3.7382741436574044`*^9, 
   3.7382741527639256`*^9}, {3.738274307881798*^9, 3.7382743288409967`*^9}, {
   3.7382743855262384`*^9, 3.738274436117132*^9}, {3.738274516934755*^9, 
   3.73827452245407*^9}, 3.7383188632787457`*^9, 3.738319204345688*^9, 
   3.7383193377874413`*^9, {3.7383193722881937`*^9, 3.738319374536162*^9}, {
   3.73832086484177*^9, 3.738320886699071*^9}, 3.738320978112089*^9, {
   3.738321037741432*^9, 3.738321076059493*^9}, {3.738321253837886*^9, 
   3.7383212693367643`*^9}, {3.738321537532569*^9, 3.738321540011644*^9}, {
   3.738321628684793*^9, 3.738321700347206*^9}, 3.738322807805932*^9, 
   3.738323056912747*^9, {3.738323795514761*^9, 3.738323834285145*^9}, {
   3.738326588408806*^9, 3.7383266268608503`*^9}, {3.738326700770171*^9, 
   3.7383267917076273`*^9}, {3.738326857291774*^9, 3.738326894550702*^9}, {
   3.738326972102236*^9, 3.738326973299615*^9}, {3.7383270312437773`*^9, 
   3.738327031385355*^9}, {3.738327187569504*^9, 3.738327188785421*^9}, {
   3.7383277880173683`*^9, 3.7383278023709383`*^9}, {3.7383282524514027`*^9, 
   3.738328261435169*^9}, {3.738328344756502*^9, 3.7383284137622337`*^9}, {
   3.738328516093944*^9, 3.738328539918006*^9}, {3.738329295382944*^9, 
   3.738329357180129*^9}, {3.738329526157064*^9, 3.73832952678786*^9}, {
   3.738329623846909*^9, 3.738329652773315*^9}, {3.7383442598512964`*^9, 
   3.73834429750445*^9}, 3.7383443523405867`*^9, 3.7383444738825383`*^9, {
   3.73834586122289*^9, 3.73834592941279*^9}, {3.738346406788094*^9, 
   3.73834640724512*^9}, {3.7383467854297514`*^9, 3.738346789523985*^9}, {
   3.7383468391248226`*^9, 3.7383468393098326`*^9}, {3.738346933095197*^9, 
   3.7383469565085363`*^9}},ExpressionUUID->"c2caaa47-8766-4b5c-a878-\
224db61919b4"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.722582546982239*^9},ExpressionUUID->"8c75b6d2-ab44-4cba-bcc0-\
41d81a7bc689"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"for", " ", "the", " ", "TAYLOR", " ", "EXPANSION"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7383475185526834`*^9, 
  3.7383475276092014`*^9}},ExpressionUUID->"1b19bbe8-9838-4536-8f91-\
baf1e51d6e6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "create", " ", "a", " ", "replication", " ", "list", " ", "called", " ", 
     "\"\<repList\>\"", " ", "for", " ", "coefficient"}], "-", 
    RowBox[{"list", " ", "\"\<cfs\>\""}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"repList", "[", 
      RowBox[{"max_", ",", "cfs_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myCfs", ",", 
         RowBox[{"rep", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"dds", "=", "\"\<\>\""}], ",", "replaceMe", ",", "withMe"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"remove", " ", "Delta"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myCfs", "=", 
         RowBox[{"cfs", "/.", 
          RowBox[{"Delta", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"loop", " ", "through", " ", "each", " ", "derivative"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "0"}], ",", 
          RowBox[{"i", "\[LessEqual]", "max"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"dds", "=", 
             RowBox[{"dds", "<>", "\"\<D\>\""}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"loop", " ", "through", " ", "each", " ", "coefficient"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{"Length", "[", "myCfs", "]"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"replaceMe", "=", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"myCfs", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"t", ",", "i"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"withMe", "=", 
               RowBox[{"ToExpression", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"myCfs", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "<>", 
                 "dds"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"rep", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"rep", ",", 
                 RowBox[{"{", 
                  RowBox[{"replaceMe", "\[Rule]", "withMe"}], "}"}]}], 
                "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"dds", "=", 
            RowBox[{"dds", "<>", "\"\<D\>\""}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "rep", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"in", ":", "  ", "expression"}], ",", " ", 
     RowBox[{"parameters", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"from", ",", " ", "to"}], "}"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"what", " ", "=", " ", "\"\<add\>\""}], ",", 
     RowBox[{"\"\<remove\>\"", " ", "or", " ", "\"\<change\>\""}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "input", " ", "*", "cfs", "*", " ", "always", " ", "without", " ", "time",
      " ", "dependence"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"changeTimeDep", "[", 
      RowBox[{"input_", ",", "cfs_", ",", "parameters_", ",", "what_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myCfs", ",", "reps"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myCfs", "=", 
         RowBox[{
          RowBox[{"cfs", "/.", 
           RowBox[{"Delta", "\[Rule]", "0"}]}], "//", "S"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"what", "\[Equal]", "\"\<add\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"to", "=", 
            RowBox[{"parameters", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"reps", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"myCfs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "->", 
               RowBox[{
                RowBox[{"myCfs", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", "to", "]"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "myCfs", "]"}]}], "}"}]}], "]"}]}]}]}],
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"what", "\[Equal]", "\"\<remove\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"from", "=", 
            RowBox[{"parameters", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"reps", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"myCfs", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", "from", "]"}], "->", 
               RowBox[{"myCfs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "myCfs", "]"}]}], "}"}]}], "]"}]}]}]}],
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"what", "\[Equal]", "\"\<change\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"from", ",", "to"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"parameters", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"parameters", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"reps", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"myCfs", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", "from", "]"}], "->", 
               RowBox[{
                RowBox[{"myCfs", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "[", 
                RowBox[{"ToExpression", "[", "to", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "myCfs", "]"}]}], "}"}]}], "]"}]}]}]}],
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<reps = \>\"", ",", "reps"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"input", "/.", "reps"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Do", " ", "the", " ", "Taylor"}], "-", "Expansion"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"taylorExp", "[", 
      RowBox[{"max_", ",", "HH_", ",", "cfs_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myRepList", ",", "myCfs", ",", "coeffsRep", ",", "output", ",", 
         "myH"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "many", " ", "coefficients", " ", "need", " ", "time", " ", 
         "dependence"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myH", "=", 
         RowBox[{"changeTimeDep", "[", 
          RowBox[{"HH", ",", "coeffsnD", ",", 
           RowBox[{"{", "t", "}"}], ",", "\"\<add\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<myH = \>\"", ",", "myH"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"myCfs", "=", 
         RowBox[{"changeTimeDep", "[", 
          RowBox[{"cfs", ",", "coeffsnD", ",", 
           RowBox[{"{", "t", "}"}], ",", "\"\<add\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<myCfs = \>\"", ",", "myCfs"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"myRepList", "=", 
         RowBox[{"repList", "[", 
          RowBox[{"max", ",", "cfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<myRepList = \>\"", ",", "myRepList"}], " ", "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"coeffsRep", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"cfs", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Series", "[", 
                RowBox[{
                 RowBox[{"myCfs", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"t", ",", "tr", ",", 
                   RowBox[{"max", "+", "1", "-", "i"}]}], "}"}]}], "]"}], "//",
                "Normal"}], ")"}]}], "/.", "myRepList"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "myCfs", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<coeffsRep = \>\"", ",", "coeffsRep"}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "now", " ", "make", " ", "coeffsRep", " ", "a", " ", "replacement", 
          " ", "table"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"coeffsRep", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"cfs", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "->", 
              RowBox[{"coeffsRep", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<myRepList after time-removal = \>\"", ",", "myRepList"}], " ",
            "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{
          RowBox[{"HH", "/.", "coeffsRep"}], "/.", 
          RowBox[{"(", 
           RowBox[{"myRepList", "/.", 
            RowBox[{"t", "->", "tr"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "output", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7382634506698003`*^9, 3.7382635780740876`*^9}, {
   3.738263618040374*^9, 3.738263755985264*^9}, {3.738263788568127*^9, 
   3.7382638530078125`*^9}, 3.7382639121991987`*^9, {3.7382639523754964`*^9, 
   3.738264093949594*^9}, {3.738264144597491*^9, 3.7382641476846676`*^9}, {
   3.738264244369198*^9, 3.7382642445912104`*^9}, {3.7382643537804556`*^9, 
   3.738264531075596*^9}, {3.738264660576003*^9, 3.7382647293019342`*^9}, {
   3.7382647632968783`*^9, 3.738264819844113*^9}, {3.738264865565728*^9, 
   3.7382649784251833`*^9}, {3.7382650704894485`*^9, 
   3.7382650967979536`*^9}, {3.7382651515530853`*^9, 
   3.7382652938732257`*^9}, {3.7382653960730715`*^9, 3.738265398382203*^9}, {
   3.738265602252864*^9, 3.73826571162712*^9}, {3.7382657752227573`*^9, 
   3.738265790103608*^9}, {3.7382658247175884`*^9, 3.738265841413543*^9}, {
   3.7382659903950644`*^9, 3.7382659921261635`*^9}, {3.738266029377294*^9, 
   3.738266048315377*^9}, {3.7383474805835114`*^9, 3.738347493929275*^9}, 
   3.738583755815371*^9},ExpressionUUID->"6d5e0fc6-9fea-4bd6-bde1-\
d5bdf0ca8c0f"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7383475204417915`*^9, 
  3.738347520568799*^9}},ExpressionUUID->"255f9a08-a202-4075-aff2-\
a033e48861bb"],

Cell[BoxData[
 RowBox[{"(*", "  ", 
  RowBox[{"**", "**", "   ", "Coefficients", "  ", "**", "**"}], "  ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7383436690145025`*^9, 
  3.7383437031074524`*^9}},ExpressionUUID->"4c9828c4-fbcd-4470-8259-\
bd0b9f54c2d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"coeffs", " ", "=", " ", 
    RowBox[{
    "coefficients", " ", "of", " ", "effective", " ", "Hamiltonian"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"coeffs", "=", 
     RowBox[{"setCList", "[", 
      RowBox[{"coeffs1", ",", 
       RowBox[{"max", "+", "1"}], ",", "offResonant"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"coeffs", " ", "no", " ", 
     RowBox[{"Delta", " ", "[", 
      RowBox[{"for", " ", "the", " ", "Taylor", " ", "Expansion"}], "]"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffsnD", "=", 
     RowBox[{"setCList", "[", 
      RowBox[{"coeffs1", ",", 
       RowBox[{"max", "+", "1"}], ",", "False"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myCList", "=", 
     RowBox[{"detCList", "[", 
      RowBox[{"coeffs", ",", 
       RowBox[{"max", "+", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",ExpressionUUID->"4645fef6-2d6c-4430-\
8609-49f37ca48f3b"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.7383436638592076`*^9},ExpressionUUID->"6382a5a4-ca29-41d1-a1f0-\
07927acff0e3"],

Cell[CellGroupData[{

Cell[BoxData["myCList"], "Input",
 CellChangeTimes->{{3.738583683825585*^9, 
  3.738583685160684*^9}},ExpressionUUID->"42c005aa-6a0d-444e-8240-\
188a30ad2946"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "H1", "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "H1D", "}"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "H1DD", "}"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      SuperscriptBox["H1", "2"], "}"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      SuperscriptBox["H1", "3"], "}"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"H1", ",", "H1D"}], "}"}], ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.738583685426935*^9},ExpressionUUID->"f5402cf0-f721-4b0d-b20e-\
fcafa9eddda0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["coeffsnD"], "Input",
 CellChangeTimes->{{3.7385836979530287`*^9, 
  3.738583710364627*^9}},ExpressionUUID->"78bdce34-a02d-4034-95ea-\
919751bb24f0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"H1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"H1D", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"H1DD", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"H1DDD", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.738583704305657*^9, 
  3.73858371088717*^9}},ExpressionUUID->"ca01caeb-adf8-4f7f-9c8d-\
1becd9a0f9e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["coeffs"], "Input",ExpressionUUID->"afc54591-3027-4813-b48a-34fd7ea81abf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"H1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"H1D", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"H1DD", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"H1DDD", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.73858368120924*^9},ExpressionUUID->"28b9bb96-29d7-49ec-bda9-fbad7f9c0dc4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"taylorExp", "[", 
  RowBox[{"3", ",", 
   RowBox[{"H1", "[", "t", "]"}], ",", "myCList"}], "]"}]], "Input",
 CellChangeTimes->{{3.7385836193277197`*^9, 3.738583627460696*^9}, {
  3.738583667709649*^9, 
  3.738583692244738*^9}},ExpressionUUID->"bb8a142d-631b-40f8-b76e-\
9a0965c61b2d"],

Cell[BoxData[
 RowBox[{"H1", "[", "t", "]"}]], "Output",
 CellChangeTimes->{{3.7385836719889603`*^9, 
  3.738583692624626*^9}},ExpressionUUID->"3c3f6334-698a-4fb2-aeb6-\
518310b596e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["coeffs"], "Input",
 CellChangeTimes->{{3.738583660610865*^9, 
  3.738583662054222*^9}},ExpressionUUID->"e92dcefb-9695-4861-b67b-\
f44fb6d64a9e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"H1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"H1D", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"H1DD", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"H1DDD", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.738583662416012*^9},ExpressionUUID->"b83d5690-4008-40a6-9067-\
22bb06717836"]
}, Open  ]]
},
WindowSize->{1087, 864},
WindowMargins->{{54, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> True}},
ShowSelection->True,
Magnification:>1.5 Inherited,
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 971, 22, 105, "Input",ExpressionUUID->"6c047262-06f7-4def-b8fd-544910e5d36a"],
Cell[CellGroupData[{
Cell[1554, 46, 220, 5, 105, "Input",ExpressionUUID->"845f275c-6c08-4cf6-aa2c-f379f0baa0b6"],
Cell[CellGroupData[{
Cell[1799, 55, 311, 5, 36, "Print",ExpressionUUID->"60389d04-dd91-4e75-a892-d783efeed7d7"],
Cell[2113, 62, 460, 10, 36, "Print",ExpressionUUID->"3030fbff-19dc-465e-91b5-18b8bd259595"],
Cell[2576, 74, 538, 10, 36, "Print",ExpressionUUID->"8a935431-7954-4f43-869f-1027ad10ef0c"],
Cell[3117, 86, 287, 4, 36, "Print",ExpressionUUID->"39dff0fa-2d79-4851-8226-3a6d7d203ab1"]
}, Open  ]]
}, Open  ]],
Cell[3431, 94, 9635, 161, 646, "Input",ExpressionUUID->"c397ca24-69a4-493f-91d3-ee70d5e86823"],
Cell[13069, 257, 428, 8, 304, "Input",ExpressionUUID->"1ba2070e-713d-4b94-acca-5db7a2ace5f9"],
Cell[13500, 267, 152, 3, 46, "Input",ExpressionUUID->"6c5a2d12-093b-4ede-b78c-46a21d94da9b"],
Cell[CellGroupData[{
Cell[13677, 274, 662, 14, 76, "Input",ExpressionUUID->"216b6541-5ed8-42d2-8113-a101a0036f9f"],
Cell[14342, 290, 5222, 75, 46, "Output",ExpressionUUID->"def05332-c18d-4a8f-927c-c141481853dc"],
Cell[19567, 367, 5376, 77, 48, "Output",ExpressionUUID->"e4f27691-88b3-44cb-b2f1-99fd0a2ec795"]
}, Open  ]],
Cell[24958, 447, 3206, 93, 304, "Input",ExpressionUUID->"4c722c32-8986-4382-b985-5ed8d352bedb"],
Cell[CellGroupData[{
Cell[28189, 544, 485, 12, 76, "Input",ExpressionUUID->"ef4d6b76-dd69-4ca5-8a29-44bc36ef55cd"],
Cell[28677, 558, 5346, 79, 46, "Output",ExpressionUUID->"c58f1fea-de1f-403e-b544-5bfe65efd992"],
Cell[34026, 639, 5377, 80, 46, "Output",ExpressionUUID->"89b9692d-a4fc-48f4-9357-77e5115e6851"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39440, 724, 322, 9, 46, "Input",ExpressionUUID->"7f6f8020-75c4-4947-847d-46fe016a1d0e"],
Cell[39765, 735, 5187, 78, 46, "Output",ExpressionUUID->"55d970ca-5980-4088-a44c-5d2c3016d588"]
}, Open  ]],
Cell[44967, 816, 5744, 159, 333, "Input",ExpressionUUID->"0bbddc1d-3f62-43ff-807b-86b45d7253ea"],
Cell[CellGroupData[{
Cell[50736, 979, 291, 7, 76, "Input",ExpressionUUID->"a01a8235-36c3-430d-8461-19c7114d6214"],
Cell[51030, 988, 5107, 73, 46, "Output",ExpressionUUID->"9bef4048-d673-4cfe-b5f1-3a28dc77d9c7"],
Cell[56140, 1063, 5111, 73, 46, "Output",ExpressionUUID->"d5a0ba4b-c0e4-4e24-b9e6-368972947bd8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61288, 1141, 1114, 34, 46, "Input",ExpressionUUID->"03a9572e-09d8-4e00-a2f8-af978cde0e91"],
Cell[62405, 1177, 6015, 102, 46, "Output",ExpressionUUID->"f674b8b2-654e-443a-85ec-9b8fa5794c81"]
}, Open  ]],
Cell[68435, 1282, 150, 3, 46, "Input",ExpressionUUID->"2819428d-c3e8-429d-a13c-f5104770ae41"],
Cell[68588, 1287, 492, 10, 88, "Text",ExpressionUUID->"87ac8d07-10f9-485b-be11-6a4a324f32d8"],
Cell[69083, 1299, 4786, 131, 504, "Input",ExpressionUUID->"3140e23a-edfa-4156-8d0f-b5a7b0a7533a"],
Cell[73872, 1432, 206, 4, 105, "Input",ExpressionUUID->"09f3bd6e-ba21-4e4e-b3e3-96555f76aa63"],
Cell[74081, 1438, 206, 4, 105, "Input",ExpressionUUID->"0307b34c-3907-409a-b408-b03cbc85c648"],
Cell[74290, 1444, 346, 7, 39, "Text",ExpressionUUID->"b3b7d255-8074-42f4-a0ee-3d14a0074b4b"],
Cell[74639, 1453, 8643, 188, 858, "Input",ExpressionUUID->"ccabe858-fe33-4de0-be08-7331aa9d41a3"],
Cell[83285, 1643, 234, 5, 133, "Input",ExpressionUUID->"adb30d95-e908-4d2c-9c8e-5886451f92d9"],
Cell[83522, 1650, 252, 6, 46, "Input",ExpressionUUID->"6342f5e2-8b8b-4fb8-aa85-77dbbbde7a01"],
Cell[83777, 1658, 3882, 101, 504, "Input",ExpressionUUID->"1d12a89a-53cc-40b3-99c2-9b9f52b72533"],
Cell[87662, 1761, 12261, 269, 1228, "Input",ExpressionUUID->"1c0dbf3f-8518-4498-85f4-38a88ff7acc8"],
Cell[99926, 2032, 147, 3, 76, "Input",ExpressionUUID->"46514008-5004-4b95-aa49-289073451663"],
Cell[100076, 2037, 8415, 166, 789, "Input",ExpressionUUID->"c3c80b85-1444-40c1-85d3-8cda474a03a6"],
Cell[108494, 2205, 208, 4, 105, "Input",ExpressionUUID->"552601b9-58eb-4846-9aeb-14077abbe02f"],
Cell[108705, 2211, 206, 4, 105, "Input",ExpressionUUID->"f5c1929c-d0da-4264-8437-12c8eec89070"],
Cell[108914, 2217, 152, 3, 46, "Input",ExpressionUUID->"0ab08077-9da1-419a-b558-8f13b4f6c66b"],
Cell[109069, 2222, 16530, 343, 1800, "Input",ExpressionUUID->"a03b9462-03f4-4072-95c9-0854b4873965"],
Cell[125602, 2567, 147, 3, 77, "Input",ExpressionUUID->"0ef0325a-b40a-402c-87cf-6c561d2e1904"],
Cell[125752, 2572, 9689, 208, 1052, "Input",ExpressionUUID->"c2caaa47-8766-4b5c-a878-224db61919b4"],
Cell[135444, 2782, 147, 3, 77, "Input",ExpressionUUID->"8c75b6d2-ab44-4cba-bcc0-41d81a7bc689"],
Cell[135594, 2787, 254, 6, 47, "Input",ExpressionUUID->"1b19bbe8-9838-4536-8f91-baf1e51d6e6d"],
Cell[135851, 2795, 13510, 326, 2020, "Input",ExpressionUUID->"6d5e0fc6-9fea-4bd6-bde1-d5bdf0ca8c0f"],
Cell[149364, 3123, 208, 4, 106, "Input",ExpressionUUID->"255f9a08-a202-4075-aff2-a033e48861bb"],
Cell[149575, 3129, 257, 6, 47, "Input",ExpressionUUID->"4c9828c4-fbcd-4470-8259-bd0b9f54c2d0"],
Cell[149835, 3137, 1086, 31, 193, "Input",ExpressionUUID->"4645fef6-2d6c-4430-8609-49f37ca48f3b"],
Cell[150924, 3170, 149, 3, 77, "Input",ExpressionUUID->"6382a5a4-ca29-41d1-a1f0-07927acff0e3"],
Cell[CellGroupData[{
Cell[151098, 3177, 159, 3, 47, "Input",ExpressionUUID->"42c005aa-6a0d-444e-8240-188a30ad2946"],
Cell[151260, 3182, 759, 26, 50, "Output",ExpressionUUID->"f5402cf0-f721-4b0d-b20e-fcafa9eddda0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152056, 3213, 162, 3, 47, "Input",ExpressionUUID->"78bdce34-a02d-4034-95ea-919751bb24f0"],
Cell[152221, 3218, 424, 13, 47, "Output",ExpressionUUID->"ca01caeb-adf8-4f7f-9c8d-1becd9a0f9e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152682, 3236, 87, 0, 47, "Input",ExpressionUUID->"afc54591-3027-4813-b48a-34fd7ea81abf"],
Cell[152772, 3238, 398, 12, 47, "Output",ExpressionUUID->"28b9bb96-29d7-49ec-bda9-fbad7f9c0dc4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153207, 3255, 308, 7, 47, "Input",ExpressionUUID->"bb8a142d-631b-40f8-b76e-9a0965c61b2d"],
Cell[153518, 3264, 184, 4, 47, "Output",ExpressionUUID->"3c3f6334-698a-4fb2-aeb6-518310b596e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153739, 3273, 158, 3, 47, "Input",ExpressionUUID->"e92dcefb-9695-4861-b67b-f44fb6d64a9e"],
Cell[153900, 3278, 401, 13, 47, "Output",ExpressionUUID->"b83d5690-4008-40a6-9067-22bb06717836"]
}, Open  ]]
}
]
*)

