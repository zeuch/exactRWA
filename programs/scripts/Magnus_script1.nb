(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    309164,       6391]
NotebookOptionsPosition[    299756,       6255]
NotebookOutlinePosition[    300237,       6274]
CellTagsIndexPosition[    300194,       6271]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Derivation", " ", "of", " ", "Magnus", " ", "terms", " ", "sketched", " ",
     "in", " ", 
    RowBox[{"FlipFlop", ".", "pdf", "."}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"You", "'"}], "re", " ", "not", " ", "using", " ", "commutators", 
    " ", "from", " ", "\"\<Quantum Unit\>\"", " ", 
    RowBox[{"(", 
     RowBox[{
     "or", " ", "whatever", " ", "this", " ", "MM", " ", "little", " ", 
      "package", " ", "is", " ", "called"}], ")"}], " ", "to", " ", 
    "calculate", " ", "these", " ", "terms", " ", "yet"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.685081133724957*^9, 3.6850811441514387`*^9}, {
  3.687060963025004*^9, 3.68706101373247*^9}, {3.68706106785851*^9, 
  3.6870611077671824`*^9}, {3.688473981694998*^9, 3.688474010772595*^9}, {
  3.68847736135122*^9, 3.688477428012034*^9}},
 CellLabel->
  "In[354]:=",ExpressionUUID->"6c047262-06f7-4def-b8fd-544910e5d36a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.739077156745366*^9, 3.73907715687915*^9}},
 CellLabel->
  "In[355]:=",ExpressionUUID->"facbcaac-a43a-4b57-9a7f-e9ec53e6e894"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.739078563868722*^9, 3.739078565191019*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"721288f1-7c6e-49b5-80bd-e47d1ece0c72"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["0.   Definitions and Replacements",
 FontColor->RGBColor[1, 0, 0]]], "Section",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738406695464067*^9, 3.738406699136009*^9}, {
   3.7384068847910023`*^9, 3.7384068906466017`*^9}, {3.739077161790329*^9, 
   3.7390771631346607`*^9}},ExpressionUUID->"32eb6d27-127e-44d5-b111-\
2a6c45ac5f51"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"some", " ", "standard", " ", "replacements"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"repStd", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ww", "\[Rule]", "\[Omega]"}], ",", 
       RowBox[{"phi10", "\[Rule]", "\[Phi]"}], ",", 
       RowBox[{"\[Alpha]0", "\[Rule]", 
        SubscriptBox["\[Alpha]", "0"]}], ",", 
       RowBox[{"\[Beta]0", "\[Rule]", 
        SubscriptBox["\[Beta]", "0"]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"repSigma", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sigx", "\[Rule]", 
        SubscriptBox["\[Sigma]", "x"]}], ",", 
       RowBox[{"sigy", "\[Rule]", 
        SubscriptBox["\[Sigma]", "y"]}], ",", 
       RowBox[{"sigz", "\[Rule]", 
        SubscriptBox["\[Sigma]", "z"]}], ",", 
       RowBox[{"sx", "\[Rule]", 
        SubscriptBox["\[Sigma]", "x"]}], ",", 
       RowBox[{"sy", "\[Rule]", 
        SubscriptBox["\[Sigma]", "y"]}], ",", 
       RowBox[{"sz", "\[Rule]", 
        SubscriptBox["\[Sigma]", "z"]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"repField", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"field", "[", "t", "]"}], "\[Rule]", 
        SubscriptBox["H", "1"]}], ",", 
       RowBox[{"H1", "\[Rule]", 
        SubscriptBox["H", "1"]}], ",", 
       RowBox[{
        RowBox[{"der", "[", "t", "]"}], "\[Rule]", "H1D"}], ",", 
       RowBox[{
        RowBox[{"dder", "[", "t", "]"}], "\[Rule]", "H1DD"}], ",", 
       RowBox[{"Delta", "\[Rule]", "\[CapitalDelta]"}], ",", 
       RowBox[{"factor", "\[Rule]", 
        FractionBox["\[Alpha]", 
         RowBox[{"2", "\[Pi]"}]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"repAll", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"repStd", ",", "repSigma", ",", "repField"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"repAlmostAll", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"repStd", ",", "repSigma"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"replace", " ", 
     RowBox[{"\[Alpha]", "'"}], "s", " ", "by", " ", 
     RowBox[{"\[Beta]", "'"}], "s"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reppieInv", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Alpha]d", "\[Rule]", 
        RowBox[{"\[Beta]d", "/", "2"}]}], ",", 
       RowBox[{"\[Alpha]0", "->", 
        RowBox[{"\[Beta]0", "/", "2"}]}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.708417463999497*^9, 3.708417519157556*^9}, {
   3.7084176139471273`*^9, 3.7084177531278*^9}, {3.7084187857652397`*^9, 
   3.708418839956107*^9}, {3.708418892043058*^9, 3.708418907777925*^9}, {
   3.708418942529386*^9, 3.708419014535634*^9}, {3.7084190461826773`*^9, 
   3.7084191341799393`*^9}, {3.708666253918775*^9, 3.708666260446843*^9}, {
   3.7086669333748407`*^9, 3.708666948220437*^9}, {3.70866732588413*^9, 
   3.708667329389174*^9}, {3.708670225962925*^9, 3.7086702481603413`*^9}, {
   3.708670301181498*^9, 3.7086703040461063`*^9}, {3.7086704454689207`*^9, 
   3.708670454157424*^9}, {3.708676525040682*^9, 3.70867652888789*^9}, {
   3.7086823393848658`*^9, 3.708682342538103*^9}, {3.708682577781261*^9, 
   3.70868260051527*^9}, {3.724326842291248*^9, 3.724326846290477*^9}, {
   3.727333466108415*^9, 3.727333477700078*^9}, {3.73479288118368*^9, 
   3.7347929164049253`*^9}, 3.7351190713679028`*^9, {3.739079482200016*^9, 
   3.739079493911941*^9}, {3.809340278932212*^9, 3.8093402837384443`*^9}},
 CellLabel->
  "In[357]:=",ExpressionUUID->"7b9a0358-b6f3-42de-9a69-8c89a2d1f220"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"some", " ", "standard", " ", "definitions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "=", "Simplify"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FS", "=", "FullSimplify"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MF", "=", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "NC`"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "NCAlgebra`"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"General", "::", "spell1"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Off", "[", 
    RowBox[{"MatrixExp", "::", "eivn"}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6854280721762667`*^9, 3.685428156252984*^9}, {
   3.685428365025311*^9, 3.685428377730204*^9}, {3.685428591773527*^9, 
   3.685428743998624*^9}, {3.685428809659196*^9, 3.6854288144749947`*^9}, {
   3.6854289356614733`*^9, 3.685428982906287*^9}, {3.6854290605583076`*^9, 
   3.6854291812796717`*^9}, {3.685438584466955*^9, 3.685438606182131*^9}, {
   3.685438728756711*^9, 3.685438757684882*^9}, {3.6854430264239073`*^9, 
   3.6854430455273657`*^9}, {3.685443099688509*^9, 3.685443111700201*^9}, {
   3.685443186072546*^9, 3.685443357654079*^9}, {3.685443388373611*^9, 
   3.685443492840063*^9}, {3.685443672744789*^9, 3.6854437023164387`*^9}, {
   3.6854437482347507`*^9, 3.685443800007066*^9}, {3.685444080064969*^9, 
   3.6854441545573893`*^9}, {3.685444219494914*^9, 3.6854442521279097`*^9}, {
   3.685444325533291*^9, 3.685444331012267*^9}, {3.685444367714292*^9, 
   3.685444404112564*^9}, {3.685444442494067*^9, 3.685444608397945*^9}, {
   3.6854449240940228`*^9, 3.685445147075528*^9}, 3.685445246172552*^9, {
   3.685445288210637*^9, 3.68544546860104*^9}, {3.685445740690527*^9, 
   3.6854459347224703`*^9}, {3.685445985342507*^9, 3.685446183148288*^9}, 
   3.685446296111268*^9, 3.685446327406671*^9, {3.685446380002393*^9, 
   3.685446499635841*^9}, {3.685446564152755*^9, 3.6854465643893948`*^9}, {
   3.6854466020556173`*^9, 3.685446619941609*^9}, {3.685446697850505*^9, 
   3.685446698825523*^9}, {3.685446738304585*^9, 3.685446740815366*^9}, 
   3.685446775022687*^9, {3.685446807349608*^9, 3.685446907182836*^9}, {
   3.685446942589156*^9, 3.6854470153877487`*^9}, 3.68544706215914*^9, {
   3.685447104302463*^9, 3.685447258501079*^9}, {3.685447401915511*^9, 
   3.685447407458702*^9}, {3.685447521623539*^9, 3.685447830783773*^9}, {
   3.685447938795052*^9, 3.685448063475031*^9}, {3.685448094457341*^9, 
   3.685448139247037*^9}, {3.685448312534136*^9, 3.685448331293077*^9}, {
   3.685448747815238*^9, 3.6854487483913183`*^9}, {3.685448795861264*^9, 
   3.685448815756217*^9}, {3.685448863866296*^9, 3.6854488666662703`*^9}, {
   3.68544894970197*^9, 3.685448969876096*^9}, {3.685449124141901*^9, 
   3.6854491829291897`*^9}, {3.685449239055122*^9, 3.685449268372387*^9}, {
   3.685449343033641*^9, 3.685449401237926*^9}, {3.685449442387971*^9, 
   3.685449453594746*^9}, {3.685449521096662*^9, 3.685449672127655*^9}, {
   3.6854497671231947`*^9, 3.685449827288219*^9}, {3.685449969528926*^9, 
   3.685450108353345*^9}, {3.6854504132021513`*^9, 3.685450421305258*^9}, {
   3.685450503989087*^9, 3.685450523764933*^9}, {3.685450641533947*^9, 
   3.6854506430218277`*^9}, {3.6854507726794243`*^9, 3.685450773006978*^9}, {
   3.685450821492547*^9, 3.685450825460247*^9}, {3.685450869426158*^9, 
   3.685450869610022*^9}, {3.6854509536377153`*^9, 3.685450975660213*^9}, {
   3.685451020257968*^9, 3.685451029801701*^9}, {3.685451064479903*^9, 
   3.685451192360969*^9}, {3.685451355284073*^9, 3.685451410398123*^9}, {
   3.685451444924185*^9, 3.685451452299707*^9}, {3.685451790291039*^9, 
   3.685451795650496*^9}, {3.685451842232213*^9, 3.6854518652143717`*^9}, {
   3.685451899860577*^9, 3.685451907188558*^9}, {3.685452159831252*^9, 
   3.685452164870726*^9}, {3.685452287777194*^9, 3.6854523935626507`*^9}, {
   3.68545323905908*^9, 3.685453283628357*^9}, {3.685453316074792*^9, 
   3.685453373935953*^9}, {3.6854534055899057`*^9, 3.68545343116488*^9}, {
   3.685453461843294*^9, 3.6854535673969593`*^9}, {3.685453598836355*^9, 
   3.685453626490649*^9}, {3.685454172958167*^9, 3.6854542338509007`*^9}, 
   3.68545429215287*^9, {3.685454382939279*^9, 3.6854544167214117`*^9}, {
   3.685460676575384*^9, 3.6854607149674673`*^9}, {3.685461712132866*^9, 
   3.685461721484438*^9}, {3.685461910538969*^9, 3.685461929912917*^9}, {
   3.685467909913105*^9, 3.685467938720428*^9}, {3.685468004316504*^9, 
   3.685468039483872*^9}, {3.685468112494627*^9, 3.685468126346159*^9}, {
   3.6856770823420343`*^9, 3.685677087398638*^9}, {3.685677443212776*^9, 
   3.685677464555159*^9}, {3.685677533960013*^9, 3.685677610283165*^9}, {
   3.685677713797711*^9, 3.685677734996669*^9}, {3.685678055828665*^9, 
   3.68567808287997*^9}, {3.685678118626307*^9, 3.685678127225037*^9}, {
   3.685678160759049*^9, 3.685678161072011*^9}, {3.6856782033731422`*^9, 
   3.685678242226836*^9}, {3.685678275273377*^9, 3.685678281593624*^9}, {
   3.685678517561801*^9, 3.685678527992001*^9}, 3.6856810261894627`*^9, {
   3.685684500852409*^9, 3.685684511257571*^9}, 3.6856845609500513`*^9, {
   3.685684617647122*^9, 3.68568462478948*^9}, {3.68568467052174*^9, 
   3.685684672575316*^9}, {3.6856847462405567`*^9, 3.685684751670946*^9}, {
   3.6856847852129307`*^9, 3.685684798221465*^9}, {3.685684869852549*^9, 
   3.6856848716049433`*^9}, 3.6856849209776783`*^9, {3.685684963379821*^9, 
   3.685684993474588*^9}, {3.6856850453838673`*^9, 3.685685079150231*^9}, {
   3.6856851454279737`*^9, 3.685685199884295*^9}, {3.685685803137822*^9, 
   3.6856858196729603`*^9}, {3.685685890293558*^9, 3.68568590342048*^9}, {
   3.6856859444424753`*^9, 3.6856859738727217`*^9}, {3.685686009879936*^9, 
   3.685686060404449*^9}, 3.68568609225881*^9, {3.685686131824669*^9, 
   3.6856861713911533`*^9}, {3.685686397720549*^9, 3.685686405159937*^9}, {
   3.6856865848423367`*^9, 3.685686595097632*^9}, {3.6856868181547403`*^9, 
   3.685686833969338*^9}, {3.685687145758114*^9, 3.6856872547337627`*^9}, {
   3.6856875152263107`*^9, 3.685687553079838*^9}, {3.6856876776466293`*^9, 
   3.685687691350555*^9}, {3.685687788541012*^9, 3.685687791044339*^9}, 
   3.685687902788308*^9, {3.685687934198107*^9, 3.685687961424757*^9}, {
   3.6856883505193787`*^9, 3.68568835825502*^9}, {3.685688566812989*^9, 
   3.685688566948283*^9}, {3.6856886158259363`*^9, 3.68568863147302*^9}, {
   3.685688665255026*^9, 3.6856886663914547`*^9}, {3.6856887137661533`*^9, 
   3.685688777474218*^9}, {3.685688818919153*^9, 3.685688979799198*^9}, {
   3.685694321989048*^9, 3.685694587624444*^9}, {3.6856946664037952`*^9, 
   3.685694705697022*^9}, {3.6857017929912033`*^9, 3.685701817365686*^9}, {
   3.685701954366891*^9, 3.685701961030011*^9}, {3.68570204019425*^9, 
   3.685702040442431*^9}, {3.686056022731269*^9, 3.686056025865938*^9}, 
   3.686222529616403*^9, 3.6869020173826017`*^9, {3.686902081386014*^9, 
   3.686902178460608*^9}, {3.68690284700167*^9, 3.686902908118828*^9}, {
   3.686903871466975*^9, 3.686903888010007*^9}, {3.686933037851474*^9, 
   3.6869330774455366`*^9}, {3.6869331137645917`*^9, 
   3.6869332634208565`*^9}, {3.6869337007045827`*^9, 
   3.6869337059825907`*^9}, {3.686935558359727*^9, 3.686935583256764*^9}, {
   3.6869356218538313`*^9, 3.686935653508877*^9}, {3.6869359928404193`*^9, 
   3.6869360801775723`*^9}, {3.686936182417734*^9, 3.686936186351741*^9}, {
   3.6869391872982807`*^9, 3.6869392593933845`*^9}, {3.6869393041524625`*^9, 
   3.686939327938496*^9}, 3.68693941177462*^9, {3.6869394922027445`*^9, 
   3.6869394924927444`*^9}, {3.6869907545761137`*^9, 
   3.6869907571645193`*^9}, {3.6869908414498987`*^9, 
   3.6869908423431005`*^9}, {3.687060432655922*^9, 3.687060444542066*^9}, {
   3.687464392693749*^9, 3.6874644835620985`*^9}, {3.6874650304728203`*^9, 
   3.68746507189919*^9}, {3.6874651597022114`*^9, 3.6874652024066544`*^9}, {
   3.6875952592998123`*^9, 3.687595260875415*^9}, {3.6876342145274076`*^9, 
   3.6876342211106195`*^9}, 3.688473889606106*^9, {3.6884739299403667`*^9, 
   3.688473961208825*^9}, {3.707053676399847*^9, 3.707053679002863*^9}, {
   3.713243720544136*^9, 3.713243721513112*^9}, {3.739077182694868*^9, 
   3.739077186645855*^9}},
 CellLabel->
  "In[363]:=",ExpressionUUID->"c397ca24-69a4-493f-91d3-ee70d5e86823"],

Cell[CellGroupData[{

Cell[BoxData["\<\"You are using the version of NCAlgebra which is found in:\"\
\>"], "Print",
 CellChangeTimes->{
  3.6875957642755876`*^9, 3.687596465956484*^9, 3.6875965087511606`*^9, {
   3.687616536110959*^9, 3.687616539750766*^9}, {3.6876234100207014`*^9, 
   3.6876234337100563`*^9}, {3.687633781564247*^9, 3.687633783529851*^9}, 
   3.6876348186384687`*^9, 3.687677723844741*^9, 3.687706768356993*^9, 
   3.687707491637083*^9, 3.6877078549999447`*^9, 3.687708189582591*^9, 
   3.6877082345328984`*^9, 3.6877082926617312`*^9, 3.6877083676920357`*^9, 
   3.687708440983179*^9, 3.688108187570294*^9, {3.688126729502204*^9, 
   3.688126758286948*^9}, {3.68812679424172*^9, 3.688126796287423*^9}, 
   3.688479025891611*^9, 3.688479066897704*^9, 3.688479139251226*^9, 
   3.688479183103503*^9, 3.688479872287781*^9, 3.688480014341976*^9, 
   3.688481121026812*^9, 3.688481973619272*^9, 3.688482031399469*^9, 
   3.688482159715405*^9, 3.688482240132962*^9, {3.688482367136018*^9, 
   3.688482392837454*^9}, 3.6884860184996357`*^9, 3.688486806086255*^9, 
   3.6884869666143084`*^9, 3.688487297848445*^9, 3.688536856131538*^9, 
   3.688540341926879*^9, 3.6885472836829596`*^9, 3.688547322658189*^9, 
   3.6885474462252564`*^9, 3.6885495628543205`*^9, 3.6885495939571*^9, 
   3.6887158339400473`*^9, 3.688716413125424*^9, 3.688716577553854*^9, 
   3.6887216190570602`*^9, 3.68872174705774*^9, 3.6887218968939953`*^9, 
   3.6887220319016438`*^9, 3.688724230379426*^9, 3.688726702308757*^9, 
   3.688727085747422*^9, 3.6887283321020403`*^9, 3.6887284340546427`*^9, 
   3.688728699566532*^9, 3.6887287519222527`*^9, 3.688733850698881*^9, 
   3.688884454509386*^9, 3.688884775455473*^9, 3.688884877216729*^9, 
   3.688884946321968*^9, 3.689259271445711*^9, 3.689259664102425*^9, 
   3.692095559547117*^9, 3.69209615700629*^9, 3.692105400577992*^9, 
   3.6921054427044015`*^9, 3.692447360377915*^9, 3.693491149002578*^9, 
   3.693491193475884*^9, 3.7037436513289223`*^9, 3.7037442167312613`*^9, 
   3.703758446748258*^9, 3.703766084566659*^9, 3.703766767340222*^9, 
   3.703766930506926*^9, 3.703768892803115*^9, 3.703769128728662*^9, 
   3.7037693044503527`*^9, 3.703769356513098*^9, 3.703770601372628*^9, 
   3.7037708248872747`*^9, 3.703771164049481*^9, 3.703852867713554*^9, 
   3.703853010454458*^9, 3.703910545181904*^9, 3.703910615414906*^9, 
   3.705119037006193*^9, 3.706012742734775*^9, 3.7060129297487507`*^9, 
   3.7060136490259657`*^9, 3.7060176385457087`*^9, 3.706166780407482*^9, 
   3.706167569450364*^9, 3.7061692386056347`*^9, 3.706173428141816*^9, 
   3.70617350111336*^9, 3.706862882396907*^9, 3.706870334169496*^9, 
   3.7068751507912683`*^9, 3.706876613693461*^9, 3.706877261353292*^9, 
   3.7069480626377077`*^9, 3.707022603484414*^9, {3.707024674004704*^9, 
   3.7070246956869583`*^9}, 3.707025281528778*^9, 3.707107789824719*^9, 
   3.707112419035303*^9, 3.7071141898800592`*^9, 3.7071153205252123`*^9, 
   3.7071213533237534`*^9, 3.707129156310727*^9, 3.707129220709956*^9, 
   3.707131111492584*^9, 3.707131553569702*^9, {3.707140760098463*^9, 
   3.707140784412525*^9}, 3.707140896931012*^9, 3.707141051875958*^9, 
   3.707141191283601*^9, 3.7071420472116823`*^9, 3.707142290156893*^9, 
   3.707199457595438*^9, 3.707200390478352*^9, 3.707207752986494*^9, 
   3.7072079424285803`*^9, 3.707208264169772*^9, 3.707213487455653*^9, 
   3.707213768808467*^9, 3.707214002991454*^9, 3.7072149106939173`*^9, 
   3.7072191192034607`*^9, 3.707221370165494*^9, 3.7080723492480297`*^9, 
   3.708075016279542*^9, 3.7080779084980917`*^9, 3.7080781522668333`*^9, 
   3.708085245438892*^9, 3.7082492431917343`*^9, 3.708249825533558*^9, 
   3.708258893496625*^9, 3.708267631983658*^9, 3.708319159622069*^9, 
   3.708321070095017*^9, 3.708322703396276*^9, 3.7083228027327642`*^9, 
   3.708322953242639*^9, 3.70832381824271*^9, 3.708324050327333*^9, 
   3.708325066933956*^9, 3.7083252680904217`*^9, 3.708325365089438*^9, 
   3.7083254116428537`*^9, 3.708325506675776*^9, 3.708325563775529*^9, {
   3.708331644388075*^9, 3.708331668003281*^9}, 3.708341954864854*^9, 
   3.709712848853218*^9, 3.709713022713338*^9, {3.7097131018631973`*^9, 
   3.709713116975464*^9}, 3.709713398193563*^9, 3.712838404691793*^9, 
   3.712924403415305*^9, 3.712924462362211*^9, 3.712988801881612*^9, 
   3.712988999633853*^9, 3.712990590153496*^9, 3.71299125450881*^9, 
   3.712992427057288*^9, 3.712992823841217*^9, 3.712997215674397*^9, 
   3.713005615586247*^9, 3.713005684129615*^9, 3.713006942744514*^9, 
   3.713007882170978*^9, 3.713008224040535*^9, 3.713175211631332*^9, 
   3.7132404702318487`*^9, 3.713241457772726*^9, 3.7132416540382633`*^9, 
   3.713241859186593*^9, 3.713243092644155*^9, 3.7132433965358477`*^9, {
   3.713243534427169*^9, 3.7132435467196407`*^9}, 3.713244055094982*^9, 
   3.713244157130324*^9, 3.713244290866702*^9, 3.713244405963688*^9, {
   3.713245628750696*^9, 3.713245657860578*^9}, 3.713245709367334*^9, 
   3.713245812044772*^9, 3.713250177181925*^9, 3.713250597982265*^9, 
   3.713264609570838*^9, 3.713265494260006*^9, {3.713265719796294*^9, 
   3.7132657435940313`*^9}, 3.7132688067507877`*^9, 3.713268851445252*^9, 
   3.713271300860573*^9, 3.713271404622151*^9, 3.713271798428665*^9, 
   3.713271899941177*^9, 3.71327238887783*^9, 3.713272656120151*^9, 
   3.713274842360272*^9, 3.713275395407256*^9, 3.71327816127619*^9, 
   3.7132783088567266`*^9, 3.7134639267716265`*^9, 3.713464335170986*^9, 
   3.713466692577874*^9, 3.713523871995899*^9, 3.7135242954721746`*^9, 
   3.713524558600477*^9, 3.713672846969452*^9, 3.713673190193348*^9, 
   3.713687404172748*^9, 3.713804858210815*^9, 3.71385491540816*^9, 
   3.713854958388242*^9, 3.713865972171994*^9, 3.7138753227074137`*^9, 
   3.713875945033928*^9, 3.713876132015586*^9, 3.713877086061378*^9, 
   3.713877144790423*^9, 3.713877420560066*^9, 3.713877515330274*^9, 
   3.713877552748858*^9, 3.7140260296818247`*^9, 3.714028011590555*^9, 
   3.71402968608005*^9, 3.714029718014559*^9, 3.714029950240073*^9, 
   3.714032029391748*^9, 3.714032597761778*^9, 3.714033526803246*^9, 
   3.71403700514741*^9, 3.714037662229094*^9, 3.714037771833428*^9, 
   3.714037916133108*^9, 3.71403846294975*^9, 3.7140390222966547`*^9, 
   3.714039315902205*^9, 3.714039451354444*^9, 3.714110036957212*^9, 
   3.714132743053219*^9, 3.714901017482685*^9, 3.714901300038889*^9, 
   3.715852050499351*^9, 3.7158522198988132`*^9, 3.715853102275565*^9, {
   3.715858487538525*^9, 3.7158585093356743`*^9}, 3.715858625426667*^9, 
   3.71585871890098*^9, 3.7158588418798018`*^9, 3.715861270173357*^9, 
   3.718524065663927*^9, 3.722582139155418*^9, 3.722584057553858*^9, 
   3.722584150162558*^9, 3.722584974734934*^9, 3.722585211687252*^9, 
   3.722585359100726*^9, 3.722592908765881*^9, 3.7225969611692*^9, 
   3.722597079589101*^9, 3.722597374063405*^9, 3.7225978952548428`*^9, 
   3.722862895477748*^9, 3.722863430840961*^9, 3.722863658955155*^9, 
   3.7228638877845507`*^9, 3.722864099159205*^9, 3.722864971966196*^9, 
   3.7228660610102262`*^9, 3.7228661370210876`*^9, 3.722866918801416*^9, 
   3.722866969642663*^9, 3.722867461606822*^9, 3.722867593604045*^9, 
   3.72286823329069*^9, 3.722869195343931*^9, 3.722872918435444*^9, 
   3.7229372094212418`*^9, 3.722938457127689*^9, 3.7229398252166233`*^9, 
   3.7229400790606613`*^9, 3.722941533163378*^9, 3.7229418986955757`*^9, 
   3.7229452936464033`*^9, 3.722945396836145*^9, 3.7233963340398006`*^9, 
   3.7233968939303904`*^9, 3.723398176377443*^9, 3.723399493503356*^9, 
   3.7234016903968225`*^9, 3.723405224885408*^9, 3.723823858996958*^9, 
   3.723908829517705*^9, 3.723908870046239*^9, 3.7239089586716747`*^9, 
   3.723975476192952*^9, 3.723976010984548*^9, 3.723981488071978*^9, 
   3.723982713309846*^9, 3.7239831908973618`*^9, {3.7239839025710993`*^9, 
   3.723983914209523*^9}, 3.723984060992028*^9, 3.723984160139859*^9, 
   3.723984698050213*^9, 3.723984749240243*^9, 3.7347212593443823`*^9, 
   3.734760664681026*^9, 3.7347607353074627`*^9, 3.7347808552214737`*^9, 
   3.734791949928735*^9, 3.734836463312112*^9, 3.734923852315279*^9, 
   3.7349242531622066`*^9, 3.734937185658903*^9, 3.734937234889719*^9, 
   3.735119001497906*^9, 3.7351340526097803`*^9, 3.739028852999332*^9, 
   3.7390318076593285`*^9, 3.739036850382756*^9, 3.739077108931355*^9, 
   3.739079188942176*^9, 3.73908327302363*^9, 3.739194976227645*^9, 
   3.739195419526523*^9, 3.764749495321155*^9, 3.765877187476439*^9, {
   3.765877265131081*^9, 3.765877268941464*^9}, 3.765879821914899*^9, 
   3.765879901679802*^9, 3.809339726868581*^9, {3.8093398649132147`*^9, 
   3.8093398895414877`*^9}, 3.809776384958474*^9, 3.8097765259757347`*^9, 
   3.809776838253449*^9, {3.809776872146737*^9, 3.8097768772725353`*^9}, 
   3.80977698337572*^9},
 CellLabel->
  "During evaluation of \
In[363]:=",ExpressionUUID->"8ae8858c-53bb-4bd5-8119-bec5ec0a6476"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  \"\>", "\[InvisibleSpace]", "\<\"/Users/zeuch/NC/\"\>"}],
  SequenceForm["  ", "/Users/zeuch/NC/"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6875957642755876`*^9, 3.687596465956484*^9, 3.6875965087511606`*^9, {
   3.687616536110959*^9, 3.687616539750766*^9}, {3.6876234100207014`*^9, 
   3.6876234337100563`*^9}, {3.687633781564247*^9, 3.687633783529851*^9}, 
   3.6876348186384687`*^9, 3.687677723844741*^9, 3.687706768356993*^9, 
   3.687707491637083*^9, 3.6877078549999447`*^9, 3.687708189582591*^9, 
   3.6877082345328984`*^9, 3.6877082926617312`*^9, 3.6877083676920357`*^9, 
   3.687708440983179*^9, 3.688108187570294*^9, {3.688126729502204*^9, 
   3.688126758286948*^9}, {3.68812679424172*^9, 3.688126796287423*^9}, 
   3.688479025891611*^9, 3.688479066897704*^9, 3.688479139251226*^9, 
   3.688479183103503*^9, 3.688479872287781*^9, 3.688480014341976*^9, 
   3.688481121026812*^9, 3.688481973619272*^9, 3.688482031399469*^9, 
   3.688482159715405*^9, 3.688482240132962*^9, {3.688482367136018*^9, 
   3.688482392837454*^9}, 3.6884860184996357`*^9, 3.688486806086255*^9, 
   3.6884869666143084`*^9, 3.688487297848445*^9, 3.688536856131538*^9, 
   3.688540341926879*^9, 3.6885472836829596`*^9, 3.688547322658189*^9, 
   3.6885474462252564`*^9, 3.6885495628543205`*^9, 3.6885495939571*^9, 
   3.6887158339400473`*^9, 3.688716413125424*^9, 3.688716577553854*^9, 
   3.6887216190570602`*^9, 3.68872174705774*^9, 3.6887218968939953`*^9, 
   3.6887220319016438`*^9, 3.688724230379426*^9, 3.688726702308757*^9, 
   3.688727085747422*^9, 3.6887283321020403`*^9, 3.6887284340546427`*^9, 
   3.688728699566532*^9, 3.6887287519222527`*^9, 3.688733850698881*^9, 
   3.688884454509386*^9, 3.688884775455473*^9, 3.688884877216729*^9, 
   3.688884946321968*^9, 3.689259271445711*^9, 3.689259664102425*^9, 
   3.692095559547117*^9, 3.69209615700629*^9, 3.692105400577992*^9, 
   3.6921054427044015`*^9, 3.692447360377915*^9, 3.693491149002578*^9, 
   3.693491193475884*^9, 3.7037436513289223`*^9, 3.7037442167312613`*^9, 
   3.703758446748258*^9, 3.703766084566659*^9, 3.703766767340222*^9, 
   3.703766930506926*^9, 3.703768892803115*^9, 3.703769128728662*^9, 
   3.7037693044503527`*^9, 3.703769356513098*^9, 3.703770601372628*^9, 
   3.7037708248872747`*^9, 3.703771164049481*^9, 3.703852867713554*^9, 
   3.703853010454458*^9, 3.703910545181904*^9, 3.703910615414906*^9, 
   3.705119037006193*^9, 3.706012742734775*^9, 3.7060129297487507`*^9, 
   3.7060136490259657`*^9, 3.7060176385457087`*^9, 3.706166780407482*^9, 
   3.706167569450364*^9, 3.7061692386056347`*^9, 3.706173428141816*^9, 
   3.70617350111336*^9, 3.706862882396907*^9, 3.706870334169496*^9, 
   3.7068751507912683`*^9, 3.706876613693461*^9, 3.706877261353292*^9, 
   3.7069480626377077`*^9, 3.707022603484414*^9, {3.707024674004704*^9, 
   3.7070246956869583`*^9}, 3.707025281528778*^9, 3.707107789824719*^9, 
   3.707112419035303*^9, 3.7071141898800592`*^9, 3.7071153205252123`*^9, 
   3.7071213533237534`*^9, 3.707129156310727*^9, 3.707129220709956*^9, 
   3.707131111492584*^9, 3.707131553569702*^9, {3.707140760098463*^9, 
   3.707140784412525*^9}, 3.707140896931012*^9, 3.707141051875958*^9, 
   3.707141191283601*^9, 3.7071420472116823`*^9, 3.707142290156893*^9, 
   3.707199457595438*^9, 3.707200390478352*^9, 3.707207752986494*^9, 
   3.7072079424285803`*^9, 3.707208264169772*^9, 3.707213487455653*^9, 
   3.707213768808467*^9, 3.707214002991454*^9, 3.7072149106939173`*^9, 
   3.7072191192034607`*^9, 3.707221370165494*^9, 3.7080723492480297`*^9, 
   3.708075016279542*^9, 3.7080779084980917`*^9, 3.7080781522668333`*^9, 
   3.708085245438892*^9, 3.7082492431917343`*^9, 3.708249825533558*^9, 
   3.708258893496625*^9, 3.708267631983658*^9, 3.708319159622069*^9, 
   3.708321070095017*^9, 3.708322703396276*^9, 3.7083228027327642`*^9, 
   3.708322953242639*^9, 3.70832381824271*^9, 3.708324050327333*^9, 
   3.708325066933956*^9, 3.7083252680904217`*^9, 3.708325365089438*^9, 
   3.7083254116428537`*^9, 3.708325506675776*^9, 3.708325563775529*^9, {
   3.708331644388075*^9, 3.708331668003281*^9}, 3.708341954864854*^9, 
   3.709712848853218*^9, 3.709713022713338*^9, {3.7097131018631973`*^9, 
   3.709713116975464*^9}, 3.709713398193563*^9, 3.712838404691793*^9, 
   3.712924403415305*^9, 3.712924462362211*^9, 3.712988801881612*^9, 
   3.712988999633853*^9, 3.712990590153496*^9, 3.71299125450881*^9, 
   3.712992427057288*^9, 3.712992823841217*^9, 3.712997215674397*^9, 
   3.713005615586247*^9, 3.713005684129615*^9, 3.713006942744514*^9, 
   3.713007882170978*^9, 3.713008224040535*^9, 3.713175211631332*^9, 
   3.7132404702318487`*^9, 3.713241457772726*^9, 3.7132416540382633`*^9, 
   3.713241859186593*^9, 3.713243092644155*^9, 3.7132433965358477`*^9, {
   3.713243534427169*^9, 3.7132435467196407`*^9}, 3.713244055094982*^9, 
   3.713244157130324*^9, 3.713244290866702*^9, 3.713244405963688*^9, {
   3.713245628750696*^9, 3.713245657860578*^9}, 3.713245709367334*^9, 
   3.713245812044772*^9, 3.713250177181925*^9, 3.713250597982265*^9, 
   3.713264609570838*^9, 3.713265494260006*^9, {3.713265719796294*^9, 
   3.7132657435940313`*^9}, 3.7132688067507877`*^9, 3.713268851445252*^9, 
   3.713271300860573*^9, 3.713271404622151*^9, 3.713271798428665*^9, 
   3.713271899941177*^9, 3.71327238887783*^9, 3.713272656120151*^9, 
   3.713274842360272*^9, 3.713275395407256*^9, 3.71327816127619*^9, 
   3.7132783088567266`*^9, 3.7134639267716265`*^9, 3.713464335170986*^9, 
   3.713466692577874*^9, 3.713523871995899*^9, 3.7135242954721746`*^9, 
   3.713524558600477*^9, 3.713672846969452*^9, 3.713673190193348*^9, 
   3.713687404172748*^9, 3.713804858210815*^9, 3.71385491540816*^9, 
   3.713854958388242*^9, 3.713865972171994*^9, 3.7138753227074137`*^9, 
   3.713875945033928*^9, 3.713876132015586*^9, 3.713877086061378*^9, 
   3.713877144790423*^9, 3.713877420560066*^9, 3.713877515330274*^9, 
   3.713877552748858*^9, 3.7140260296818247`*^9, 3.714028011590555*^9, 
   3.71402968608005*^9, 3.714029718014559*^9, 3.714029950240073*^9, 
   3.714032029391748*^9, 3.714032597761778*^9, 3.714033526803246*^9, 
   3.71403700514741*^9, 3.714037662229094*^9, 3.714037771833428*^9, 
   3.714037916133108*^9, 3.71403846294975*^9, 3.7140390222966547`*^9, 
   3.714039315902205*^9, 3.714039451354444*^9, 3.714110036957212*^9, 
   3.714132743053219*^9, 3.714901017482685*^9, 3.714901300038889*^9, 
   3.715852050499351*^9, 3.7158522198988132`*^9, 3.715853102275565*^9, {
   3.715858487538525*^9, 3.7158585093356743`*^9}, 3.715858625426667*^9, 
   3.71585871890098*^9, 3.7158588418798018`*^9, 3.715861270173357*^9, 
   3.718524065663927*^9, 3.722582139155418*^9, 3.722584057553858*^9, 
   3.722584150162558*^9, 3.722584974734934*^9, 3.722585211687252*^9, 
   3.722585359100726*^9, 3.722592908765881*^9, 3.7225969611692*^9, 
   3.722597079589101*^9, 3.722597374063405*^9, 3.7225978952548428`*^9, 
   3.722862895477748*^9, 3.722863430840961*^9, 3.722863658955155*^9, 
   3.7228638877845507`*^9, 3.722864099159205*^9, 3.722864971966196*^9, 
   3.7228660610102262`*^9, 3.7228661370210876`*^9, 3.722866918801416*^9, 
   3.722866969642663*^9, 3.722867461606822*^9, 3.722867593604045*^9, 
   3.72286823329069*^9, 3.722869195343931*^9, 3.722872918435444*^9, 
   3.7229372094212418`*^9, 3.722938457127689*^9, 3.7229398252166233`*^9, 
   3.7229400790606613`*^9, 3.722941533163378*^9, 3.7229418986955757`*^9, 
   3.7229452936464033`*^9, 3.722945396836145*^9, 3.7233963340398006`*^9, 
   3.7233968939303904`*^9, 3.723398176377443*^9, 3.723399493503356*^9, 
   3.7234016903968225`*^9, 3.723405224885408*^9, 3.723823858996958*^9, 
   3.723908829517705*^9, 3.723908870046239*^9, 3.7239089586716747`*^9, 
   3.723975476192952*^9, 3.723976010984548*^9, 3.723981488071978*^9, 
   3.723982713309846*^9, 3.7239831908973618`*^9, {3.7239839025710993`*^9, 
   3.723983914209523*^9}, 3.723984060992028*^9, 3.723984160139859*^9, 
   3.723984698050213*^9, 3.723984749240243*^9, 3.7347212593443823`*^9, 
   3.734760664681026*^9, 3.7347607353074627`*^9, 3.7347808552214737`*^9, 
   3.734791949928735*^9, 3.734836463312112*^9, 3.734923852315279*^9, 
   3.7349242531622066`*^9, 3.734937185658903*^9, 3.734937234889719*^9, 
   3.735119001497906*^9, 3.7351340526097803`*^9, 3.739028852999332*^9, 
   3.7390318076593285`*^9, 3.739036850382756*^9, 3.739077108931355*^9, 
   3.739079188942176*^9, 3.73908327302363*^9, 3.739194976227645*^9, 
   3.739195419526523*^9, 3.764749495321155*^9, 3.765877187476439*^9, {
   3.765877265131081*^9, 3.765877268941464*^9}, 3.765879821914899*^9, 
   3.765879901679802*^9, 3.809339726868581*^9, {3.8093398649132147`*^9, 
   3.8093398895414877`*^9}, 3.809776384958474*^9, 3.8097765259757347`*^9, 
   3.809776838253449*^9, {3.809776872146737*^9, 3.8097768772725353`*^9}, 
   3.809776983384665*^9},
 CellLabel->
  "During evaluation of \
In[363]:=",ExpressionUUID->"1dad81bc-67a1-47f9-8b75-24457527ef56"],

Cell[BoxData["\<\"You can now use \\\"<< NCAlgebra`\\\" to load \
NCAlgebra.\"\>"], "Print",
 CellChangeTimes->{
  3.6875957642755876`*^9, 3.687596465956484*^9, 3.6875965087511606`*^9, {
   3.687616536110959*^9, 3.687616539750766*^9}, {3.6876234100207014`*^9, 
   3.6876234337100563`*^9}, {3.687633781564247*^9, 3.687633783529851*^9}, 
   3.6876348186384687`*^9, 3.687677723844741*^9, 3.687706768356993*^9, 
   3.687707491637083*^9, 3.6877078549999447`*^9, 3.687708189582591*^9, 
   3.6877082345328984`*^9, 3.6877082926617312`*^9, 3.6877083676920357`*^9, 
   3.687708440983179*^9, 3.688108187570294*^9, {3.688126729502204*^9, 
   3.688126758286948*^9}, {3.68812679424172*^9, 3.688126796287423*^9}, 
   3.688479025891611*^9, 3.688479066897704*^9, 3.688479139251226*^9, 
   3.688479183103503*^9, 3.688479872287781*^9, 3.688480014341976*^9, 
   3.688481121026812*^9, 3.688481973619272*^9, 3.688482031399469*^9, 
   3.688482159715405*^9, 3.688482240132962*^9, {3.688482367136018*^9, 
   3.688482392837454*^9}, 3.6884860184996357`*^9, 3.688486806086255*^9, 
   3.6884869666143084`*^9, 3.688487297848445*^9, 3.688536856131538*^9, 
   3.688540341926879*^9, 3.6885472836829596`*^9, 3.688547322658189*^9, 
   3.6885474462252564`*^9, 3.6885495628543205`*^9, 3.6885495939571*^9, 
   3.6887158339400473`*^9, 3.688716413125424*^9, 3.688716577553854*^9, 
   3.6887216190570602`*^9, 3.68872174705774*^9, 3.6887218968939953`*^9, 
   3.6887220319016438`*^9, 3.688724230379426*^9, 3.688726702308757*^9, 
   3.688727085747422*^9, 3.6887283321020403`*^9, 3.6887284340546427`*^9, 
   3.688728699566532*^9, 3.6887287519222527`*^9, 3.688733850698881*^9, 
   3.688884454509386*^9, 3.688884775455473*^9, 3.688884877216729*^9, 
   3.688884946321968*^9, 3.689259271445711*^9, 3.689259664102425*^9, 
   3.692095559547117*^9, 3.69209615700629*^9, 3.692105400577992*^9, 
   3.6921054427044015`*^9, 3.692447360377915*^9, 3.693491149002578*^9, 
   3.693491193475884*^9, 3.7037436513289223`*^9, 3.7037442167312613`*^9, 
   3.703758446748258*^9, 3.703766084566659*^9, 3.703766767340222*^9, 
   3.703766930506926*^9, 3.703768892803115*^9, 3.703769128728662*^9, 
   3.7037693044503527`*^9, 3.703769356513098*^9, 3.703770601372628*^9, 
   3.7037708248872747`*^9, 3.703771164049481*^9, 3.703852867713554*^9, 
   3.703853010454458*^9, 3.703910545181904*^9, 3.703910615414906*^9, 
   3.705119037006193*^9, 3.706012742734775*^9, 3.7060129297487507`*^9, 
   3.7060136490259657`*^9, 3.7060176385457087`*^9, 3.706166780407482*^9, 
   3.706167569450364*^9, 3.7061692386056347`*^9, 3.706173428141816*^9, 
   3.70617350111336*^9, 3.706862882396907*^9, 3.706870334169496*^9, 
   3.7068751507912683`*^9, 3.706876613693461*^9, 3.706877261353292*^9, 
   3.7069480626377077`*^9, 3.707022603484414*^9, {3.707024674004704*^9, 
   3.7070246956869583`*^9}, 3.707025281528778*^9, 3.707107789824719*^9, 
   3.707112419035303*^9, 3.7071141898800592`*^9, 3.7071153205252123`*^9, 
   3.7071213533237534`*^9, 3.707129156310727*^9, 3.707129220709956*^9, 
   3.707131111492584*^9, 3.707131553569702*^9, {3.707140760098463*^9, 
   3.707140784412525*^9}, 3.707140896931012*^9, 3.707141051875958*^9, 
   3.707141191283601*^9, 3.7071420472116823`*^9, 3.707142290156893*^9, 
   3.707199457595438*^9, 3.707200390478352*^9, 3.707207752986494*^9, 
   3.7072079424285803`*^9, 3.707208264169772*^9, 3.707213487455653*^9, 
   3.707213768808467*^9, 3.707214002991454*^9, 3.7072149106939173`*^9, 
   3.7072191192034607`*^9, 3.707221370165494*^9, 3.7080723492480297`*^9, 
   3.708075016279542*^9, 3.7080779084980917`*^9, 3.7080781522668333`*^9, 
   3.708085245438892*^9, 3.7082492431917343`*^9, 3.708249825533558*^9, 
   3.708258893496625*^9, 3.708267631983658*^9, 3.708319159622069*^9, 
   3.708321070095017*^9, 3.708322703396276*^9, 3.7083228027327642`*^9, 
   3.708322953242639*^9, 3.70832381824271*^9, 3.708324050327333*^9, 
   3.708325066933956*^9, 3.7083252680904217`*^9, 3.708325365089438*^9, 
   3.7083254116428537`*^9, 3.708325506675776*^9, 3.708325563775529*^9, {
   3.708331644388075*^9, 3.708331668003281*^9}, 3.708341954864854*^9, 
   3.709712848853218*^9, 3.709713022713338*^9, {3.7097131018631973`*^9, 
   3.709713116975464*^9}, 3.709713398193563*^9, 3.712838404691793*^9, 
   3.712924403415305*^9, 3.712924462362211*^9, 3.712988801881612*^9, 
   3.712988999633853*^9, 3.712990590153496*^9, 3.71299125450881*^9, 
   3.712992427057288*^9, 3.712992823841217*^9, 3.712997215674397*^9, 
   3.713005615586247*^9, 3.713005684129615*^9, 3.713006942744514*^9, 
   3.713007882170978*^9, 3.713008224040535*^9, 3.713175211631332*^9, 
   3.7132404702318487`*^9, 3.713241457772726*^9, 3.7132416540382633`*^9, 
   3.713241859186593*^9, 3.713243092644155*^9, 3.7132433965358477`*^9, {
   3.713243534427169*^9, 3.7132435467196407`*^9}, 3.713244055094982*^9, 
   3.713244157130324*^9, 3.713244290866702*^9, 3.713244405963688*^9, {
   3.713245628750696*^9, 3.713245657860578*^9}, 3.713245709367334*^9, 
   3.713245812044772*^9, 3.713250177181925*^9, 3.713250597982265*^9, 
   3.713264609570838*^9, 3.713265494260006*^9, {3.713265719796294*^9, 
   3.7132657435940313`*^9}, 3.7132688067507877`*^9, 3.713268851445252*^9, 
   3.713271300860573*^9, 3.713271404622151*^9, 3.713271798428665*^9, 
   3.713271899941177*^9, 3.71327238887783*^9, 3.713272656120151*^9, 
   3.713274842360272*^9, 3.713275395407256*^9, 3.71327816127619*^9, 
   3.7132783088567266`*^9, 3.7134639267716265`*^9, 3.713464335170986*^9, 
   3.713466692577874*^9, 3.713523871995899*^9, 3.7135242954721746`*^9, 
   3.713524558600477*^9, 3.713672846969452*^9, 3.713673190193348*^9, 
   3.713687404172748*^9, 3.713804858210815*^9, 3.71385491540816*^9, 
   3.713854958388242*^9, 3.713865972171994*^9, 3.7138753227074137`*^9, 
   3.713875945033928*^9, 3.713876132015586*^9, 3.713877086061378*^9, 
   3.713877144790423*^9, 3.713877420560066*^9, 3.713877515330274*^9, 
   3.713877552748858*^9, 3.7140260296818247`*^9, 3.714028011590555*^9, 
   3.71402968608005*^9, 3.714029718014559*^9, 3.714029950240073*^9, 
   3.714032029391748*^9, 3.714032597761778*^9, 3.714033526803246*^9, 
   3.71403700514741*^9, 3.714037662229094*^9, 3.714037771833428*^9, 
   3.714037916133108*^9, 3.71403846294975*^9, 3.7140390222966547`*^9, 
   3.714039315902205*^9, 3.714039451354444*^9, 3.714110036957212*^9, 
   3.714132743053219*^9, 3.714901017482685*^9, 3.714901300038889*^9, 
   3.715852050499351*^9, 3.7158522198988132`*^9, 3.715853102275565*^9, {
   3.715858487538525*^9, 3.7158585093356743`*^9}, 3.715858625426667*^9, 
   3.71585871890098*^9, 3.7158588418798018`*^9, 3.715861270173357*^9, 
   3.718524065663927*^9, 3.722582139155418*^9, 3.722584057553858*^9, 
   3.722584150162558*^9, 3.722584974734934*^9, 3.722585211687252*^9, 
   3.722585359100726*^9, 3.722592908765881*^9, 3.7225969611692*^9, 
   3.722597079589101*^9, 3.722597374063405*^9, 3.7225978952548428`*^9, 
   3.722862895477748*^9, 3.722863430840961*^9, 3.722863658955155*^9, 
   3.7228638877845507`*^9, 3.722864099159205*^9, 3.722864971966196*^9, 
   3.7228660610102262`*^9, 3.7228661370210876`*^9, 3.722866918801416*^9, 
   3.722866969642663*^9, 3.722867461606822*^9, 3.722867593604045*^9, 
   3.72286823329069*^9, 3.722869195343931*^9, 3.722872918435444*^9, 
   3.7229372094212418`*^9, 3.722938457127689*^9, 3.7229398252166233`*^9, 
   3.7229400790606613`*^9, 3.722941533163378*^9, 3.7229418986955757`*^9, 
   3.7229452936464033`*^9, 3.722945396836145*^9, 3.7233963340398006`*^9, 
   3.7233968939303904`*^9, 3.723398176377443*^9, 3.723399493503356*^9, 
   3.7234016903968225`*^9, 3.723405224885408*^9, 3.723823858996958*^9, 
   3.723908829517705*^9, 3.723908870046239*^9, 3.7239089586716747`*^9, 
   3.723975476192952*^9, 3.723976010984548*^9, 3.723981488071978*^9, 
   3.723982713309846*^9, 3.7239831908973618`*^9, {3.7239839025710993`*^9, 
   3.723983914209523*^9}, 3.723984060992028*^9, 3.723984160139859*^9, 
   3.723984698050213*^9, 3.723984749240243*^9, 3.7347212593443823`*^9, 
   3.734760664681026*^9, 3.7347607353074627`*^9, 3.7347808552214737`*^9, 
   3.734791949928735*^9, 3.734836463312112*^9, 3.734923852315279*^9, 
   3.7349242531622066`*^9, 3.734937185658903*^9, 3.734937234889719*^9, 
   3.735119001497906*^9, 3.7351340526097803`*^9, 3.739028852999332*^9, 
   3.7390318076593285`*^9, 3.739036850382756*^9, 3.739077108931355*^9, 
   3.739079188942176*^9, 3.73908327302363*^9, 3.739194976227645*^9, 
   3.739195419526523*^9, 3.764749495321155*^9, 3.765877187476439*^9, {
   3.765877265131081*^9, 3.765877268941464*^9}, 3.765879821914899*^9, 
   3.765879901679802*^9, 3.809339726868581*^9, {3.8093398649132147`*^9, 
   3.8093398895414877`*^9}, 3.809776384958474*^9, 3.8097765259757347`*^9, 
   3.809776838253449*^9, {3.809776872146737*^9, 3.8097768772725353`*^9}, 
   3.809776983392305*^9},
 CellLabel->
  "During evaluation of \
In[363]:=",ExpressionUUID->"bdf93db5-870c-4f8c-a49e-15b93c7b25b6"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.686936200390766*^9, 3.6869362012407675`*^9}, {
  3.7071103599744787`*^9, 3.70711036341159*^9}},
 CellLabel->
  "In[370]:=",ExpressionUUID->"1ba2070e-713d-4b94-acca-5db7a2ace5f9"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.713507286914978*^9, 3.713507288666814*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"6c5a2d12-093b-4ede-b78c-46a21d94da9b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["1.   Define basic Math Functions",
 FontColor->RGBColor[1, 0, 0]]], "Section",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738406695464067*^9, 3.738406699136009*^9}, {
   3.738764866417782*^9, 
   3.738764869425149*^9}},ExpressionUUID->"4bcbc86a-42b4-4dbf-8ba4-\
b4d16eb512f3"],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
  "Define", " ", "basic", " ", "principles", " ", "of", " ", "Math", " ", 
   "Multiplication"}], "Subsection"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
  "Idea", " ", "from", " ", "the", " ", "same", " ", "stackexchange", " ", 
   "post", " ", "as", " ", "the", " ", "one", " ", "whose", " ", "link", " ", 
   "is", " ", "given", " ", "below", " ", "when", " ", "defining", " ", "the",
    " ", "commutator"}], "Subsubsection"]}], "Input",
 CellChangeTimes->{{3.707199907269494*^9, 3.707199947533094*^9}, {
  3.7071999839473553`*^9, 3.7072000287303667`*^9}},
 CellLabel->
  "In[372]:=",ExpressionUUID->"216b6541-5ed8-42d2-8113-a101a0036f9f"],

Cell[BoxData[
 RowBox[{"basic", " ", "Define", " ", "Math", " ", "Multiplication", " ", 
  "of", " ", "principles"}]], "Output",
 CellChangeTimes->{
  3.707200390696267*^9, 3.7072077532358093`*^9, 3.707207942666328*^9, 
   3.707208264414586*^9, 3.707213487675226*^9, 3.7072137703628073`*^9, 
   3.707214003215536*^9, 3.707214910916134*^9, 3.707219119423944*^9, 
   3.707221370392983*^9, 3.70807234986644*^9, 3.708075016633404*^9, 
   3.7080779089893503`*^9, 3.708078152726819*^9, 3.708085245810009*^9, 
   3.708249243560369*^9, 3.708249825895012*^9, 3.708258893887779*^9, 
   3.708267633393882*^9, 3.70831916003237*^9, 3.708321070490366*^9, 
   3.7083227037317944`*^9, 3.708322803145878*^9, 3.708322953641468*^9, 
   3.7083238186398153`*^9, 3.708324050677053*^9, 3.7083250673040323`*^9, 
   3.7083252684808073`*^9, 3.708325365498801*^9, 3.7083254117498903`*^9, 
   3.708325507075354*^9, 3.7083255641339493`*^9, {3.708331644821999*^9, 
   3.7083316684210367`*^9}, 3.708341955257514*^9, 3.709712849550269*^9, 
   3.709713023071327*^9, {3.709713102364616*^9, 3.709713117322776*^9}, 
   3.709713398544464*^9, 3.7128384051222763`*^9, 3.712924403809877*^9, 
   3.712924462702973*^9, 3.7129888022508574`*^9, 3.712989000092991*^9, 
   3.712990590494645*^9, 3.712991254862896*^9, 3.712992427487204*^9, 
   3.712992824211857*^9, 3.712997216066689*^9, 3.713005616026626*^9, 
   3.7130056844914513`*^9, 3.713006943175551*^9, 3.7130078825784197`*^9, 
   3.713008224510191*^9, 3.713175213245337*^9, 3.713240470666202*^9, 
   3.7132414580980053`*^9, 3.713241654357418*^9, 3.7132418595284777`*^9, 
   3.713243092977187*^9, 3.713243396907157*^9, {3.713243534517726*^9, 
   3.713243547052123*^9}, 3.7132440554910183`*^9, 3.7132441574589777`*^9, 
   3.7132442912224693`*^9, 3.71324440627297*^9, {3.713245629082117*^9, 
   3.713245658190596*^9}, 3.713245709699074*^9, 3.713245812380589*^9, 
   3.713250177525526*^9, 3.713250598358356*^9, 3.7132646099853563`*^9, 
   3.713265494627233*^9, {3.713265720149145*^9, 3.7132657439537983`*^9}, 
   3.713268807102416*^9, 3.7132688517857523`*^9, 3.713271301212556*^9, 
   3.713271405007127*^9, 3.7132717988282747`*^9, 3.71327190033178*^9, 
   3.71327239020154*^9, 3.713272656532425*^9, 3.7132748428243*^9, 
   3.7132753966222258`*^9, 3.71327816174093*^9, 3.7132783095039263`*^9, 
   3.7134639286657352`*^9, 3.713464336654071*^9, 3.7134666929855537`*^9, 
   3.713523872770049*^9, 3.7135242961321774`*^9, 3.713524559349369*^9, 
   3.7136728497853193`*^9, 3.713673190504858*^9, 3.7136874044729023`*^9, 
   3.713804858975506*^9, 3.7138549159314013`*^9, 3.713854958832399*^9, 
   3.713865972718472*^9, 3.7138753231108713`*^9, 3.713875945414609*^9, 
   3.713876132429997*^9, 3.7138770865082006`*^9, 3.713877145204359*^9, 
   3.713877420974777*^9, 3.7138775157306213`*^9, 3.713877553113906*^9, 
   3.714026030127915*^9, 3.714028011710791*^9, 3.714029686454919*^9, 
   3.714029718355152*^9, 3.7140299505898*^9, 3.714032029794148*^9, 
   3.714032598121167*^9, 3.714033527163602*^9, 3.7140370056334543`*^9, 
   3.714037662688613*^9, 3.7140377722958603`*^9, 3.714037916607338*^9, 
   3.714038463411227*^9, 3.714039022755406*^9, 3.714039316379922*^9, 
   3.714039451860523*^9, 3.714110037441347*^9, 3.7141327436864367`*^9, 
   3.7149010180147657`*^9, 3.7149013004154873`*^9, 3.715852051134026*^9, 
   3.715852220369259*^9, 3.715853102767915*^9, {3.715858487831047*^9, 
   3.7158585097589417`*^9}, 3.7158586259189777`*^9, 3.715858719390615*^9, 
   3.7158588423498917`*^9, 3.715861270624954*^9, 3.718524066259481*^9, 
   3.7225821395843067`*^9, 3.722584057945004*^9, 3.7225841505174313`*^9, 
   3.72258497512068*^9, 3.7225852120835114`*^9, 3.722585363477291*^9, 
   3.7225929121758623`*^9, 3.722596961539549*^9, 3.722597079949621*^9, 
   3.7225973744329023`*^9, 3.722597895627348*^9, 3.722862895958506*^9, 
   3.722863431223514*^9, 3.7228636626607037`*^9, 3.7228638881591387`*^9, 
   3.722864102053772*^9, 3.7228649723223333`*^9, 3.7228660613835363`*^9, 
   3.722866137377997*^9, 3.722866919174004*^9, 3.7228669727136497`*^9, 
   3.722867464697185*^9, 3.7228675939689837`*^9, 3.7228682336461477`*^9, 
   3.722869195700789*^9, 3.7228729188091516`*^9, 3.722937209634927*^9, 
   3.722938457249321*^9, 3.7229398254521437`*^9, 3.722940079271023*^9, 
   3.722941533475884*^9, 3.722941898939485*^9, 3.7229452938613253`*^9, 
   3.722945397120438*^9, 3.7233963393906107`*^9, 3.7233969012624035`*^9, 
   3.723398183241455*^9, 3.7233995004297686`*^9, 3.723401695950432*^9, 
   3.7234052252883577`*^9, 3.723823862566317*^9, 3.723908833425061*^9, 
   3.723908870408017*^9, 3.723908959058812*^9, 3.723975476564849*^9, 
   3.723976011356577*^9, 3.7239814886048326`*^9, 3.723982713699489*^9, 
   3.723983191271723*^9, {3.72398390299008*^9, 3.723983914598797*^9}, 
   3.723984061349018*^9, 3.723984160537047*^9, 3.723984698457007*^9, 
   3.7239847496462584`*^9, 3.734721260485448*^9, 3.73476066491705*^9, 
   3.7347607357524977`*^9, 3.734780855654587*^9, 3.73479195367028*^9, 
   3.734836463771305*^9, 3.734923853853367*^9, 3.734924254592288*^9, 
   3.73493718682897*^9, 3.7349372362507963`*^9, 3.735119002685974*^9, 
   3.735134053805849*^9, 3.739028853197343*^9, 3.73903180872139*^9, 
   3.739036851565824*^9, 3.739077109396446*^9, 3.739079189057721*^9, 
   3.7390832731278553`*^9, 3.739194976784294*^9, 3.7391954202021914`*^9, 
   3.764749499907563*^9, 3.765877187907517*^9, {3.765877265288848*^9, 
   3.765877269125753*^9}, 3.76587982227459*^9, 3.7658799019136677`*^9, 
   3.809339727319131*^9, {3.809339865070465*^9, 3.809339889628578*^9}, 
   3.80977638506907*^9, 3.8097765260682287`*^9, 3.809776839240459*^9, {
   3.809776872308106*^9, 3.8097768773769827`*^9}, 3.809776983462635*^9},
 CellLabel->
  "Out[372]=",ExpressionUUID->"8b288f6d-14fd-4ddb-9412-b3539ad33ac7"],

Cell[BoxData[
 RowBox[{"as", " ", "below", " ", "commutator", " ", "defining", " ", "from", 
  " ", "given", " ", "Idea", " ", "is", " ", "link", " ", "one", " ", "post", 
  " ", "same", " ", "stackexchange", " ", 
  SuperscriptBox["the", "3"], " ", "when", " ", "whose"}]], "Output",
 CellChangeTimes->{
  3.707200390696267*^9, 3.7072077532358093`*^9, 3.707207942666328*^9, 
   3.707208264414586*^9, 3.707213487675226*^9, 3.7072137703628073`*^9, 
   3.707214003215536*^9, 3.707214910916134*^9, 3.707219119423944*^9, 
   3.707221370392983*^9, 3.70807234986644*^9, 3.708075016633404*^9, 
   3.7080779089893503`*^9, 3.708078152726819*^9, 3.708085245810009*^9, 
   3.708249243560369*^9, 3.708249825895012*^9, 3.708258893887779*^9, 
   3.708267633393882*^9, 3.70831916003237*^9, 3.708321070490366*^9, 
   3.7083227037317944`*^9, 3.708322803145878*^9, 3.708322953641468*^9, 
   3.7083238186398153`*^9, 3.708324050677053*^9, 3.7083250673040323`*^9, 
   3.7083252684808073`*^9, 3.708325365498801*^9, 3.7083254117498903`*^9, 
   3.708325507075354*^9, 3.7083255641339493`*^9, {3.708331644821999*^9, 
   3.7083316684210367`*^9}, 3.708341955257514*^9, 3.709712849550269*^9, 
   3.709713023071327*^9, {3.709713102364616*^9, 3.709713117322776*^9}, 
   3.709713398544464*^9, 3.7128384051222763`*^9, 3.712924403809877*^9, 
   3.712924462702973*^9, 3.7129888022508574`*^9, 3.712989000092991*^9, 
   3.712990590494645*^9, 3.712991254862896*^9, 3.712992427487204*^9, 
   3.712992824211857*^9, 3.712997216066689*^9, 3.713005616026626*^9, 
   3.7130056844914513`*^9, 3.713006943175551*^9, 3.7130078825784197`*^9, 
   3.713008224510191*^9, 3.713175213245337*^9, 3.713240470666202*^9, 
   3.7132414580980053`*^9, 3.713241654357418*^9, 3.7132418595284777`*^9, 
   3.713243092977187*^9, 3.713243396907157*^9, {3.713243534517726*^9, 
   3.713243547052123*^9}, 3.7132440554910183`*^9, 3.7132441574589777`*^9, 
   3.7132442912224693`*^9, 3.71324440627297*^9, {3.713245629082117*^9, 
   3.713245658190596*^9}, 3.713245709699074*^9, 3.713245812380589*^9, 
   3.713250177525526*^9, 3.713250598358356*^9, 3.7132646099853563`*^9, 
   3.713265494627233*^9, {3.713265720149145*^9, 3.7132657439537983`*^9}, 
   3.713268807102416*^9, 3.7132688517857523`*^9, 3.713271301212556*^9, 
   3.713271405007127*^9, 3.7132717988282747`*^9, 3.71327190033178*^9, 
   3.71327239020154*^9, 3.713272656532425*^9, 3.7132748428243*^9, 
   3.7132753966222258`*^9, 3.71327816174093*^9, 3.7132783095039263`*^9, 
   3.7134639286657352`*^9, 3.713464336654071*^9, 3.7134666929855537`*^9, 
   3.713523872770049*^9, 3.7135242961321774`*^9, 3.713524559349369*^9, 
   3.7136728497853193`*^9, 3.713673190504858*^9, 3.7136874044729023`*^9, 
   3.713804858975506*^9, 3.7138549159314013`*^9, 3.713854958832399*^9, 
   3.713865972718472*^9, 3.7138753231108713`*^9, 3.713875945414609*^9, 
   3.713876132429997*^9, 3.7138770865082006`*^9, 3.713877145204359*^9, 
   3.713877420974777*^9, 3.7138775157306213`*^9, 3.713877553113906*^9, 
   3.714026030127915*^9, 3.714028011710791*^9, 3.714029686454919*^9, 
   3.714029718355152*^9, 3.7140299505898*^9, 3.714032029794148*^9, 
   3.714032598121167*^9, 3.714033527163602*^9, 3.7140370056334543`*^9, 
   3.714037662688613*^9, 3.7140377722958603`*^9, 3.714037916607338*^9, 
   3.714038463411227*^9, 3.714039022755406*^9, 3.714039316379922*^9, 
   3.714039451860523*^9, 3.714110037441347*^9, 3.7141327436864367`*^9, 
   3.7149010180147657`*^9, 3.7149013004154873`*^9, 3.715852051134026*^9, 
   3.715852220369259*^9, 3.715853102767915*^9, {3.715858487831047*^9, 
   3.7158585097589417`*^9}, 3.7158586259189777`*^9, 3.715858719390615*^9, 
   3.7158588423498917`*^9, 3.715861270624954*^9, 3.718524066259481*^9, 
   3.7225821395843067`*^9, 3.722584057945004*^9, 3.7225841505174313`*^9, 
   3.72258497512068*^9, 3.7225852120835114`*^9, 3.722585363477291*^9, 
   3.7225929121758623`*^9, 3.722596961539549*^9, 3.722597079949621*^9, 
   3.7225973744329023`*^9, 3.722597895627348*^9, 3.722862895958506*^9, 
   3.722863431223514*^9, 3.7228636626607037`*^9, 3.7228638881591387`*^9, 
   3.722864102053772*^9, 3.7228649723223333`*^9, 3.7228660613835363`*^9, 
   3.722866137377997*^9, 3.722866919174004*^9, 3.7228669727136497`*^9, 
   3.722867464697185*^9, 3.7228675939689837`*^9, 3.7228682336461477`*^9, 
   3.722869195700789*^9, 3.7228729188091516`*^9, 3.722937209634927*^9, 
   3.722938457249321*^9, 3.7229398254521437`*^9, 3.722940079271023*^9, 
   3.722941533475884*^9, 3.722941898939485*^9, 3.7229452938613253`*^9, 
   3.722945397120438*^9, 3.7233963393906107`*^9, 3.7233969012624035`*^9, 
   3.723398183241455*^9, 3.7233995004297686`*^9, 3.723401695950432*^9, 
   3.7234052252883577`*^9, 3.723823862566317*^9, 3.723908833425061*^9, 
   3.723908870408017*^9, 3.723908959058812*^9, 3.723975476564849*^9, 
   3.723976011356577*^9, 3.7239814886048326`*^9, 3.723982713699489*^9, 
   3.723983191271723*^9, {3.72398390299008*^9, 3.723983914598797*^9}, 
   3.723984061349018*^9, 3.723984160537047*^9, 3.723984698457007*^9, 
   3.7239847496462584`*^9, 3.734721260485448*^9, 3.73476066491705*^9, 
   3.7347607357524977`*^9, 3.734780855654587*^9, 3.73479195367028*^9, 
   3.734836463771305*^9, 3.734923853853367*^9, 3.734924254592288*^9, 
   3.73493718682897*^9, 3.7349372362507963`*^9, 3.735119002685974*^9, 
   3.735134053805849*^9, 3.739028853197343*^9, 3.73903180872139*^9, 
   3.739036851565824*^9, 3.739077109396446*^9, 3.739079189057721*^9, 
   3.7390832731278553`*^9, 3.739194976784294*^9, 3.7391954202021914`*^9, 
   3.764749499907563*^9, 3.765877187907517*^9, {3.765877265288848*^9, 
   3.765877269125753*^9}, 3.76587982227459*^9, 3.7658799019136677`*^9, 
   3.809339727319131*^9, {3.809339865070465*^9, 3.809339889628578*^9}, 
   3.80977638506907*^9, 3.8097765260682287`*^9, 3.809776839240459*^9, {
   3.809776872308106*^9, 3.8097768773769827`*^9}, 3.8097769834701853`*^9},
 CellLabel->
  "Out[373]=",ExpressionUUID->"c567f7aa-6f02-4a10-b313-1e39377f6496"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"lower", "-", 
     RowBox[{"case", ":", "  ", 
      RowBox[{
       RowBox[{"(", "usually", ")"}], " ", "operator"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"upper", "-", 
     RowBox[{"case", ":", "  ", "scalar"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"a_", ",", "a_"}], "]"}], ":=", 
     RowBox[{"a", ".", "a"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"a_", ",", "C_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"C", " ", "a"}], " ", "/;", " ", 
      RowBox[{"CommutativeQ", "[", "C", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"C_", ",", "a_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"C", " ", "a"}], " ", "/;", " ", 
      RowBox[{"CommutativeQ", "[", "C", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{
       RowBox[{"Plus", "[", 
        RowBox[{"a_", ",", "addends__"}], "]"}], ",", "b_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"MatM", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "+", 
      RowBox[{"MatM", "[", 
       RowBox[{
        RowBox[{"Plus", "[", "addends", "]"}], ",", "b"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"Plus", "[", 
        RowBox[{"b_", ",", "baddends_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"MatM", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "+", 
      RowBox[{"MatM", "[", 
       RowBox[{"a", ",", 
        RowBox[{"Plus", "[", "baddends", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{
       RowBox[{"Times", "[", 
        RowBox[{"C_", ",", "factors__"}], "]"}], ",", "b_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"C", " ", 
       RowBox[{"MatM", "[", 
        RowBox[{
         RowBox[{"Times", "[", "factors", "]"}], ",", "b"}], "]"}]}], " ", "/;",
       " ", 
      RowBox[{"CommutativeQ", "[", "C", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"Times", "[", 
        RowBox[{"C_", ",", "factors__"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"C", " ", 
       RowBox[{"MatM", "[", 
        RowBox[{"a", ",", 
         RowBox[{"Times", "[", "factors", "]"}]}], "]"}]}], " ", "/;", " ", 
      RowBox[{"CommutativeQ", "[", "C", "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.707144967307352*^9, 3.707145063736967*^9}, 
   3.707145390209306*^9, {3.707145484478651*^9, 3.707145501379898*^9}, {
   3.7071455325701847`*^9, 3.707145563592757*^9}, {3.7071456246857758`*^9, 
   3.70714564203738*^9}, {3.7071456893465357`*^9, 3.7071459120638103`*^9}, {
   3.707146006482107*^9, 3.707146042377239*^9}, {3.707146084645227*^9, 
   3.7071462297281733`*^9}, {3.707147195001252*^9, 3.7071472053605967`*^9}},
 CellLabel->
  "In[374]:=",ExpressionUUID->"4c722c32-8986-4382-b985-5ed8d352bedb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatM", "[", 
  RowBox[{"a", ",", 
   RowBox[{"b", "+", "c"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatM", "[", 
  RowBox[{"c", ",", 
   RowBox[{"I", 
    RowBox[{"(", " ", 
     RowBox[{"b", "+", "c"}], ")"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.707147068888291*^9, 3.7071470701855907`*^9}, {
  3.707147103141281*^9, 3.707147131140129*^9}, {3.707147176556802*^9, 
  3.707147185201355*^9}},
 CellLabel->
  "In[381]:=",ExpressionUUID->"ef4d6b76-dd69-4ca5-8a29-44bc36ef55cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatM", "[", 
   RowBox[{"a", ",", "b"}], "]"}], "+", 
  RowBox[{"MatM", "[", 
   RowBox[{"a", ",", "c"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.707147105998897*^9, 3.707147131521646*^9}, {
   3.707147178669676*^9, 3.707147206630189*^9}, 3.707200066270007*^9, 
   3.7072003907184687`*^9, 3.707207753267054*^9, 3.707207942695545*^9, 
   3.707208264443851*^9, 3.7072134877039137`*^9, 3.707213770393611*^9, 
   3.707214003243682*^9, 3.70721491094538*^9, 3.707219119455327*^9, 
   3.707221370429689*^9, 3.708072349983358*^9, 3.708075016712679*^9, 
   3.708077909055324*^9, 3.708078152800376*^9, 3.70808524590903*^9, 
   3.7082492436330338`*^9, 3.7082498259531403`*^9, 3.708258893963339*^9, 
   3.708267633449973*^9, 3.708319160099332*^9, 3.7083210705654488`*^9, 
   3.708322703799308*^9, 3.708322803229823*^9, 3.70832295371413*^9, 
   3.708323818721108*^9, 3.7083240507560387`*^9, 3.708325067383452*^9, 
   3.708325268560877*^9, 3.708325365571549*^9, 3.708325411825303*^9, 
   3.7083255071682863`*^9, 3.708325564214341*^9, {3.708331644905621*^9, 
   3.7083316684896107`*^9}, 3.7083419553233624`*^9, 3.70971284966757*^9, 
   3.70971302313472*^9, {3.709713102428535*^9, 3.709713117398479*^9}, 
   3.709713398609098*^9, 3.712838405215136*^9, 3.712924403887779*^9, 
   3.712924462767399*^9, 3.7129888023336563`*^9, 3.712989000141281*^9, 
   3.7129905905616093`*^9, 3.7129912549422693`*^9, 3.7129924275614843`*^9, 
   3.712992824268454*^9, 3.712997216172027*^9, 3.713005616099576*^9, 
   3.713005684571073*^9, 3.713006943259503*^9, 3.713007882654684*^9, 
   3.7130082245926237`*^9, 3.713175213457747*^9, 3.713240470748909*^9, 
   3.713241458162882*^9, 3.713241654420042*^9, 3.7132418595835667`*^9, 
   3.7132430930389767`*^9, 3.713243396981702*^9, {3.71324353459321*^9, 
   3.713243547135949*^9}, 3.713244055564796*^9, 3.713244157523336*^9, 
   3.713244291297696*^9, 3.7132444063388243`*^9, {3.713245629147011*^9, 
   3.713245658254457*^9}, 3.713245709786578*^9, 3.713245812442593*^9, 
   3.7132501776035233`*^9, 3.7132505984386168`*^9, 3.713264610056563*^9, 
   3.7132654946904182`*^9, {3.713265720214552*^9, 3.713265744033415*^9}, 
   3.713268807220626*^9, 3.713268851850733*^9, 3.713271301294113*^9, 
   3.713271405073349*^9, 3.7132717988945723`*^9, 3.713271900406559*^9, 
   3.713272390285162*^9, 3.713272656617457*^9, 3.713274842913913*^9, 
   3.713275396725268*^9, 3.713278161844688*^9, 3.7132783096088667`*^9, 
   3.713463928802743*^9, 3.713464336766077*^9, 3.713466693068866*^9, 
   3.713523872920912*^9, 3.713524296199144*^9, 3.713524559424005*^9, 
   3.7136728501052847`*^9, 3.713673190530918*^9, 3.713687404498542*^9, 
   3.7138048591088877`*^9, 3.713854915982101*^9, 3.713854958899556*^9, 
   3.713865972786634*^9, 3.713875323181212*^9, 3.713875945463674*^9, 
   3.713876132479292*^9, 3.713877086559662*^9, 3.713877145255254*^9, 
   3.713877421024825*^9, 3.7138775157924023`*^9, 3.713877553188962*^9, 
   3.7140260302101316`*^9, 3.7140280117545*^9, 3.714029686505413*^9, 
   3.714029718447702*^9, 3.7140299506819267`*^9, 3.714032029844254*^9, 
   3.714032598210843*^9, 3.7140335272137203`*^9, 3.714037005702262*^9, 
   3.7140376627601357`*^9, 3.7140377723646317`*^9, 3.71403791667852*^9, 
   3.714038463483368*^9, 3.7140390228296423`*^9, 3.7140393164462013`*^9, 
   3.7140394519137917`*^9, 3.7141100375088663`*^9, 3.714132743773786*^9, 
   3.714901018132758*^9, 3.714901300522398*^9, 3.715852051218624*^9, 
   3.715852220434187*^9, 3.715853102848624*^9, {3.7158584879147053`*^9, 
   3.7158585098472023`*^9}, 3.715858625988985*^9, 3.715858719464419*^9, 
   3.715858842405356*^9, 3.715861270695837*^9, 3.718524066340013*^9, 
   3.722582139654456*^9, 3.722584058019824*^9, 3.72258415059354*^9, 
   3.7225849751961308`*^9, 3.7225852148518267`*^9, 3.722585363526662*^9, 
   3.7225929122519073`*^9, 3.722596961616563*^9, 3.722597082574698*^9, 
   3.72259737746133*^9, 3.722597895678846*^9, 3.722862896073677*^9, 
   3.722863431289921*^9, 3.722863662727233*^9, 3.722863888208556*^9, 
   3.7228641021138*^9, 3.722864972372204*^9, 3.722866061433901*^9, 
   3.722866137437937*^9, 3.722866921817396*^9, 3.7228669727973013`*^9, 
   3.722867464747109*^9, 3.722867594015791*^9, 3.72286823370704*^9, 
   3.722869195745185*^9, 3.7228729188849277`*^9, 3.722937209655219*^9, 
   3.722938457279887*^9, 3.722939825483385*^9, 3.722940079289365*^9, 
   3.722941533522637*^9, 3.722941898959084*^9, 3.722945293876322*^9, 
   3.722945397138308*^9, 3.7233963395934105`*^9, 3.7233969013560033`*^9, 
   3.7233981833350554`*^9, 3.7233995005389686`*^9, 3.7234016963092327`*^9, 
   3.723405225388098*^9, 3.723823862632927*^9, 3.723908833491811*^9, 
   3.723908870470456*^9, 3.723908959124324*^9, 3.723975476639683*^9, 
   3.72397601143211*^9, 3.723981488672958*^9, 3.723982713766398*^9, 
   3.7239831913477163`*^9, {3.7239839055711193`*^9, 3.723983914675118*^9}, 
   3.723984063819034*^9, 3.723984160603702*^9, 3.7239846985322857`*^9, 
   3.7239847497472*^9, 3.7347212605504513`*^9, 3.734760665033176*^9, 
   3.7347607358309517`*^9, 3.734780855728644*^9, 3.734791953761161*^9, 
   3.734836463854672*^9, 3.734923853977374*^9, 3.7349242546502914`*^9, 
   3.7349371868949738`*^9, 3.7349372363538027`*^9, 3.7351190027679787`*^9, 
   3.7351340539068546`*^9, 3.7390288533053493`*^9, 3.739031808761392*^9, 
   3.7390368516428285`*^9, 3.739077109480143*^9, 3.7390791891374073`*^9, 
   3.739083273236349*^9, 3.739194976902986*^9, 3.7391954202928762`*^9, 
   3.7647495002039633`*^9, 3.765877187969824*^9, {3.7658772655140944`*^9, 
   3.7658772692248373`*^9}, 3.76587982245569*^9, 3.765879901995348*^9, 
   3.809339727401347*^9, {3.809339865140485*^9, 3.8093398897097273`*^9}, 
   3.809776385136101*^9, 3.809776526147974*^9, 3.8097768393132553`*^9, {
   3.809776872374831*^9, 3.809776877443006*^9}, 3.809776983547391*^9},
 CellLabel->
  "Out[381]=",ExpressionUUID->"cd5d95b9-4c25-467e-a6d2-3193f0413d1c"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"c", ".", "c"}], "+", 
    RowBox[{"MatM", "[", 
     RowBox[{"c", ",", "b"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.707147105998897*^9, 3.707147131521646*^9}, {
   3.707147178669676*^9, 3.707147206630189*^9}, 3.707200066270007*^9, 
   3.7072003907184687`*^9, 3.707207753267054*^9, 3.707207942695545*^9, 
   3.707208264443851*^9, 3.7072134877039137`*^9, 3.707213770393611*^9, 
   3.707214003243682*^9, 3.70721491094538*^9, 3.707219119455327*^9, 
   3.707221370429689*^9, 3.708072349983358*^9, 3.708075016712679*^9, 
   3.708077909055324*^9, 3.708078152800376*^9, 3.70808524590903*^9, 
   3.7082492436330338`*^9, 3.7082498259531403`*^9, 3.708258893963339*^9, 
   3.708267633449973*^9, 3.708319160099332*^9, 3.7083210705654488`*^9, 
   3.708322703799308*^9, 3.708322803229823*^9, 3.70832295371413*^9, 
   3.708323818721108*^9, 3.7083240507560387`*^9, 3.708325067383452*^9, 
   3.708325268560877*^9, 3.708325365571549*^9, 3.708325411825303*^9, 
   3.7083255071682863`*^9, 3.708325564214341*^9, {3.708331644905621*^9, 
   3.7083316684896107`*^9}, 3.7083419553233624`*^9, 3.70971284966757*^9, 
   3.70971302313472*^9, {3.709713102428535*^9, 3.709713117398479*^9}, 
   3.709713398609098*^9, 3.712838405215136*^9, 3.712924403887779*^9, 
   3.712924462767399*^9, 3.7129888023336563`*^9, 3.712989000141281*^9, 
   3.7129905905616093`*^9, 3.7129912549422693`*^9, 3.7129924275614843`*^9, 
   3.712992824268454*^9, 3.712997216172027*^9, 3.713005616099576*^9, 
   3.713005684571073*^9, 3.713006943259503*^9, 3.713007882654684*^9, 
   3.7130082245926237`*^9, 3.713175213457747*^9, 3.713240470748909*^9, 
   3.713241458162882*^9, 3.713241654420042*^9, 3.7132418595835667`*^9, 
   3.7132430930389767`*^9, 3.713243396981702*^9, {3.71324353459321*^9, 
   3.713243547135949*^9}, 3.713244055564796*^9, 3.713244157523336*^9, 
   3.713244291297696*^9, 3.7132444063388243`*^9, {3.713245629147011*^9, 
   3.713245658254457*^9}, 3.713245709786578*^9, 3.713245812442593*^9, 
   3.7132501776035233`*^9, 3.7132505984386168`*^9, 3.713264610056563*^9, 
   3.7132654946904182`*^9, {3.713265720214552*^9, 3.713265744033415*^9}, 
   3.713268807220626*^9, 3.713268851850733*^9, 3.713271301294113*^9, 
   3.713271405073349*^9, 3.7132717988945723`*^9, 3.713271900406559*^9, 
   3.713272390285162*^9, 3.713272656617457*^9, 3.713274842913913*^9, 
   3.713275396725268*^9, 3.713278161844688*^9, 3.7132783096088667`*^9, 
   3.713463928802743*^9, 3.713464336766077*^9, 3.713466693068866*^9, 
   3.713523872920912*^9, 3.713524296199144*^9, 3.713524559424005*^9, 
   3.7136728501052847`*^9, 3.713673190530918*^9, 3.713687404498542*^9, 
   3.7138048591088877`*^9, 3.713854915982101*^9, 3.713854958899556*^9, 
   3.713865972786634*^9, 3.713875323181212*^9, 3.713875945463674*^9, 
   3.713876132479292*^9, 3.713877086559662*^9, 3.713877145255254*^9, 
   3.713877421024825*^9, 3.7138775157924023`*^9, 3.713877553188962*^9, 
   3.7140260302101316`*^9, 3.7140280117545*^9, 3.714029686505413*^9, 
   3.714029718447702*^9, 3.7140299506819267`*^9, 3.714032029844254*^9, 
   3.714032598210843*^9, 3.7140335272137203`*^9, 3.714037005702262*^9, 
   3.7140376627601357`*^9, 3.7140377723646317`*^9, 3.71403791667852*^9, 
   3.714038463483368*^9, 3.7140390228296423`*^9, 3.7140393164462013`*^9, 
   3.7140394519137917`*^9, 3.7141100375088663`*^9, 3.714132743773786*^9, 
   3.714901018132758*^9, 3.714901300522398*^9, 3.715852051218624*^9, 
   3.715852220434187*^9, 3.715853102848624*^9, {3.7158584879147053`*^9, 
   3.7158585098472023`*^9}, 3.715858625988985*^9, 3.715858719464419*^9, 
   3.715858842405356*^9, 3.715861270695837*^9, 3.718524066340013*^9, 
   3.722582139654456*^9, 3.722584058019824*^9, 3.72258415059354*^9, 
   3.7225849751961308`*^9, 3.7225852148518267`*^9, 3.722585363526662*^9, 
   3.7225929122519073`*^9, 3.722596961616563*^9, 3.722597082574698*^9, 
   3.72259737746133*^9, 3.722597895678846*^9, 3.722862896073677*^9, 
   3.722863431289921*^9, 3.722863662727233*^9, 3.722863888208556*^9, 
   3.7228641021138*^9, 3.722864972372204*^9, 3.722866061433901*^9, 
   3.722866137437937*^9, 3.722866921817396*^9, 3.7228669727973013`*^9, 
   3.722867464747109*^9, 3.722867594015791*^9, 3.72286823370704*^9, 
   3.722869195745185*^9, 3.7228729188849277`*^9, 3.722937209655219*^9, 
   3.722938457279887*^9, 3.722939825483385*^9, 3.722940079289365*^9, 
   3.722941533522637*^9, 3.722941898959084*^9, 3.722945293876322*^9, 
   3.722945397138308*^9, 3.7233963395934105`*^9, 3.7233969013560033`*^9, 
   3.7233981833350554`*^9, 3.7233995005389686`*^9, 3.7234016963092327`*^9, 
   3.723405225388098*^9, 3.723823862632927*^9, 3.723908833491811*^9, 
   3.723908870470456*^9, 3.723908959124324*^9, 3.723975476639683*^9, 
   3.72397601143211*^9, 3.723981488672958*^9, 3.723982713766398*^9, 
   3.7239831913477163`*^9, {3.7239839055711193`*^9, 3.723983914675118*^9}, 
   3.723984063819034*^9, 3.723984160603702*^9, 3.7239846985322857`*^9, 
   3.7239847497472*^9, 3.7347212605504513`*^9, 3.734760665033176*^9, 
   3.7347607358309517`*^9, 3.734780855728644*^9, 3.734791953761161*^9, 
   3.734836463854672*^9, 3.734923853977374*^9, 3.7349242546502914`*^9, 
   3.7349371868949738`*^9, 3.7349372363538027`*^9, 3.7351190027679787`*^9, 
   3.7351340539068546`*^9, 3.7390288533053493`*^9, 3.739031808761392*^9, 
   3.7390368516428285`*^9, 3.739077109480143*^9, 3.7390791891374073`*^9, 
   3.739083273236349*^9, 3.739194976902986*^9, 3.7391954202928762`*^9, 
   3.7647495002039633`*^9, 3.765877187969824*^9, {3.7658772655140944`*^9, 
   3.7658772692248373`*^9}, 3.76587982245569*^9, 3.765879901995348*^9, 
   3.809339727401347*^9, {3.809339865140485*^9, 3.8093398897097273`*^9}, 
   3.809776385136101*^9, 3.809776526147974*^9, 3.8097768393132553`*^9, {
   3.809776872374831*^9, 3.809776877443006*^9}, 3.80977698355556*^9},
 CellLabel->
  "Out[382]=",ExpressionUUID->"31f2bb81-ffd9-48a6-a953-d454a0367331"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"c", ".", "c"}], "+", 
    RowBox[{"MatM", "[", 
     RowBox[{"c", ",", "b"}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.7072005486450853`*^9, 3.7072005579411097`*^9}},
 CellLabel->
  "In[383]:=",ExpressionUUID->"7f6f8020-75c4-4947-847d-46fe016a1d0e"],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"c", ".", "c"}], "+", 
    RowBox[{"MatM", "[", 
     RowBox[{"c", ",", "b"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.707207753291656*^9, 3.707207942721518*^9, 3.707208264448893*^9, 
   3.7072134877285843`*^9, 3.707213770420802*^9, 3.7072140032682056`*^9, 
   3.707214910970434*^9, 3.7072191194811077`*^9, 3.70722137045785*^9, 
   3.7080750167521152`*^9, 3.7080779091003447`*^9, 3.708078152843883*^9, 
   3.708085245971113*^9, 3.70824924367043*^9, 3.708249825990567*^9, 
   3.708258894013104*^9, 3.708267633508891*^9, 3.7083191601383123`*^9, 
   3.7083210706145487`*^9, 3.7083227038402653`*^9, 3.7083228032785*^9, 
   3.7083229537899933`*^9, 3.708323818762065*^9, 3.7083240507979603`*^9, 
   3.708325067424677*^9, 3.7083252686072598`*^9, 3.708325365613576*^9, 
   3.7083254118674383`*^9, 3.7083255072505283`*^9, 3.708325564263036*^9, {
   3.708331644970974*^9, 3.708331668539797*^9}, 3.7083419553792467`*^9, 
   3.7097128497108793`*^9, 3.70971302317308*^9, {3.709713102470039*^9, 
   3.709713117506606*^9}, 3.709713398647296*^9, 3.712838405281938*^9, 
   3.7129244039270277`*^9, 3.7129244628052273`*^9, 3.712988802378769*^9, 
   3.712989000181713*^9, 3.712990590601688*^9, 3.712991254989778*^9, 
   3.7129924276035423`*^9, 3.712992824328162*^9, 3.712997216224863*^9, 
   3.71300561614359*^9, 3.713005684636613*^9, 3.713006943345783*^9, 
   3.7130078827197437`*^9, 3.7130082246604757`*^9, 3.7131752135706043`*^9, 
   3.713240470797709*^9, 3.713241458198348*^9, 3.713241654456172*^9, 
   3.713241859619968*^9, 3.7132430930764017`*^9, 3.713243397018347*^9, {
   3.7132435346302013`*^9, 3.71324354719458*^9}, 3.713244055608786*^9, 
   3.713244157560341*^9, 3.713244291335867*^9, 3.713244406376742*^9, {
   3.7132456291851892`*^9, 3.71324565830294*^9}, 3.713245709844269*^9, 
   3.713245812480876*^9, 3.713250177644409*^9, 3.713250598481222*^9, 
   3.713264610097044*^9, 3.713265494731086*^9, {3.713265720281557*^9, 
   3.71326574413319*^9}, 3.713268807283352*^9, 3.713268851889894*^9, 
   3.713271301382351*^9, 3.71327140511547*^9, 3.713271798937235*^9, 
   3.713271900474311*^9, 3.713272390351316*^9, 3.713272656690877*^9, 
   3.7132748429755383`*^9, 3.713275396785819*^9, 3.713278161961668*^9, 
   3.713278309870755*^9, 3.713463928908749*^9, 3.713464336832081*^9, 
   3.713466693119924*^9, 3.7135238730453043`*^9, 3.713524296255546*^9, 
   3.713524559480864*^9, 3.7136728502023773`*^9, 3.713673190555341*^9, 
   3.713687404517983*^9, 3.713804859275522*^9, 3.71385491603069*^9, 
   3.713854958933062*^9, 3.713865972824725*^9, 3.7138753232471724`*^9, 
   3.713875945523342*^9, 3.713876132521659*^9, 3.713877086616596*^9, 
   3.71387714529751*^9, 3.7138774210669107`*^9, 3.7138775158427563`*^9, 
   3.7138775532235622`*^9, 3.7140260302602*^9, 3.7140280117851152`*^9, 
   3.714029686542575*^9, 3.714029718497738*^9, 3.7140299507325*^9, 
   3.714032029877513*^9, 3.714032598248385*^9, 3.714033527256221*^9, 
   3.714037005780815*^9, 3.714037662809389*^9, 3.714037772413796*^9, 
   3.714037916714167*^9, 3.714038463532551*^9, 3.71403902287206*^9, 
   3.7140393164891987`*^9, 3.714039451971324*^9, 3.71411003755345*^9, 
   3.714132743824519*^9, 3.714901018181003*^9, 3.714901300572672*^9, 
   3.71585205126849*^9, 3.715852220468956*^9, 3.7158531028989162`*^9, {
   3.715858487963443*^9, 3.715858509898118*^9}, 3.715858626025313*^9, 
   3.715858719498887*^9, 3.715858842462719*^9, 3.715861270736245*^9, 
   3.7185240663925047`*^9, 3.722582139701022*^9, 3.722584058053175*^9, 
   3.722584150624467*^9, 3.72258497522917*^9, 3.7225852148869133`*^9, 
   3.722585363570838*^9, 3.72259291228596*^9, 3.7225969644455967`*^9, 
   3.722597082901072*^9, 3.722597377510413*^9, 3.722597895719942*^9, 
   3.72286289612541*^9, 3.722863431339808*^9, 3.72286366275976*^9, 
   3.722863888239193*^9, 3.722864102147477*^9, 3.722864972414982*^9, 
   3.722866061528616*^9, 3.722866137470586*^9, 3.7228669220924463`*^9, 
   3.7228669728435173`*^9, 3.72286746478983*^9, 3.7228675940595293`*^9, 
   3.722868233740602*^9, 3.722869195779169*^9, 3.7228729189193*^9, 
   3.7229372096682253`*^9, 3.722938457299644*^9, 3.722939825488065*^9, 
   3.722940079300789*^9, 3.7229415335452642`*^9, 3.722941898971912*^9, 
   3.722945293887863*^9, 3.722945397150342*^9, 3.723396339936611*^9, 
   3.7233969014028034`*^9, 3.723398183381855*^9, 3.723399500616969*^9, 
   3.723401696387233*^9, 3.723405225421163*^9, 3.723823862681705*^9, 
   3.723908833530004*^9, 3.723908870520473*^9, 3.7239089616384573`*^9, 
   3.7239754766793737`*^9, 3.723976011472443*^9, 3.72398148872253*^9, 
   3.723982713807609*^9, 3.723983191386549*^9, {3.723983905871023*^9, 
   3.723983914715226*^9}, 3.723984064114696*^9, 3.723984162988242*^9, 
   3.72398469857292*^9, 3.7239847498054113`*^9, 3.7347212606014547`*^9, 
   3.7347606650829*^9, 3.7347607358909483`*^9, 3.734780855771687*^9, 
   3.734791953812018*^9, 3.7348364639285517`*^9, 3.7349238540543785`*^9, 
   3.734924254696294*^9, 3.7349371869419765`*^9, 3.734937236395805*^9, 
   3.7351190028789854`*^9, 3.73513405400186*^9, 3.7390288533603525`*^9, 
   3.7390318087753925`*^9, 3.7390368516958313`*^9, 3.739077109685009*^9, 
   3.739079189187694*^9, 3.7390832733016863`*^9, 3.739194976967671*^9, 
   3.7391954203484077`*^9, 3.764749500391164*^9, 3.765877188011363*^9, {
   3.765877265554371*^9, 3.765877269275783*^9}, 3.765879822516843*^9, 
   3.7658799020457687`*^9, 3.809339727460788*^9, {3.809339865205143*^9, 
   3.809339889756208*^9}, 3.809776385186288*^9, 3.809776526197156*^9, 
   3.8097768393794413`*^9, {3.809776872461719*^9, 3.809776877509818*^9}, 
   3.8097769835954027`*^9},
 CellLabel->
  "Out[383]=",ExpressionUUID->"f260bc62-dc75-40e9-893e-d70c18b42792"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"rules", " ", "for", " ", "multiplying", " ", "sigma"}], "-", 
    "matrices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sigma", "[", "ii_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"ii", ",", "1"}], "]"}], "sx"}], "+", 
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"ii", ",", "2"}], "]"}], "sy"}], "+", 
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"ii", ",", "3"}], "]"}], "sz"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"SigmaRules", "=", 
      RowBox[{"{", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MatM", "[", 
             RowBox[{
              RowBox[{"sigma", "[", "ii", "]"}], ",", 
              RowBox[{"sigma", "[", "jj", "]"}]}], "]"}], "->", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"KroneckerDelta", "[", 
               RowBox[{"ii", ",", "jj"}], "]"}], "id"}], "+", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"I", " ", 
                RowBox[{
                 RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"ii", ",", "jj", ",", "kk"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"kk", ",", "3"}], "}"}]}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "3"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "3"}], "}"}]}], "]"}], "}"}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetNonCommutative", "[", 
     RowBox[{"sx", ",", "sy", ",", "sz"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SigmaRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"MatM", "[", 
         RowBox[{"sx", ",", "sy"}], "]"}], "\[Rule]", 
        RowBox[{"I", " ", "sz"}]}], ",", 
       RowBox[{
        RowBox[{"MatM", "[", 
         RowBox[{"sy", ",", "sx"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "sz"}]}], ",", 
       RowBox[{
        RowBox[{"MatM", "[", 
         RowBox[{"sy", ",", "sz"}], "]"}], "\[Rule]", 
        RowBox[{"I", " ", "sx"}]}], ",", 
       RowBox[{
        RowBox[{"MatM", "[", 
         RowBox[{"sz", ",", "sy"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "sx"}]}], ",", 
       RowBox[{
        RowBox[{"MatM", "[", 
         RowBox[{"sz", ",", "sx"}], "]"}], "\[Rule]", 
        RowBox[{"I", " ", "sy"}]}], ",", 
       RowBox[{
        RowBox[{"MatM", "[", 
         RowBox[{"sx", ",", "sz"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "sy"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SigmaMRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sx", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"sy", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "I"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"I", ",", "0"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"sz", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SigmaComRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{"sx", ",", "sy"}], "]"}], "\[Rule]", 
        RowBox[{"2", "I", " ", "sz"}]}], ",", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{"sy", ",", "sx"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "2"}], "I", " ", "sz"}]}], ",", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{"sy", ",", "sz"}], "]"}], "\[Rule]", 
        RowBox[{"2", "I", " ", "sx"}]}], ",", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{"sz", ",", "sy"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "2"}], "I", " ", "sx"}]}], ",", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{"sz", ",", "sx"}], "]"}], "\[Rule]", 
        RowBox[{"2", "I", " ", "sy"}]}], ",", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{"sx", ",", "sz"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"-", "2"}], "I", " ", "sy"}]}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7072005592454233`*^9, 3.707200560236704*^9}, {
  3.707200606036077*^9, 3.70720073467288*^9}, {3.707200773608013*^9, 
  3.707200954571744*^9}, {3.707201049961164*^9, 3.707201178782775*^9}, {
  3.707201349066576*^9, 3.707201372792913*^9}, {3.70720256857242*^9, 
  3.707202617059319*^9}, {3.707202682241213*^9, 3.707202778974551*^9}, {
  3.707205898649386*^9, 3.707205929119828*^9}, {3.707206008958642*^9, 
  3.707206020821785*^9}, {3.707206082589411*^9, 3.707206083764413*^9}, {
  3.707206482466934*^9, 3.707206546648831*^9}, {3.707206585360615*^9, 
  3.707206610071673*^9}, {3.70721371509057*^9, 3.70721374536127*^9}, {
  3.7083349329182863`*^9, 3.708334997097377*^9}},
 CellLabel->
  "In[384]:=",ExpressionUUID->"0bbddc1d-3f62-43ff-807b-86b45d7253ea"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatM", "[", 
  RowBox[{"w", ",", "q"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatM", "[", 
  RowBox[{"sx", ",", "sy"}], "]"}]}], "Input",
 CellChangeTimes->{{3.707213656620713*^9, 3.707213675194297*^9}},
 CellLabel->
  "In[389]:=",ExpressionUUID->"a01a8235-36c3-430d-8461-19c7114d6214"],

Cell[BoxData[
 RowBox[{"MatM", "[", 
  RowBox[{"w", ",", "q"}], "]"}]], "Output",
 CellChangeTimes->{{3.7072136663835573`*^9, 3.707213675528854*^9}, {
   3.7072137483754597`*^9, 3.70721377045287*^9}, 3.7072140032986317`*^9, 
   3.707214911001442*^9, 3.707219119528315*^9, 3.707221370493095*^9, 
   3.7080723500831337`*^9, 3.708075016829918*^9, 3.7080779091740637`*^9, 
   3.708078152917234*^9, 3.708085246036187*^9, 3.708249243733411*^9, 
   3.708249826076277*^9, 3.708258894071021*^9, 3.708267633577592*^9, 
   3.708319160268355*^9, 3.708321070699435*^9, 3.7083227039404163`*^9, 
   3.7083228033381977`*^9, 3.708322953866434*^9, 3.708323818954124*^9, 
   3.708324050924574*^9, 3.7083250675106497`*^9, 3.7083252686767693`*^9, 
   3.708325365688134*^9, 3.708325411941334*^9, 3.7083255073268213`*^9, 
   3.708325564329727*^9, {3.70833164510168*^9, 3.70833166859828*^9}, 
   3.708341955447019*^9, 3.709712849784639*^9, 3.709713023234666*^9, {
   3.709713102529305*^9, 3.7097131176601*^9}, 3.709713398708873*^9, 
   3.712838405379237*^9, 3.712924403987207*^9, 3.712924462867733*^9, 
   3.7129888024508047`*^9, 3.7129890002275476`*^9, 3.712990590661023*^9, 
   3.7129912550592613`*^9, 3.71299242767349*^9, 3.7129928243947887`*^9, 
   3.712997216305356*^9, 3.713005616216855*^9, 3.71300568470278*^9, 
   3.713006943425274*^9, 3.713007882825069*^9, 3.713008224726891*^9, 
   3.7131752137509127`*^9, 3.7132404708978767`*^9, 3.713241458262855*^9, 
   3.7132416545201406`*^9, 3.713241859685236*^9, 3.713243093139688*^9, 
   3.713243397082624*^9, {3.71324353469381*^9, 3.713243547297708*^9}, 
   3.713244055675705*^9, 3.7132441576242437`*^9, 3.713244291397427*^9, 
   3.713244406439084*^9, {3.7132456292474003`*^9, 3.713245658390129*^9}, 
   3.713245709911489*^9, 3.71324581254359*^9, 3.7132501777034693`*^9, 
   3.7132505985545063`*^9, 3.7132646101563177`*^9, 3.713265494816022*^9, {
   3.7132657203973703`*^9, 3.713265744199585*^9}, 3.7132688073497057`*^9, 
   3.713268851951179*^9, 3.7132713014609632`*^9, 3.713271405190673*^9, 
   3.7132717990037327`*^9, 3.71327190054079*^9, 3.713272390429514*^9, 
   3.713272656790886*^9, 3.713274843056595*^9, 3.7132753968691473`*^9, 
   3.713278162061558*^9, 3.713278309976694*^9, 3.7134639290437565`*^9, 
   3.713464336943087*^9, 3.713466693219797*^9, 3.7135238731207523`*^9, 
   3.713524296322114*^9, 3.713524559615182*^9, 3.713672850374298*^9, 
   3.713673190579255*^9, 3.713687404547414*^9, 3.71380485937563*^9, 
   3.713854916080789*^9, 3.713854959031179*^9, 3.713865972885787*^9, 
   3.7138753233391457`*^9, 3.713875945589632*^9, 3.713876132588789*^9, 
   3.7138770866832857`*^9, 3.713877145362938*^9, 3.7138774211349993`*^9, 
   3.71387751590923*^9, 3.713877553289324*^9, 3.714026030342258*^9, 
   3.714028011827875*^9, 3.714029686605689*^9, 3.714029718540553*^9, 
   3.7140299507999*^9, 3.7140320299430447`*^9, 3.714032598312811*^9, 
   3.714033527322462*^9, 3.714037005847456*^9, 3.7140376628762693`*^9, 
   3.7140377724808483`*^9, 3.7140379167793283`*^9, 3.7140384635994377`*^9, 
   3.714039022946435*^9, 3.714039316564248*^9, 3.714039452056288*^9, 
   3.714110037633597*^9, 3.714132744119729*^9, 3.7149010182360992`*^9, 
   3.714901300639257*^9, 3.715852051353454*^9, 3.7158522205297947`*^9, 
   3.715853102967355*^9, {3.7158584880486917`*^9, 3.715858509964452*^9}, 
   3.7158586260890408`*^9, 3.715858719563692*^9, 3.715858842529537*^9, 
   3.7158612708142033`*^9, 3.718524066476182*^9, 3.722582139758698*^9, 
   3.72258405812*^9, 3.7225841506933126`*^9, 3.722584975271139*^9, 
   3.722585214952466*^9, 3.7225853636365347`*^9, 3.722592912351708*^9, 
   3.722596964744252*^9, 3.722597082961914*^9, 3.722597377577883*^9, 
   3.7225978957869368`*^9, 3.72286289620907*^9, 3.722863434609898*^9, 
   3.722863662799807*^9, 3.722863888282064*^9, 3.7228641022140303`*^9, 
   3.722864972482478*^9, 3.722866061593153*^9, 3.722866139899303*^9, 
   3.722866922153289*^9, 3.722866972910131*^9, 3.722867464856097*^9, 
   3.722867594126495*^9, 3.722868233806252*^9, 3.722869198457086*^9, 
   3.7228729189846983`*^9, 3.7229372096886387`*^9, 3.722938457327347*^9, 
   3.722939825517242*^9, 3.7229400793202877`*^9, 3.7229415335734367`*^9, 
   3.722941898992217*^9, 3.7229452939058437`*^9, 3.722945397169167*^9, 
   3.7233963400926113`*^9, 3.723396901512004*^9, 3.7233981834910555`*^9, 
   3.7233995007261686`*^9, 3.723401696543233*^9, 3.723405225487958*^9, 
   3.7238238627329693`*^9, 3.723908833592157*^9, 3.723908870570601*^9, 
   3.7239089619002*^9, 3.723975476739213*^9, 3.723976011532363*^9, 
   3.723981488789258*^9, 3.723982713883142*^9, 3.72398319151481*^9, {
   3.7239839059330378`*^9, 3.7239839147976837`*^9}, 3.7239840642687397`*^9, 
   3.723984163247313*^9, 3.723984698633081*^9, 3.723984749873247*^9, 
   3.734721260666458*^9, 3.734760665183907*^9, 3.734760735974284*^9, 
   3.7347808558373327`*^9, 3.734791953911241*^9, 3.734836464144536*^9, 
   3.734923854172385*^9, 3.734924254753297*^9, 3.7349371870029793`*^9, 
   3.7349372364558086`*^9, 3.7351190029569893`*^9, 3.7351340540918655`*^9, 
   3.739028853441357*^9, 3.7390318088033943`*^9, 3.7390368517748356`*^9, 
   3.739077109763661*^9, 3.739079189240922*^9, 3.739083273402072*^9, 
   3.7391949770841827`*^9, 3.7391954204249887`*^9, 3.764749500937165*^9, 
   3.765877188067254*^9, {3.765877265654872*^9, 3.765877269375764*^9}, 
   3.765879822592717*^9, 3.765879902145362*^9, 3.809339727568096*^9, {
   3.809339865307424*^9, 3.8093398898265944`*^9}, 3.809776385252743*^9, 
   3.8097765262659187`*^9, 3.809776839463429*^9, {3.809776872524935*^9, 
   3.809776877577157*^9}, 3.80977698366389*^9},
 CellLabel->
  "Out[389]=",ExpressionUUID->"2c8eda7a-e1b5-484e-a4ae-1e23fc5a3353"],

Cell[BoxData[
 RowBox[{"MatM", "[", 
  RowBox[{"sx", ",", "sy"}], "]"}]], "Output",
 CellChangeTimes->{{3.7072136663835573`*^9, 3.707213675528854*^9}, {
   3.7072137483754597`*^9, 3.70721377045287*^9}, 3.7072140032986317`*^9, 
   3.707214911001442*^9, 3.707219119528315*^9, 3.707221370493095*^9, 
   3.7080723500831337`*^9, 3.708075016829918*^9, 3.7080779091740637`*^9, 
   3.708078152917234*^9, 3.708085246036187*^9, 3.708249243733411*^9, 
   3.708249826076277*^9, 3.708258894071021*^9, 3.708267633577592*^9, 
   3.708319160268355*^9, 3.708321070699435*^9, 3.7083227039404163`*^9, 
   3.7083228033381977`*^9, 3.708322953866434*^9, 3.708323818954124*^9, 
   3.708324050924574*^9, 3.7083250675106497`*^9, 3.7083252686767693`*^9, 
   3.708325365688134*^9, 3.708325411941334*^9, 3.7083255073268213`*^9, 
   3.708325564329727*^9, {3.70833164510168*^9, 3.70833166859828*^9}, 
   3.708341955447019*^9, 3.709712849784639*^9, 3.709713023234666*^9, {
   3.709713102529305*^9, 3.7097131176601*^9}, 3.709713398708873*^9, 
   3.712838405379237*^9, 3.712924403987207*^9, 3.712924462867733*^9, 
   3.7129888024508047`*^9, 3.7129890002275476`*^9, 3.712990590661023*^9, 
   3.7129912550592613`*^9, 3.71299242767349*^9, 3.7129928243947887`*^9, 
   3.712997216305356*^9, 3.713005616216855*^9, 3.71300568470278*^9, 
   3.713006943425274*^9, 3.713007882825069*^9, 3.713008224726891*^9, 
   3.7131752137509127`*^9, 3.7132404708978767`*^9, 3.713241458262855*^9, 
   3.7132416545201406`*^9, 3.713241859685236*^9, 3.713243093139688*^9, 
   3.713243397082624*^9, {3.71324353469381*^9, 3.713243547297708*^9}, 
   3.713244055675705*^9, 3.7132441576242437`*^9, 3.713244291397427*^9, 
   3.713244406439084*^9, {3.7132456292474003`*^9, 3.713245658390129*^9}, 
   3.713245709911489*^9, 3.71324581254359*^9, 3.7132501777034693`*^9, 
   3.7132505985545063`*^9, 3.7132646101563177`*^9, 3.713265494816022*^9, {
   3.7132657203973703`*^9, 3.713265744199585*^9}, 3.7132688073497057`*^9, 
   3.713268851951179*^9, 3.7132713014609632`*^9, 3.713271405190673*^9, 
   3.7132717990037327`*^9, 3.71327190054079*^9, 3.713272390429514*^9, 
   3.713272656790886*^9, 3.713274843056595*^9, 3.7132753968691473`*^9, 
   3.713278162061558*^9, 3.713278309976694*^9, 3.7134639290437565`*^9, 
   3.713464336943087*^9, 3.713466693219797*^9, 3.7135238731207523`*^9, 
   3.713524296322114*^9, 3.713524559615182*^9, 3.713672850374298*^9, 
   3.713673190579255*^9, 3.713687404547414*^9, 3.71380485937563*^9, 
   3.713854916080789*^9, 3.713854959031179*^9, 3.713865972885787*^9, 
   3.7138753233391457`*^9, 3.713875945589632*^9, 3.713876132588789*^9, 
   3.7138770866832857`*^9, 3.713877145362938*^9, 3.7138774211349993`*^9, 
   3.71387751590923*^9, 3.713877553289324*^9, 3.714026030342258*^9, 
   3.714028011827875*^9, 3.714029686605689*^9, 3.714029718540553*^9, 
   3.7140299507999*^9, 3.7140320299430447`*^9, 3.714032598312811*^9, 
   3.714033527322462*^9, 3.714037005847456*^9, 3.7140376628762693`*^9, 
   3.7140377724808483`*^9, 3.7140379167793283`*^9, 3.7140384635994377`*^9, 
   3.714039022946435*^9, 3.714039316564248*^9, 3.714039452056288*^9, 
   3.714110037633597*^9, 3.714132744119729*^9, 3.7149010182360992`*^9, 
   3.714901300639257*^9, 3.715852051353454*^9, 3.7158522205297947`*^9, 
   3.715853102967355*^9, {3.7158584880486917`*^9, 3.715858509964452*^9}, 
   3.7158586260890408`*^9, 3.715858719563692*^9, 3.715858842529537*^9, 
   3.7158612708142033`*^9, 3.718524066476182*^9, 3.722582139758698*^9, 
   3.72258405812*^9, 3.7225841506933126`*^9, 3.722584975271139*^9, 
   3.722585214952466*^9, 3.7225853636365347`*^9, 3.722592912351708*^9, 
   3.722596964744252*^9, 3.722597082961914*^9, 3.722597377577883*^9, 
   3.7225978957869368`*^9, 3.72286289620907*^9, 3.722863434609898*^9, 
   3.722863662799807*^9, 3.722863888282064*^9, 3.7228641022140303`*^9, 
   3.722864972482478*^9, 3.722866061593153*^9, 3.722866139899303*^9, 
   3.722866922153289*^9, 3.722866972910131*^9, 3.722867464856097*^9, 
   3.722867594126495*^9, 3.722868233806252*^9, 3.722869198457086*^9, 
   3.7228729189846983`*^9, 3.7229372096886387`*^9, 3.722938457327347*^9, 
   3.722939825517242*^9, 3.7229400793202877`*^9, 3.7229415335734367`*^9, 
   3.722941898992217*^9, 3.7229452939058437`*^9, 3.722945397169167*^9, 
   3.7233963400926113`*^9, 3.723396901512004*^9, 3.7233981834910555`*^9, 
   3.7233995007261686`*^9, 3.723401696543233*^9, 3.723405225487958*^9, 
   3.7238238627329693`*^9, 3.723908833592157*^9, 3.723908870570601*^9, 
   3.7239089619002*^9, 3.723975476739213*^9, 3.723976011532363*^9, 
   3.723981488789258*^9, 3.723982713883142*^9, 3.72398319151481*^9, {
   3.7239839059330378`*^9, 3.7239839147976837`*^9}, 3.7239840642687397`*^9, 
   3.723984163247313*^9, 3.723984698633081*^9, 3.723984749873247*^9, 
   3.734721260666458*^9, 3.734760665183907*^9, 3.734760735974284*^9, 
   3.7347808558373327`*^9, 3.734791953911241*^9, 3.734836464144536*^9, 
   3.734923854172385*^9, 3.734924254753297*^9, 3.7349371870029793`*^9, 
   3.7349372364558086`*^9, 3.7351190029569893`*^9, 3.7351340540918655`*^9, 
   3.739028853441357*^9, 3.7390318088033943`*^9, 3.7390368517748356`*^9, 
   3.739077109763661*^9, 3.739079189240922*^9, 3.739083273402072*^9, 
   3.7391949770841827`*^9, 3.7391954204249887`*^9, 3.764749500937165*^9, 
   3.765877188067254*^9, {3.765877265654872*^9, 3.765877269375764*^9}, 
   3.765879822592717*^9, 3.765879902145362*^9, 3.809339727568096*^9, {
   3.809339865307424*^9, 3.8093398898265944`*^9}, 3.809776385252743*^9, 
   3.8097765262659187`*^9, 3.809776839463429*^9, {3.809776872524935*^9, 
   3.809776877577157*^9}, 3.809776983672187*^9},
 CellLabel->
  "Out[390]=",ExpressionUUID->"cd03bf76-1629-4116-86a0-078ffe0e614c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SigmaRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"sx", ",", "sy"}], "]"}], "\[Rule]", 
     RowBox[{"I", " ", "sz"}]}], ",", 
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"sy", ",", "sx"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "sz"}]}], ",", 
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"sy", ",", "sz"}], "]"}], "\[Rule]", 
     RowBox[{"I", " ", "sx"}]}], ",", 
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"sz", ",", "sy"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "sx"}]}], ",", 
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"sz", ",", "sx"}], "]"}], "\[Rule]", 
     RowBox[{"I", " ", "sy"}]}], ",", 
    RowBox[{
     RowBox[{"MatM", "[", 
      RowBox[{"sx", ",", "sz"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "sy"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.707208503289118*^9, 3.707208505295559*^9}, {
  3.7072086356443863`*^9, 3.707208639900655*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"03a9572e-09d8-4e00-a2f8-af978cde0e91"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"MatM", "[", 
     RowBox[{"sx", ",", "sy"}], "]"}], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", "sz"}]}], ",", 
   RowBox[{
    RowBox[{"MatM", "[", 
     RowBox[{"sy", ",", "sx"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "sz"}]}], ",", 
   RowBox[{
    RowBox[{"MatM", "[", 
     RowBox[{"sy", ",", "sz"}], "]"}], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", "sx"}]}], ",", 
   RowBox[{
    RowBox[{"MatM", "[", 
     RowBox[{"sz", ",", "sy"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "sx"}]}], ",", 
   RowBox[{
    RowBox[{"MatM", "[", 
     RowBox[{"sz", ",", "sx"}], "]"}], "\[Rule]", 
    RowBox[{"\[ImaginaryI]", " ", "sy"}]}], ",", 
   RowBox[{
    RowBox[{"MatM", "[", 
     RowBox[{"sx", ",", "sz"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "sy"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.707208640869484*^9, 3.7072134877610826`*^9, {3.7072136871499033`*^9, 
   3.7072137027792387`*^9}, {3.707213749087329*^9, 3.707213770480398*^9}, 
   3.7072140033248796`*^9, 3.707214911028027*^9, 3.7072191195549793`*^9, 
   3.707221370519611*^9, 3.708072350134472*^9, 3.708075016881991*^9, 
   3.708077909212912*^9, 3.708078153067067*^9, 3.708085246086994*^9, 
   3.708249243766795*^9, 3.7082498261193037`*^9, 3.708258894128845*^9, 
   3.7082676336152973`*^9, 3.708319160351758*^9, 3.708321070747692*^9, 
   3.708322703999783*^9, 3.708322803394307*^9, 3.7083229539154797`*^9, 
   3.708323819003899*^9, 3.708324050991466*^9, 3.708325067566383*^9, 
   3.7083252687217827`*^9, 3.7083253657266703`*^9, 3.708325411979841*^9, 
   3.7083255074173813`*^9, 3.708325564379918*^9, {3.708331645154894*^9, 
   3.708331668657118*^9}, 3.7083419554840937`*^9, 3.7097128498200607`*^9, 
   3.70971302327326*^9, {3.709713102568318*^9, 3.7097131177079678`*^9}, 
   3.70971339874374*^9, 3.712838405427186*^9, 3.712924404069826*^9, 
   3.712924462916916*^9, 3.7129888025249043`*^9, 3.712989000264688*^9, 
   3.7129905907105293`*^9, 3.712991255096921*^9, 3.712992427728281*^9, 
   3.7129928244329*^9, 3.7129972163577414`*^9, 3.713005616257451*^9, 
   3.713005684743432*^9, 3.713006943465431*^9, 3.7130078828870792`*^9, 
   3.7130082247688007`*^9, 3.713175213862948*^9, 3.713240470947648*^9, 
   3.713241458295858*^9, 3.71324165455372*^9, 3.713241859719256*^9, 
   3.713243093174473*^9, 3.71324339711689*^9, {3.7132435347282763`*^9, 
   3.713243547358477*^9}, 3.7132440557106256`*^9, 3.7132441576593447`*^9, 
   3.713244291433803*^9, 3.7132444064740353`*^9, {3.713245629282641*^9, 
   3.713245658436441*^9}, 3.7132457099484262`*^9, 3.7132458125786457`*^9, 
   3.713250177741082*^9, 3.713250598594913*^9, 3.7132646101903353`*^9, 
   3.713265494874168*^9, {3.713265720434175*^9, 3.713265744248897*^9}, 
   3.713268807399431*^9, 3.713268851988432*^9, 3.713271301511413*^9, 
   3.713271405230742*^9, 3.7132717990621634`*^9, 3.7132719006082497`*^9, 
   3.713272390501742*^9, 3.713272656857625*^9, 3.713274843130309*^9, 
   3.71327539694195*^9, 3.713278162362369*^9, 3.713278310058241*^9, 
   3.7134639291287613`*^9, 3.7134643371020966`*^9, 3.7134666932697573`*^9, 
   3.713523873187039*^9, 3.71352429647259*^9, 3.713524559653297*^9, 
   3.7136728504820223`*^9, 3.713673190600354*^9, 3.71368740456703*^9, 
   3.713804859426552*^9, 3.713854916114854*^9, 3.713854959081229*^9, 
   3.71386597296707*^9, 3.713875323382139*^9, 3.713875945632916*^9, 
   3.713876132625599*^9, 3.713877086720686*^9, 3.7138771454000874`*^9, 
   3.713877421171588*^9, 3.71387751594753*^9, 3.7138775533264914`*^9, 
   3.71402603039785*^9, 3.7140280118714857`*^9, 3.714029686641707*^9, 
   3.7140297185813837`*^9, 3.714029950831551*^9, 3.7140320299929447`*^9, 
   3.714032598346506*^9, 3.714033527354837*^9, 3.714037005902936*^9, 
   3.714037662915738*^9, 3.7140377725193663`*^9, 3.714037916829606*^9, 
   3.71403846364124*^9, 3.714039022996151*^9, 3.7140393166074677`*^9, 
   3.714039452109622*^9, 3.7141100376825857`*^9, 3.714132744190775*^9, 
   3.714901018313479*^9, 3.7149013006755543`*^9, 3.7158520515854063`*^9, 
   3.715852220584641*^9, 3.715853103003484*^9, {3.715858488097073*^9, 
   3.715858510004957*^9}, 3.715858626125606*^9, 3.715858719597754*^9, 
   3.715858842566373*^9, 3.7158612708802023`*^9, 3.718524066526566*^9, 
   3.722582139834429*^9, 3.722584058168893*^9, 3.722584150725038*^9, 
   3.72258497531236*^9, 3.722585214985486*^9, 3.722585363669956*^9, 
   3.722592912417749*^9, 3.722596964785262*^9, 3.7225970829945*^9, 
   3.722597377616414*^9, 3.722597895823586*^9, 3.722862896258628*^9, 
   3.72286343465936*^9, 3.7228636628433332`*^9, 3.722863888325523*^9, 
   3.722864102249305*^9, 3.722864972516995*^9, 3.722866061643446*^9, 
   3.722866140164144*^9, 3.722866922188884*^9, 3.722866972949189*^9, 
   3.722867464891259*^9, 3.7228675941613483`*^9, 3.722868233843396*^9, 
   3.7228691987127657`*^9, 3.722872919022888*^9, 3.722937209703974*^9, 
   3.722938457346314*^9, 3.722939825539793*^9, 3.722940079333976*^9, 
   3.722941533595697*^9, 3.722941899005608*^9, 3.722945293918737*^9, 
   3.722945397182913*^9, 3.723396340248612*^9, 3.7233969015588036`*^9, 
   3.723398183537855*^9, 3.7233995007729692`*^9, 3.723401696668033*^9, 
   3.7234052255209427`*^9, 3.7238238627649307`*^9, 3.723908833627508*^9, 
   3.723908870604939*^9, 3.723908961943303*^9, 3.723975476777878*^9, 
   3.723976011568837*^9, 3.723981488828219*^9, 3.723982713920746*^9, 
   3.723983191564785*^9, {3.7239839059724407`*^9, 3.723983914856669*^9}, 
   3.723984064326601*^9, 3.723984163305978*^9, 3.723984698673254*^9, 
   3.723984749914257*^9, 3.734721260713461*^9, 3.734760665233161*^9, 
   3.7347607360258827`*^9, 3.7347808558965816`*^9, 3.734791953977871*^9, 
   3.734836464211549*^9, 3.7349238542573905`*^9, 3.7349242547983*^9, 
   3.734937187049982*^9, 3.734937236501811*^9, 3.735119003015993*^9, 
   3.735134054159869*^9, 3.7390288534963603`*^9, 3.7390318088273954`*^9, 
   3.739036851830839*^9, 3.739077109813673*^9, 3.739079189288732*^9, 
   3.739083273467689*^9, 3.739194977400359*^9, 3.7391954204937353`*^9, 
   3.764749501124365*^9, 3.765877188112093*^9, {3.765877265708496*^9, 
   3.765877269478635*^9}, 3.765879822651227*^9, 3.765879902196954*^9, 
   3.809339727632532*^9, {3.8093398653726*^9, 3.809339889876285*^9}, 
   3.809776385307481*^9, 3.809776526322699*^9, 3.809776839529834*^9, {
   3.809776872559361*^9, 3.809776877643331*^9}, 3.809776983714306*^9},
 CellLabel->
  "Out[391]=",ExpressionUUID->"e769e500-f9ef-4879-8524-ca1205a42468"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.707053719178553*^9, 3.707111764087183*^9},
 CellLabel->
  "In[392]:=",ExpressionUUID->"2819428d-c3e8-429d-a13c-f5104770ae41"],

Cell[TextData[{
 StyleBox["Define the Commutator\n", "Subsection"],
 "Idea from here (second answer by `evanb\[CloseCurlyQuote])",
 StyleBox["\n", "Subsection"],
 "https://mathematica.stackexchange.com/questions/63811/pull-out-scalars-from-\
noncommutativemultiply-in-commutator-of-su2-spin-algebra"
}], "Text",
 CellChangeTimes->{{3.7071393813653517`*^9, 3.707139429163363*^9}, {
  3.7071396964865713`*^9, 
  3.7071397432300177`*^9}},ExpressionUUID->"87ac8d07-10f9-485b-be11-\
6a4a324f32d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"obviously", " ", "trivial", " ", "commutators"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{"xx_", ",", "xx_"}], "]"}], ":=", "0"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Commutator", " ", "/:", " ", 
     RowBox[{"Plus", "[", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{"xx_", ",", "yy_"}], "]"}], ",", 
       RowBox[{"Commutator", "[", 
        RowBox[{"yy_", ",", "xx_"}], "]"}]}], "]"}], " ", ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"below", ":", " ", 
     RowBox[{"scalars", " ", "always", " ", "commute"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{"xx_", ",", "yy_"}], "]"}], ":=", 
     RowBox[{"0", " ", "/;", " ", 
      RowBox[{"CommutativeQ", "[", "xx", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{"xx_", ",", "yy_"}], "]"}], ":=", 
     RowBox[{"0", " ", "/;", " ", 
      RowBox[{"CommutativeQ", "[", "yy", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Linearity", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{
       RowBox[{"Plus", "[", 
        RowBox[{"a_", ",", "addends__"}], "]"}], ",", "B_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Commutator", "[", 
       RowBox[{"a", ",", "B"}], "]"}], "+", 
      RowBox[{"Commutator", "[", 
       RowBox[{
        RowBox[{"Plus", "[", "addends", "]"}], ",", "B"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{"A_", ",", 
       RowBox[{"Plus", "[", 
        RowBox[{"b_", ",", "baddends__"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Commutator", "[", 
       RowBox[{"A", ",", "b"}], "]"}], "+", 
      RowBox[{"Commutator", "[", 
       RowBox[{"A", ",", 
        RowBox[{"Plus", "[", "baddends", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{
       RowBox[{"Times", "[", 
        RowBox[{"c_", ",", "factors__"}], "]"}], ",", "B_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{"Times", "[", "factors", "]"}], ",", "B"}], "]"}]}], " ", "/;",
       " ", 
      RowBox[{"CommutativeQ", "[", "c", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{"A_", ",", 
       RowBox[{"Times", "[", 
        RowBox[{"c_", ",", "factors__"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"Commutator", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Times", "[", "factors", "]"}]}], "]"}]}], " ", "/;", " ", 
      RowBox[{"CommutativeQ", "[", "c", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "  ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "pull", " ", "integrals", " ", "out", " ", "of", " ", "the", " ", 
     "commutator", " ", 
     RowBox[{"(", 
      RowBox[{
      "only", " ", "works", " ", "for", " ", "\"\<definite integrals\>\"", 
       " ", "I", " ", "think"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"A_", ",", "x_"}], "]"}], ",", "B_"}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{"A", ",", "B"}], "]"}], ",", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Commutator", "[", 
      RowBox[{"A_", ",", 
       RowBox[{"Integrate", "[", 
        RowBox[{"B_", ",", "x_"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{"A", ",", "B"}], "]"}], ",", "x"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7071394235541067`*^9, 3.707139535253931*^9}, {
   3.707139635201075*^9, 3.707139635625049*^9}, {3.7071397637151413`*^9, 
   3.707139852615191*^9}, {3.7071398860851507`*^9, 3.7071401129947453`*^9}, 
   3.707140165048381*^9, 3.7071408922367077`*^9, 3.707141183717742*^9, 
   3.707141672368496*^9, 3.7071420136986303`*^9, {3.707142090932115*^9, 
   3.7071421170237703`*^9}, {3.707142222150655*^9, 3.707142229252624*^9}, {
   3.709717177812396*^9, 3.709717184256524*^9}, {3.7097172674757853`*^9, 
   3.709717307345194*^9}},
 CellLabel->
  "In[393]:=",ExpressionUUID->"3140e23a-edfa-4156-8d0f-b5a7b0a7533a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.707199869091449*^9, 3.707199869230146*^9}},
 CellLabel->
  "In[403]:=",ExpressionUUID->"09f3bd6e-ba21-4e4e-b3e3-96555f76aa63"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.707199869809314*^9, 3.707199869966061*^9}},
 CellLabel->
  "In[404]:=",ExpressionUUID->"0307b34c-3907-409a-b408-b03cbc85c648"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Third", " ", "MagnusM3", " ", "for", " ", "the", " ", "case", " ", 
     "that", " ", "the", " ", "initial", " ", "time", " ", 
     SubscriptBox["t", "0"], " ", "is", " ", "not", " ", "equal", " ", "to", 
     " ", "0"}], ",", " ", 
    RowBox[{"and", " ", "using", " ", "commutators", " ", 
     RowBox[{"properly", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Assuming", " ", "NCi", " ", "are", " ", "already", " ", "Non"}], 
    "-", 
    RowBox[{"Commutative", " ", "variables", " ", "in", " ", "the", " ", 
     RowBox[{"Hamiltonian", " ", "[", 
      RowBox[{
       RowBox[{"e", ".", "g", "."}], ",", " ", "sx", ",", " ", "sy", ",", " ",
        "sz"}], "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MagnusM3", "[", 
     RowBox[{"Ht_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "HH", ",", "temp", ",", "result0", ",", "result1", ",", "term"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"In", ":", " ", 
         RowBox[{"Ht", " ", 
          RowBox[{"(", 
           RowBox[{"NC", " ", "object"}], ")"}]}]}], ",", " ", 
        RowBox[{"k", " ", "=", " ", "1"}], ",", "2", ",", 
        RowBox[{
         RowBox[{"3", "..."}], " ", 
         RowBox[{"(", 
          RowBox[{"order", " ", "of", " ", "Magnus", " ", "Expansion"}], 
          ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Out", ":", " ", 
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{"result", ",", " ", 
           SuperscriptBox["\[Lambda]", "k"]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k", "-", 
            RowBox[{"th", " ", "Magnus", " ", "term", " ", 
             SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "k"], " ", 
             RowBox[{"(", 
              RowBox[{"anti", "-", "Hermitian"}], ")"}], " ", "as", " ", "a", 
             " ", "function", " ", "of", " ", "Hamiltonian", " ", 
             RowBox[{"Ht", " ", "--"}], " ", "to", " ", "get", " ", 
             SubscriptBox["H", "k"], "*", 
             SubscriptBox["t", "c"]}]}], ",", " ", 
           RowBox[{
            RowBox[{"multiply", " ", "by"}], " ", "+", "\[ImaginaryI]"}]}], 
          ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", 
        RowBox[{"x", ",", "y", ",", "please"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SetNonCommutative", "[", 
        RowBox[{
        "HH", ",", "please", ",", "\[CapitalOmega]\[CapitalOmega]", ",", 
         SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "1"], ",", "x", ",", 
         "y"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetCommutative", "[", "\[Lambda]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"HH", "=", "please"}], ";", "\[IndentingNewLine]", 
       RowBox[{"result0", "=", 
        RowBox[{"\[Lambda]", " ", "HH"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "=", "1"}], ";", 
          RowBox[{"temp", "=", "HH"}]}], ",", 
         RowBox[{"i", "<", "k"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Write", " ", "down", " ", 
           RowBox[{"Eq", ".", " ", 
            RowBox[{"(", "21", ")"}]}], " ", 
           RowBox[{"of", " ", "'"}], "A", " ", "pedagogical", " ", "approach",
            " ", "to", " ", "the", " ", 
           RowBox[{"ME", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"temp", "=", 
           RowBox[{"Commutator", "[", 
            RowBox[{"\[CapitalOmega]\[CapitalOmega]", ",", "temp"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"term", "=", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"BernoulliB", "[", "i", "]"}], 
              RowBox[{"Factorial", "[", "i", "]"}]], "\[Lambda]", "*", 
             "temp"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]\[CapitalOmega]", "\[Rule]", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"s", "=", "1"}], 
                RowBox[{"k", "+", "1", "-", "i"}]], 
               RowBox[{
                SuperscriptBox["\[Lambda]", "s"], 
                RowBox[{
                 SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "s"], "[", 
                 RowBox[{"t", ",", "t0"}], "]"}]}]}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result0", "+=", "term"}], ";", "\[IndentingNewLine]", 
          RowBox[{"SetNonCommutative", "[", 
           SubscriptBox["\[CapitalOmega]\[CapitalOmega]", 
            RowBox[{"i", "+", "1"}]], "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"result1", "[", "\[Lambda]_", "]"}], ":=", "result0"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"result1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"result1", "[", "\[Lambda]", "]"}], "//", "NCE"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]", ",", "0", ",", "k"}], "}"}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"please", "\[Rule]", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "Ht"}]}], "}"}]}], "//", 
         "Normal"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"If", " ", "you", " ", "want", " ", "to", " ", "double"}], 
          "-", 
          RowBox[{
          "check", " ", "the", " ", "first", " ", "few", " ", "terms", " ", 
           "remember", " ", "that"}]}], ",", " ", 
         RowBox[{"for", " ", "instance"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "1"], " ", "=", " ", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           RowBox[{"\[Integral]", 
            RowBox[{"H", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"and", " ", "not"}], " ", "+", "\[ImaginaryI]"}], 
               ")"}], "."}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"result1", "//", "NCE"}], "//", "Expand"}], ",", 
         SuperscriptBox["\[Lambda]", "k"]}], "]"}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.707111771288121*^9, 3.707111789609984*^9}, {
   3.707112030020212*^9, 3.7071121691880417`*^9}, {3.7071122022039347`*^9, 
   3.7071122437619534`*^9}, {3.707112314790288*^9, 3.7071123167780123`*^9}, 
   3.707112379610424*^9, {3.707131059268106*^9, 3.707131072484827*^9}, {
   3.707139327307535*^9, 3.707139370039452*^9}, {3.707139403901848*^9, 
   3.707139418589225*^9}, {3.70714044205525*^9, 3.7071404485000353`*^9}, {
   3.7071408211950693`*^9, 3.7071408481992903`*^9}, {3.707141017144085*^9, 
   3.707141037295416*^9}, {3.7071411468170424`*^9, 3.707141172561247*^9}, {
   3.707141322153028*^9, 3.7071413317440166`*^9}, {3.707141394269773*^9, 
   3.70714144965106*^9}, {3.7071417273103743`*^9, 3.7071417301089354`*^9}, {
   3.707141784146392*^9, 3.7071417929061737`*^9}, {3.70714252805975*^9, 
   3.707142536961306*^9}, 3.707199868433742*^9, {3.721984933214237*^9, 
   3.7219849359823017`*^9}, {3.721985496629765*^9, 3.721985539197152*^9}, {
   3.72198557532434*^9, 3.72198567753734*^9}, {3.721985856206003*^9, 
   3.7219859567062883`*^9}, 3.721986978607662*^9, {3.721987065886168*^9, 
   3.721987073549246*^9}, {3.7219884657260027`*^9, 3.721988539788446*^9}, {
   3.721988597185894*^9, 3.721988653241888*^9}, 3.721990526520855*^9, {
   3.721990804056933*^9, 3.7219908621987133`*^9}, 3.72208530868289*^9, {
   3.7220859277569017`*^9, 3.722086203870735*^9}, {3.722086260380568*^9, 
   3.722086261156311*^9}, {3.7220863878222017`*^9, 3.722086392589443*^9}, {
   3.722086436988825*^9, 3.7220864375393953`*^9}, {3.722086535150161*^9, 
   3.72208660932338*^9}, {3.722086652103705*^9, 3.722086667749743*^9}, {
   3.72208929326413*^9, 3.722089294584712*^9}, {3.722089500334942*^9, 
   3.722089582200533*^9}},
 CellLabel->
  "In[405]:=",ExpressionUUID->"ccabe858-fe33-4de0-be08-7331aa9d41a3"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.707051677032414*^9, 3.7070516773408413`*^9}},
 CellLabel->
  "In[406]:=",ExpressionUUID->"adb30d95-e908-4d2c-9c8e-5886451f92d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["2.   Basic Magnus Expansion",
 FontColor->RGBColor[1, 0, 0]]], "Section",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738404299663188*^9, 3.738404305126616*^9}, {
   3.738406704248948*^9, 
   3.738406705351635*^9}},ExpressionUUID->"5de7e064-e812-42ce-a5c5-\
74d28fab2001"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.739077294442658*^9, 3.739077294584723*^9}},
 CellLabel->
  "In[407]:=",ExpressionUUID->"00197fec-a503-4b26-b229-53e932052624"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["3.   Trim Expressions",
 FontColor->RGBColor[1, 0, 0]]], "Section",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738404299663188*^9, 3.738404305126616*^9}, {
   3.738404391665751*^9, 3.73840439835355*^9}, {3.7384067098878193`*^9, 
   3.7384067112153473`*^9}},ExpressionUUID->"ab28e685-c723-458a-a2de-\
9236913674c7"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"write", " ", "list", " ", "of", " ", "coefficients"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.722582218799387*^9, 3.722582226705678*^9}},
 CellLabel->
  "In[408]:=",ExpressionUUID->"6342f5e2-8b8b-4fb8-aa85-77dbbbde7a01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"INPUT", ":", "  ", 
      RowBox[{
      "coeffs1", " ", "in", " ", "the", " ", "form", " ", "of", " ", 
       "\[IndentingNewLine]", "coeffs1"}]}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Kc", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Ks", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Jc", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Js", ",", "1"}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "max", " ", "is", " ", "the", " ", "maximum", " ", "power", " ", "of", 
      " ", "\[Omega]", " ", "\[IndentingNewLine]", "offR", " ", 
      RowBox[{"(", "resonant", ")"}]}], " ", "=", " ", 
     RowBox[{"True", " ", "or", " ", "False"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"OUTPUT", ":", "  ", 
     RowBox[{"principal", " ", "coefficients"}]}], ",", " ", 
    RowBox[{"e", ".", "g", "."}], ",", " ", 
    RowBox[{"coeffs", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"H1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"H1D", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"H1DD", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Delta", ",", "1"}], "}"}]}], "}"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"for", " ", "max"}], " ", "=", " ", 
        RowBox[{"3", " ", "I", " ", "guess"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"setCList", "[", 
     RowBox[{"coeffs1_", ",", "max_", ",", "offR_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coeffs", ",", "dds", ",", "termSt"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "first", " ", "loop", " ", "through", " ", "number", " ", "of", " ", 
        "derivatives"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "=", "1"}], ";", 
          RowBox[{"coeffs", "=", "coeffs1"}], ";", 
          RowBox[{"dds", "=", "\"\<\>\""}]}], ",", 
         RowBox[{"i", "\[LessEqual]", "max"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dds", "=", 
           RowBox[{"dds", "<>", "\"\<D\>\""}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "loop", " ", "through", " ", "coefficients", " ", "to", " ", "add",
             " ", "derivative", " ", "terms"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", "coeffs1", "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termSt", "=", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"coeffs", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "<>", 
               "dds"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"coeffs", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"coeffs", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ToExpression", "@", "termSt"}], ",", 
                   RowBox[{"i", "+", "1"}]}], "}"}], "}"}]}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"offR", "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"coeffs", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"Delta", ",", "1"}], "}"}], "}"}], ",", "coeffs"}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "coeffs", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.722582239596987*^9, 3.722582462165538*^9}, {
   3.722582573238707*^9, 3.722582663994506*^9}, {3.7225836565365133`*^9, 
   3.722583667241906*^9}, {3.722870090330449*^9, 3.722870094786159*^9}, 
   3.734763471823992*^9, {3.7347770721068907`*^9, 3.734777083005735*^9}, {
   3.734778775950811*^9, 3.734778781007913*^9}},
 CellLabel->
  "In[409]:=",ExpressionUUID->"1d12a89a-53cc-40b3-99c2-9b9f52b72533"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"based", " ", "on", " ", "coeffs"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c1", ",", "dim1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"c2", ",", "dim2"}], "}"}], ",", " ", ".."}], "}"}], " ", 
      "[", 
      RowBox[{
       RowBox[{"obtained", " ", "from", " ", "setCList"}], ",", " ", 
       "ideally"}], "]"}]}], ",", " ", 
    RowBox[{"find", " ", "a", " ", "list", " ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          SuperscriptBox["c1A", "p1"], "}"}], ",", " ", "dimTotA"}], "}"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["c1B", "p1"], ",", " ", 
           SuperscriptBox["c2B", "p2"]}], "}"}], ",", " ", "dimTotB"}], "}"}],
        ",", " ", ".."}], "}"}], "\[IndentingNewLine]", "or", " ", 
     "something", " ", "like", " ", "that"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"detCList", "[", 
     RowBox[{"coeffs_", ",", "max_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "work", ",", "item", ",", "i", ",", "exp", ",", "rep", ",", "cBigList",
         ",", "cList", ",", "coefficient"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"work", "=", "coeffs"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"here", ":", "  ", 
          RowBox[{"extend", " ", "coeffs", " ", 
           RowBox[{"(", "\"\<work\>\"", ")"}], " ", "to", " ", "include", " ",
            "higher", " ", "order", " ", "of", " ", "H1"}]}], ",", " ", "H1D",
          ",", " ", "..", ",", " ", "Hn", ",", " ", ".."}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", 
          RowBox[{"Length", "[", "coeffs", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<outer loop, i = \>\"", ",", "i"}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"item", "=", 
           RowBox[{"coeffs", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "all", " ", "extra", " ", "items", " ", "start", " ", "at", " ", 
             "exp"}], " ", "=", " ", "2"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"exp", "=", "2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "up", " ", "to", " ", "dimension", " ", "\"\<exp\>\"", " ", "so", 
             " ", "that", " ", 
             SuperscriptBox["Hn", "exp"], " ", "so", " ", "that", " ", 
             "total", " ", "dimension", " ", 
             RowBox[{"dim", "[", "Hn", "]"}], "*", "exp"}], " ", 
            "\[LessEqual]", " ", "max"}], "  ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"exp", "*", 
              RowBox[{"item", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "<=", "max"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"work", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"work", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"item", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "exp"], ",", 
                   RowBox[{"exp", "*", 
                    RowBox[{"item", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"exp", "+=", "1"}], ";"}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"exp", ">", "10"}], ",", "Break"}], "]"}], "*)"}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", ">", "20"}], ",", "Break"}], "]"}], "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"now", " ", "create", " ", "all", " ", "combinations"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cBigList", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{"work", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "max"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<After Subsets: CBigList = \>\"", ",", "cBigList"}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Table", ":", " ", 
         RowBox[{"elements", " ", "of", " ", "coeffs"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"cBigList", "=", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cBigList", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", 
               RowBox[{"1", ";;", 
                RowBox[{"Length", "[", 
                 RowBox[{"cBigList", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", "1"}], "]"}], 
             "]"}], ",", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"cBigList", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"cBigList", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "cBigList", "]"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Now", " ", "remove", " ", "all", " ", "those", " ", "entries", " ", 
         "whose", " ", "dimension", " ", "is", " ", "too", " ", "large"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cBigList", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"cBigList", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "<=", "max"}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Now", " ", "remove", " ", "all", " ", "\"\<double entries\>\"", " ", 
         "such", " ", "as", " ", 
         RowBox[{"{", 
          RowBox[{"H1", ",", 
           SuperscriptBox["H1", "2"], ",", "3"}], "}"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rep", "=", 
        RowBox[{
         RowBox[{"x_", "^", "y_"}], "\[RuleDelayed]", "x"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Before, cBigList = \>\"", ",", "cBigList"}], "]"}], 
         ";"}], "*)"}], 
       RowBox[{"cBigList", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"cBigList", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"#1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/.", "rep"}], "]"}], "]"}]}],
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Afterwards, cBigList = \>\"", ",", "cBigList"}], "]"}],
          ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<After combining subsets: CBigList = \>\"", ",", "cBigList"}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "cBigList", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.722265649333127*^9, 3.7222656660438023`*^9}, {
   3.72226571918497*^9, 3.722265787237772*^9}, {3.722265829467671*^9, 
   3.722265881809205*^9}, {3.722265913391123*^9, 3.722265993874937*^9}, {
   3.722266130659968*^9, 3.722266182146254*^9}, {3.722266245022108*^9, 
   3.722266292203671*^9}, {3.722266331441856*^9, 3.722266347721066*^9}, {
   3.7222664354846992`*^9, 3.722266557134239*^9}, {3.7222666103494177`*^9, 
   3.722266637265815*^9}, {3.722266751941916*^9, 3.7222667770190773`*^9}, {
   3.722266828304941*^9, 3.722267019694347*^9}, {3.722267083947215*^9, 
   3.722267193237677*^9}, {3.722267228995532*^9, 3.7222672471066236`*^9}, {
   3.722267569426394*^9, 3.7222676390544*^9}, {3.722267690044179*^9, 
   3.722267692084495*^9}, {3.7222677280819483`*^9, 3.722267774391572*^9}, {
   3.722267826418831*^9, 3.72226783990849*^9}, {3.722267991940419*^9, 
   3.722268239840456*^9}, {3.722268301940954*^9, 3.722268308708186*^9}, {
   3.7222683480589247`*^9, 3.722268357026557*^9}, {3.7222702365688467`*^9, 
   3.722270241280201*^9}, {3.7222703752818403`*^9, 3.7222704125436773`*^9}, {
   3.72227053594503*^9, 3.722270637572221*^9}, {3.722270669354926*^9, 
   3.722270782468568*^9}, {3.722271017105094*^9, 3.722271190424255*^9}, {
   3.72227122467875*^9, 3.722271230269107*^9}, {3.722271278354701*^9, 
   3.722271365295229*^9}, {3.7222714238442698`*^9, 3.722271488336911*^9}, {
   3.722271548629878*^9, 3.722271568868731*^9}, {3.7222716081230717`*^9, 
   3.7222717074298964`*^9}, 3.722271918129998*^9, {3.722272026557276*^9, 
   3.722272027741239*^9}, 3.72227214883521*^9, {3.722323444892396*^9, 
   3.7223234933390913`*^9}, {3.722323534866523*^9, 3.722323625983028*^9}, {
   3.722323677838883*^9, 3.7223236845739403`*^9}, {3.72232372196519*^9, 
   3.722323768555046*^9}, {3.722323858641345*^9, 3.7223238762010937`*^9}, {
   3.722323960022725*^9, 3.722324008421112*^9}, {3.7223242881189413`*^9, 
   3.722324316580667*^9}, {3.722325144454933*^9, 3.722325150045713*^9}, {
   3.722325183914885*^9, 3.722325323916162*^9}, {3.722325476701263*^9, 
   3.72232550445122*^9}, {3.722325542129327*^9, 3.7223255441333942`*^9}, {
   3.72232576414926*^9, 3.722325775140049*^9}, {3.722326359964814*^9, 
   3.722326421187125*^9}, {3.722329575852964*^9, 3.722329580864532*^9}, {
   3.722329613284609*^9, 3.722329691706996*^9}, 3.722329732273837*^9, {
   3.722329843658019*^9, 3.7223298444233103`*^9}, 3.722337793393621*^9, 
   3.722605138245414*^9, {3.722870859017942*^9, 3.722870873160345*^9}, {
   3.7228709765654697`*^9, 3.722870992537624*^9}, {3.722871045975439*^9, 
   3.7228712400683413`*^9}, {3.722871367677937*^9, 3.722871400923794*^9}, {
   3.722872176652277*^9, 3.722872182361086*^9}, {3.722872628153451*^9, 
   3.7228726369316072`*^9}, 3.7228727266125174`*^9, {3.7228727997441072`*^9, 
   3.722872802752112*^9}, {3.722872875837571*^9, 3.7228728858911657`*^9}, {
   3.7228730071473722`*^9, 3.7228730613621798`*^9}, 3.722877665628639*^9, {
   3.7229382138571167`*^9, 3.722938251948758*^9}, {3.72293838890589*^9, 
   3.7229384056473513`*^9}, {3.722938814316485*^9, 3.7229388207255707`*^9}, {
   3.722939082085661*^9, 3.7229391039087*^9}, {3.722939686758284*^9, 
   3.722939687629053*^9}, {3.722939730764876*^9, 3.722939731923811*^9}, {
   3.722939782186533*^9, 3.722939791474189*^9}, {3.722940444497147*^9, 
   3.722940480782804*^9}, {3.722940511104767*^9, 3.722940514548882*^9}, {
   3.7229408825659*^9, 3.7229408999086018`*^9}, {3.734780959616317*^9, 
   3.734780996174679*^9}, {3.734781027342183*^9, 3.734781075210333*^9}, {
   3.7347811199046593`*^9, 3.7347811662860937`*^9}, {3.7347829143128557`*^9, 
   3.734782925358172*^9}, 3.7347863737734833`*^9},
 CellLabel->
  "In[410]:=",ExpressionUUID->"1c0dbf3f-8518-4498-85f4-38a88ff7acc8"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.722940546842856*^9},
 CellLabel->
  "In[411]:=",ExpressionUUID->"46514008-5004-4b95-aa49-289073451663"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"assumes", " ", 
     RowBox[{"coeffs", "[", "i", "]"}], " ", "for", " ", "all", " ", "i"}], 
    " ", "\[LessEqual]", " ", 
    RowBox[{"max", " ", "have", " ", "been", " ", "defined"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sTrim", "[", 
     RowBox[{"input_", ",", "max_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"work", ",", "CC"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "use", " ", "detCList", " ", "to", " ", "determine", " ", "a", " ", 
         "coefficient", " ", "list", " ", "with", " ", "units", " ", 
         "power"}], " ", "<", " ", "max"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"NEW", ":", "  ", 
        RowBox[{"remove", " ", "the", " ", "detCList", " ", "command", " ", 
         RowBox[{"here", " ", "[", 
          RowBox[{"just", " ", "call", " ", "it", " ", "once"}], "]"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"cList", "=", 
         RowBox[{
          RowBox[{"det", "--"}], 
          RowBox[{"CList", "[", 
           RowBox[{"coeffs", ",", "max"}], "]"}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"setZero", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"coeffs", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Rule]", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "coeffs", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<within sTrim, setZero = \>\"", ",", "setZero"}], "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<within sTrim, cList = \>\"", ",", "cList"}], "]"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<the cList = \>\"", ",", "cList"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "define", " ", "\"\<coefficient\>\"", " ", "taken", " ", "from", " ", 
         "myCList"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CC", "[", "x_", "]"}], ":=", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"myCList", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "1", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"myCList", "[", 
              RowBox[{"[", 
               RowBox[{"x", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<CC[1] = \>\"", ",", 
           RowBox[{"CC", "[", "1", "]"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<myCList = \>\"", ",", "myCList"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "myDelta", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"work", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"CC", "[", "i", "]"}], "\[Times]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Coefficient", "[", 
              RowBox[{"input", ",", 
               RowBox[{"CC", "[", "i", "]"}]}], "]"}], "/.", "setZero"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "myCList", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "work", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.721646861578413*^9, 3.721647122937542*^9}, {
   3.721647186059969*^9, 3.7216472040669928`*^9}, {3.7216472516417313`*^9, 
   3.721647366186899*^9}, {3.7216485826710453`*^9, 3.721648583261739*^9}, {
   3.721649350479156*^9, 3.7216493918294353`*^9}, {3.721649452795085*^9, 
   3.721649454939217*^9}, {3.721650026821982*^9, 3.721650028261038*^9}, {
   3.721650204732091*^9, 3.721650367644103*^9}, {3.7216504126346617`*^9, 
   3.7216506589970503`*^9}, {3.7216507124590187`*^9, 3.721650811772908*^9}, {
   3.7216509145362988`*^9, 3.721650916240287*^9}, {3.721651347890688*^9, 
   3.721651396536365*^9}, {3.7216514449656973`*^9, 3.721651521130227*^9}, {
   3.721651570223546*^9, 3.721651620109528*^9}, {3.7216516856813593`*^9, 
   3.721651725735572*^9}, {3.721651802947692*^9, 3.721651804483438*^9}, {
   3.721651935605544*^9, 3.7216520702460737`*^9}, {3.721652123643791*^9, 
   3.721652153089279*^9}, {3.7216521976245832`*^9, 3.7216523451275673`*^9}, {
   3.721652508615893*^9, 3.721652514390979*^9}, {3.721652577828837*^9, 
   3.72165258525949*^9}, {3.721652642873365*^9, 3.72165269068592*^9}, {
   3.72165286523077*^9, 3.721652884276165*^9}, {3.721652996887019*^9, 
   3.721653025005021*^9}, {3.721653113312718*^9, 3.721653139182396*^9}, {
   3.721653197619608*^9, 3.721653221258705*^9}, {3.721653445377419*^9, 
   3.721653547842104*^9}, {3.72165359472047*^9, 3.721653599302874*^9}, {
   3.721653633869792*^9, 3.721653646670844*^9}, {3.72165371277079*^9, 
   3.721653740212371*^9}, {3.721653982843232*^9, 3.7216539847626343`*^9}, {
   3.721654044698041*^9, 3.721654102612323*^9}, 3.721654177961626*^9, {
   3.721654561550646*^9, 3.721654575164209*^9}, {3.721654610660861*^9, 
   3.7216546235058603`*^9}, {3.7216546565629253`*^9, 3.721654696925716*^9}, {
   3.721654743381205*^9, 3.721654769090541*^9}, {3.721655123279132*^9, 
   3.721655123897428*^9}, {3.721655339949319*^9, 3.721655409440703*^9}, {
   3.721655630317445*^9, 3.7216556308853893`*^9}, {3.7216573573189507`*^9, 
   3.721657358942239*^9}, {3.722060512608799*^9, 3.722060513182702*^9}, {
   3.722060629664212*^9, 3.722060632448197*^9}, {3.7220609438318443`*^9, 
   3.722060947615685*^9}, 3.722249735066506*^9, {3.722249778199438*^9, 
   3.722249778614716*^9}, {3.722250209080286*^9, 3.722250212584449*^9}, {
   3.722250418918291*^9, 3.722250425979177*^9}, {3.722268433857778*^9, 
   3.722268510393326*^9}, {3.722268732847348*^9, 3.722268733591189*^9}, {
   3.722268784829177*^9, 3.722268991121221*^9}, {3.722269055613061*^9, 
   3.72226909641136*^9}, {3.722269151304063*^9, 3.722269221508543*^9}, {
   3.722269253595476*^9, 3.7222692550777693`*^9}, 3.722269287785211*^9, {
   3.722269389371937*^9, 3.7222694529848757`*^9}, {3.722269508118339*^9, 
   3.722269509749908*^9}, {3.722269549892626*^9, 3.7222695514679127`*^9}, {
   3.7222696965802603`*^9, 3.722269697348217*^9}, {3.722269739538418*^9, 
   3.722269739953968*^9}, {3.7222699673421803`*^9, 3.722269981399115*^9}, {
   3.722270485795659*^9, 3.7222705245457287`*^9}, 3.722272117989572*^9, {
   3.722272311896781*^9, 3.7222723256216927`*^9}, {3.722273323426779*^9, 
   3.722273328529426*^9}, 3.7222808966773233`*^9, {3.7222809439454064`*^9, 
   3.72228098590948*^9}, {3.722281017671136*^9, 3.7222810395579743`*^9}, {
   3.7222811379941473`*^9, 3.722281166932198*^9}, {3.722281197586252*^9, 
   3.722281199973056*^9}, {3.7222812886552114`*^9, 3.7222813233652725`*^9}, 
   3.7222813613357396`*^9, {3.722281876631735*^9, 3.7222818885969563`*^9}, {
   3.722604511639942*^9, 3.722604553866919*^9}, {3.722604692026877*^9, 
   3.722604740277816*^9}, {3.722868157070367*^9, 3.722868178421338*^9}, {
   3.7228690841579247`*^9, 3.722869177519308*^9}, {3.7229404138863163`*^9, 
   3.722940425353148*^9}, {3.7229406520811653`*^9, 3.722940684176736*^9}, {
   3.7229410874305887`*^9, 3.722941091334589*^9}, {3.722941295920381*^9, 
   3.722941297340198*^9}, 3.7229413312965317`*^9, {3.7229414136302853`*^9, 
   3.7229414836279488`*^9}},
 CellLabel->
  "In[412]:=",ExpressionUUID->"c3c80b85-1444-40c1-85d3-8cda474a03a6"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7229413664389763`*^9, 3.722941366565814*^9}},
 CellLabel->
  "In[413]:=",ExpressionUUID->"552601b9-58eb-4846-9aeb-14077abbe02f"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.722941367380577*^9, 3.722941367509789*^9}},
 CellLabel->
  "In[414]:=",ExpressionUUID->"f5c1929c-d0da-4264-8437-12c8eec89070"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["4.   Magnus-Taylor Expansion",
 FontColor->RGBColor[1, 0, 0]]], "Section",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738404299663188*^9, 3.738404305126616*^9}, {
   3.738404391665751*^9, 3.73840439835355*^9}, {3.738404610726592*^9, 
   3.7384046135186043`*^9}, {3.738406715329616*^9, 3.738406716159206*^9}, {
   3.7384709782115088`*^9, 
   3.7384710371843977`*^9}},ExpressionUUID->"5a05a067-3250-4f19-8143-\
3ad55c80f1e4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721650822968539*^9, 3.721650823435548*^9}},
 CellLabel->
  "In[415]:=",ExpressionUUID->"0ab08077-9da1-419a-b558-8f13b4f6c66b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Get", " ", "\[CapitalOmega]\[CapitalOmega]", 
    RowBox[{"(", 
     RowBox[{"t", ",", "t0"}], ")"}], " ", "may", " ", "output", " ", 
    RowBox[{"(", 
     RowBox[{"depending", " ", "on", " ", 
      RowBox[{"lastTrue", "/", "False"}]}], ")"}], "\[IndentingNewLine]", 
    SubscriptBox["\[CapitalOmega]\[CapitalOmega]", "order"], 
    RowBox[{"(", 
     RowBox[{"t", ",", "t0"}], ")"}], " ", "\[IndentingNewLine]", "or", 
    "\[IndentingNewLine]", 
    SubscriptBox["Omega", "order"], 
    RowBox[{"(", "t0", ")"}], "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{"maximal", " ", 
      RowBox[{
       RowBox[{"coefficient", " ", "~", " ", "1"}], "/", 
       SuperscriptBox["ww", "maxOmega"]}]}], ")"}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"'", 
    RowBox[{"s", "'"}], " ", "stands", " ", 
    RowBox[{"for", " ", "'"}], 
    RowBox[{
     RowBox[{"smart", "'"}], " ", "--"}], " ", "here", " ", "we", " ", "use", 
    " ", "sTrim"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sGetOO", "[", 
     RowBox[{"order_", ",", "maxOmega_", ",", "lastTF_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cList", ",", "fn", ",", "Omega", ",", "OO"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"I", "'"}], "m", " ", "assuming", " ", "that", " ", 
        "maxOmega", " ", "is", " ", "the", " ", "maximal", " ", 
        RowBox[{"1", "/", "ww"}], " ", "in", " ", 
        RowBox[{"Omega", "[", 
         RowBox[{"t", ",", "t0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"and", " ", "not", " ", "the", " ", "maximal", " ", 
          RowBox[{"1", "/", "ww"}], " ", "in", " ", "the", " ", 
          "Hamiltonian"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\\n Begin calculating \!\(\*SubscriptBox[\(\[CapitalOmega]\
\[CapitalOmega]\), \(k\)]\)[t,t0] (or Omega[t0]) of Magnus Expansion order k \
= \>\"", ",", " ", "order", ",", " ", "\"\<, at date and time \>\"", ",", " ", 
         RowBox[{
          RowBox[{"Date", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fn", "[", "t_", "]"}], "=", 
        RowBox[{
         RowBox[{"fxn", "[", 
          RowBox[{"t", ",", "order"}], "]"}], "//.", "SigmaComRules"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<SigmaComRules Done:  \>\"", ",", " ", 
         RowBox[{
          RowBox[{"Date", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"4", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tempo", "=", 
        RowBox[{"sTrim", "[", 
         RowBox[{
          RowBox[{"fn", "[", "t", "]"}], ",", 
          RowBox[{"maxOmega", "+", "1"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fn", "[", "t_", "]"}], "=", "tempo"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Trimming Done:  \>\"", ",", " ", 
         RowBox[{
          RowBox[{"Date", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"3", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"fn", "[", "t_", "]"}], "=", 
          RowBox[{
           RowBox[{"fn", "[", "t", "]"}], "//", "S"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fn", "[", "t_", "]"}], "=", 
        RowBox[{
         RowBox[{"fn", "[", "t", "]"}], "//", "TrigReduce"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fn", "[", "t_", "]"}], "=", 
        RowBox[{
         RowBox[{"fn", "[", "t", "]"}], "//", "Expand"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Simplify (formerly:  FS) of fn finished:  \>\"", ",", " ", 
         RowBox[{
          RowBox[{"Date", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"3", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<fn[t]//Length = \>\"", ",", 
         RowBox[{
          RowBox[{"fn", "[", "t", "]"}], "//", "Length"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\\n \\n fn[t] = \>\"", ",", 
           RowBox[{"fn", "[", "t", "]"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"lastTF", "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Calculate", " ", "the", " ", "actual", " ", "Magnus", " ", "Term", 
           " ", "for", " ", "a", " ", "period", " ", "tc"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Omega", "[", "t0_", "]"}], "=", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"fn", "[", "tt", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"tt", ",", "t0", ",", 
               RowBox[{"t0", "+", "tc"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Integration from `t0' to `t0 + tc' done:  \>\"", ",", " ", 
            RowBox[{
             RowBox[{"Date", "[", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"4", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"Omega", "[", "t0_", "]"}], "=", 
             RowBox[{
              RowBox[{"Grim", "[", 
               RowBox[{
                RowBox[{"Omega", "[", "t0", "]"}], ",", 
                FractionBox["1", "ww"], ",", "tc", ",", "t0", ",", 
                RowBox[{"maxOmega", "+", "1"}]}], "]"}], "//", "S"}]}], ";"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Omega", "[", "t0_", "]"}], "=", 
           RowBox[{
            RowBox[{"Omega", "[", "t0", "]"}], "//", "Expand"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Done.  Returning Omega[t0] @ \>\"", ",", 
            RowBox[{
             RowBox[{"Date", "[", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"3", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"Omega", "[", "t0", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Otherwise", " ", "Calculate", " ", "the", " ", 
           "\"\<intermediate Magnus Term\>\"", " ", "from", " ", "time", " ", 
           "t0", " ", "to", " ", "t"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"OO", "[", 
            RowBox[{"t_", ",", "t0_"}], "]"}], "=", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"fn", "[", "tt", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"tt", ",", "t0", ",", "t"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Integration from `t0' to `t' done:  \>\"", ",", " ", 
            RowBox[{
             RowBox[{"Date", "[", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"tempo", "=", 
             RowBox[{
              RowBox[{"Grim", "[", 
               RowBox[{
                RowBox[{"OO", "[", 
                 RowBox[{"t", ",", "t0"}], "]"}], ",", 
                FractionBox["1", "ww"], ",", "t", ",", "t0", ",", 
                RowBox[{"maxOmega", "+", "1"}]}], "]"}], "//", "S"}]}], ";"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<(2) After applying Grim, tempo = \>\"", ",", "tempo"}], 
             "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"OO", "[", 
              RowBox[{"t_", ",", "t0_"}], "]"}], "=", "tempo"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"OO", "[", 
            RowBox[{"t_", ",", "t0_"}], "]"}], "=", 
           RowBox[{
            RowBox[{"OO", "[", 
             RowBox[{"t", ",", "t0"}], "]"}], "//", "Expand"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Done.  Returning \[CapitalOmega]\[CapitalOmega][t,t0] @ \>\"",
             ",", 
            RowBox[{
             RowBox[{"Date", "[", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"OO", "[", 
            RowBox[{"t", ",", "t0"}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<Error in GetOO:  Not returning a value.\>\"", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7140260426925383`*^9, 3.714026049543007*^9}, {
   3.7140264904393272`*^9, 3.7140264975107813`*^9}, {3.714027456679131*^9, 
   3.714027475733078*^9}, {3.714027589984705*^9, 3.714027615942354*^9}, {
   3.714027840155286*^9, 3.714027933791109*^9}, {3.714028032912889*^9, 
   3.7140280699516068`*^9}, {3.7140281420761023`*^9, 3.714028188409039*^9}, {
   3.7140282513105907`*^9, 3.714028261277321*^9}, {3.714028292532201*^9, 
   3.714028308770823*^9}, {3.714028623588571*^9, 3.714029151688439*^9}, {
   3.714029204726091*^9, 3.714029214453555*^9}, {3.714029263348009*^9, 
   3.71402928895323*^9}, {3.714029322912924*^9, 3.714029323856091*^9}, {
   3.714029384852892*^9, 3.714029508144293*^9}, {3.714029544685296*^9, 
   3.71402965435994*^9}, {3.7140298415663033`*^9, 3.7140298946337013`*^9}, 
   3.714031845928854*^9, 3.714032096573615*^9, {3.714032157216181*^9, 
   3.714032169679215*^9}, {3.714032406364376*^9, 3.714032450825303*^9}, {
   3.714032481687807*^9, 3.7140325233977127`*^9}, {3.714032569661084*^9, 
   3.714032577536427*^9}, {3.714032709475704*^9, 3.714032712987866*^9}, {
   3.7140327432125874`*^9, 3.7140327432412977`*^9}, {3.714033500605049*^9, 
   3.714033502500091*^9}, {3.714033693558601*^9, 3.714033698294201*^9}, {
   3.7140369647728558`*^9, 3.7140369839179983`*^9}, {3.714037476309639*^9, 
   3.714037532553767*^9}, {3.714037569641075*^9, 3.714037649124505*^9}, 
   3.714037760598216*^9, {3.714037888168128*^9, 3.714037903752211*^9}, {
   3.714038208503997*^9, 3.714038224030754*^9}, {3.714038376727951*^9, 
   3.7140384034423437`*^9}, {3.7140395592126017`*^9, 3.714039566611388*^9}, 
   3.714040043296257*^9, 3.7140401990146093`*^9, {3.714110345829932*^9, 
   3.7141103641643467`*^9}, {3.714120039299493*^9, 3.714120104192177*^9}, {
   3.714120790766384*^9, 3.714120835009925*^9}, 3.7141211799986153`*^9, {
   3.714121220197948*^9, 3.714121275459208*^9}, 3.7141242053874807`*^9, 
   3.7156156895490484`*^9, {3.715667526010626*^9, 3.715667681164093*^9}, {
   3.7156677743754807`*^9, 3.7156678058632*^9}, {3.715667850612784*^9, 
   3.715667890609943*^9}, {3.715668034610754*^9, 3.715668047650387*^9}, {
   3.715668503797359*^9, 3.715668511227899*^9}, {3.716100614384966*^9, 
   3.716100629592639*^9}, {3.7161007313021708`*^9, 3.716100741172083*^9}, {
   3.716101290030175*^9, 3.716101304108267*^9}, {3.716101418646975*^9, 
   3.7161014571883593`*^9}, {3.716101521112522*^9, 3.716101526785357*^9}, {
   3.7161056272550077`*^9, 3.7161056298235826`*^9}, {3.716105733913231*^9, 
   3.71610578780648*^9}, {3.716105907185014*^9, 3.716105934712315*^9}, 
   3.716106047777412*^9, {3.716106215664777*^9, 3.7161062164963617`*^9}, {
   3.716106267589604*^9, 3.716106279230775*^9}, {3.716106934588006*^9, 
   3.7161069613157167`*^9}, {3.716109272418009*^9, 3.7161092735036707`*^9}, {
   3.716109319278286*^9, 3.716109319740603*^9}, {3.7161094050968323`*^9, 
   3.716109422744524*^9}, 3.716112803650763*^9, {3.716125552788731*^9, 
   3.716125552925077*^9}, {3.716125724412046*^9, 3.7161257304037046`*^9}, {
   3.7161257771308517`*^9, 3.716125778217497*^9}, {3.716125837185573*^9, 
   3.716125846327836*^9}, {3.717130417829729*^9, 3.717130420024781*^9}, {
   3.717130457039091*^9, 3.717130476126556*^9}, {3.7216464850500402`*^9, 
   3.7216465404298897`*^9}, {3.721655444760976*^9, 3.721655495204322*^9}, {
   3.7216563090442867`*^9, 3.721656309410828*^9}, {3.721657098578437*^9, 
   3.721657116394072*^9}, {3.722062422252212*^9, 3.722062445938748*^9}, {
   3.72206277371446*^9, 3.722062773793195*^9}, {3.722062806368455*^9, 
   3.722062806455557*^9}, {3.722063935036903*^9, 3.722063987120311*^9}, 
   3.722076607414689*^9, 3.7220766696368017`*^9, {3.722076835396352*^9, 
   3.72207684025014*^9}, 3.722077815123934*^9, 3.722077941749178*^9, 
   3.7220780244016237`*^9, {3.7220923642351723`*^9, 3.722092367969694*^9}, {
   3.7222819144618015`*^9, 3.722282014785578*^9}, {3.722282072100078*^9, 
   3.722282082115296*^9}, {3.7222821139549513`*^9, 3.7222822172271333`*^9}, {
   3.722338643854249*^9, 3.72233868182863*^9}, {3.722339531150635*^9, 
   3.722339541869759*^9}, {3.7223396319883823`*^9, 3.722339634092937*^9}, 
   3.722339682939569*^9, 3.722339724266879*^9, 3.722584516121903*^9, {
   3.722596719616889*^9, 3.722596762380941*^9}, {3.722597287919258*^9, 
   3.7225973312361727`*^9}, {3.7225973621314707`*^9, 3.72259736288246*^9}, {
   3.722604453752264*^9, 3.722604482922195*^9}, {3.722863543461102*^9, 
   3.72286357516374*^9}, {3.7228637385642548`*^9, 3.7228637532596693`*^9}, 
   3.722863821681571*^9, {3.7228638607243147`*^9, 3.722863862417911*^9}, 
   3.7228639783709373`*^9, {3.722864421500538*^9, 3.7228644231921473`*^9}, 
   3.722866102991184*^9, {3.7228670813682547`*^9, 3.722867082928289*^9}, 
   3.722867425755155*^9, {3.7229402293702097`*^9, 3.7229403160524893`*^9}, {
   3.722941608104253*^9, 3.722941627000263*^9}, {3.723396647013157*^9, 
   3.7233967360893135`*^9}, {3.723975940094746*^9, 3.723975995266087*^9}, {
   3.723977471150168*^9, 3.723977474293599*^9}, {3.723981400704432*^9, 
   3.723981443539872*^9}, 3.7239826953637447`*^9, {3.7239831761782513`*^9, 
   3.723983179114408*^9}, {3.7239838020122957`*^9, 3.723983833087895*^9}, {
   3.723983869983033*^9, 3.7239838922851553`*^9}, 3.723984139315653*^9, {
   3.723984651646055*^9, 3.723984656773494*^9}, 3.7239847249287024`*^9},
 CellLabel->
  "In[416]:=",ExpressionUUID->"a03b9462-03f4-4072-95c9-0854b4873965"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.722582105462973*^9},
 CellLabel->
  "In[417]:=",ExpressionUUID->"0ef0325a-b40a-402c-87cf-6c561d2e1904"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.722582546982239*^9},
 CellLabel->
  "In[418]:=",ExpressionUUID->"8c75b6d2-ab44-4cba-bcc0-41d81a7bc689"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"INPUT", ":", "  ", 
     RowBox[{"coefficient", "-", 
      RowBox[{
       RowBox[{"list", " ", "[", 
        RowBox[{
         RowBox[{"e", ".", "g", "."}], ",", " ", "myCList"}], "]"}], " ", 
       "with", " ", "possibly", " ", "redundant", " ", "entries"}]}]}], ",", 
    " ", 
    RowBox[{
     RowBox[{"namely", " ", 
      RowBox[{"Delta", "^", "ii"}], " ", "with", " ", "ii"}], " ", ">", " ", 
     RowBox[{"1", "\[IndentingNewLine]", 
      RowBox[{"OUTPUT", ":", "  ", 
       RowBox[{"coefficient", "-", 
        RowBox[{
        "list", " ", "without", " ", "those", " ", "redundant", " ", 
         "entries"}]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RemoveOmegas", "[", "coeffList_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "localList", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"localList", "=", "coeffList"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<input = \>\"", ",", "coeffList"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "loop", " ", "through", " ", "coefficient", " ", "list", " ", "and", 
         " ", "remove", " ", "items", " ", "that", " ", "we", " ", 
         RowBox[{"don", "'"}], "t", " ", "need"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ii", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"ii", "\[LessEqual]", 
          RowBox[{"Length", "[", "localList", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"item", "=", 
           RowBox[{
            RowBox[{"localList", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"1", ";;", 
               RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"power", "=", 
           RowBox[{
            RowBox[{"localList", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<{ii, current item} = \>\"", ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "item"}], "}"}]}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"remove", " ", 
             RowBox[{"Delta", "^", "ii"}], " ", "for", " ", "all", " ", 
             "ii"}], " ", ">", " ", "1."}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Assuming", "[", 
              RowBox[{
               RowBox[{"Delta", ">", "0"}], ",", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["item", 
                  RowBox[{"1", "/", "power"}]], "\[Equal]", "Delta"}], "//", 
                "S"}]}], "]"}], " ", "\[And]", " ", 
             RowBox[{"ii", ">", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"condition", " ", 
              RowBox[{"fulfilled", ":", "  ", 
               RowBox[{"remove", " ", "item"}]}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<Equal.\>\"", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<Removing the above item.\>\"", "]"}],
               ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"localList", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"localList", ",", "ii"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"condition", " ", "not", " ", 
              RowBox[{"fulfilled", ":", "  ", 
               RowBox[{"increase", " ", "index"}]}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Not equal, \!\(\*SuperscriptBox[\(item\), \(1/power\)]\) \
= \>\"", ",", 
                SuperscriptBox["item", 
                 RowBox[{"1", "/", "power"}]]}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"ii", "+=", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Not even unequal, \!\(\*SuperscriptBox[\(item\), \
\(1/power\)]\) = \>\"", ",", 
                SuperscriptBox["item", 
                 RowBox[{"1", "/", "power"}]]}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"ii", "+=", "1"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "localList", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.734762106518169*^9, 3.734762145264153*^9}, 
   3.734762182102174*^9, {3.734762220579845*^9, 3.734762373939909*^9}, {
   3.73476242131395*^9, 3.73476259152837*^9}, {3.7347631049966183`*^9, 
   3.734763113708119*^9}, {3.7347845787025146`*^9, 3.734784591032591*^9}, {
   3.734784630011901*^9, 3.7347847154803534`*^9}, {3.7347852659215727`*^9, 
   3.734785266633586*^9}, {3.73478575502063*^9, 3.734785761567772*^9}, 
   3.7347895641951513`*^9},
 CellLabel->
  "In[419]:=",ExpressionUUID->"6b2cdccb-01f9-40fe-a1aa-0b94bef36e84"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.734763040525806*^9, 3.7347630413349123`*^9}},
 CellLabel->
  "In[420]:=",ExpressionUUID->"279b837e-6846-456b-a285-1f74b82768b2"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.739077632372476*^9, 3.7390776326308823`*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"36501855-014d-4d63-b90c-a0aebb111870"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["5.   TeXForm Help Functions",
 FontColor->RGBColor[1, 0, 0]]], "Section",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738404299663188*^9, 3.738404305126616*^9}, {
   3.738404391665751*^9, 3.73840439835355*^9}, {3.73840462391805*^9, 
   3.738404626237836*^9}, {3.73840468375496*^9, 3.738404686354837*^9}, {
   3.738406725632657*^9, 3.738406727782609*^9}, {3.73907751065405*^9, 
   3.739077517316731*^9}},ExpressionUUID->"3643d674-51d7-4537-9e8b-\
01de15390abd"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"E", " ", "=", " ", 
    RowBox[{"Enhanced", ":", "  ", 
     RowBox[{
     "add", " ", "another", " ", "entry", " ", "to", " ", "coeffs", 
      "\[IndentingNewLine]", "only", " ", "works", " ", "for", " ", "single", 
      " ", "drive"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"important", " ", "for", " ", "sorting", " ", "coefficients"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"setCListE", "[", 
     RowBox[{"max_", ",", "offR_", ",", "taylor_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coeffs", ",", 
        RowBox[{"base", "=", "10"}], ",", "dds", ",", "termSt", ",", 
        "priority"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coeffs1", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"H1", ",", "1", ",", "0"}], "}"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coeffs", "=", "coeffs1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "first", " ", "loop", " ", "through", " ", "number", " ", "of", " ", 
         "derivatives"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"taylor", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<taylor = True\>\"", "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "=", "1"}], ";", 
             RowBox[{"coeffs", "=", "coeffs1"}], ";", 
             RowBox[{"dds", "=", "\"\<\>\""}]}], ",", 
            RowBox[{"i", "\[LessEqual]", "max"}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"priority", "=", 
              SuperscriptBox["base", 
               RowBox[{"i", "-", "1"}]]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dds", "=", 
              RowBox[{"dds", "<>", "\"\<D\>\""}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "loop", " ", "through", " ", "coefficients", " ", "to", " ", 
               "add", " ", "derivative", " ", "terms"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "\[LessEqual]", 
                RowBox[{"Length", "[", "coeffs1", "]"}]}], ",", 
               RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"termSt", "=", 
                 RowBox[{
                  RowBox[{"ToString", "[", 
                   RowBox[{"coeffs", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "<>", 
                  "dds"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"coeffs", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"coeffs", ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToExpression", "@", "termSt"}], ",", 
                    RowBox[{"i", "+", "1"}], ",", "priority"}], "}"}], 
                    "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"offR", "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"coeffs", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"Delta", ",", "1", ",", 
               SuperscriptBox["base", 
                RowBox[{"-", "1"}]]}], "}"}], "}"}], ",", "coeffs"}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "coeffs", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.722582239596987*^9, 3.722582462165538*^9}, {
   3.722582573238707*^9, 3.722582663994506*^9}, {3.7225836565365133`*^9, 
   3.722583667241906*^9}, {3.722870090330449*^9, 3.722870094786159*^9}, 
   3.734763471823992*^9, {3.7347641229082613`*^9, 3.734764132163863*^9}, {
   3.734764708868565*^9, 3.734764728811575*^9}, {3.7347648066969852`*^9, 
   3.734764890899081*^9}, {3.7347726670291023`*^9, 3.734772727342752*^9}, {
   3.734772823025834*^9, 3.7347728594956007`*^9}, {3.734772892062969*^9, 
   3.734772955682749*^9}, {3.734777194370364*^9, 3.734777198719131*^9}, {
   3.73477728099502*^9, 3.734777305076479*^9}, {3.734777413074922*^9, 
   3.734777467753745*^9}, {3.734778032977401*^9, 3.734778037760027*^9}, {
   3.734778238756527*^9, 3.734778266789733*^9}, {3.73477830588624*^9, 
   3.7347783119605*^9}, {3.7347784071809683`*^9, 3.734778409995585*^9}, {
   3.734778530725768*^9, 3.7347785808457413`*^9}, {3.734778660358038*^9, 
   3.734778670845336*^9}, {3.734778702410906*^9, 3.734778766863744*^9}, {
   3.734779767272271*^9, 3.7347797758717737`*^9}, {3.734779820342043*^9, 
   3.734779870946596*^9}, {3.7347799809570723`*^9, 3.7347799817805*^9}, {
   3.7347800254910917`*^9, 3.7347800449128647`*^9}, {3.73478011346987*^9, 
   3.734780123317299*^9}, {3.734780168210569*^9, 3.734780210927779*^9}, {
   3.73478026495713*^9, 3.7347802687417517`*^9}, {3.734780305738791*^9, 
   3.734780439260119*^9}, {3.739077452724195*^9, 3.739077491856119*^9}, {
   3.7390788027331467`*^9, 3.7390788636408443`*^9}, {3.739078978285262*^9, 
   3.739078987738439*^9}, {3.739079031856853*^9, 3.739079042055748*^9}, {
   3.7390791066848307`*^9, 3.739079124155648*^9}, 3.739079279810946*^9},
 CellLabel->
  "In[422]:=",ExpressionUUID->"381307db-54a9-4268-a042-876944a0a9c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"setCListE", "[", 
  RowBox[{"3", ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.73478028080932*^9, 3.734780286898717*^9}},
 CellLabel->
  "In[423]:=",ExpressionUUID->"bac7041d-54dd-451f-81b0-ed2d6d710720"],

Cell[BoxData[
 RowBox[{"setCListE", "[", 
  RowBox[{"3", ",", "True"}], "]"}]], "Output",
 CellChangeTimes->{
  3.734780287169835*^9, 3.7347805926056643`*^9, 3.734780691428451*^9, 
   3.7347808572307377`*^9, 3.734791954329658*^9, 3.734836464597157*^9, 
   3.7349238553084507`*^9, 3.734924255135319*^9, 3.7349371875620117`*^9, 
   3.7349372369208345`*^9, 3.73511900383704*^9, 3.735134055025919*^9, 
   3.739028854339409*^9, 3.7390318090744095`*^9, 3.739036852509878*^9, 
   3.739077110515133*^9, 3.739079190054834*^9, 3.7390832747194977`*^9, 
   3.73919497865199*^9, 3.739195420830235*^9, 3.76474950407277*^9, 
   3.765877189012588*^9, {3.765877266391151*^9, 3.765877270676004*^9}, 
   3.765879823073967*^9, 3.765879902962966*^9, 3.809339727990922*^9, {
   3.809339865624107*^9, 3.809339890189356*^9}, 3.8097763855751677`*^9, 
   3.8097765266045513`*^9, 3.809776839815337*^9, {3.8097768728314342`*^9, 
   3.8097768779071493`*^9}, 3.8097769839844103`*^9},
 CellLabel->
  "Out[423]=",ExpressionUUID->"2eeaec6a-3958-4608-b296-c41870126e60"]
}, Open  ]],

Cell[BoxData["  "], "Input",
 CellChangeTimes->{{3.734780656059578*^9, 3.734780678197633*^9}},
 CellLabel->
  "In[424]:=",ExpressionUUID->"d292c81b-69f8-4d35-8b57-fab0a69681f1"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.734780279890629*^9},
 CellLabel->
  "In[425]:=",ExpressionUUID->"fd16a933-841a-43af-b81b-6d4f9cdf95c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"based", " ", "on", " ", "coeffs"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c1", ",", "dim1", ",", "p1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"c2", ",", "dim2", ",", "p2"}], "}"}], ",", " ", ".."}], 
       "}"}], " ", "[", 
      RowBox[{
       RowBox[{"obtained", " ", "from", " ", "setCList"}], ",", " ", 
       RowBox[{"ideally", ";", " ", "p1"}], ",", " ", 
       RowBox[{"p2", " ", 
        RowBox[{"etc", ".", " ", "are"}], " ", "priorities"}]}], "]"}]}], ",",
     " ", 
    RowBox[{"find", " ", "a", " ", "list", " ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          SuperscriptBox["c1A", "p1"], "}"}], ",", " ", "dimTotA", ",", 
         "pA"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["c1B", "p1"], ",", " ", 
           SuperscriptBox["c2B", "p2"]}], "}"}], ",", " ", "dimTotB", ",", 
         "pB"}], "}"}], ",", " ", ".."}], "}"}], "\[IndentingNewLine]", "or", 
     " ", "something", " ", "like", " ", "that"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"E", " ", "=", " ", "Enhanced"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"detCListE", "[", 
     RowBox[{"coeffs_", ",", "max_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "work", ",", "item", ",", "i", ",", "exp", ",", "rep", ",", "cBigList",
         ",", "cList", ",", "coefficient"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"work", "=", "coeffs"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"here", ":", "  ", 
          RowBox[{"extend", " ", "coeffs", " ", 
           RowBox[{"(", "\"\<work\>\"", ")"}], " ", "to", " ", "include", " ",
            "higher", " ", "orders", " ", "of", " ", "H1"}]}], ",", " ", 
         "H1D", ",", " ", "..", ",", " ", "Hn", ",", " ", ".."}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", 
          RowBox[{"Length", "[", "coeffs", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"item", "=", 
           RowBox[{"coeffs", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "<", "2"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<outer loop, i = \>\"", ",", "i"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<item = \>\"", ",", "item"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"exp", "=", "2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "up", " ", "to", " ", "dimension", " ", "\"\<exp\>\"", " ", "so", 
             " ", "that", " ", 
             SuperscriptBox["Hn", "exp"], " ", "so", " ", "that", " ", 
             "total", " ", "dimension", " ", 
             RowBox[{"dim", "[", "Hn", "]"}], "*", "exp"}], " ", 
            "\[LessEqual]", " ", "max"}], "  ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"exp", "*", 
              RowBox[{"item", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "<=", "max"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"work", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"work", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"item", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "exp"], ",", 
                   RowBox[{"exp", "*", 
                    RowBox[{"item", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                   RowBox[{"exp", "*", 
                    RowBox[{"item", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"exp", "+=", "1"}], ";"}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"exp", ">", "10"}], ",", "Break"}], "]"}], "*)"}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", ">", "20"}], ",", "Break"}], "]"}], "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"now", " ", "create", " ", "all", " ", "combinations"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cBigList", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{"work", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "max"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<After Subsets: CBigList = \>\"", ",", "cBigList"}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Table", ":", " ", 
         RowBox[{"elements", " ", "of", " ", "coeffs"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"cBigList", "=", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cBigList", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", 
               RowBox[{"1", ";;", 
                RowBox[{"Length", "[", 
                 RowBox[{"cBigList", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", "1"}], "]"}], 
             "]"}], " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"j", "-", 
               RowBox[{"th", " ", "item"}]}], ",", " ", "all", " ", ",", " ", 
              "1"}], "*)"}], ",", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"cBigList", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"cBigList", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"cBigList", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k", ",", "3"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"cBigList", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "cBigList", "]"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Now", " ", "remove", " ", "all", " ", "those", " ", "entries", " ", 
         "whose", " ", "dimension", " ", "is", " ", "too", " ", "large"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cBigList", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"cBigList", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "<=", "max"}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Now", " ", "remove", " ", "all", " ", "\"\<double entries\>\"", " ", 
         "such", " ", "as", " ", 
         RowBox[{"{", 
          RowBox[{"H1", ",", 
           SuperscriptBox["H1", "2"], ",", "3"}], "}"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rep", "=", 
        RowBox[{
         RowBox[{"x_", "^", "y_"}], "\[RuleDelayed]", "x"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Before, cBigList = \>\"", ",", "cBigList"}], "]"}], 
         ";"}], "*)"}], 
       RowBox[{"cBigList", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"cBigList", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"#1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/.", "rep"}], "]"}], "]"}]}],
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Afterwards, cBigList = \>\"", ",", "cBigList"}], "]"}],
          ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<After combining subsets: CBigList = \>\"", ",", "cBigList"}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"cBigList", "=", 
        RowBox[{"RemoveOmegas", "[", "cBigList", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cBigList", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"cBigList", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "&"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "cBigList", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.722265649333127*^9, 3.7222656660438023`*^9}, {
   3.72226571918497*^9, 3.722265787237772*^9}, {3.722265829467671*^9, 
   3.722265881809205*^9}, {3.722265913391123*^9, 3.722265993874937*^9}, {
   3.722266130659968*^9, 3.722266182146254*^9}, {3.722266245022108*^9, 
   3.722266292203671*^9}, {3.722266331441856*^9, 3.722266347721066*^9}, {
   3.7222664354846992`*^9, 3.722266557134239*^9}, {3.7222666103494177`*^9, 
   3.722266637265815*^9}, {3.722266751941916*^9, 3.7222667770190773`*^9}, {
   3.722266828304941*^9, 3.722267019694347*^9}, {3.722267083947215*^9, 
   3.722267193237677*^9}, {3.722267228995532*^9, 3.7222672471066236`*^9}, {
   3.722267569426394*^9, 3.7222676390544*^9}, {3.722267690044179*^9, 
   3.722267692084495*^9}, {3.7222677280819483`*^9, 3.722267774391572*^9}, {
   3.722267826418831*^9, 3.72226783990849*^9}, {3.722267991940419*^9, 
   3.722268239840456*^9}, {3.722268301940954*^9, 3.722268308708186*^9}, {
   3.7222683480589247`*^9, 3.722268357026557*^9}, {3.7222702365688467`*^9, 
   3.722270241280201*^9}, {3.7222703752818403`*^9, 3.7222704125436773`*^9}, {
   3.72227053594503*^9, 3.722270637572221*^9}, {3.722270669354926*^9, 
   3.722270782468568*^9}, {3.722271017105094*^9, 3.722271190424255*^9}, {
   3.72227122467875*^9, 3.722271230269107*^9}, {3.722271278354701*^9, 
   3.722271365295229*^9}, {3.7222714238442698`*^9, 3.722271488336911*^9}, {
   3.722271548629878*^9, 3.722271568868731*^9}, {3.7222716081230717`*^9, 
   3.7222717074298964`*^9}, 3.722271918129998*^9, {3.722272026557276*^9, 
   3.722272027741239*^9}, 3.72227214883521*^9, {3.722323444892396*^9, 
   3.7223234933390913`*^9}, {3.722323534866523*^9, 3.722323625983028*^9}, {
   3.722323677838883*^9, 3.7223236845739403`*^9}, {3.72232372196519*^9, 
   3.722323768555046*^9}, {3.722323858641345*^9, 3.7223238762010937`*^9}, {
   3.722323960022725*^9, 3.722324008421112*^9}, {3.7223242881189413`*^9, 
   3.722324316580667*^9}, {3.722325144454933*^9, 3.722325150045713*^9}, {
   3.722325183914885*^9, 3.722325323916162*^9}, {3.722325476701263*^9, 
   3.72232550445122*^9}, {3.722325542129327*^9, 3.7223255441333942`*^9}, {
   3.72232576414926*^9, 3.722325775140049*^9}, {3.722326359964814*^9, 
   3.722326421187125*^9}, {3.722329575852964*^9, 3.722329580864532*^9}, {
   3.722329613284609*^9, 3.722329691706996*^9}, 3.722329732273837*^9, {
   3.722329843658019*^9, 3.7223298444233103`*^9}, 3.722337793393621*^9, 
   3.722605138245414*^9, {3.722870859017942*^9, 3.722870873160345*^9}, {
   3.7228709765654697`*^9, 3.722870992537624*^9}, {3.722871045975439*^9, 
   3.7228712400683413`*^9}, {3.722871367677937*^9, 3.722871400923794*^9}, {
   3.722872176652277*^9, 3.722872182361086*^9}, {3.722872628153451*^9, 
   3.7228726369316072`*^9}, 3.7228727266125174`*^9, {3.7228727997441072`*^9, 
   3.722872802752112*^9}, {3.722872875837571*^9, 3.7228728858911657`*^9}, {
   3.7228730071473722`*^9, 3.7228730613621798`*^9}, 3.722877665628639*^9, {
   3.7229382138571167`*^9, 3.722938251948758*^9}, {3.72293838890589*^9, 
   3.7229384056473513`*^9}, {3.722938814316485*^9, 3.7229388207255707`*^9}, {
   3.722939082085661*^9, 3.7229391039087*^9}, {3.722939686758284*^9, 
   3.722939687629053*^9}, {3.722939730764876*^9, 3.722939731923811*^9}, {
   3.722939782186533*^9, 3.722939791474189*^9}, {3.722940444497147*^9, 
   3.722940480782804*^9}, {3.722940511104767*^9, 3.722940514548882*^9}, {
   3.7229408825659*^9, 3.7229408999086018`*^9}, {3.734764136556417*^9, 
   3.734764136876951*^9}, {3.734764391039507*^9, 3.734764400422989*^9}, 
   3.7347807183660088`*^9, {3.734781107312995*^9, 3.734781113992406*^9}, {
   3.734783002307247*^9, 3.734783006394182*^9}, {3.734783285180711*^9, 
   3.7347832991382723`*^9}, {3.734783438156068*^9, 3.7347834582340393`*^9}, 
   3.734783594387368*^9, 3.734783704733679*^9, 3.734783880845042*^9, {
   3.7347858311485662`*^9, 3.7347858706900177`*^9}, 3.734786078334852*^9, {
   3.734786259663746*^9, 3.734786280516152*^9}, 3.734786775484383*^9, {
   3.734786817142939*^9, 3.734786844302967*^9}, {3.734786888899474*^9, 
   3.734786919636025*^9}, 3.7347870141717863`*^9, {3.734788762473529*^9, 
   3.7347887849120903`*^9}, {3.734788817903544*^9, 3.7347888252693233`*^9}},
 CellLabel->
  "In[426]:=",ExpressionUUID->"bab25a44-ed74-4c80-b4bf-8ae132d9b291"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7347787926766167`*^9, 3.734778794253027*^9}},
 CellLabel->
  "In[427]:=",ExpressionUUID->"b96564a1-8295-432d-9117-66a4bb41ab5a"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.734778793139464*^9},
 CellLabel->
  "In[428]:=",ExpressionUUID->"20f0842c-bf85-448f-b13b-cbc3916aa231"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.734870298420004*^9, 3.734870298529879*^9}},
 CellLabel->
  "In[429]:=",ExpressionUUID->"f3274f2d-54ce-493a-824f-1c2928297be3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", " ", 
   RowBox[{
   "sort", " ", "complicated", " ", "terms", " ", "to", " ", "put", " ", "sx",
     " ", "and", " ", "sy", " ", "and", " ", "sz", " ", "towards", " ", "the",
     " ", "end", " ", "of", " ", "the", " ", "string"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "redo", " ", "this", " ", "procedure", " ", "because", " ", "we", " ", 
    "want", " ", "to", " ", "try", " ", "square", " ", "brackets", " ", 
    "rather", " ", "than", " ", "round", " ", "brackets"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OLDandWORKINGcomplicatedTerms", "[", "input_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"idle", "=", "\"\<no\>\""}], ",", 
        RowBox[{"teXOut", "=", "\"\<(\>\""}], ",", "coeffX", ",", "coeffY", 
        ",", "coeffZ", ",", 
        RowBox[{"count", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "pick", " ", "sx", " ", "and", " ", "sy", " ", "coefficients", " ", 
        "to", " ", "put", " ", "the", " ", "sigma_x", " ", "and", " ", 
        "sigma_y", " ", "operators", " ", "towards", " ", "the", " ", "end", 
        " ", "of", " ", "the", " ", "sum"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<input = \>\"", ",", "input"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"coeffX", ",", "coeffY"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{"input", ",", "sx"}], "]"}], ",", 
          RowBox[{"Coefficient", "[", 
           RowBox[{"input", ",", "sy"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "just", " ", "in", " ", "case", " ", "there", " ", "are", " ", "no", 
          " ", "sx", " ", "or", " ", "sy", " ", "terms"}], " ", ".."}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"coeffZ", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"input", "-", 
           RowBox[{"coeffX", "*", "sx"}], "-", 
           RowBox[{"coeffY", "*", "sy"}]}], "//", "TrigToExp"}], "//", 
         "ExpToTrig"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<For some reason, coeffZ = \>\"", ",", "coeffZ"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<{coeffX, coeffY, coeffZ} = \>\"", ",", 
           RowBox[{"{", 
            RowBox[{"coeffX", ",", " ", "coeffY", ",", " ", "coeffZ"}], 
            "}"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "sx", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"coeffX", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"idle", "=", "\"\<yes\>\""}]}], "\[IndentingNewLine]", "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"idle", "\[Equal]", "\"\<no\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"count", "+=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Here\>\"", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Doing sx\>\"", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"Head", "[", "coeffX", "]"}]}], "\[Equal]", 
             "\"\<Plus\>\""}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "we", " ", "have", " ", "a", " ", "sum", " ", "of", " ", "sx", 
              " ", "terms"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"coeffX", "=", 
             RowBox[{"\"\<(\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"TeXForm", "[", 
                RowBox[{"coeffX", "/.", "repAll"}], "]"}], "]"}], "<>", 
              "\"\<)\\\\sigma_x\>\""}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"else", " ", "we", " ", 
              RowBox[{"don", "'"}], "t", " ", "have", " ", "a", " ", "sum"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<Doing something\>\"", "]"}], ";"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"coeffX", "=", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"TeXForm", "[", 
                RowBox[{"coeffX", "/.", "repAll"}], "]"}], "]"}], "<>", 
              "\"\<\\\\sigma_x\>\""}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Doing nothing\>\"", "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"teXOut", "=", 
           RowBox[{"teXOut", "<>", "coeffX"}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"idle", "=", "\"\<no\>\""}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "sy", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"coeffY", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"idle", "=", "\"\<yes\>\""}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"idle", "\[Equal]", "\"\<no\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"count", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "we", " ", "have", " ", "sigmax", " ", "and", " ", "sigmay"}], 
              ",", " ", 
              RowBox[{
               RowBox[{"so", " ", "put", " ", "a"}], " ", "+", " ", 
               RowBox[{"sign", " ", "in", " ", "between"}]}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"teXOut", "=", 
             RowBox[{"teXOut", "<>", "\"\<+\>\""}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"count", "+=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Doing sy\>\"", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"Head", "[", "coeffY", "]"}]}], "\[Equal]", 
             "\"\<Plus\>\""}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "we", " ", "have", " ", "a", " ", "sum", " ", "of", " ", "sy", 
              " ", "terms"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"coeffY", "=", 
             RowBox[{"\"\<(\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"TeXForm", "[", 
                RowBox[{"coeffY", "/.", "repAll"}], "]"}], "]"}], "<>", 
              "\"\<)\\\\sigma_y\>\""}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"else", " ", "we", " ", 
              RowBox[{"don", "'"}], "t", " ", "have", " ", "a", " ", "sum"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"coeffY", "=", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"TeXForm", "[", 
                RowBox[{"coeffY", "/.", "repAll"}], "]"}], "]"}], "<>", 
              "\"\<\\\\sigma_y\>\""}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"teXOut", "=", 
           RowBox[{"teXOut", "<>", "coeffY"}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"idle", "=", "\"\<no\>\""}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "sz", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"coeffZ", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"idle", "=", "\"\<yes\>\""}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"idle", "\[Equal]", "\"\<no\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coeffZ", "=", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"TeXForm", "[", 
              RowBox[{"coeffZ", "/.", "repAll"}], "]"}], "]"}], "<>", 
            "\"\<)\\\\sigma_z\>\""}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "parentheses", " ", "are", " ", "taken", " ", "care", " ", "of", 
            " ", "already"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"teXOut", "=", 
           RowBox[{"teXOut", "<>", "coeffZ"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"count", "\[Equal]", "2"}], ",", 
           RowBox[{"teXOut", "=", 
            RowBox[{"teXOut", "<>", "\"\<)\>\""}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "teXOut", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.734843190482069*^9, 3.734843251352254*^9}, 
   3.734843321653064*^9, {3.734843353146658*^9, 3.734843434533692*^9}, 
   3.7348435353683243`*^9, {3.734843721903364*^9, 3.734843873215044*^9}, {
   3.7348439493654423`*^9, 3.734844172878427*^9}, {3.734844238300218*^9, 
   3.73484426028848*^9}, {3.734844368845169*^9, 3.734844788911934*^9}, 
   3.734844848884659*^9, {3.7348448810996513`*^9, 3.7348449840925617`*^9}, {
   3.7348450965106897`*^9, 3.734845220495865*^9}, {3.7348459217787857`*^9, 
   3.734846050387792*^9}, {3.73484618389303*^9, 3.734846311886313*^9}, {
   3.734846374618782*^9, 3.7348464147290277`*^9}, {3.734846486830236*^9, 
   3.734846574392989*^9}, {3.734846616782769*^9, 3.734846625470179*^9}, {
   3.734847200904204*^9, 3.734847204478755*^9}, {3.734847250965824*^9, 
   3.734847306770894*^9}, 3.734847339516737*^9, {3.734847372847599*^9, 
   3.734847374709683*^9}, {3.7348474676566553`*^9, 3.73484747670439*^9}, {
   3.734847688710949*^9, 3.734847690973917*^9}, {3.734847889130549*^9, 
   3.734847900830305*^9}, {3.734847992766082*^9, 3.7348479941977673`*^9}, {
   3.7348481189266*^9, 3.734848126826091*^9}, 3.734848166828569*^9, {
   3.734848238049136*^9, 3.734848258711565*^9}, {3.734848292456781*^9, 
   3.734848310398315*^9}, {3.734848373742454*^9, 3.734848389440064*^9}, {
   3.734848879526155*^9, 3.7348489487414217`*^9}, {3.73484912175327*^9, 
   3.734849200701747*^9}, {3.734849248506496*^9, 3.734849250826376*^9}, 
   3.734849294432247*^9, 3.734849369285211*^9, {3.734849973077565*^9, 
   3.7348501410931787`*^9}, {3.734857509284408*^9, 3.734857515180665*^9}, {
   3.734857670546812*^9, 3.734857674122448*^9}, {3.734857996436597*^9, 
   3.7348580044400597`*^9}, {3.734864043739233*^9, 3.734864045771405*^9}, {
   3.734864090975115*^9, 3.7348641119632807`*^9}, {3.73486414791562*^9, 
   3.734864149772325*^9}, {3.734870499997014*^9, 3.734870504884521*^9}, {
   3.7348710578549967`*^9, 3.734871063324747*^9}, {3.734871095379174*^9, 
   3.734871163649304*^9}, 3.7349248837162724`*^9, {3.7349249308129654`*^9, 
   3.7349249496030407`*^9}, {3.735120140317043*^9, 3.73512018520161*^9}},
 CellLabel->
  "In[430]:=",ExpressionUUID->"19806159-d3e5-4968-aba6-e06843275e8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "sort", " ", "complicated", " ", "terms", " ", "to", " ", "put", " ", "sx",
     " ", "and", " ", "sy", " ", "and", " ", "sz", " ", "towards", " ", "the",
     " ", "end", " ", "of", " ", "the", " ", "string"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "redo", " ", "this", " ", "procedure", " ", "because", " ", "we", " ", 
    "want", " ", "to", " ", "try", " ", "square", " ", "brackets", " ", 
    "rather", " ", "than", " ", "round", " ", "brackets"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"complicatedTerms", "[", "input_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"idle", "=", "\"\<no\>\""}], ",", "coeffX", ",", "coeffY", 
        ",", "coeffZ", ",", 
        RowBox[{"count", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "pick", " ", "sx", " ", "and", " ", "sy", " ", "coefficients", " ", 
        "to", " ", "put", " ", "the", " ", "sigma_x", " ", "and", " ", 
        "sigma_y", " ", "operators", " ", "towards", " ", "the", " ", "end", 
        " ", "of", " ", "the", " ", "sum"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<input = \>\"", ",", "input"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"coeffX", ",", "coeffY"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{"input", ",", "sx"}], "]"}], ",", 
          RowBox[{"Coefficient", "[", 
           RowBox[{"input", ",", "sy"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "just", " ", "in", " ", "case", " ", "there", " ", "are", " ", "no", 
          " ", "sx", " ", "or", " ", "sy", " ", "terms"}], " ", ".."}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"coeffZ", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"input", "-", 
           RowBox[{"coeffX", "*", "sx"}], "-", 
           RowBox[{"coeffY", "*", "sy"}]}], "//", "TrigToExp"}], "//", 
         "ExpToTrig"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<For some reason, coeffZ = \>\"", ",", "coeffZ"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<{coeffX, coeffY, coeffZ} = \>\"", ",", 
           RowBox[{"{", 
            RowBox[{"coeffX", ",", " ", "coeffY", ",", " ", "coeffZ"}], 
            "}"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "sx", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"coeffX", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"idle", "=", "\"\<yes\>\""}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "parentheses", " ", "for", " ", "sigma_z", " ", "dependence"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"teXOut", "=", "\"\<(\>\""}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"square", " ", "brackest", " ", "for", " ", "sigma_x", " ", 
           RowBox[{"(", 
            RowBox[{
            "I", " ", "assume", " ", "we", " ", "only", " ", "have", " ", 
             "sigma_y", " ", "if", " ", "there", " ", "is", " ", "sigma_x"}], 
            ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"teXOut", "=", "\"\<[\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{"teXOut", "=", "\"\<[\>\""}]}], "\[IndentingNewLine]", "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"idle", "\[Equal]", "\"\<no\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"count", "+=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Here\>\"", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Doing sx\>\"", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"Head", "[", "coeffX", "]"}]}], "\[Equal]", 
             "\"\<Plus\>\""}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "we", " ", "have", " ", "a", " ", "sum", " ", "of", " ", "sx", 
              " ", "terms"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"coeffX", "=", 
             RowBox[{"\"\<(\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"TeXForm", "[", 
                RowBox[{"coeffX", "/.", "repAll"}], "]"}], "]"}], "<>", 
              "\"\<)\\\\sigma_x\>\""}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"else", " ", "we", " ", 
              RowBox[{"don", "'"}], "t", " ", "have", " ", "a", " ", "sum"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<Doing something\>\"", "]"}], ";"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"coeffX", "=", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"TeXForm", "[", 
                RowBox[{"coeffX", "/.", "repAll"}], "]"}], "]"}], "<>", 
              "\"\<\\\\sigma_x\>\""}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Doing nothing\>\"", "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"teXOut", "=", 
           RowBox[{"teXOut", "<>", "coeffX"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"idle", "=", "\"\<no\>\""}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "sy", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"coeffY", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"idle", "=", "\"\<yes\>\""}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"idle", "\[Equal]", "\"\<no\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"count", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "we", " ", "have", " ", "sigmax", " ", "and", " ", "sigmay"}], 
              ",", " ", 
              RowBox[{
               RowBox[{"so", " ", "put", " ", "a"}], " ", "+", " ", 
               RowBox[{"sign", " ", "in", " ", "between"}]}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"teXOut", "=", 
             RowBox[{"teXOut", "<>", "\"\<+\>\""}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"count", "+=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Doing sy\>\"", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"Head", "[", "coeffY", "]"}]}], "\[Equal]", 
             "\"\<Plus\>\""}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "we", " ", "have", " ", "a", " ", "sum", " ", "of", " ", "sy", 
              " ", "terms"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"coeffY", "=", 
             RowBox[{"\"\<(\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"TeXForm", "[", 
                RowBox[{"coeffY", "/.", "repAll"}], "]"}], "]"}], "<>", 
              "\"\<)\\\\sigma_y\>\""}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"else", " ", "we", " ", 
              RowBox[{"don", "'"}], "t", " ", "have", " ", "a", " ", "sum"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"coeffY", "=", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"TeXForm", "[", 
                RowBox[{"coeffY", "/.", "repAll"}], "]"}], "]"}], "<>", 
              "\"\<\\\\sigma_y\>\""}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"teXOut", "=", 
           RowBox[{"teXOut", "<>", "coeffY"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"idle", "=", "\"\<no\>\""}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"count", "\[Equal]", "2"}], " ", "\[Or]", 
          RowBox[{"count", "\[Equal]", "1"}]}], ",", 
         RowBox[{"teXOut", "=", 
          RowBox[{"teXOut", "<>", "\"\<]\>\""}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "sz", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"coeffZ", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"idle", "=", "\"\<yes\>\""}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"idle", "\[Equal]", "\"\<no\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coeffZ", "=", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"TeXForm", "[", 
              RowBox[{"coeffZ", "/.", "repAll"}], "]"}], "]"}], "<>", 
            "\"\<)\\\\sigma_z\>\""}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "parentheses", " ", "are", " ", "taken", " ", "care", " ", "of", 
            " ", "already"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"teXOut", "=", 
           RowBox[{"teXOut", "<>", "coeffZ"}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "teXOut", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.734843190482069*^9, 3.734843251352254*^9}, 
   3.734843321653064*^9, {3.734843353146658*^9, 3.734843434533692*^9}, 
   3.7348435353683243`*^9, {3.734843721903364*^9, 3.734843873215044*^9}, {
   3.7348439493654423`*^9, 3.734844172878427*^9}, {3.734844238300218*^9, 
   3.73484426028848*^9}, {3.734844368845169*^9, 3.734844788911934*^9}, 
   3.734844848884659*^9, {3.7348448810996513`*^9, 3.7348449840925617`*^9}, {
   3.7348450965106897`*^9, 3.734845220495865*^9}, {3.7348459217787857`*^9, 
   3.734846050387792*^9}, {3.73484618389303*^9, 3.734846311886313*^9}, {
   3.734846374618782*^9, 3.7348464147290277`*^9}, {3.734846486830236*^9, 
   3.734846574392989*^9}, {3.734846616782769*^9, 3.734846625470179*^9}, {
   3.734847200904204*^9, 3.734847204478755*^9}, {3.734847250965824*^9, 
   3.734847306770894*^9}, 3.734847339516737*^9, {3.734847372847599*^9, 
   3.734847374709683*^9}, {3.7348474676566553`*^9, 3.73484747670439*^9}, {
   3.734847688710949*^9, 3.734847690973917*^9}, {3.734847889130549*^9, 
   3.734847900830305*^9}, {3.734847992766082*^9, 3.7348479941977673`*^9}, {
   3.7348481189266*^9, 3.734848126826091*^9}, 3.734848166828569*^9, {
   3.734848238049136*^9, 3.734848258711565*^9}, {3.734848292456781*^9, 
   3.734848310398315*^9}, {3.734848373742454*^9, 3.734848389440064*^9}, {
   3.734848879526155*^9, 3.7348489487414217`*^9}, {3.73484912175327*^9, 
   3.734849200701747*^9}, {3.734849248506496*^9, 3.734849250826376*^9}, 
   3.734849294432247*^9, 3.734849369285211*^9, {3.734849973077565*^9, 
   3.7348501410931787`*^9}, {3.734857509284408*^9, 3.734857515180665*^9}, {
   3.734857670546812*^9, 3.734857674122448*^9}, {3.734857996436597*^9, 
   3.7348580044400597`*^9}, {3.734864043739233*^9, 3.734864045771405*^9}, {
   3.734864090975115*^9, 3.7348641119632807`*^9}, {3.73486414791562*^9, 
   3.734864149772325*^9}, {3.734870499997014*^9, 3.734870504884521*^9}, {
   3.7348710578549967`*^9, 3.734871063324747*^9}, {3.734871095379174*^9, 
   3.734871163649304*^9}, 3.7349248837162724`*^9, {3.7349249308129654`*^9, 
   3.7349249496030407`*^9}, {3.735120140317043*^9, 3.73512018520161*^9}, 
   3.735123145799947*^9, {3.735123653155966*^9, 3.735123706977044*^9}, {
   3.7351237511995735`*^9, 3.7351237784871345`*^9}, {3.735123818853443*^9, 
   3.735123837374502*^9}, {3.7351238750936604`*^9, 3.7351239328049607`*^9}, {
   3.7351239837778764`*^9, 3.7351240381019835`*^9}, {3.735124071856914*^9, 
   3.735124074316055*^9}},
 CellLabel->
  "In[431]:=",ExpressionUUID->"bcdbf5af-f025-4291-bcf1-16aae54007ed"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7348703309435863`*^9, 3.7348703319357147`*^9}},
 CellLabel->
  "In[432]:=",ExpressionUUID->"c17c10d2-315c-47c8-a2f2-02b88bc82def"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PersonalTeX", "[", 
    RowBox[{"Op_", ",", "cList_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"output", "=", 
        RowBox[{"{", "}"}]}], ",", "OpWork", ",", "omegaList", ",", 
       "omegaItem", ",", "omegaCListItem", ",", "coefficientList", ",", 
       "coefficient", ",", "item", ",", "sigmaList", ",", "commonFactor", ",",
        "commonFactorModSz", ",", "stringReps"}], "}"}], ",", 
     RowBox[{
      RowBox[{"OpWork", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{"ExpToTrig", "[", 
         RowBox[{"TrigToExp", "[", "Op", "]"}], "]"}], "]"}]}], ";", 
      RowBox[{"stringReps", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<\\\\right\>\"", "\[Rule]", "\"\<\>\""}], ",", 
         RowBox[{"\"\<\\\\left\>\"", "\[Rule]", "\"\<\>\""}], ",", 
         RowBox[{"\"\< _\>\"", "\[Rule]", "\"\<_\>\""}], ",", 
         RowBox[{"\"\<,\>\"", "\[Rule]", "\"\<+\>\""}], ",", 
         RowBox[{"\"\< }\>\"", "\[Rule]", "\"\<}\>\""}], ",", 
         RowBox[{"\"\< )\>\"", "\[Rule]", "\"\<)\>\""}], ",", 
         RowBox[{"\"\< (\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
         RowBox[{"\"\<  \>\"", "\[Rule]", "\"\< \>\""}], ",", 
         RowBox[{"\"\<\\\\text{H1D}\>\"", "\[Rule]", "\"\<\\\\dot H_1\>\""}], 
         ",", 
         RowBox[{
         "\"\<\\\\text{H1DD}\>\"", "\[Rule]", "\"\<\\\\ddot H_1\>\""}], ",", 
         RowBox[{
         "\"\<\\\\text{H1DDD}\>\"", "\[Rule]", "\"\<\\\\dddot H_1\>\""}], ",", 
         RowBox[{"\"\<(\\\\phi)\>\"", "\[Rule]", "\"\<\\\\phi\>\""}], ",", 
         RowBox[{"\"\<+-\>\"", "\[Rule]", "\"\<-\>\""}], ",", 
         RowBox[{"\"\<+)\>\"", "\[Rule]", "\"\<)\>\""}]}], "}"}]}], ";", 
      RowBox[{"omegaList", "=", 
       RowBox[{"CoefficientList", "[", 
        RowBox[{"OpWork", ",", 
         FractionBox["1", "ww"]}], "]"}]}], ";", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "omegaList", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{"omegaItem", "=", 
          RowBox[{
          "omegaList", "\[LeftDoubleBracket]", "k", 
           "\[RightDoubleBracket]"}]}], ";", 
         RowBox[{"omegaCListItem", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"cList", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "\[Equal]", "k"}], "&"}]}], "]"}]}], ";", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"kk", "=", "1"}], ",", 
           RowBox[{"kk", "\[LessEqual]", 
            RowBox[{"Length", "[", "omegaCListItem", "]"}]}], ",", 
           RowBox[{"kk", "++"}], ",", 
           RowBox[{
            RowBox[{"coefficientList", "=", 
             RowBox[{"omegaCListItem", "\[LeftDoubleBracket]", 
              RowBox[{"kk", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
            RowBox[{"coefficient", "=", 
             RowBox[{
              UnderoverscriptBox["\[Product]", 
               RowBox[{"kkk", "=", "1"}], 
               RowBox[{"Length", "[", "coefficientList", "]"}]], 
              RowBox[{
              "coefficientList", "\[LeftDoubleBracket]", "kkk", 
               "\[RightDoubleBracket]"}]}]}], ";", 
            RowBox[{"item", "=", 
             RowBox[{"Expand", "[", 
              RowBox[{"ExpToTrig", "[", 
               RowBox[{"TrigToExp", "[", 
                FractionBox[
                 RowBox[{"coefficient", " ", 
                  RowBox[{"Coefficient", "[", 
                   RowBox[{"omegaItem", ",", "coefficient"}], "]"}]}], 
                 SuperscriptBox["ww", 
                  RowBox[{"k", "-", "1"}]]], "]"}], "]"}], "]"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"Head", "[", "item", "]"}], "]"}], "\[NotEqual]", 
               "\"\<Plus\>\""}], ",", 
              RowBox[{"output", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"output", ",", 
                 RowBox[{"TeXForm", "[", 
                  RowBox[{"item", "//.", "\[VeryThinSpace]", "repAll"}], 
                  "]"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"commonFactor", "=", 
                RowBox[{"PolynomialGCD", "[", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"List", "@@", "item"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Coefficient", "[", 
                   RowBox[{"commonFactor", ",", "sz"}], "]"}], "\[Equal]", 
                  "0"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"commonFactorModSz", "=", "commonFactor"}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "otherwise", " ", "it", " ", "will", " ", "jump", " ", "to",
                    " ", "\"\<undecided\>\""}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"commonFactorModSz", "=", "commonFactor"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"else", ":", "  ", 
                   RowBox[{"remove", " ", "sz"}]}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"commonFactorModSz", "=", 
                   RowBox[{
                    RowBox[{"commonFactor", "/", "sz"}], "//", "S"}]}], 
                  ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"output", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"output", ",", 
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{"TeXForm", "[", 
                    RowBox[{
                    "commonFactorModSz", "/.", "\[VeryThinSpace]", "repAll"}],
                     "]"}], "]"}], "<>", 
                   RowBox[{"complicatedTerms", "[", 
                    RowBox[{"Cancel", "[", 
                    FractionBox["item", "commonFactor"], "]"}], "]"}]}]}], 
                 "]"}]}]}]}], "]"}], ";"}]}], "]"}], ";", 
         RowBox[{"output", "=", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "output", "]"}], ",", "stringReps"}], 
           "]"}]}], ";", 
         RowBox[{"output", "=", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"output", ",", "stringReps"}], "]"}]}], ";", 
         RowBox[{"Print", "[", "\"\<Next order output = \>\"", "]"}], ";", 
         RowBox[{"Print", "[", 
          RowBox[{"StringDrop", "[", 
           RowBox[{
            RowBox[{"StringDrop", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "output", "]"}], ",", "1"}], "]"}], 
            ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}], ";", 
         RowBox[{"output", "=", 
          RowBox[{"{", "}"}]}], ";"}]}], "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.734673928689412*^9, 3.7346740439419737`*^9}, {
   3.734674233884364*^9, 3.7346742386763268`*^9}, {3.734674269154725*^9, 
   3.7346744111222677`*^9}, {3.73467445404813*^9, 3.734674524668453*^9}, {
   3.7346749928028603`*^9, 3.734675100253214*^9}, {3.7346751841775007`*^9, 
   3.734675260788476*^9}, {3.7346753121378517`*^9, 3.7346753469839*^9}, {
   3.7346777592379*^9, 3.734677831569839*^9}, {3.734683712028838*^9, 
   3.734683791912449*^9}, {3.734683942856291*^9, 3.734683973062786*^9}, {
   3.734684009597022*^9, 3.734684026676731*^9}, {3.734684117774952*^9, 
   3.7346841232786493`*^9}, {3.734686179935567*^9, 3.7346863428904667`*^9}, {
   3.734688198557001*^9, 3.7346882080891457`*^9}, {3.734690787632175*^9, 
   3.734690803478805*^9}, {3.734690873771098*^9, 3.734690884193822*^9}, {
   3.734690936702958*^9, 3.734690993940879*^9}, {3.734691042609407*^9, 
   3.734691113998448*^9}, 3.734691489017239*^9, {3.7346927590519333`*^9, 
   3.734692768972389*^9}, {3.734692905163933*^9, 3.734692926178722*^9}, {
   3.73469297216875*^9, 3.734693008318976*^9}, {3.734693132089252*^9, 
   3.7346931515670137`*^9}, {3.7346932816161222`*^9, 3.734693282592052*^9}, {
   3.734693993937449*^9, 3.73469400476891*^9}, {3.734696709969338*^9, 
   3.734696733607473*^9}, {3.734696885736861*^9, 3.734696898927195*^9}, {
   3.734696931869012*^9, 3.7346969460673122`*^9}, {3.7346969798014603`*^9, 
   3.734697002513052*^9}, {3.734697045134001*^9, 3.734697087698567*^9}, {
   3.734789958225075*^9, 3.734790033366392*^9}, {3.73479011393788*^9, 
   3.734790120561204*^9}, 3.734790604800153*^9, {3.734790686387012*^9, 
   3.73479071350566*^9}, {3.734790753367159*^9, 3.734790875065631*^9}, {
   3.7347909573170633`*^9, 3.7347910087627*^9}, {3.734791042009368*^9, 
   3.734791375128978*^9}, {3.734791477811926*^9, 3.7347915528625593`*^9}, {
   3.734791630811358*^9, 3.734791709223283*^9}, {3.734791739599697*^9, 
   3.734791748599581*^9}, {3.734791875295526*^9, 3.734791928900805*^9}, {
   3.7347920113294067`*^9, 3.734792068331167*^9}, {3.734792113468253*^9, 
   3.7347921315470457`*^9}, {3.7347921664656687`*^9, 3.734792192736062*^9}, {
   3.734792377600072*^9, 3.734792403974494*^9}, {3.734792697609007*^9, 
   3.734792815338201*^9}, {3.73479301251222*^9, 3.734793063430094*^9}, {
   3.734793996193783*^9, 3.734794073459516*^9}, {3.734794170993415*^9, 
   3.734794175470408*^9}, {3.734794208188828*^9, 3.734794240827469*^9}, {
   3.734794398659634*^9, 3.734794429786759*^9}, {3.734794467338982*^9, 
   3.734794484583778*^9}, {3.734794594925097*^9, 3.734794672622963*^9}, {
   3.73479493119261*^9, 3.73479494314395*^9}, {3.7347950138935738`*^9, 
   3.734795018060092*^9}, {3.7347950978736267`*^9, 3.734795134671392*^9}, {
   3.734795275329398*^9, 3.73479528136722*^9}, {3.734796018125477*^9, 
   3.734796110218466*^9}, {3.734796144197904*^9, 3.734796180788392*^9}, {
   3.7347962174762907`*^9, 3.734796218459384*^9}, {3.734796399451178*^9, 
   3.734796469273472*^9}, {3.734837176863737*^9, 3.7348371785743303`*^9}, {
   3.7348373412451887`*^9, 3.7348373475090513`*^9}, {3.7348379417238913`*^9, 
   3.7348379417912607`*^9}, {3.734838228043548*^9, 3.734838230279155*^9}, {
   3.734838287674829*^9, 3.734838288328133*^9}, {3.73483834264746*^9, 
   3.734838350495976*^9}, {3.734838415163629*^9, 3.73483843306664*^9}, {
   3.734838485511611*^9, 3.734838486591804*^9}, {3.7348386214963837`*^9, 
   3.7348386278861513`*^9}, {3.734838672917954*^9, 3.734838673086219*^9}, {
   3.734838770129648*^9, 3.734838842237587*^9}, {3.734838883467967*^9, 
   3.7348389007458973`*^9}, {3.734838963110359*^9, 3.7348389632704077`*^9}, {
   3.7348389941401243`*^9, 3.734838996603887*^9}, {3.734839106638781*^9, 
   3.734839106782669*^9}, {3.734839177586349*^9, 3.734839197049391*^9}, {
   3.7348393266990147`*^9, 3.734839333131591*^9}, 3.7348394055363703`*^9, {
   3.734839472262578*^9, 3.7348394853296747`*^9}, {3.734839529256659*^9, 
   3.7348396166761503`*^9}, {3.734839685567531*^9, 3.7348396883189373`*^9}, {
   3.734840061971816*^9, 3.734840067490363*^9}, {3.734840099065654*^9, 
   3.734840106696589*^9}, {3.7348402120116987`*^9, 3.734840271394642*^9}, {
   3.7348403476205063`*^9, 3.734840354179152*^9}, {3.7348404976595078`*^9, 
   3.734840505523678*^9}, {3.734840558337522*^9, 3.734840584047187*^9}, {
   3.734840635653358*^9, 3.734840649787159*^9}, {3.734840689329218*^9, 
   3.7348407463742228`*^9}, {3.734842317412725*^9, 3.734842318636435*^9}, {
   3.734843545770893*^9, 3.734843550315126*^9}, {3.734843684252047*^9, 
   3.734843691422124*^9}, {3.734844199364699*^9, 3.7348442240705853`*^9}, {
   3.734845270590275*^9, 3.734845310203861*^9}, {3.734845759149145*^9, 
   3.734845786258958*^9}, {3.734848194812036*^9, 3.734848220722481*^9}, {
   3.734848451445725*^9, 3.734848454397201*^9}, {3.734848698130618*^9, 
   3.73484869826506*^9}, {3.734848988082612*^9, 3.734848995160356*^9}, 
   3.73484946305742*^9, {3.7348501846668*^9, 3.734850188924122*^9}, {
   3.73485042120055*^9, 3.73485042797505*^9}, {3.734850500734284*^9, 
   3.734850562375944*^9}, {3.734850627820366*^9, 3.734850636757634*^9}, 
   3.73485070344049*^9, {3.734857530476873*^9, 3.734857537707258*^9}, {
   3.7348576431601477`*^9, 3.734857651320586*^9}, {3.734857755575511*^9, 
   3.73485776223175*^9}, {3.7348635484872103`*^9, 3.7348635511749687`*^9}, {
   3.734863582910396*^9, 3.734863584532797*^9}, {3.734863732358643*^9, 
   3.734863864943437*^9}, {3.734863897246182*^9, 3.734863915780821*^9}, 
   3.734870263480384*^9, {3.73487035197327*^9, 3.734870379968871*^9}, {
   3.7348704240463123`*^9, 3.734870447900196*^9}, {3.7348705405796347`*^9, 
   3.734870543960842*^9}, {3.734870723095409*^9, 3.734870769765785*^9}, {
   3.7349256707962904`*^9, 3.73492577271412*^9}, 3.7349279929751115`*^9, {
   3.7349280445580616`*^9, 3.7349280510174313`*^9}, {3.734928440056683*^9, 
   3.734928455530568*^9}, 3.7349285020422287`*^9, {3.7349285384423103`*^9, 
   3.7349285810017443`*^9}, 3.734931418476039*^9, 3.734931614576255*^9, {
   3.7351196839709415`*^9, 3.735119687058118*^9}, 3.7351199356323357`*^9, {
   3.735123282347757*^9, 3.7351233124104767`*^9}, {3.7351233448793335`*^9, 
   3.735123414513316*^9}, {3.735134347238632*^9, 3.7351343477676625`*^9}, {
   3.735134390639115*^9, 3.7351344067010336`*^9}, {3.73513445419875*^9, 
   3.7351344622442102`*^9}, {3.7351345588627367`*^9, 3.735134580690985*^9}, {
   3.735134671431175*^9, 3.7351346761404448`*^9}, {3.7351347108784313`*^9, 
   3.7351348285791636`*^9}, {3.7351348814401865`*^9, 3.735134892647828*^9}, {
   3.7647515707842207`*^9, 3.764751614809498*^9}},
 CellLabel->
  "In[433]:=",ExpressionUUID->"129555ba-380a-4b42-909d-953487e57ac5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.734870644599557*^9, 3.734870644919832*^9}},
 CellLabel->
  "In[434]:=",ExpressionUUID->"51cd5449-62f5-4e7a-8ef9-8286d176d857"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.734870641825164*^9},
 CellLabel->
  "In[435]:=",ExpressionUUID->"b037b1ad-f428-422b-bbb6-6de9826fe4c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["6.   Output TeXForm automated",
 FontColor->RGBColor[1, 0, 0]]], "Section",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738404299663188*^9, 3.738404305126616*^9}, {
   3.738404391665751*^9, 3.73840439835355*^9}, {3.73840462391805*^9, 
   3.738404626237836*^9}, {3.73840468375496*^9, 3.738404686354837*^9}, {
   3.738406725632657*^9, 3.738406727782609*^9}, {3.739077648805573*^9, 
   3.739077660525449*^9}},ExpressionUUID->"85f8edec-b807-4dda-9bda-\
105ddc4c9f96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myTeXofH", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"make", " ", "simple", " ", "coefficient", " ", "List", " ", 
       RowBox[{"(", 
        RowBox[{"include", " ", "all", " ", "necessary", " ", "derivatives"}],
         ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myCListE", "=", 
       RowBox[{"setCListE", "[", 
        RowBox[{"max", ",", "offResonant", ",", "taylor"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<myCListE = \>\"", ",", "myCListE"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"make", " ", "complete", " ", "coefficient", " ", "List", " ", 
        RowBox[{"(", 
         RowBox[{"include", " ", "cross", " ", "terms"}], ")"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"myCListEE", "=", 
       RowBox[{"detCListE", "[", 
        RowBox[{"myCListE", ",", "max"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<myCListEE = \>\"", ",", "myCListEE"}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"PersonalTeX", "[", 
        RowBox[{
         RowBox[{"HforTeX", "//", "S"}], ",", "myCListEE"}], "]"}], "]"}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.739077743983927*^9, 3.739077779625917*^9}, {
  3.739078589605742*^9, 3.739078632628315*^9}, {3.739078669667759*^9, 
  3.739078669883977*^9}, {3.739078699889419*^9, 3.739078722150806*^9}, {
  3.73907913701768*^9, 3.73907917269769*^9}, {3.739079233365847*^9, 
  3.739079263043172*^9}, {3.739083335514925*^9, 3.7390833459312983`*^9}},
 CellLabel->
  "In[436]:=",ExpressionUUID->"997732a3-c0e7-4f15-bcf7-132a2b8e0123"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.739078584314547*^9, 3.739078584597979*^9}},
 CellLabel->
  "In[437]:=",ExpressionUUID->"d90675c0-95f0-4e8f-9e4a-202a35079bea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["7.   Hamiltonians / Kick Operators",
 FontColor->RGBColor[1, 0, 0]]], "Section",
 CellChangeTimes->{{3.7384039033250647`*^9, 3.7384039095263643`*^9}, 
   3.7384042394074717`*^9, {3.738406695464067*^9, 3.738406699136009*^9}, {
   3.7384068847910023`*^9, 3.7384068906466017`*^9}, {3.739077161790329*^9, 
   3.7390771631346607`*^9}, {3.7390785706623583`*^9, 3.7390785799744663`*^9}, 
   3.7390791301225843`*^9},ExpressionUUID->"b21775d1-5ed1-4904-99ad-\
a357f6c53dce"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.739078568740065*^9, 3.739078568878847*^9}, {
  3.739079410140992*^9, 3.73907941029986*^9}},
 CellLabel->
  "In[438]:=",ExpressionUUID->"febb14c8-1e1c-4e78-8252-5850e21ed31d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"exact", " ", "lab", " ", "frame", " ", "Hamiltonian"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.739079412327334*^9, 3.739079448562601*^9}},
 CellLabel->
  "In[439]:=",ExpressionUUID->"6f9bb2d7-80ba-4a37-af64-06993882ecce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HExact", "=", 
   RowBox[{
    RowBox[{
     FractionBox["H1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "phi", "]"}], "sx"}], "+", 
       RowBox[{"sx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"2", " ", "t", " ", "ww"}], "+", "phi"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "phi", "]"}], "sy"}], "-", 
       RowBox[{"sy", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"2", " ", "t", " ", "ww"}], "+", "phi"}], "]"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Delta", "/", "2"}], ")"}], "sz"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7390794343418713`*^9, 3.739079445834567*^9}, {
  3.7390821783857527`*^9, 3.7390821797699823`*^9}},
 CellLabel->
  "In[440]:=",ExpressionUUID->"86c8e4e5-9377-455b-8eb6-722723d81189"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.739079452252603*^9, 3.739079453801045*^9}},
 CellLabel->
  "In[441]:=",ExpressionUUID->"ae59c44a-df68-4f21-8f0c-cebc19c6cf11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"reppieInv", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]d", "\[Rule]", 
      RowBox[{"\[Beta]", "/", "2"}]}], ",", 
     RowBox[{"\[Alpha]0", "->", 
      RowBox[{"\[Beta]0", "/", "2"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{3.7390833938961163`*^9},
 CellLabel->
  "In[442]:=",ExpressionUUID->"78aedaf8-8349-414d-a82e-096382a97b94"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "kick", " ", "operators", " ", "\[IndentingNewLine]", "taken", " ", "from", 
   " ", "the", " ", "folder", " ", "0", "_mostRecent", "_g3", "_kicks"}], " ",
   "*)"}]], "Input",
 CellChangeTimes->{{3.739079552289013*^9, 3.739079569884495*^9}},
 CellLabel->
  "In[443]:=",ExpressionUUID->"20918a50-5b1e-4d20-adf9-af5c0415d1db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"here", " ", "Delta"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"0", " ", "and", " ", "phi"}], " ", "=", " ", "0"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"be", " ", "careful", " ", "to", " ", "use", " ", 
     FractionBox["1", 
      SuperscriptBox["ww", "2"]], " ", "to", " ", "make", " ", "it", " ", 
     "look", " ", "like", " ", "a", " ", 
     RowBox[{"Hamiltonian", "?"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "should", " ", "perhaps", " ", "be", " ", "called", " ", "2", "nd", " ", 
     "order"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"firstOrder", "=", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"64", " ", 
          SuperscriptBox["ww", "2"]}]], "\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"H1D", " ", "sx"}], "-", 
             RowBox[{"H2D", " ", "sx"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"H1", "-", "H2"}], ")"}], " ", "sy", " ", "ww"}]}], 
            ")"}], " ", 
           RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "H1D", " ", "sx"}], "+", 
             RowBox[{"4", " ", "H2D", " ", "sx"}], "+", 
             RowBox[{"8", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "H1"}], "+", "H2"}], ")"}], " ", "sy", " ", 
              "ww"}]}], ")"}], " ", 
           RowBox[{"Cos", "[", "\[Beta]d", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["H1", "2"], " ", "sz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"2", " ", "\[Alpha]d"}], "-", "\[Beta]0"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["H2", "2"], " ", "sz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"2", " ", "\[Alpha]d"}], "-", "\[Beta]0"}], "]"}]}], "-", 
          RowBox[{"4", " ", "H1D", " ", "sy", " ", 
           RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
          RowBox[{"4", " ", "H2D", " ", "sy", " ", 
           RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["H1", "2"], " ", "sz", " ", 
           RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["H2", "2"], " ", "sz", " ", 
           RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
          RowBox[{"8", " ", "H1", " ", "sx", " ", "ww", " ", 
           RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
          RowBox[{"8", " ", "H2", " ", "sx", " ", "ww", " ", 
           RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
          RowBox[{"4", " ", "H1D", " ", "sy", " ", 
           RowBox[{"Sin", "[", "\[Beta]d", "]"}]}], "-", 
          RowBox[{"4", " ", "H2D", " ", "sy", " ", 
           RowBox[{"Sin", "[", "\[Beta]d", "]"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["H1", "2"], " ", "sz", " ", 
           RowBox[{"Sin", "[", "\[Beta]d", "]"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["H2", "2"], " ", "sz", " ", 
           RowBox[{"Sin", "[", "\[Beta]d", "]"}]}], "-", 
          RowBox[{"8", " ", "H1", " ", "sx", " ", "ww", " ", 
           RowBox[{"Sin", "[", "\[Beta]d", "]"}]}], "+", 
          RowBox[{"8", " ", "H2", " ", "sx", " ", "ww", " ", 
           RowBox[{"Sin", "[", "\[Beta]d", "]"}]}]}], ")"}]}]}], ";"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"keep", " ", "in", " ", 
       RowBox[{"mind", ":", "  ", 
        RowBox[{"multiply", " ", "by", " ", 
         RowBox[{"omega", "/", "\[ImaginaryI]"}], " ", "to", " ", "make", " ",
          "this", " ", "a", " ", "Hamiltonian"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HforTeX", "=", 
       RowBox[{
        FractionBox["ww", "I"], "*", "firstOrder"}]}], ";"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"secondOrder", "=", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"1536", " ", 
          SuperscriptBox["ww", "3"]}]], "\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "\[Alpha]0"}], "-", 
            RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"H1", "-", "H2"}], ")"}], "3"]}], " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "-", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"12", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["H1", "3"], " ", "sx"}], "-", 
             RowBox[{
              SuperscriptBox["H2", "3"], " ", "sx"}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["H1", "2"], " ", "sz", " ", "ww"}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["H2", "2"], " ", "sz", " ", "ww"}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "-", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["H1", "3"], " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], 
          "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], 
          "+", 
          RowBox[{"3", " ", "H1", " ", 
           SuperscriptBox["H2", "2"], " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], 
          "+", 
          RowBox[{
           SuperscriptBox["H2", "3"], " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], 
          "-", 
          RowBox[{"10", " ", 
           SuperscriptBox["H1", "3"], " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"10", " ", 
           SuperscriptBox["H2", "3"], " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"192", " ", "H1D", " ", "sy", " ", "ww", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"192", " ", "H2D", " ", "sy", " ", "ww", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"96", " ", 
           SuperscriptBox["H1", "2"], " ", "sz", " ", "ww", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"96", " ", 
           SuperscriptBox["H2", "2"], " ", "sz", " ", "ww", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"384", " ", "H1", " ", "sx", " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"384", " ", "H2", " ", "sx", " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["H1", "3"], " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"6", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"6", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"6", " ", "H1", " ", 
           SuperscriptBox["H2", "2"], " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"6", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["H2", "3"], " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"6", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["H1", "3"], " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"6", " ", 
           SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"6", " ", "H1", " ", 
           SuperscriptBox["H2", "2"], " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["H2", "3"], " ", "sx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["H1", "3"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "-", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "-", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"3", " ", "H1", " ", 
           SuperscriptBox["H2", "2"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "-", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["H2", "3"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "-", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"12", " ", 
           SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "-", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"12", " ", "H1", " ", 
           SuperscriptBox["H2", "2"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "-", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"48", " ", "H1D", " ", "H2", " ", "sz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "-", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"48", " ", "H1", " ", "H2D", " ", "sz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "-", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["H1", "3"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], 
          "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], 
          "-", 
          RowBox[{"3", " ", "H1", " ", 
           SuperscriptBox["H2", "2"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], 
          "-", 
          RowBox[{
           SuperscriptBox["H2", "3"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], 
          "-", 
          RowBox[{"14", " ", 
           SuperscriptBox["H1", "3"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"14", " ", 
           SuperscriptBox["H2", "3"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"144", " ", "H1", " ", "H1D", " ", "sz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"144", " ", "H2", " ", "H2D", " ", "sz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"192", " ", "H1D", " ", "sx", " ", "ww", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"192", " ", "H2D", " ", "sx", " ", "ww", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"384", " ", "H1", " ", "sy", " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"384", " ", "H2", " ", "sy", " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["H1", "3"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"6", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"6", " ", 
           SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"6", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"6", " ", "H1", " ", 
           SuperscriptBox["H2", "2"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"6", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["H2", "3"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"6", " ", "\[Alpha]0"}], "+", 
               RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["H1", "3"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"6", " ", "H1", " ", 
           SuperscriptBox["H2", "2"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["H2", "3"], " ", "sy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "\[Alpha]0"}], "+", 
               RowBox[{"6", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}]}], ")"}]}],
        "/.", "reppieInv"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"keep", " ", "also", " ", "in", " ", 
      RowBox[{"mind", ":", "  ", 
       RowBox[{
       "output", " ", "will", " ", "be", " ", "propto", " ", "H1", " ", 
        RowBox[{"(", 
         RowBox[{"corresponding", " ", "to", " ", 
          SuperscriptBox["H1", "<"]}], ")"}], " ", "only"}]}]}], ",", " ", 
     RowBox[{"so", " ", 
      RowBox[{"don", "'"}], "t", " ", "forget", " ", "to", " ", "add", " ", 
      "H2", " ", "dependency", " ", 
      RowBox[{"(", 
       SuperscriptBox["H1", ">"], ")"}]}]}], " ", "*)"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.73907974579589*^9, 3.739079835510076*^9}, {
  3.73907986911679*^9, 3.739079920826045*^9}, {3.739081554202429*^9, 
  3.739081578747666*^9}, {3.739082112308999*^9, 3.739082129308825*^9}},
 CellLabel->
  "In[444]:=",ExpressionUUID->"183b858c-8862-4639-8c67-9872ab1bcfcd"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.7390821424273233`*^9},
 CellLabel->
  "In[445]:=",ExpressionUUID->"1353eee7-df5f-4ce9-b535-786588196b0c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"generic", " ", "phi", " ", "and", " ", "Delta"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7390831953416557`*^9, 3.739083200184531*^9}},
 CellLabel->
  "In[446]:=",ExpressionUUID->"0ee91e2a-69ff-4482-a54e-d2d30175c7a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"be", " ", "careful", " ", "to", " ", "use", " ", 
    FractionBox["1", 
     SuperscriptBox["ww", "2"]], " ", "to", " ", "make", " ", "it", " ", 
    "look", " ", "like", " ", "a", " ", 
    RowBox[{"Hamiltonian", "?"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "should", " ", "perhaps", " ", "be", " ", "called", " ", "2", "nd", " ", 
    "order"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"firstOrder", "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"32", " ", 
        SuperscriptBox["ww", "2"]}]], "\[ImaginaryI]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "\[Alpha]0"}], "-", 
          RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["H1", "2"]}], "+", 
           SuperscriptBox["H2", "2"]}], ")"}], " ", "sz", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "\[Alpha]0"}], "-", 
             RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Delta", " ", 
            RowBox[{"(", 
             RowBox[{"H1", "-", "H2"}], ")"}], " ", "sx"}], "+", 
           RowBox[{"H1D", " ", "sy"}], "-", 
           RowBox[{"H2D", " ", "sy"}], "-", 
           RowBox[{"2", " ", "H1", " ", "sx", " ", "ww"}], "+", 
           RowBox[{"2", " ", "H2", " ", "sx", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "phi"}], "+", 
             RowBox[{"2", " ", "\[Alpha]0"}], "+", 
             RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["H1", "2"], " ", "sz", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "phi"}], "+", 
             RowBox[{"2", " ", "\[Alpha]0"}], "+", 
             RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["H2", "2"], " ", "sz", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "phi"}], "+", 
             RowBox[{"2", " ", "\[Alpha]0"}], "+", 
             RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "H1D", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "phi"}], "+", 
             RowBox[{"2", " ", "\[Alpha]0"}], "+", 
             RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"4", " ", "H2D", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "phi"}], "+", 
             RowBox[{"2", " ", "\[Alpha]0"}], "+", 
             RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"4", " ", "Delta", " ", "H1", " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "phi"}], "+", 
             RowBox[{"2", " ", "\[Alpha]0"}], "+", 
             RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "Delta", " ", "H2", " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "phi"}], "+", 
             RowBox[{"2", " ", "\[Alpha]0"}], "+", 
             RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"8", " ", "H1", " ", "sy", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "phi"}], "+", 
             RowBox[{"2", " ", "\[Alpha]0"}], "+", 
             RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"8", " ", "H2", " ", "sy", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "phi"}], "+", 
             RowBox[{"2", " ", "\[Alpha]0"}], "+", 
             RowBox[{"2", " ", "\[Alpha]d"}]}], ")"}]}], "]"}]}]}], ")"}]}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"keep", " ", "in", " ", 
     RowBox[{"mind", ":", "  ", 
      RowBox[{"multiply", " ", "by", " ", 
       RowBox[{"omega", "/", "\[ImaginaryI]"}], " ", "to", " ", "make", " ", 
       "this", " ", "a", " ", "Hamiltonian"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HKick", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["ww", "I"], "*", "firstOrder"}], "/.", "reppieInv"}], "//",
       "TrigReduce"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", 
    "\"\<Remember to replace \[Beta] with \!\(\*SubscriptBox[\(\[Beta]\), \(d\
\)]\) (and {H1, H1D, H1DD} with {H1-H2, etc.}) in the teX code\>\"", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.739082168971119*^9, 3.739082170905877*^9}, {
   3.739082219063532*^9, 3.739082220814006*^9}, 3.739083189141942*^9, {
   3.73908322055892*^9, 3.739083237763702*^9}, {3.739083427565695*^9, 
   3.739083509201338*^9}},
 CellLabel->
  "In[447]:=",ExpressionUUID->"310ddad8-cfc0-4c98-b1f8-d379200922ab"],

Cell[BoxData["\<\"Remember to replace \[Beta] with \\!\\(\\*SubscriptBox[\\(\
\[Beta]\\), \\(d\\)]\\) (and {H1, H1D, H1DD} with {H1-H2, etc.}) in the teX \
code\"\>"], "Print",
 CellChangeTimes->{
  3.739083510257004*^9, 3.7391949798374434`*^9, 3.739195421409539*^9, 
   3.764749506173386*^9, 3.76587718994865*^9, {3.765877267010635*^9, 
   3.765877271843401*^9}, 3.765879823468418*^9, 3.765879903645883*^9, 
   3.8093397282166*^9, {3.809339865959011*^9, 3.8093398904206448`*^9}, 
   3.8097763858738403`*^9, 3.8097765269630947`*^9, 3.809776840089986*^9, {
   3.809776873185247*^9, 3.8097768780737867`*^9}, 3.8097769842119007`*^9},
 CellLabel->
  "During evaluation of \
In[447]:=",ExpressionUUID->"85a9c6d5-0fe6-4c86-9994-aa67fe73c707"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.739083445256497*^9, 3.7390834454044847`*^9}},
 CellLabel->
  "In[450]:=",ExpressionUUID->"913aa2a5-fa7b-45fa-acc1-ad4fac5cb1fb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"thirdOrder", "=", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"3072", " ", 
         SuperscriptBox["ww", "3"]}]]}], "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"12", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sy"}], "-", 
        RowBox[{"12", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sy"}], "+", 
        RowBox[{"48", " ", "H1D", " ", "H2", " ", "sz"}], "-", 
        RowBox[{"48", " ", "H1", " ", "H2D", " ", "sz"}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"5", " ", 
            SuperscriptBox["H1", "3"], " ", "sy"}], "-", 
           RowBox[{
            SuperscriptBox["H1", "2"], " ", "H2", " ", "sy"}], "-", 
           RowBox[{"5", " ", 
            SuperscriptBox["H2", "3"], " ", "sy"}], "+", 
           RowBox[{"64", " ", 
            RowBox[{"(", 
             RowBox[{"H1D", "-", "H2D"}], ")"}], " ", "sx", " ", "ww"}], "-", 
           RowBox[{"16", " ", "H2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", "H2D", " ", "sz"}], "+", 
              RowBox[{"8", " ", "sy", " ", 
               SuperscriptBox["ww", "2"]}]}], ")"}]}], "+", 
           RowBox[{"H1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["H2", "2"], " ", "sy"}], "+", 
              RowBox[{"48", " ", "H1D", " ", "sz"}], "+", 
              RowBox[{"128", " ", "sy", " ", 
               SuperscriptBox["ww", "2"]}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", "\[Beta]", "]"}]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["H1", "3"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["H1", "2"], " ", "H2"}], "+", 
           RowBox[{"2", " ", "H1", " ", 
            SuperscriptBox["H2", "2"]}], "-", 
           SuperscriptBox["H2", "3"]}], ")"}], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Beta]"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["H1", "3"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "-", 
        RowBox[{"3", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["H2", "3"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "-", 
        RowBox[{"12", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Beta]", "-", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"12", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Beta]", "-", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"48", " ", "H1D", " ", "H2", " ", "sz", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Beta]", "-", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"48", " ", "H1", " ", "H2D", " ", "sz", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Beta]", "-", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["H1", "3"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"2", " ", "\[Beta]"}], "-", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"2", " ", "\[Beta]"}], "-", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"3", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"2", " ", "\[Beta]"}], "-", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["H2", "3"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"2", " ", "\[Beta]"}], "-", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"15", " ", 
         SuperscriptBox["H1", "3"], " ", "sy", " ", 
         RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
         RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
        RowBox[{"3", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
        RowBox[{"15", " ", 
         SuperscriptBox["H2", "3"], " ", "sy", " ", 
         RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
        RowBox[{"144", " ", "H1", " ", "H1D", " ", "sz", " ", 
         RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
        RowBox[{"144", " ", "H2", " ", "H2D", " ", "sz", " ", 
         RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
        RowBox[{"192", " ", "H1D", " ", "sx", " ", "ww", " ", 
         RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
        RowBox[{"192", " ", "H2D", " ", "sx", " ", "ww", " ", 
         RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
        RowBox[{"384", " ", "H1", " ", "sy", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "+", 
        RowBox[{"384", " ", "H2", " ", "sy", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Cos", "[", "\[Beta]0", "]"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["H1", "3"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"6", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"6", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["H2", "3"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Beta]", "+", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"12", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Beta]", "+", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"9", " ", 
         SuperscriptBox["H1", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
         RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
        RowBox[{"3", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox["H2", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "-", 
        RowBox[{"192", " ", "H1D", " ", "sy", " ", "ww", " ", 
         RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
        RowBox[{"192", " ", "H2D", " ", "sy", " ", "ww", " ", 
         RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
        RowBox[{"96", " ", 
         SuperscriptBox["H1", "2"], " ", "sz", " ", "ww", " ", 
         RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "-", 
        RowBox[{"96", " ", 
         SuperscriptBox["H2", "2"], " ", "sz", " ", "ww", " ", 
         RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
        RowBox[{"384", " ", "H1", " ", "sx", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "-", 
        RowBox[{"384", " ", "H2", " ", "sx", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["H1", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Beta]"}], "]"}]}], "-", 
        RowBox[{"6", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Beta]"}], "]"}]}], "+", 
        RowBox[{"6", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Beta]"}], "]"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["H2", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Beta]"}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["H1", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "+", 
        RowBox[{"3", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["H2", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"2", " ", "\[Beta]0"}]}], "]"}]}], "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["H1", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Beta]", "-", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"12", " ", 
         SuperscriptBox["H2", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Beta]", "-", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"48", " ", 
         SuperscriptBox["H1", "2"], " ", "sz", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Beta]", "-", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"48", " ", 
         SuperscriptBox["H2", "2"], " ", "sz", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Beta]", "-", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["H1", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"2", " ", "\[Beta]"}], "-", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"2", " ", "\[Beta]"}], "-", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"3", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"2", " ", "\[Beta]"}], "-", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["H2", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"2", " ", "\[Beta]"}], "-", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox["H1", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
        RowBox[{"3", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
        RowBox[{"9", " ", 
         SuperscriptBox["H2", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
        RowBox[{"192", " ", "H1D", " ", "sy", " ", "ww", " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
        RowBox[{"192", " ", "H2D", " ", "sy", " ", "ww", " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
        RowBox[{"96", " ", 
         SuperscriptBox["H1", "2"], " ", "sz", " ", "ww", " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
        RowBox[{"96", " ", 
         SuperscriptBox["H2", "2"], " ", "sz", " ", "ww", " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
        RowBox[{"384", " ", "H1", " ", "sx", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "+", 
        RowBox[{"384", " ", "H2", " ", "sx", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "\[Beta]0", "]"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["H1", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"6", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"6", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["H2", "3"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Beta]0"}], "]"}]}], "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Beta]", "+", "\[Beta]0"}], "]"}]}], "-", 
        RowBox[{"12", " ", "H1", " ", 
         SuperscriptBox["H2", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Beta]", "+", "\[Beta]0"}], "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HKick", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["ww", "I"], "*", "thirdOrder"}], "/.", "reppieInv"}], "//",
       "TrigReduce"}]}], ";"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.739089713773891*^9, 3.73908974639776*^9}},
 CellLabel->
  "In[451]:=",ExpressionUUID->"ef2f55e2-c81f-4b25-bf21-f48c2539a7ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ThirdOrder", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"1536", " ", 
      SuperscriptBox["ww", "3"]}]], "\[ImaginaryI]", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]d"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"48", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["H1", "2"], "-", 
         SuperscriptBox["H2", "2"]}], ")"}], " ", "sz", " ", 
       RowBox[{"(", 
        RowBox[{"Delta", "-", "ww"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["H1", "3"], "-", 
         RowBox[{
          SuperscriptBox["H1", "2"], " ", "H2"}], "+", 
         RowBox[{"H1", " ", 
          SuperscriptBox["H2", "2"]}], "-", 
         SuperscriptBox["H2", "3"]}], ")"}], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"3", " ", "H1", " ", 
       SuperscriptBox["H2", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["H2", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"6", " ", "H1", " ", 
       SuperscriptBox["H2", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["H2", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"96", " ", 
       SuperscriptBox["Delta", "2"], " ", "H1", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"96", " ", "H1DD", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"96", " ", 
       SuperscriptBox["Delta", "2"], " ", "H2", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H2", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"96", " ", "H2DD", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"192", " ", "Delta", " ", "H1D", " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"192", " ", "Delta", " ", "H2D", " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"192", " ", "Delta", " ", "H1", " ", "sx", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"192", " ", "Delta", " ", "H2", " ", "sx", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"192", " ", "H1D", " ", "sy", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"192", " ", "H2D", " ", "sy", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"384", " ", "H1", " ", "sx", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"384", " ", "H2", " ", "sx", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"48", " ", "Delta", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]d"}], 
        "]"}]}], "+", 
      RowBox[{"48", " ", "Delta", " ", 
       SuperscriptBox["H2", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]d"}], 
        "]"}]}], "+", 
      RowBox[{"96", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]d"}], 
        "]"}]}], "-", 
      RowBox[{"96", " ", 
       SuperscriptBox["H2", "2"], " ", "sz", " ", "ww", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]d"}], 
        "]"}]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]d"}], 
        "]"}]}], "+", 
      RowBox[{"12", " ", 
       SuperscriptBox["H2", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]d"}], 
        "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"6", " ", "H1", " ", 
       SuperscriptBox["H2", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["H2", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "-", 
      RowBox[{"3", " ", "H1", " ", 
       SuperscriptBox["H2", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["H2", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "H2", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "+", 
      RowBox[{"6", " ", "H1", " ", 
       SuperscriptBox["H2", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["H2", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "-", 
      RowBox[{"48", " ", "H1D", " ", "H2", " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"48", " ", "H1", " ", "H2D", " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"6", " ", "H1", " ", 
       SuperscriptBox["H2", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["H2", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"3", " ", "H1", " ", 
       SuperscriptBox["H2", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["H2", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"6", " ", "H1", " ", 
       SuperscriptBox["H2", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["H2", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"192", " ", "Delta", " ", "H1D", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"192", " ", "Delta", " ", "H2D", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"96", " ", 
       SuperscriptBox["Delta", "2"], " ", "H1", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"96", " ", "H1DD", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"96", " ", 
       SuperscriptBox["Delta", "2"], " ", "H2", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["H2", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"96", " ", "H2DD", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"192", " ", "H1D", " ", "sx", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"192", " ", "H2D", " ", "sx", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"192", " ", "Delta", " ", "H1", " ", "sy", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"192", " ", "Delta", " ", "H2", " ", "sy", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"384", " ", "H1", " ", "sy", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"384", " ", "H2", " ", "sy", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"144", " ", "H1", " ", "H1D", " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]d"}], 
        "]"}]}], "+", 
      RowBox[{"144", " ", "H2", " ", "H2D", " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]d"}], 
        "]"}]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]d"}], 
        "]"}]}], "+", 
      RowBox[{"12", " ", 
       SuperscriptBox["H2", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]d"}], 
        "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "+", "\[Alpha]d"}], "]"}]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"6", " ", "H1", " ", 
       SuperscriptBox["H2", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["H2", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "+", "\[Alpha]d"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "+", 
      RowBox[{"3", " ", "H1", " ", 
       SuperscriptBox["H2", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["H2", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "H2", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "-", 
      RowBox[{"6", " ", "H1", " ", 
       SuperscriptBox["H2", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["H2", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]d"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HKick", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["ww", "I"], "*", "ThirdOrder"}], "/.", "reppieInv"}], "//", 
    "TrigReduce"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.739194983408396*^9, 3.739195019633342*^9}, 
   3.739195445156424*^9},
 CellLabel->
  "In[452]:=",ExpressionUUID->"5603f6f4-d1ea-42e3-b3c2-b619d80d50fb"]
}, Open  ]]
},
WindowSize->{1008, 485},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> True}},
ShowSelection->True,
Magnification:>1.5 Inherited,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 994, 22, 135, "Input",ExpressionUUID->"6c047262-06f7-4def-b8fd-544910e5d36a"],
Cell[1555, 44, 228, 4, 106, "Input",ExpressionUUID->"facbcaac-a43a-4b57-9a7f-e9ec53e6e894"],
Cell[1786, 50, 175, 3, 47, "Input",ExpressionUUID->"721288f1-7c6e-49b5-80bd-e47d1ece0c72"],
Cell[CellGroupData[{
Cell[1986, 57, 410, 6, 102, "Section",ExpressionUUID->"32eb6d27-127e-44d5-b111-2a6c45ac5f51"],
Cell[2399, 65, 3707, 88, 343, "Input",ExpressionUUID->"7b9a0358-b6f3-42de-9a69-8c89a2d1f220"],
Cell[CellGroupData[{
Cell[6131, 157, 8492, 129, 309, "Input",ExpressionUUID->"c397ca24-69a4-493f-91d3-ee70d5e86823"],
Cell[CellGroupData[{
Cell[14648, 290, 8836, 126, 36, "Print",ExpressionUUID->"8ae8858c-53bb-4bd5-8119-bec5ec0a6476"],
Cell[23487, 418, 8924, 129, 36, "Print",ExpressionUUID->"1dad81bc-67a1-47f9-8b75-24457527ef56"],
Cell[32414, 549, 8836, 126, 36, "Print",ExpressionUUID->"bdf93db5-870c-4f8c-a49e-15b93c7b25b6"]
}, Open  ]]
}, Open  ]],
Cell[41277, 679, 451, 8, 1563, "Input",ExpressionUUID->"1ba2070e-713d-4b94-acca-5db7a2ace5f9"],
Cell[41731, 689, 175, 3, 236, "Input",ExpressionUUID->"6c5a2d12-093b-4ede-b78c-46a21d94da9b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41943, 697, 357, 6, 102, "Section",ExpressionUUID->"4bcbc86a-42b4-4dbf-8ba4-b4d16eb512f3"],
Cell[CellGroupData[{
Cell[42325, 707, 685, 14, 106, "Input",ExpressionUUID->"216b6541-5ed8-42d2-8113-a101a0036f9f"],
Cell[43013, 723, 5762, 82, 47, "Output",ExpressionUUID->"8b288f6d-14fd-4ddb-9412-b3539ad33ac7"],
Cell[48778, 807, 5920, 84, 77, "Output",ExpressionUUID->"c567f7aa-6f02-4a10-b313-1e39377f6496"]
}, Open  ]],
Cell[54713, 894, 3228, 93, 309, "Input",ExpressionUUID->"4c722c32-8986-4382-b985-5ed8d352bedb"],
Cell[CellGroupData[{
Cell[57966, 991, 511, 13, 77, "Input",ExpressionUUID->"ef4d6b76-dd69-4ca5-8a29-44bc36ef55cd"],
Cell[58480, 1006, 5903, 86, 47, "Output",ExpressionUUID->"cd5d95b9-4c25-467e-a6d2-3193f0413d1c"],
Cell[64386, 1094, 5935, 87, 47, "Output",ExpressionUUID->"31f2bb81-ffd9-48a6-a953-d454a0367331"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70358, 1186, 345, 9, 47, "Input",ExpressionUUID->"7f6f8020-75c4-4947-847d-46fe016a1d0e"],
Cell[70706, 1197, 5750, 86, 47, "Output",ExpressionUUID->"f260bc62-dc75-40e9-893e-d70c18b42792"]
}, Open  ]],
Cell[76471, 1286, 5767, 159, 483, "Input",ExpressionUUID->"0bbddc1d-3f62-43ff-807b-86b45d7253ea"],
Cell[CellGroupData[{
Cell[82263, 1449, 314, 7, 77, "Input",ExpressionUUID->"a01a8235-36c3-430d-8461-19c7114d6214"],
Cell[82580, 1458, 5665, 81, 47, "Output",ExpressionUUID->"2c8eda7a-e1b5-484e-a4ae-1e23fc5a3353"],
Cell[88248, 1541, 5668, 81, 47, "Output",ExpressionUUID->"cd03bf76-1629-4116-86a0-078ffe0e614c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93953, 1627, 1137, 34, 77, "Input",ExpressionUUID->"03a9572e-09d8-4e00-a2f8-af978cde0e91"],
Cell[95093, 1663, 6559, 109, 77, "Output",ExpressionUUID->"e769e500-f9ef-4879-8524-ca1205a42468"]
}, Open  ]],
Cell[101667, 1775, 173, 3, 30591, "Input",ExpressionUUID->"2819428d-c3e8-429d-a13c-f5104770ae41"],
Cell[101843, 1780, 492, 10, 75242, "Text",ExpressionUUID->"87ac8d07-10f9-485b-be11-6a4a324f32d8"],
Cell[102338, 1792, 4812, 132, 431385, "Input",ExpressionUUID->"3140e23a-edfa-4156-8d0f-b5a7b0a7533a"],
Cell[107153, 1926, 229, 4, 69345, "Input",ExpressionUUID->"09f3bd6e-ba21-4e4e-b3e3-96555f76aa63"],
Cell[107385, 1932, 229, 4, 69345, "Input",ExpressionUUID->"0307b34c-3907-409a-b408-b03cbc85c648"],
Cell[107617, 1938, 8669, 189, 639488, "Input",ExpressionUUID->"ccabe858-fe33-4de0-be08-7331aa9d41a3"],
Cell[116289, 2129, 257, 5, 88330, "Input",ExpressionUUID->"adb30d95-e908-4d2c-9c8e-5886451f92d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116583, 2139, 352, 6, 66757, "Section",ExpressionUUID->"5de7e064-e812-42ce-a5c5-74d28fab2001"],
Cell[116938, 2147, 229, 4, 69345, "Input",ExpressionUUID->"00197fec-a503-4b26-b229-53e932052624"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117204, 2156, 395, 6, 66757, "Section",ExpressionUUID->"ab28e685-c723-458a-a2de-9236913674c7"],
Cell[117602, 2164, 275, 6, 30591, "Input",ExpressionUUID->"6342f5e2-8b8b-4fb8-aa85-77dbbbde7a01"],
Cell[117880, 2172, 4774, 120, 431385, "Input",ExpressionUUID->"1d12a89a-53cc-40b3-99c2-9b9f52b72533"],
Cell[122657, 2294, 12650, 275, 981607, "Input",ExpressionUUID->"1c0dbf3f-8518-4498-85f4-38a88ff7acc8"],
Cell[135310, 2571, 170, 3, 50436, "Input",ExpressionUUID->"46514008-5004-4b95-aa49-289073451663"],
Cell[135483, 2576, 8441, 167, 526585, "Input",ExpressionUUID->"c3c80b85-1444-40c1-85d3-8cda474a03a6"],
Cell[143927, 2745, 231, 4, 69345, "Input",ExpressionUUID->"552601b9-58eb-4846-9aeb-14077abbe02f"],
Cell[144161, 2751, 229, 4, 69345, "Input",ExpressionUUID->"f5c1929c-d0da-4264-8437-12c8eec89070"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144427, 2760, 504, 8, 66757, "Section",ExpressionUUID->"5a05a067-3250-4f19-8143-3ad55c80f1e4"],
Cell[144934, 2770, 175, 3, 30591, "Input",ExpressionUUID->"0ab08077-9da1-419a-b558-8f13b4f6c66b"],
Cell[145112, 2775, 15404, 319, 1115617, "Input",ExpressionUUID->"a03b9462-03f4-4072-95c9-0854b4873965"],
Cell[160519, 3096, 170, 3, 50436, "Input",ExpressionUUID->"0ef0325a-b40a-402c-87cf-6c561d2e1904"],
Cell[160692, 3101, 170, 3, 50436, "Input",ExpressionUUID->"8c75b6d2-ab44-4cba-bcc0-41d81a7bc689"],
Cell[160865, 3106, 5872, 139, 579690, "Input",ExpressionUUID->"6b2cdccb-01f9-40fe-a1aa-0b94bef36e84"],
Cell[166740, 3247, 231, 4, 69345, "Input",ExpressionUUID->"279b837e-6846-456b-a285-1f74b82768b2"],
Cell[166974, 3253, 257, 5, 88330, "Input",ExpressionUUID->"36501855-014d-4d63-b90c-a0aebb111870"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167268, 3263, 540, 8, 66757, "Section",ExpressionUUID->"3643d674-51d7-4537-9e8b-01de15390abd"],
Cell[167811, 3273, 6020, 125, 825, "Input",ExpressionUUID->"381307db-54a9-4268-a042-876944a0a9c9"],
Cell[CellGroupData[{
Cell[173856, 3402, 236, 5, 47, "Input",ExpressionUUID->"bac7041d-54dd-451f-81b0-ed2d6d710720"],
Cell[174095, 3409, 1036, 17, 47, "Output",ExpressionUUID->"2eeaec6a-3958-4608-b296-c41870126e60"]
}, Open  ]],
Cell[175146, 3429, 177, 3, 30591, "Input",ExpressionUUID->"d292c81b-69f8-4d35-8b57-fab0a69681f1"],
Cell[175326, 3434, 170, 3, 50436, "Input",ExpressionUUID->"fd16a933-841a-43af-b81b-6d4f9cdf95c0"],
Cell[175499, 3439, 14930, 323, 1115106, "Input",ExpressionUUID->"bab25a44-ed74-4c80-b4bf-8ae132d9b291"],
Cell[190432, 3764, 177, 3, 30591, "Input",ExpressionUUID->"b96564a1-8295-432d-9117-66a4bb41ab5a"],
Cell[190612, 3769, 170, 3, 50436, "Input",ExpressionUUID->"20f0842c-bf85-448f-b13b-cbc3916aa231"],
Cell[190785, 3774, 229, 4, 69345, "Input",ExpressionUUID->"f3274f2d-54ce-493a-824f-1c2928297be3"],
Cell[191017, 3780, 12021, 255, 1288460, "Input",ExpressionUUID->"19806159-d3e5-4968-aba6-e06843275e8e"],
Cell[203041, 4037, 13185, 277, 1440922, "Input",ExpressionUUID->"bcdbf5af-f025-4291-bcf1-16aae54007ed"],
Cell[216229, 4316, 179, 3, 30591, "Input",ExpressionUUID->"c17c10d2-315c-47c8-a2f2-02b88bc82def"],
Cell[216411, 4321, 13990, 256, 806485, "Input",ExpressionUUID->"129555ba-380a-4b42-909d-953487e57ac5"],
Cell[230404, 4579, 175, 3, 30591, "Input",ExpressionUUID->"51cd5449-62f5-4e7a-8ef9-8286d176d857"],
Cell[230582, 4584, 170, 3, 50436, "Input",ExpressionUUID->"b037b1ad-f428-422b-bbb6-6de9826fe4c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230789, 4592, 543, 8, 66757, "Section",ExpressionUUID->"85f8edec-b807-4dda-9bda-105ddc4c9f96"],
Cell[231335, 4602, 1961, 43, 202736, "Input",ExpressionUUID->"997732a3-c0e7-4f15-bcf7-132a2b8e0123"],
Cell[233299, 4647, 255, 5, 88330, "Input",ExpressionUUID->"d90675c0-95f0-4e8f-9e4a-202a35079bea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[233591, 4657, 489, 7, 66757, "Section",ExpressionUUID->"b21775d1-5ed1-4904-99ad-a357f6c53dce"],
Cell[234083, 4666, 223, 4, 30591, "Input",ExpressionUUID->"febb14c8-1e1c-4e78-8252-5850e21ed31d"],
Cell[234309, 4672, 276, 6, 30591, "Input",ExpressionUUID->"6f9bb2d7-80ba-4a37-af64-06993882ecce"],
Cell[234588, 4680, 910, 27, 64683, "Input",ExpressionUUID->"86c8e4e5-9377-455b-8eb6-722723d81189"],
Cell[235501, 4709, 175, 3, 30591, "Input",ExpressionUUID->"ae59c44a-df68-4f21-8f0c-cebc19c6cf11"],
Cell[235679, 4714, 393, 11, 105, "Input",ExpressionUUID->"78aedaf8-8349-414d-a82e-096382a97b94"],
Cell[236075, 4727, 373, 8, 173, "Input",ExpressionUUID->"20918a50-5b1e-4d20-adf9-af5c0415d1db"],
Cell[236451, 4737, 23077, 567, 3757, "Input",ExpressionUUID->"183b858c-8862-4639-8c67-9872ab1bcfcd"],
Cell[259531, 5306, 172, 3, 173, "Input",ExpressionUUID->"1353eee7-df5f-4ce9-b535-786588196b0c"],
Cell[259706, 5311, 272, 6, 47, "Input",ExpressionUUID->"0ee91e2a-69ff-4482-a54e-d2d30175c7a3"],
Cell[CellGroupData[{
Cell[260003, 5321, 6150, 158, 655, "Input",ExpressionUUID->"310ddad8-cfc0-4c98-b1f8-d379200922ab"],
Cell[266156, 5481, 736, 12, 66, "Print",ExpressionUUID->"85a9c6d5-0fe6-4c86-9994-aa67fe73c707"]
}, Open  ]],
Cell[266907, 5496, 231, 4, 106, "Input",ExpressionUUID->"913aa2a5-fa7b-45fa-acc1-ad4fac5cb1fb"],
Cell[267141, 5502, 14170, 322, 890, "Input",ExpressionUUID->"ef2f55e2-c81f-4b25-bf21-f48c2539a7ea"],
Cell[281314, 5826, 18426, 426, 1407, "Input",ExpressionUUID->"5603f6f4-d1ea-42e3-b3c2-b619d80d50fb"]
}, Open  ]]
}
]
*)

